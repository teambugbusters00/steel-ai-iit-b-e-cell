var Gie=Object.defineProperty;var YX=t=>{throw TypeError(t)};var Bie=(t,e,n)=>e in t?Gie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var wi=(t,e,n)=>Bie(t,typeof e!="symbol"?e+"":e,n),V1=(t,e,n)=>e.has(t)||YX("Cannot "+n);var ue=(t,e,n)=>(V1(t,e,"read from private field"),n?n.call(t):e.get(t)),qt=(t,e,n)=>e.has(t)?YX("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Zt=(t,e,n,i)=>(V1(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),vn=(t,e,n)=>(V1(t,e,"access private method"),n);var rb=(t,e,n,i)=>({set _(r){Zt(t,e,r,n)},get _(){return ue(t,e,i)}});function Sie(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var sb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xj={exports:{}},c2={},Ej={exports:{}},Zn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x0=Symbol.for("react.element"),Zie=Symbol.for("react.portal"),Rie=Symbol.for("react.fragment"),Nie=Symbol.for("react.strict_mode"),Wie=Symbol.for("react.profiler"),Mie=Symbol.for("react.provider"),Vie=Symbol.for("react.context"),Fie=Symbol.for("react.forward_ref"),_ie=Symbol.for("react.suspense"),Tie=Symbol.for("react.memo"),Xie=Symbol.for("react.lazy"),kX=Symbol.iterator;function Eie(t){return t===null||typeof t!="object"?null:(t=kX&&t[kX]||t["@@iterator"],typeof t=="function"?t:null)}var Yj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kj=Object.assign,Hj={};function vC(t,e,n){this.props=t,this.context=e,this.refs=Hj,this.updater=n||Yj}vC.prototype.isReactComponent={};vC.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vC.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Kj(){}Kj.prototype=vC.prototype;function tV(t,e,n){this.props=t,this.context=e,this.refs=Hj,this.updater=n||Yj}var nV=tV.prototype=new Kj;nV.constructor=tV;kj(nV,vC.prototype);nV.isPureReactComponent=!0;var HX=Array.isArray,Lj=Object.prototype.hasOwnProperty,iV={current:null},zj={key:!0,ref:!0,__self:!0,__source:!0};function jj(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Lj.call(e,i)&&!zj.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:x0,type:t,key:s,ref:o,props:r,_owner:iV.current}}function Yie(t,e){return{$$typeof:x0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rV(t){return typeof t=="object"&&t!==null&&t.$$typeof===x0}function kie(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var KX=/\/+/g;function F1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?kie(""+t.key):e.toString(36)}function tx(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case x0:case Zie:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+F1(o,0):i,HX(r)?(n="",t!=null&&(n=t.replace(KX,"$&/")+"/"),tx(r,e,n,"",function(c){return c})):r!=null&&(rV(r)&&(r=Yie(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(KX,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",HX(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+F1(s,a);o+=tx(s,e,n,l,r)}else if(l=Eie(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+F1(s,a++),o+=tx(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ob(t,e,n){if(t==null)return t;var i=[],r=0;return tx(t,i,"","",function(s){return e.call(n,s,r++)}),i}function Hie(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zs={current:null},nx={transition:null},Kie={ReactCurrentDispatcher:Zs,ReactCurrentBatchConfig:nx,ReactCurrentOwner:iV};function Pj(){throw Error("act(...) is not supported in production builds of React.")}Zn.Children={map:ob,forEach:function(t,e,n){ob(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ob(t,function(){e++}),e},toArray:function(t){return ob(t,function(e){return e})||[]},only:function(t){if(!rV(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Zn.Component=vC;Zn.Fragment=Rie;Zn.Profiler=Wie;Zn.PureComponent=tV;Zn.StrictMode=Nie;Zn.Suspense=_ie;Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kie;Zn.act=Pj;Zn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=kj({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=iV.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Lj.call(e,l)&&!zj.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:x0,type:t.type,key:r,ref:s,props:i,_owner:o}};Zn.createContext=function(t){return t={$$typeof:Vie,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mie,_context:t},t.Consumer=t};Zn.createElement=jj;Zn.createFactory=function(t){var e=jj.bind(null,t);return e.type=t,e};Zn.createRef=function(){return{current:null}};Zn.forwardRef=function(t){return{$$typeof:Fie,render:t}};Zn.isValidElement=rV;Zn.lazy=function(t){return{$$typeof:Xie,_payload:{_status:-1,_result:t},_init:Hie}};Zn.memo=function(t,e){return{$$typeof:Tie,type:t,compare:e===void 0?null:e}};Zn.startTransition=function(t){var e=nx.transition;nx.transition={};try{t()}finally{nx.transition=e}};Zn.unstable_act=Pj;Zn.useCallback=function(t,e){return Zs.current.useCallback(t,e)};Zn.useContext=function(t){return Zs.current.useContext(t)};Zn.useDebugValue=function(){};Zn.useDeferredValue=function(t){return Zs.current.useDeferredValue(t)};Zn.useEffect=function(t,e){return Zs.current.useEffect(t,e)};Zn.useId=function(){return Zs.current.useId()};Zn.useImperativeHandle=function(t,e,n){return Zs.current.useImperativeHandle(t,e,n)};Zn.useInsertionEffect=function(t,e){return Zs.current.useInsertionEffect(t,e)};Zn.useLayoutEffect=function(t,e){return Zs.current.useLayoutEffect(t,e)};Zn.useMemo=function(t,e){return Zs.current.useMemo(t,e)};Zn.useReducer=function(t,e,n){return Zs.current.useReducer(t,e,n)};Zn.useRef=function(t){return Zs.current.useRef(t)};Zn.useState=function(t){return Zs.current.useState(t)};Zn.useSyncExternalStore=function(t,e,n){return Zs.current.useSyncExternalStore(t,e,n)};Zn.useTransition=function(){return Zs.current.useTransition()};Zn.version="18.3.1";Ej.exports=Zn;var S=Ej.exports;const $=Pn(S),Oj=Sie({__proto__:null,default:$},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lie=S,zie=Symbol.for("react.element"),jie=Symbol.for("react.fragment"),Pie=Object.prototype.hasOwnProperty,Oie=Lie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Die={key:!0,ref:!0,__self:!0,__source:!0};function Dj(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Pie.call(e,i)&&!Die.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:zie,type:t,key:s,ref:o,props:r,_owner:Oie.current}}c2.Fragment=jie;c2.jsx=Dj;c2.jsxs=Dj;Xj.exports=c2;var g=Xj.exports,Uj={exports:{}},Zo={},Jj={exports:{}},Qj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,E){var P=_.length;_.push(E);e:for(;0<P;){var q=P-1>>>1,re=_[q];if(0<r(re,E))_[q]=E,_[P]=re,P=q;else break e}}function n(_){return _.length===0?null:_[0]}function i(_){if(_.length===0)return null;var E=_[0],P=_.pop();if(P!==E){_[0]=P;e:for(var q=0,re=_.length,de=re>>>1;q<de;){var Re=2*(q+1)-1,Pe=_[Re],ae=Re+1,he=_[ae];if(0>r(Pe,P))ae<re&&0>r(he,Pe)?(_[q]=he,_[ae]=P,q=ae):(_[q]=Pe,_[Re]=P,q=Re);else if(ae<re&&0>r(he,P))_[q]=he,_[ae]=P,q=ae;else break e}}return E}function r(_,E){var P=_.sortIndex-E.sortIndex;return P!==0?P:_.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,I=!1,p=!1,y=!1,A=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(_){for(var E=n(c);E!==null;){if(E.callback===null)i(c);else if(E.startTime<=_)i(c),E.sortIndex=E.expirationTime,e(l,E);else break;E=n(c)}}function w(_){if(y=!1,v(_),!p)if(n(l)!==null)p=!0,j(x);else{var E=n(c);E!==null&&O(w,E.startTime-_)}}function x(_,E){p=!1,y&&(y=!1,m(N),N=-1),I=!0;var P=h;try{for(v(E),d=n(l);d!==null&&(!(d.expirationTime>E)||_&&!F());){var q=d.callback;if(typeof q=="function"){d.callback=null,h=d.priorityLevel;var re=q(d.expirationTime<=E);E=t.unstable_now(),typeof re=="function"?d.callback=re:d===n(l)&&i(l),v(E)}else i(l);d=n(l)}if(d!==null)var de=!0;else{var Re=n(c);Re!==null&&O(w,Re.startTime-E),de=!1}return de}finally{d=null,h=P,I=!1}}var B=!1,Z=null,N=-1,W=5,M=-1;function F(){return!(t.unstable_now()-M<W)}function T(){if(Z!==null){var _=t.unstable_now();M=_;var E=!0;try{E=Z(!0,_)}finally{E?H():(B=!1,Z=null)}}else B=!1}var H;if(typeof b=="function")H=function(){b(T)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,z=K.port2;K.port1.onmessage=T,H=function(){z.postMessage(null)}}else H=function(){A(T,0)};function j(_){Z=_,B||(B=!0,H())}function O(_,E){N=A(function(){_(t.unstable_now())},E)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){p||I||(p=!0,j(x))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var E=3;break;default:E=h}var P=h;h=E;try{return _()}finally{h=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,E){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var P=h;h=_;try{return E()}finally{h=P}},t.unstable_scheduleCallback=function(_,E,P){var q=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?q+P:q):P=q,_){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=P+re,_={id:u++,callback:E,priorityLevel:_,startTime:P,expirationTime:re,sortIndex:-1},P>q?(_.sortIndex=P,e(c,_),n(l)===null&&_===n(c)&&(y?(m(N),N=-1):y=!0,O(w,P-q))):(_.sortIndex=re,e(l,_),p||I||(p=!0,j(x))),_},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(_){var E=h;return function(){var P=h;h=E;try{return _.apply(this,arguments)}finally{h=P}}}})(Qj);Jj.exports=Qj;var Uie=Jj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jie=S,So=Uie;function lt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qj=new Set,Qm={};function ah(t,e){pf(t,e),pf(t+"Capture",e)}function pf(t,e){for(Qm[t]=e,t=0;t<e.length;t++)qj.add(e[t])}var Vc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),CN=Object.prototype.hasOwnProperty,Qie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LX={},zX={};function qie(t){return CN.call(zX,t)?!0:CN.call(LX,t)?!1:Qie.test(t)?zX[t]=!0:(LX[t]=!0,!1)}function $ie(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ere(t,e,n,i){if(e===null||typeof e>"u"||$ie(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rs(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xr[t]=new Rs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xr[e]=new Rs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xr[t]=new Rs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xr[t]=new Rs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xr[t]=new Rs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xr[t]=new Rs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xr[t]=new Rs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xr[t]=new Rs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xr[t]=new Rs(t,5,!1,t.toLowerCase(),null,!1,!1)});var sV=/[\-:]([a-z])/g;function oV(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sV,oV);Xr[e]=new Rs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sV,oV);Xr[e]=new Rs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sV,oV);Xr[e]=new Rs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xr[t]=new Rs(t,1,!1,t.toLowerCase(),null,!1,!1)});Xr.xlinkHref=new Rs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xr[t]=new Rs(t,1,!1,t.toLowerCase(),null,!0,!0)});function aV(t,e,n,i){var r=Xr.hasOwnProperty(e)?Xr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ere(e,n,r,i)&&(n=null),i||r===null?qie(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var zc=Jie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ab=Symbol.for("react.element"),CI=Symbol.for("react.portal"),pI=Symbol.for("react.fragment"),lV=Symbol.for("react.strict_mode"),pN=Symbol.for("react.profiler"),$j=Symbol.for("react.provider"),eP=Symbol.for("react.context"),cV=Symbol.for("react.forward_ref"),mN=Symbol.for("react.suspense"),AN=Symbol.for("react.suspense_list"),gV=Symbol.for("react.memo"),mg=Symbol.for("react.lazy"),tP=Symbol.for("react.offscreen"),jX=Symbol.iterator;function yp(t){return t===null||typeof t!="object"?null:(t=jX&&t[jX]||t["@@iterator"],typeof t=="function"?t:null)}var Ti=Object.assign,_1;function cm(t){if(_1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_1=e&&e[1]||""}return`
`+_1+t}var T1=!1;function X1(t,e){if(!t||T1)return"";T1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{T1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cm(t):""}function tre(t){switch(t.tag){case 5:return cm(t.type);case 16:return cm("Lazy");case 13:return cm("Suspense");case 19:return cm("SuspenseList");case 0:case 2:case 15:return t=X1(t.type,!1),t;case 11:return t=X1(t.type.render,!1),t;case 1:return t=X1(t.type,!0),t;default:return""}}function yN(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pI:return"Fragment";case CI:return"Portal";case pN:return"Profiler";case lV:return"StrictMode";case mN:return"Suspense";case AN:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eP:return(t.displayName||"Context")+".Consumer";case $j:return(t._context.displayName||"Context")+".Provider";case cV:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gV:return e=t.displayName||null,e!==null?e:yN(t.type)||"Memo";case mg:e=t._payload,t=t._init;try{return yN(t(e))}catch{}}return null}function nre(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yN(e);case 8:return e===lV?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $g(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function nP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ire(t){var e=nP(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function lb(t){t._valueTracker||(t._valueTracker=ire(t))}function iP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=nP(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Vx(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bN(t,e){var n=e.checked;return Ti({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function PX(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=$g(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rP(t,e){e=e.checked,e!=null&&aV(t,"checked",e,!1)}function vN(t,e){rP(t,e);var n=$g(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xN(t,e.type,n):e.hasOwnProperty("defaultValue")&&xN(t,e.type,$g(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function OX(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xN(t,e,n){(e!=="number"||Vx(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var gm=Array.isArray;function XI(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+$g(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function wN(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(lt(91));return Ti({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function DX(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(lt(92));if(gm(n)){if(1<n.length)throw Error(lt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$g(n)}}function sP(t,e){var n=$g(e.value),i=$g(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function UX(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function oP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GN(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?oP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cb,aP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cb=cb||document.createElement("div"),cb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qm(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rre=["Webkit","ms","Moz","O"];Object.keys(vm).forEach(function(t){rre.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vm[e]=vm[t]})});function lP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vm.hasOwnProperty(t)&&vm[t]?(""+e).trim():e+"px"}function cP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=lP(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var sre=Ti({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function BN(t,e){if(e){if(sre[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(lt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(lt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(lt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(lt(62))}}function SN(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ZN=null;function uV(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var RN=null,EI=null,YI=null;function JX(t){if(t=B0(t)){if(typeof RN!="function")throw Error(lt(280));var e=t.stateNode;e&&(e=I2(e),RN(t.stateNode,t.type,e))}}function gP(t){EI?YI?YI.push(t):YI=[t]:EI=t}function uP(){if(EI){var t=EI,e=YI;if(YI=EI=null,JX(t),e)for(t=0;t<e.length;t++)JX(e[t])}}function dP(t,e){return t(e)}function hP(){}var E1=!1;function IP(t,e,n){if(E1)return t(e,n);E1=!0;try{return dP(t,e,n)}finally{E1=!1,(EI!==null||YI!==null)&&(hP(),uP())}}function $m(t,e){var n=t.stateNode;if(n===null)return null;var i=I2(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(lt(231,e,typeof n));return n}var NN=!1;if(Vc)try{var bp={};Object.defineProperty(bp,"passive",{get:function(){NN=!0}}),window.addEventListener("test",bp,bp),window.removeEventListener("test",bp,bp)}catch{NN=!1}function ore(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var xm=!1,Fx=null,_x=!1,WN=null,are={onError:function(t){xm=!0,Fx=t}};function lre(t,e,n,i,r,s,o,a,l){xm=!1,Fx=null,ore.apply(are,arguments)}function cre(t,e,n,i,r,s,o,a,l){if(lre.apply(this,arguments),xm){if(xm){var c=Fx;xm=!1,Fx=null}else throw Error(lt(198));_x||(_x=!0,WN=c)}}function lh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function fP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function QX(t){if(lh(t)!==t)throw Error(lt(188))}function gre(t){var e=t.alternate;if(!e){if(e=lh(t),e===null)throw Error(lt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return QX(r),t;if(s===i)return QX(r),e;s=s.sibling}throw Error(lt(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(lt(189))}}if(n.alternate!==i)throw Error(lt(190))}if(n.tag!==3)throw Error(lt(188));return n.stateNode.current===n?t:e}function CP(t){return t=gre(t),t!==null?pP(t):null}function pP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pP(t);if(e!==null)return e;t=t.sibling}return null}var mP=So.unstable_scheduleCallback,qX=So.unstable_cancelCallback,ure=So.unstable_shouldYield,dre=So.unstable_requestPaint,Oi=So.unstable_now,hre=So.unstable_getCurrentPriorityLevel,dV=So.unstable_ImmediatePriority,AP=So.unstable_UserBlockingPriority,Tx=So.unstable_NormalPriority,Ire=So.unstable_LowPriority,yP=So.unstable_IdlePriority,g2=null,Rl=null;function fre(t){if(Rl&&typeof Rl.onCommitFiberRoot=="function")try{Rl.onCommitFiberRoot(g2,t,void 0,(t.current.flags&128)===128)}catch{}}var Ka=Math.clz32?Math.clz32:mre,Cre=Math.log,pre=Math.LN2;function mre(t){return t>>>=0,t===0?32:31-(Cre(t)/pre|0)|0}var gb=64,ub=4194304;function um(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xx(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=um(a):(s&=o,s!==0&&(i=um(s)))}else o=n&~r,o!==0?i=um(o):s!==0&&(i=um(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ka(e),r=1<<n,i|=t[n],e&=~r;return i}function Are(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yre(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ka(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=Are(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function MN(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bP(){var t=gb;return gb<<=1,!(gb&4194240)&&(gb=64),t}function Y1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function w0(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ka(e),t[e]=n}function bre(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ka(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function hV(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ka(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ei=0;function vP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var xP,IV,wP,GP,BP,VN=!1,db=[],Kg=null,Lg=null,zg=null,eA=new Map,tA=new Map,vg=[],vre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $X(t,e){switch(t){case"focusin":case"focusout":Kg=null;break;case"dragenter":case"dragleave":Lg=null;break;case"mouseover":case"mouseout":zg=null;break;case"pointerover":case"pointerout":eA.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tA.delete(e.pointerId)}}function vp(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=B0(e),e!==null&&IV(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function xre(t,e,n,i,r){switch(e){case"focusin":return Kg=vp(Kg,t,e,n,i,r),!0;case"dragenter":return Lg=vp(Lg,t,e,n,i,r),!0;case"mouseover":return zg=vp(zg,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return eA.set(s,vp(eA.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,tA.set(s,vp(tA.get(s)||null,t,e,n,i,r)),!0}return!1}function SP(t){var e=dd(t.target);if(e!==null){var n=lh(e);if(n!==null){if(e=n.tag,e===13){if(e=fP(n),e!==null){t.blockedOn=e,BP(t.priority,function(){wP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ix(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=FN(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);ZN=i,n.target.dispatchEvent(i),ZN=null}else return e=B0(n),e!==null&&IV(e),t.blockedOn=n,!1;e.shift()}return!0}function eE(t,e,n){ix(t)&&n.delete(e)}function wre(){VN=!1,Kg!==null&&ix(Kg)&&(Kg=null),Lg!==null&&ix(Lg)&&(Lg=null),zg!==null&&ix(zg)&&(zg=null),eA.forEach(eE),tA.forEach(eE)}function xp(t,e){t.blockedOn===e&&(t.blockedOn=null,VN||(VN=!0,So.unstable_scheduleCallback(So.unstable_NormalPriority,wre)))}function nA(t){function e(r){return xp(r,t)}if(0<db.length){xp(db[0],t);for(var n=1;n<db.length;n++){var i=db[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Kg!==null&&xp(Kg,t),Lg!==null&&xp(Lg,t),zg!==null&&xp(zg,t),eA.forEach(e),tA.forEach(e),n=0;n<vg.length;n++)i=vg[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<vg.length&&(n=vg[0],n.blockedOn===null);)SP(n),n.blockedOn===null&&vg.shift()}var kI=zc.ReactCurrentBatchConfig,Ex=!0;function Gre(t,e,n,i){var r=ei,s=kI.transition;kI.transition=null;try{ei=1,fV(t,e,n,i)}finally{ei=r,kI.transition=s}}function Bre(t,e,n,i){var r=ei,s=kI.transition;kI.transition=null;try{ei=4,fV(t,e,n,i)}finally{ei=r,kI.transition=s}}function fV(t,e,n,i){if(Ex){var r=FN(t,e,n,i);if(r===null)U1(t,e,i,Yx,n),$X(t,i);else if(xre(r,t,e,n,i))i.stopPropagation();else if($X(t,i),e&4&&-1<vre.indexOf(t)){for(;r!==null;){var s=B0(r);if(s!==null&&xP(s),s=FN(t,e,n,i),s===null&&U1(t,e,i,Yx,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else U1(t,e,i,null,n)}}var Yx=null;function FN(t,e,n,i){if(Yx=null,t=uV(i),t=dd(t),t!==null)if(e=lh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=fP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yx=t,null}function ZP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hre()){case dV:return 1;case AP:return 4;case Tx:case Ire:return 16;case yP:return 536870912;default:return 16}default:return 16}}var _g=null,CV=null,rx=null;function RP(){if(rx)return rx;var t,e=CV,n=e.length,i,r="value"in _g?_g.value:_g.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return rx=r.slice(t,1<i?1-i:void 0)}function sx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hb(){return!0}function tE(){return!1}function Ro(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?hb:tE,this.isPropagationStopped=tE,this}return Ti(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hb)},persist:function(){},isPersistent:hb}),e}var xC={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pV=Ro(xC),G0=Ti({},xC,{view:0,detail:0}),Sre=Ro(G0),k1,H1,wp,u2=Ti({},G0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mV,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wp&&(wp&&t.type==="mousemove"?(k1=t.screenX-wp.screenX,H1=t.screenY-wp.screenY):H1=k1=0,wp=t),k1)},movementY:function(t){return"movementY"in t?t.movementY:H1}}),nE=Ro(u2),Zre=Ti({},u2,{dataTransfer:0}),Rre=Ro(Zre),Nre=Ti({},G0,{relatedTarget:0}),K1=Ro(Nre),Wre=Ti({},xC,{animationName:0,elapsedTime:0,pseudoElement:0}),Mre=Ro(Wre),Vre=Ti({},xC,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Fre=Ro(Vre),_re=Ti({},xC,{data:0}),iE=Ro(_re),Tre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xre={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ere={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yre(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ere[t])?!!e[t]:!1}function mV(){return Yre}var kre=Ti({},G0,{key:function(t){if(t.key){var e=Tre[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xre[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mV,charCode:function(t){return t.type==="keypress"?sx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Hre=Ro(kre),Kre=Ti({},u2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rE=Ro(Kre),Lre=Ti({},G0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mV}),zre=Ro(Lre),jre=Ti({},xC,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pre=Ro(jre),Ore=Ti({},u2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Dre=Ro(Ore),Ure=[9,13,27,32],AV=Vc&&"CompositionEvent"in window,wm=null;Vc&&"documentMode"in document&&(wm=document.documentMode);var Jre=Vc&&"TextEvent"in window&&!wm,NP=Vc&&(!AV||wm&&8<wm&&11>=wm),sE=" ",oE=!1;function WP(t,e){switch(t){case"keyup":return Ure.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mI=!1;function Qre(t,e){switch(t){case"compositionend":return MP(e);case"keypress":return e.which!==32?null:(oE=!0,sE);case"textInput":return t=e.data,t===sE&&oE?null:t;default:return null}}function qre(t,e){if(mI)return t==="compositionend"||!AV&&WP(t,e)?(t=RP(),rx=CV=_g=null,mI=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return NP&&e.locale!=="ko"?null:e.data;default:return null}}var $re={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$re[t.type]:e==="textarea"}function VP(t,e,n,i){gP(i),e=kx(e,"onChange"),0<e.length&&(n=new pV("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Gm=null,iA=null;function ese(t){zP(t,0)}function d2(t){var e=bI(t);if(iP(e))return t}function tse(t,e){if(t==="change")return e}var FP=!1;if(Vc){var L1;if(Vc){var z1="oninput"in document;if(!z1){var lE=document.createElement("div");lE.setAttribute("oninput","return;"),z1=typeof lE.oninput=="function"}L1=z1}else L1=!1;FP=L1&&(!document.documentMode||9<document.documentMode)}function cE(){Gm&&(Gm.detachEvent("onpropertychange",_P),iA=Gm=null)}function _P(t){if(t.propertyName==="value"&&d2(iA)){var e=[];VP(e,iA,t,uV(t)),IP(ese,e)}}function nse(t,e,n){t==="focusin"?(cE(),Gm=e,iA=n,Gm.attachEvent("onpropertychange",_P)):t==="focusout"&&cE()}function ise(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return d2(iA)}function rse(t,e){if(t==="click")return d2(e)}function sse(t,e){if(t==="input"||t==="change")return d2(e)}function ose(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ja=typeof Object.is=="function"?Object.is:ose;function rA(t,e){if(Ja(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!CN.call(e,r)||!Ja(t[r],e[r]))return!1}return!0}function gE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function uE(t,e){var n=gE(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gE(n)}}function TP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?TP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function XP(){for(var t=window,e=Vx();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vx(t.document)}return e}function yV(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ase(t){var e=XP(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&TP(n.ownerDocument.documentElement,n)){if(i!==null&&yV(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=uE(n,s);var o=uE(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lse=Vc&&"documentMode"in document&&11>=document.documentMode,AI=null,_N=null,Bm=null,TN=!1;function dE(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;TN||AI==null||AI!==Vx(i)||(i=AI,"selectionStart"in i&&yV(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Bm&&rA(Bm,i)||(Bm=i,i=kx(_N,"onSelect"),0<i.length&&(e=new pV("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=AI)))}function Ib(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yI={animationend:Ib("Animation","AnimationEnd"),animationiteration:Ib("Animation","AnimationIteration"),animationstart:Ib("Animation","AnimationStart"),transitionend:Ib("Transition","TransitionEnd")},j1={},EP={};Vc&&(EP=document.createElement("div").style,"AnimationEvent"in window||(delete yI.animationend.animation,delete yI.animationiteration.animation,delete yI.animationstart.animation),"TransitionEvent"in window||delete yI.transitionend.transition);function h2(t){if(j1[t])return j1[t];if(!yI[t])return t;var e=yI[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in EP)return j1[t]=e[n];return t}var YP=h2("animationend"),kP=h2("animationiteration"),HP=h2("animationstart"),KP=h2("transitionend"),LP=new Map,hE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function du(t,e){LP.set(t,e),ah(e,[t])}for(var P1=0;P1<hE.length;P1++){var O1=hE[P1],cse=O1.toLowerCase(),gse=O1[0].toUpperCase()+O1.slice(1);du(cse,"on"+gse)}du(YP,"onAnimationEnd");du(kP,"onAnimationIteration");du(HP,"onAnimationStart");du("dblclick","onDoubleClick");du("focusin","onFocus");du("focusout","onBlur");du(KP,"onTransitionEnd");pf("onMouseEnter",["mouseout","mouseover"]);pf("onMouseLeave",["mouseout","mouseover"]);pf("onPointerEnter",["pointerout","pointerover"]);pf("onPointerLeave",["pointerout","pointerover"]);ah("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ah("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ah("onBeforeInput",["compositionend","keypress","textInput","paste"]);ah("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ah("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ah("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),use=new Set("cancel close invalid load scroll toggle".split(" ").concat(dm));function IE(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,cre(i,e,void 0,t),t.currentTarget=null}function zP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;IE(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;IE(r,a,c),s=l}}}if(_x)throw t=WN,_x=!1,WN=null,t}function Ci(t,e){var n=e[HN];n===void 0&&(n=e[HN]=new Set);var i=t+"__bubble";n.has(i)||(jP(e,t,2,!1),n.add(i))}function D1(t,e,n){var i=0;e&&(i|=4),jP(n,t,i,e)}var fb="_reactListening"+Math.random().toString(36).slice(2);function sA(t){if(!t[fb]){t[fb]=!0,qj.forEach(function(n){n!=="selectionchange"&&(use.has(n)||D1(n,!1,t),D1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fb]||(e[fb]=!0,D1("selectionchange",!1,e))}}function jP(t,e,n,i){switch(ZP(e)){case 1:var r=Gre;break;case 4:r=Bre;break;default:r=fV}n=r.bind(null,e,n,t),r=void 0,!NN||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function U1(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=dd(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}IP(function(){var c=s,u=uV(n),d=[];e:{var h=LP.get(t);if(h!==void 0){var I=pV,p=t;switch(t){case"keypress":if(sx(n)===0)break e;case"keydown":case"keyup":I=Hre;break;case"focusin":p="focus",I=K1;break;case"focusout":p="blur",I=K1;break;case"beforeblur":case"afterblur":I=K1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=nE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=Rre;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=zre;break;case YP:case kP:case HP:I=Mre;break;case KP:I=Pre;break;case"scroll":I=Sre;break;case"wheel":I=Dre;break;case"copy":case"cut":case"paste":I=Fre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=rE}var y=(e&4)!==0,A=!y&&t==="scroll",m=y?h!==null?h+"Capture":null:h;y=[];for(var b=c,v;b!==null;){v=b;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,m!==null&&(w=$m(b,m),w!=null&&y.push(oA(b,w,v)))),A)break;b=b.return}0<y.length&&(h=new I(h,p,null,n,u),d.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",h&&n!==ZN&&(p=n.relatedTarget||n.fromElement)&&(dd(p)||p[Fc]))break e;if((I||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,I?(p=n.relatedTarget||n.toElement,I=c,p=p?dd(p):null,p!==null&&(A=lh(p),p!==A||p.tag!==5&&p.tag!==6)&&(p=null)):(I=null,p=c),I!==p)){if(y=nE,w="onMouseLeave",m="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(y=rE,w="onPointerLeave",m="onPointerEnter",b="pointer"),A=I==null?h:bI(I),v=p==null?h:bI(p),h=new y(w,b+"leave",I,n,u),h.target=A,h.relatedTarget=v,w=null,dd(u)===c&&(y=new y(m,b+"enter",p,n,u),y.target=v,y.relatedTarget=A,w=y),A=w,I&&p)t:{for(y=I,m=p,b=0,v=y;v;v=Eh(v))b++;for(v=0,w=m;w;w=Eh(w))v++;for(;0<b-v;)y=Eh(y),b--;for(;0<v-b;)m=Eh(m),v--;for(;b--;){if(y===m||m!==null&&y===m.alternate)break t;y=Eh(y),m=Eh(m)}y=null}else y=null;I!==null&&fE(d,h,I,y,!1),p!==null&&A!==null&&fE(d,A,p,y,!0)}}e:{if(h=c?bI(c):window,I=h.nodeName&&h.nodeName.toLowerCase(),I==="select"||I==="input"&&h.type==="file")var x=tse;else if(aE(h))if(FP)x=sse;else{x=ise;var B=nse}else(I=h.nodeName)&&I.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=rse);if(x&&(x=x(t,c))){VP(d,x,n,u);break e}B&&B(t,h,c),t==="focusout"&&(B=h._wrapperState)&&B.controlled&&h.type==="number"&&xN(h,"number",h.value)}switch(B=c?bI(c):window,t){case"focusin":(aE(B)||B.contentEditable==="true")&&(AI=B,_N=c,Bm=null);break;case"focusout":Bm=_N=AI=null;break;case"mousedown":TN=!0;break;case"contextmenu":case"mouseup":case"dragend":TN=!1,dE(d,n,u);break;case"selectionchange":if(lse)break;case"keydown":case"keyup":dE(d,n,u)}var Z;if(AV)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else mI?WP(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(NP&&n.locale!=="ko"&&(mI||N!=="onCompositionStart"?N==="onCompositionEnd"&&mI&&(Z=RP()):(_g=u,CV="value"in _g?_g.value:_g.textContent,mI=!0)),B=kx(c,N),0<B.length&&(N=new iE(N,t,null,n,u),d.push({event:N,listeners:B}),Z?N.data=Z:(Z=MP(n),Z!==null&&(N.data=Z)))),(Z=Jre?Qre(t,n):qre(t,n))&&(c=kx(c,"onBeforeInput"),0<c.length&&(u=new iE("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=Z))}zP(d,e)})}function oA(t,e,n){return{instance:t,listener:e,currentTarget:n}}function kx(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=$m(t,n),s!=null&&i.unshift(oA(t,s,r)),s=$m(t,e),s!=null&&i.push(oA(t,s,r))),t=t.return}return i}function Eh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fE(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=$m(n,s),l!=null&&o.unshift(oA(n,l,a))):r||(l=$m(n,s),l!=null&&o.push(oA(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var dse=/\r\n?/g,hse=/\u0000|\uFFFD/g;function CE(t){return(typeof t=="string"?t:""+t).replace(dse,`
`).replace(hse,"")}function Cb(t,e,n){if(e=CE(e),CE(t)!==e&&n)throw Error(lt(425))}function Hx(){}var XN=null,EN=null;function YN(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kN=typeof setTimeout=="function"?setTimeout:void 0,Ise=typeof clearTimeout=="function"?clearTimeout:void 0,pE=typeof Promise=="function"?Promise:void 0,fse=typeof queueMicrotask=="function"?queueMicrotask:typeof pE<"u"?function(t){return pE.resolve(null).then(t).catch(Cse)}:kN;function Cse(t){setTimeout(function(){throw t})}function J1(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),nA(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);nA(e)}function jg(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function mE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wC=Math.random().toString(36).slice(2),xl="__reactFiber$"+wC,aA="__reactProps$"+wC,Fc="__reactContainer$"+wC,HN="__reactEvents$"+wC,pse="__reactListeners$"+wC,mse="__reactHandles$"+wC;function dd(t){var e=t[xl];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fc]||n[xl]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=mE(t);t!==null;){if(n=t[xl])return n;t=mE(t)}return e}t=n,n=t.parentNode}return null}function B0(t){return t=t[xl]||t[Fc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function bI(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(lt(33))}function I2(t){return t[aA]||null}var KN=[],vI=-1;function hu(t){return{current:t}}function vi(t){0>vI||(t.current=KN[vI],KN[vI]=null,vI--)}function hi(t,e){vI++,KN[vI]=t.current,t.current=e}var eu={},os=hu(eu),qs=hu(!1),Kd=eu;function mf(t,e){var n=t.type.contextTypes;if(!n)return eu;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function $s(t){return t=t.childContextTypes,t!=null}function Kx(){vi(qs),vi(os)}function AE(t,e,n){if(os.current!==eu)throw Error(lt(168));hi(os,e),hi(qs,n)}function PP(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(lt(108,nre(t)||"Unknown",r));return Ti({},n,i)}function Lx(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||eu,Kd=os.current,hi(os,t),hi(qs,qs.current),!0}function yE(t,e,n){var i=t.stateNode;if(!i)throw Error(lt(169));n?(t=PP(t,e,Kd),i.__reactInternalMemoizedMergedChildContext=t,vi(qs),vi(os),hi(os,t)):vi(qs),hi(qs,n)}var fc=null,f2=!1,Q1=!1;function OP(t){fc===null?fc=[t]:fc.push(t)}function Ase(t){f2=!0,OP(t)}function Iu(){if(!Q1&&fc!==null){Q1=!0;var t=0,e=ei;try{var n=fc;for(ei=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}fc=null,f2=!1}catch(r){throw fc!==null&&(fc=fc.slice(t+1)),mP(dV,Iu),r}finally{ei=e,Q1=!1}}return null}var xI=[],wI=0,zx=null,jx=0,Oo=[],Do=0,Ld=null,Ac=1,yc="";function ed(t,e){xI[wI++]=jx,xI[wI++]=zx,zx=t,jx=e}function DP(t,e,n){Oo[Do++]=Ac,Oo[Do++]=yc,Oo[Do++]=Ld,Ld=t;var i=Ac;t=yc;var r=32-Ka(i)-1;i&=~(1<<r),n+=1;var s=32-Ka(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Ac=1<<32-Ka(e)+r|n<<r|i,yc=s+t}else Ac=1<<s|n<<r|i,yc=t}function bV(t){t.return!==null&&(ed(t,1),DP(t,1,0))}function vV(t){for(;t===zx;)zx=xI[--wI],xI[wI]=null,jx=xI[--wI],xI[wI]=null;for(;t===Ld;)Ld=Oo[--Do],Oo[Do]=null,yc=Oo[--Do],Oo[Do]=null,Ac=Oo[--Do],Oo[Do]=null}var vo=null,Ao=null,Gi=!1,Ta=null;function UP(t,e){var n=qo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vo=t,Ao=jg(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vo=t,Ao=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ld!==null?{id:Ac,overflow:yc}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vo=t,Ao=null,!0):!1;default:return!1}}function LN(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zN(t){if(Gi){var e=Ao;if(e){var n=e;if(!bE(t,e)){if(LN(t))throw Error(lt(418));e=jg(n.nextSibling);var i=vo;e&&bE(t,e)?UP(i,n):(t.flags=t.flags&-4097|2,Gi=!1,vo=t)}}else{if(LN(t))throw Error(lt(418));t.flags=t.flags&-4097|2,Gi=!1,vo=t}}}function vE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vo=t}function pb(t){if(t!==vo)return!1;if(!Gi)return vE(t),Gi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!YN(t.type,t.memoizedProps)),e&&(e=Ao)){if(LN(t))throw JP(),Error(lt(418));for(;e;)UP(t,e),e=jg(e.nextSibling)}if(vE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(lt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ao=jg(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ao=null}}else Ao=vo?jg(t.stateNode.nextSibling):null;return!0}function JP(){for(var t=Ao;t;)t=jg(t.nextSibling)}function Af(){Ao=vo=null,Gi=!1}function xV(t){Ta===null?Ta=[t]:Ta.push(t)}var yse=zc.ReactCurrentBatchConfig;function Gp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(lt(309));var i=n.stateNode}if(!i)throw Error(lt(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(lt(284));if(!n._owner)throw Error(lt(290,t))}return t}function mb(t,e){throw t=Object.prototype.toString.call(e),Error(lt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function xE(t){var e=t._init;return e(t._payload)}function QP(t){function e(m,b){if(t){var v=m.deletions;v===null?(m.deletions=[b],m.flags|=16):v.push(b)}}function n(m,b){if(!t)return null;for(;b!==null;)e(m,b),b=b.sibling;return null}function i(m,b){for(m=new Map;b!==null;)b.key!==null?m.set(b.key,b):m.set(b.index,b),b=b.sibling;return m}function r(m,b){return m=Ug(m,b),m.index=0,m.sibling=null,m}function s(m,b,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<b?(m.flags|=2,b):v):(m.flags|=2,b)):(m.flags|=1048576,b)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,b,v,w){return b===null||b.tag!==6?(b=rZ(v,m.mode,w),b.return=m,b):(b=r(b,v),b.return=m,b)}function l(m,b,v,w){var x=v.type;return x===pI?u(m,b,v.props.children,w,v.key):b!==null&&(b.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===mg&&xE(x)===b.type)?(w=r(b,v.props),w.ref=Gp(m,b,v),w.return=m,w):(w=dx(v.type,v.key,v.props,null,m.mode,w),w.ref=Gp(m,b,v),w.return=m,w)}function c(m,b,v,w){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=sZ(v,m.mode,w),b.return=m,b):(b=r(b,v.children||[]),b.return=m,b)}function u(m,b,v,w,x){return b===null||b.tag!==7?(b=Fd(v,m.mode,w,x),b.return=m,b):(b=r(b,v),b.return=m,b)}function d(m,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=rZ(""+b,m.mode,v),b.return=m,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ab:return v=dx(b.type,b.key,b.props,null,m.mode,v),v.ref=Gp(m,null,b),v.return=m,v;case CI:return b=sZ(b,m.mode,v),b.return=m,b;case mg:var w=b._init;return d(m,w(b._payload),v)}if(gm(b)||yp(b))return b=Fd(b,m.mode,v,null),b.return=m,b;mb(m,b)}return null}function h(m,b,v,w){var x=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return x!==null?null:a(m,b,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ab:return v.key===x?l(m,b,v,w):null;case CI:return v.key===x?c(m,b,v,w):null;case mg:return x=v._init,h(m,b,x(v._payload),w)}if(gm(v)||yp(v))return x!==null?null:u(m,b,v,w,null);mb(m,v)}return null}function I(m,b,v,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(v)||null,a(b,m,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ab:return m=m.get(w.key===null?v:w.key)||null,l(b,m,w,x);case CI:return m=m.get(w.key===null?v:w.key)||null,c(b,m,w,x);case mg:var B=w._init;return I(m,b,v,B(w._payload),x)}if(gm(w)||yp(w))return m=m.get(v)||null,u(b,m,w,x,null);mb(b,w)}return null}function p(m,b,v,w){for(var x=null,B=null,Z=b,N=b=0,W=null;Z!==null&&N<v.length;N++){Z.index>N?(W=Z,Z=null):W=Z.sibling;var M=h(m,Z,v[N],w);if(M===null){Z===null&&(Z=W);break}t&&Z&&M.alternate===null&&e(m,Z),b=s(M,b,N),B===null?x=M:B.sibling=M,B=M,Z=W}if(N===v.length)return n(m,Z),Gi&&ed(m,N),x;if(Z===null){for(;N<v.length;N++)Z=d(m,v[N],w),Z!==null&&(b=s(Z,b,N),B===null?x=Z:B.sibling=Z,B=Z);return Gi&&ed(m,N),x}for(Z=i(m,Z);N<v.length;N++)W=I(Z,m,N,v[N],w),W!==null&&(t&&W.alternate!==null&&Z.delete(W.key===null?N:W.key),b=s(W,b,N),B===null?x=W:B.sibling=W,B=W);return t&&Z.forEach(function(F){return e(m,F)}),Gi&&ed(m,N),x}function y(m,b,v,w){var x=yp(v);if(typeof x!="function")throw Error(lt(150));if(v=x.call(v),v==null)throw Error(lt(151));for(var B=x=null,Z=b,N=b=0,W=null,M=v.next();Z!==null&&!M.done;N++,M=v.next()){Z.index>N?(W=Z,Z=null):W=Z.sibling;var F=h(m,Z,M.value,w);if(F===null){Z===null&&(Z=W);break}t&&Z&&F.alternate===null&&e(m,Z),b=s(F,b,N),B===null?x=F:B.sibling=F,B=F,Z=W}if(M.done)return n(m,Z),Gi&&ed(m,N),x;if(Z===null){for(;!M.done;N++,M=v.next())M=d(m,M.value,w),M!==null&&(b=s(M,b,N),B===null?x=M:B.sibling=M,B=M);return Gi&&ed(m,N),x}for(Z=i(m,Z);!M.done;N++,M=v.next())M=I(Z,m,N,M.value,w),M!==null&&(t&&M.alternate!==null&&Z.delete(M.key===null?N:M.key),b=s(M,b,N),B===null?x=M:B.sibling=M,B=M);return t&&Z.forEach(function(T){return e(m,T)}),Gi&&ed(m,N),x}function A(m,b,v,w){if(typeof v=="object"&&v!==null&&v.type===pI&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ab:e:{for(var x=v.key,B=b;B!==null;){if(B.key===x){if(x=v.type,x===pI){if(B.tag===7){n(m,B.sibling),b=r(B,v.props.children),b.return=m,m=b;break e}}else if(B.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===mg&&xE(x)===B.type){n(m,B.sibling),b=r(B,v.props),b.ref=Gp(m,B,v),b.return=m,m=b;break e}n(m,B);break}else e(m,B);B=B.sibling}v.type===pI?(b=Fd(v.props.children,m.mode,w,v.key),b.return=m,m=b):(w=dx(v.type,v.key,v.props,null,m.mode,w),w.ref=Gp(m,b,v),w.return=m,m=w)}return o(m);case CI:e:{for(B=v.key;b!==null;){if(b.key===B)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(m,b.sibling),b=r(b,v.children||[]),b.return=m,m=b;break e}else{n(m,b);break}else e(m,b);b=b.sibling}b=sZ(v,m.mode,w),b.return=m,m=b}return o(m);case mg:return B=v._init,A(m,b,B(v._payload),w)}if(gm(v))return p(m,b,v,w);if(yp(v))return y(m,b,v,w);mb(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(m,b.sibling),b=r(b,v),b.return=m,m=b):(n(m,b),b=rZ(v,m.mode,w),b.return=m,m=b),o(m)):n(m,b)}return A}var yf=QP(!0),qP=QP(!1),Px=hu(null),Ox=null,GI=null,wV=null;function GV(){wV=GI=Ox=null}function BV(t){var e=Px.current;vi(Px),t._currentValue=e}function jN(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function HI(t,e){Ox=t,wV=GI=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Js=!0),t.firstContext=null)}function oa(t){var e=t._currentValue;if(wV!==t)if(t={context:t,memoizedValue:e,next:null},GI===null){if(Ox===null)throw Error(lt(308));GI=t,Ox.dependencies={lanes:0,firstContext:t}}else GI=GI.next=t;return e}var hd=null;function SV(t){hd===null?hd=[t]:hd.push(t)}function $P(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,SV(e)):(n.next=r.next,r.next=n),e.interleaved=n,_c(t,i)}function _c(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ag=!1;function ZV(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pg(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Yn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,_c(t,n)}return r=i.interleaved,r===null?(e.next=e,SV(i)):(e.next=r.next,r.next=e),i.interleaved=e,_c(t,n)}function ox(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,hV(t,n)}}function wE(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Dx(t,e,n,i){var r=t.updateQueue;Ag=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,I=a.eventTime;if((i&h)===h){u!==null&&(u=u.next={eventTime:I,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(h=e,I=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){d=p.call(I,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,h=typeof p=="function"?p.call(I,d,h):p,h==null)break e;d=Ti({},d,h);break e;case 2:Ag=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else I={eventTime:I,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=I,l=d):u=u.next=I,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);jd|=o,t.lanes=o,t.memoizedState=d}}function GE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(lt(191,r));r.call(i)}}}var S0={},Nl=hu(S0),lA=hu(S0),cA=hu(S0);function Id(t){if(t===S0)throw Error(lt(174));return t}function RV(t,e){switch(hi(cA,e),hi(lA,t),hi(Nl,S0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GN(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GN(e,t)}vi(Nl),hi(Nl,e)}function bf(){vi(Nl),vi(lA),vi(cA)}function tO(t){Id(cA.current);var e=Id(Nl.current),n=GN(e,t.type);e!==n&&(hi(lA,t),hi(Nl,n))}function NV(t){lA.current===t&&(vi(Nl),vi(lA))}var Ri=hu(0);function Ux(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var q1=[];function WV(){for(var t=0;t<q1.length;t++)q1[t]._workInProgressVersionPrimary=null;q1.length=0}var ax=zc.ReactCurrentDispatcher,$1=zc.ReactCurrentBatchConfig,zd=0,_i=null,lr=null,xr=null,Jx=!1,Sm=!1,gA=0,bse=0;function zr(){throw Error(lt(321))}function MV(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ja(t[n],e[n]))return!1;return!0}function VV(t,e,n,i,r,s){if(zd=s,_i=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ax.current=t===null||t.memoizedState===null?Gse:Bse,t=n(i,r),Sm){s=0;do{if(Sm=!1,gA=0,25<=s)throw Error(lt(301));s+=1,xr=lr=null,e.updateQueue=null,ax.current=Sse,t=n(i,r)}while(Sm)}if(ax.current=Qx,e=lr!==null&&lr.next!==null,zd=0,xr=lr=_i=null,Jx=!1,e)throw Error(lt(300));return t}function FV(){var t=gA!==0;return gA=0,t}function ml(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?_i.memoizedState=xr=t:xr=xr.next=t,xr}function aa(){if(lr===null){var t=_i.alternate;t=t!==null?t.memoizedState:null}else t=lr.next;var e=xr===null?_i.memoizedState:xr.next;if(e!==null)xr=e,lr=t;else{if(t===null)throw Error(lt(310));lr=t,t={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},xr===null?_i.memoizedState=xr=t:xr=xr.next=t}return xr}function uA(t,e){return typeof e=="function"?e(t):e}function eZ(t){var e=aa(),n=e.queue;if(n===null)throw Error(lt(311));n.lastRenderedReducer=t;var i=lr,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((zd&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,_i.lanes|=u,jd|=u}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,Ja(i,e.memoizedState)||(Js=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,_i.lanes|=s,jd|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function tZ(t){var e=aa(),n=e.queue;if(n===null)throw Error(lt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ja(s,e.memoizedState)||(Js=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function nO(){}function iO(t,e){var n=_i,i=aa(),r=e(),s=!Ja(i.memoizedState,r);if(s&&(i.memoizedState=r,Js=!0),i=i.queue,_V(oO.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||xr!==null&&xr.memoizedState.tag&1){if(n.flags|=2048,dA(9,sO.bind(null,n,i,r,e),void 0,null),Br===null)throw Error(lt(349));zd&30||rO(n,e,r)}return r}function rO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_i.updateQueue,e===null?(e={lastEffect:null,stores:null},_i.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sO(t,e,n,i){e.value=n,e.getSnapshot=i,aO(e)&&lO(t)}function oO(t,e,n){return n(function(){aO(e)&&lO(t)})}function aO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ja(t,n)}catch{return!0}}function lO(t){var e=_c(t,1);e!==null&&La(e,t,1,-1)}function BE(t){var e=ml();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uA,lastRenderedState:t},e.queue=t,t=t.dispatch=wse.bind(null,_i,t),[e.memoizedState,t]}function dA(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=_i.updateQueue,e===null?(e={lastEffect:null,stores:null},_i.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function cO(){return aa().memoizedState}function lx(t,e,n,i){var r=ml();_i.flags|=t,r.memoizedState=dA(1|e,n,void 0,i===void 0?null:i)}function C2(t,e,n,i){var r=aa();i=i===void 0?null:i;var s=void 0;if(lr!==null){var o=lr.memoizedState;if(s=o.destroy,i!==null&&MV(i,o.deps)){r.memoizedState=dA(e,n,s,i);return}}_i.flags|=t,r.memoizedState=dA(1|e,n,s,i)}function SE(t,e){return lx(8390656,8,t,e)}function _V(t,e){return C2(2048,8,t,e)}function gO(t,e){return C2(4,2,t,e)}function uO(t,e){return C2(4,4,t,e)}function dO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hO(t,e,n){return n=n!=null?n.concat([t]):null,C2(4,4,dO.bind(null,e,t),n)}function TV(){}function IO(t,e){var n=aa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&MV(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function fO(t,e){var n=aa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&MV(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function CO(t,e,n){return zd&21?(Ja(n,e)||(n=bP(),_i.lanes|=n,jd|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Js=!0),t.memoizedState=n)}function vse(t,e){var n=ei;ei=n!==0&&4>n?n:4,t(!0);var i=$1.transition;$1.transition={};try{t(!1),e()}finally{ei=n,$1.transition=i}}function pO(){return aa().memoizedState}function xse(t,e,n){var i=Dg(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},mO(t))AO(e,n);else if(n=$P(t,e,n,i),n!==null){var r=ws();La(n,t,i,r),yO(n,e,i)}}function wse(t,e,n){var i=Dg(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(mO(t))AO(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ja(a,o)){var l=e.interleaved;l===null?(r.next=r,SV(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=$P(t,e,r,i),n!==null&&(r=ws(),La(n,t,i,r),yO(n,e,i))}}function mO(t){var e=t.alternate;return t===_i||e!==null&&e===_i}function AO(t,e){Sm=Jx=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yO(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,hV(t,n)}}var Qx={readContext:oa,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},Gse={readContext:oa,useCallback:function(t,e){return ml().memoizedState=[t,e===void 0?null:e],t},useContext:oa,useEffect:SE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,lx(4194308,4,dO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return lx(4194308,4,t,e)},useInsertionEffect:function(t,e){return lx(4,2,t,e)},useMemo:function(t,e){var n=ml();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ml();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=xse.bind(null,_i,t),[i.memoizedState,t]},useRef:function(t){var e=ml();return t={current:t},e.memoizedState=t},useState:BE,useDebugValue:TV,useDeferredValue:function(t){return ml().memoizedState=t},useTransition:function(){var t=BE(!1),e=t[0];return t=vse.bind(null,t[1]),ml().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=_i,r=ml();if(Gi){if(n===void 0)throw Error(lt(407));n=n()}else{if(n=e(),Br===null)throw Error(lt(349));zd&30||rO(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,SE(oO.bind(null,i,s,t),[t]),i.flags|=2048,dA(9,sO.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ml(),e=Br.identifierPrefix;if(Gi){var n=yc,i=Ac;n=(i&~(1<<32-Ka(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=gA++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=bse++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Bse={readContext:oa,useCallback:IO,useContext:oa,useEffect:_V,useImperativeHandle:hO,useInsertionEffect:gO,useLayoutEffect:uO,useMemo:fO,useReducer:eZ,useRef:cO,useState:function(){return eZ(uA)},useDebugValue:TV,useDeferredValue:function(t){var e=aa();return CO(e,lr.memoizedState,t)},useTransition:function(){var t=eZ(uA)[0],e=aa().memoizedState;return[t,e]},useMutableSource:nO,useSyncExternalStore:iO,useId:pO,unstable_isNewReconciler:!1},Sse={readContext:oa,useCallback:IO,useContext:oa,useEffect:_V,useImperativeHandle:hO,useInsertionEffect:gO,useLayoutEffect:uO,useMemo:fO,useReducer:tZ,useRef:cO,useState:function(){return tZ(uA)},useDebugValue:TV,useDeferredValue:function(t){var e=aa();return lr===null?e.memoizedState=t:CO(e,lr.memoizedState,t)},useTransition:function(){var t=tZ(uA)[0],e=aa().memoizedState;return[t,e]},useMutableSource:nO,useSyncExternalStore:iO,useId:pO,unstable_isNewReconciler:!1};function Za(t,e){if(t&&t.defaultProps){e=Ti({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function PN(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Ti({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var p2={isMounted:function(t){return(t=t._reactInternals)?lh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ws(),r=Dg(t),s=Zc(i,r);s.payload=e,n!=null&&(s.callback=n),e=Pg(t,s,r),e!==null&&(La(e,t,r,i),ox(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ws(),r=Dg(t),s=Zc(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Pg(t,s,r),e!==null&&(La(e,t,r,i),ox(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ws(),i=Dg(t),r=Zc(n,i);r.tag=2,e!=null&&(r.callback=e),e=Pg(t,r,i),e!==null&&(La(e,t,i,n),ox(e,t,i))}};function ZE(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!rA(n,i)||!rA(r,s):!0}function bO(t,e,n){var i=!1,r=eu,s=e.contextType;return typeof s=="object"&&s!==null?s=oa(s):(r=$s(e)?Kd:os.current,i=e.contextTypes,s=(i=i!=null)?mf(t,r):eu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=p2,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function RE(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&p2.enqueueReplaceState(e,e.state,null)}function ON(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},ZV(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=oa(s):(s=$s(e)?Kd:os.current,r.context=mf(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(PN(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&p2.enqueueReplaceState(r,r.state,null),Dx(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function vf(t,e){try{var n="",i=e;do n+=tre(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function nZ(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function DN(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Zse=typeof WeakMap=="function"?WeakMap:Map;function vO(t,e,n){n=Zc(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){$x||($x=!0,rW=i),DN(t,e)},n}function xO(t,e,n){n=Zc(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){DN(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){DN(t,e),typeof i!="function"&&(Og===null?Og=new Set([this]):Og.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function NE(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new Zse;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Kse.bind(null,t,e,n),e.then(t,t))}function WE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ME(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zc(-1,1),e.tag=2,Pg(n,e,1))),n.lanes|=1),t)}var Rse=zc.ReactCurrentOwner,Js=!1;function Cs(t,e,n,i){e.child=t===null?qP(e,null,n,i):yf(e,t.child,n,i)}function VE(t,e,n,i,r){n=n.render;var s=e.ref;return HI(e,r),i=VV(t,e,n,i,s,r),n=FV(),t!==null&&!Js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Tc(t,e,r)):(Gi&&n&&bV(e),e.flags|=1,Cs(t,e,i,r),e.child)}function FE(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!zV(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,wO(t,e,s,i,r)):(t=dx(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:rA,n(o,i)&&t.ref===e.ref)return Tc(t,e,r)}return e.flags|=1,t=Ug(s,i),t.ref=e.ref,t.return=e,e.child=t}function wO(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(rA(s,i)&&t.ref===e.ref)if(Js=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Js=!0);else return e.lanes=t.lanes,Tc(t,e,r)}return UN(t,e,n,i,r)}function GO(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},hi(SI,fo),fo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,hi(SI,fo),fo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,hi(SI,fo),fo|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,hi(SI,fo),fo|=i;return Cs(t,e,r,n),e.child}function BO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function UN(t,e,n,i,r){var s=$s(n)?Kd:os.current;return s=mf(e,s),HI(e,r),n=VV(t,e,n,i,s,r),i=FV(),t!==null&&!Js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Tc(t,e,r)):(Gi&&i&&bV(e),e.flags|=1,Cs(t,e,n,r),e.child)}function _E(t,e,n,i,r){if($s(n)){var s=!0;Lx(e)}else s=!1;if(HI(e,r),e.stateNode===null)cx(t,e),bO(e,n,i),ON(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=oa(c):(c=$s(n)?Kd:os.current,c=mf(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&RE(e,o,i,c),Ag=!1;var h=e.memoizedState;o.state=h,Dx(e,i,o,r),l=e.memoizedState,a!==i||h!==l||qs.current||Ag?(typeof u=="function"&&(PN(e,n,u,i),l=e.memoizedState),(a=Ag||ZE(e,n,a,i,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,eO(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Za(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=oa(l):(l=$s(n)?Kd:os.current,l=mf(e,l));var I=n.getDerivedStateFromProps;(u=typeof I=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&RE(e,o,i,l),Ag=!1,h=e.memoizedState,o.state=h,Dx(e,i,o,r);var p=e.memoizedState;a!==d||h!==p||qs.current||Ag?(typeof I=="function"&&(PN(e,n,I,i),p=e.memoizedState),(c=Ag||ZE(e,n,c,i,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),i=!1)}return JN(t,e,n,i,s,r)}function JN(t,e,n,i,r,s){BO(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&yE(e,n,!1),Tc(t,e,s);i=e.stateNode,Rse.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=yf(e,t.child,null,s),e.child=yf(e,null,a,s)):Cs(t,e,a,s),e.memoizedState=i.state,r&&yE(e,n,!0),e.child}function SO(t){var e=t.stateNode;e.pendingContext?AE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&AE(t,e.context,!1),RV(t,e.containerInfo)}function TE(t,e,n,i,r){return Af(),xV(r),e.flags|=256,Cs(t,e,n,i),e.child}var QN={dehydrated:null,treeContext:null,retryLane:0};function qN(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZO(t,e,n){var i=e.pendingProps,r=Ri.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),hi(Ri,r&1),t===null)return zN(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=y2(o,i,0,null),t=Fd(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=qN(n),e.memoizedState=QN,t):XV(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Nse(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Ug(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ug(a,s):(s=Fd(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?qN(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=QN,i}return s=t.child,t=s.sibling,i=Ug(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function XV(t,e){return e=y2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ab(t,e,n,i){return i!==null&&xV(i),yf(e,t.child,null,n),t=XV(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Nse(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=nZ(Error(lt(422))),Ab(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=y2({mode:"visible",children:i.children},r,0,null),s=Fd(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&yf(e,t.child,null,o),e.child.memoizedState=qN(o),e.memoizedState=QN,s);if(!(e.mode&1))return Ab(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(lt(419)),i=nZ(s,i,void 0),Ab(t,e,o,i)}if(a=(o&t.childLanes)!==0,Js||a){if(i=Br,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,_c(t,r),La(i,t,r,-1))}return LV(),i=nZ(Error(lt(421))),Ab(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Lse.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Ao=jg(r.nextSibling),vo=e,Gi=!0,Ta=null,t!==null&&(Oo[Do++]=Ac,Oo[Do++]=yc,Oo[Do++]=Ld,Ac=t.id,yc=t.overflow,Ld=e),e=XV(e,i.children),e.flags|=4096,e)}function XE(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),jN(t.return,e,n)}function iZ(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function RO(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Cs(t,e,i.children,n),i=Ri.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&XE(t,n,e);else if(t.tag===19)XE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(hi(Ri,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Ux(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),iZ(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Ux(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}iZ(e,!0,n,null,s);break;case"together":iZ(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Tc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),jd|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(lt(153));if(e.child!==null){for(t=e.child,n=Ug(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ug(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Wse(t,e,n){switch(e.tag){case 3:SO(e),Af();break;case 5:tO(e);break;case 1:$s(e.type)&&Lx(e);break;case 4:RV(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;hi(Px,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(hi(Ri,Ri.current&1),e.flags|=128,null):n&e.child.childLanes?ZO(t,e,n):(hi(Ri,Ri.current&1),t=Tc(t,e,n),t!==null?t.sibling:null);hi(Ri,Ri.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return RO(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),hi(Ri,Ri.current),i)break;return null;case 22:case 23:return e.lanes=0,GO(t,e,n)}return Tc(t,e,n)}var NO,$N,WO,MO;NO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$N=function(){};WO=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Id(Nl.current);var s=null;switch(n){case"input":r=bN(t,r),i=bN(t,i),s=[];break;case"select":r=Ti({},r,{value:void 0}),i=Ti({},i,{value:void 0}),s=[];break;case"textarea":r=wN(t,r),i=wN(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Hx)}BN(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qm.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qm.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ci("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};MO=function(t,e,n,i){n!==i&&(e.flags|=4)};function Bp(t,e){if(!Gi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function jr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Mse(t,e,n){var i=e.pendingProps;switch(vV(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jr(e),null;case 1:return $s(e.type)&&Kx(),jr(e),null;case 3:return i=e.stateNode,bf(),vi(qs),vi(os),WV(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(pb(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ta!==null&&(aW(Ta),Ta=null))),$N(t,e),jr(e),null;case 5:NV(e);var r=Id(cA.current);if(n=e.type,t!==null&&e.stateNode!=null)WO(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(lt(166));return jr(e),null}if(t=Id(Nl.current),pb(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[xl]=e,i[aA]=s,t=(e.mode&1)!==0,n){case"dialog":Ci("cancel",i),Ci("close",i);break;case"iframe":case"object":case"embed":Ci("load",i);break;case"video":case"audio":for(r=0;r<dm.length;r++)Ci(dm[r],i);break;case"source":Ci("error",i);break;case"img":case"image":case"link":Ci("error",i),Ci("load",i);break;case"details":Ci("toggle",i);break;case"input":PX(i,s),Ci("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ci("invalid",i);break;case"textarea":DX(i,s),Ci("invalid",i)}BN(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Cb(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Cb(i.textContent,a,t),r=["children",""+a]):Qm.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ci("scroll",i)}switch(n){case"input":lb(i),OX(i,s,!0);break;case"textarea":lb(i),UX(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Hx)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=oP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[xl]=e,t[aA]=i,NO(t,e,!1,!1),e.stateNode=t;e:{switch(o=SN(n,i),n){case"dialog":Ci("cancel",t),Ci("close",t),r=i;break;case"iframe":case"object":case"embed":Ci("load",t),r=i;break;case"video":case"audio":for(r=0;r<dm.length;r++)Ci(dm[r],t);r=i;break;case"source":Ci("error",t),r=i;break;case"img":case"image":case"link":Ci("error",t),Ci("load",t),r=i;break;case"details":Ci("toggle",t),r=i;break;case"input":PX(t,i),r=bN(t,i),Ci("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Ti({},i,{value:void 0}),Ci("invalid",t);break;case"textarea":DX(t,i),r=wN(t,i),Ci("invalid",t);break;default:r=i}BN(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?cP(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&aP(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&qm(t,l):typeof l=="number"&&qm(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Qm.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ci("scroll",t):l!=null&&aV(t,s,l,o))}switch(n){case"input":lb(t),OX(t,i,!1);break;case"textarea":lb(t),UX(t);break;case"option":i.value!=null&&t.setAttribute("value",""+$g(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?XI(t,!!i.multiple,s,!1):i.defaultValue!=null&&XI(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Hx)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return jr(e),null;case 6:if(t&&e.stateNode!=null)MO(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(lt(166));if(n=Id(cA.current),Id(Nl.current),pb(e)){if(i=e.stateNode,n=e.memoizedProps,i[xl]=e,(s=i.nodeValue!==n)&&(t=vo,t!==null))switch(t.tag){case 3:Cb(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cb(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[xl]=e,e.stateNode=i}return jr(e),null;case 13:if(vi(Ri),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Gi&&Ao!==null&&e.mode&1&&!(e.flags&128))JP(),Af(),e.flags|=98560,s=!1;else if(s=pb(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(lt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(lt(317));s[xl]=e}else Af(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;jr(e),s=!1}else Ta!==null&&(aW(Ta),Ta=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Ri.current&1?ur===0&&(ur=3):LV())),e.updateQueue!==null&&(e.flags|=4),jr(e),null);case 4:return bf(),$N(t,e),t===null&&sA(e.stateNode.containerInfo),jr(e),null;case 10:return BV(e.type._context),jr(e),null;case 17:return $s(e.type)&&Kx(),jr(e),null;case 19:if(vi(Ri),s=e.memoizedState,s===null)return jr(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Bp(s,!1);else{if(ur!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ux(t),o!==null){for(e.flags|=128,Bp(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return hi(Ri,Ri.current&1|2),e.child}t=t.sibling}s.tail!==null&&Oi()>xf&&(e.flags|=128,i=!0,Bp(s,!1),e.lanes=4194304)}else{if(!i)if(t=Ux(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Bp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Gi)return jr(e),null}else 2*Oi()-s.renderingStartTime>xf&&n!==1073741824&&(e.flags|=128,i=!0,Bp(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Oi(),e.sibling=null,n=Ri.current,hi(Ri,i?n&1|2:n&1),e):(jr(e),null);case 22:case 23:return KV(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?fo&1073741824&&(jr(e),e.subtreeFlags&6&&(e.flags|=8192)):jr(e),null;case 24:return null;case 25:return null}throw Error(lt(156,e.tag))}function Vse(t,e){switch(vV(e),e.tag){case 1:return $s(e.type)&&Kx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return bf(),vi(qs),vi(os),WV(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return NV(e),null;case 13:if(vi(Ri),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(lt(340));Af()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return vi(Ri),null;case 4:return bf(),null;case 10:return BV(e.type._context),null;case 22:case 23:return KV(),null;case 24:return null;default:return null}}var yb=!1,ns=!1,Fse=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function BI(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ki(t,e,i)}else n.current=null}function eW(t,e,n){try{n()}catch(i){ki(t,e,i)}}var EE=!1;function _se(t,e){if(XN=Ex,t=XP(),yV(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var I;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(I=d.firstChild)!==null;)h=d,d=I;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===s&&++u===i&&(l=o),(I=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=I}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(EN={focusedElem:t,selectionRange:n},Ex=!1,Wt=e;Wt!==null;)if(e=Wt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Wt=t;else for(;Wt!==null;){e=Wt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,A=p.memoizedState,m=e.stateNode,b=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:Za(e.type,y),A);m.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(w){ki(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Wt=t;break}Wt=e.return}return p=EE,EE=!1,p}function Zm(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&eW(e,n,s)}r=r.next}while(r!==i)}}function m2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function tW(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VO(t){var e=t.alternate;e!==null&&(t.alternate=null,VO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xl],delete e[aA],delete e[HN],delete e[pse],delete e[mse])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FO(t){return t.tag===5||t.tag===3||t.tag===4}function YE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nW(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Hx));else if(i!==4&&(t=t.child,t!==null))for(nW(t,e,n),t=t.sibling;t!==null;)nW(t,e,n),t=t.sibling}function iW(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(iW(t,e,n),t=t.sibling;t!==null;)iW(t,e,n),t=t.sibling}var Vr=null,Ma=!1;function rg(t,e,n){for(n=n.child;n!==null;)_O(t,e,n),n=n.sibling}function _O(t,e,n){if(Rl&&typeof Rl.onCommitFiberUnmount=="function")try{Rl.onCommitFiberUnmount(g2,n)}catch{}switch(n.tag){case 5:ns||BI(n,e);case 6:var i=Vr,r=Ma;Vr=null,rg(t,e,n),Vr=i,Ma=r,Vr!==null&&(Ma?(t=Vr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Vr.removeChild(n.stateNode));break;case 18:Vr!==null&&(Ma?(t=Vr,n=n.stateNode,t.nodeType===8?J1(t.parentNode,n):t.nodeType===1&&J1(t,n),nA(t)):J1(Vr,n.stateNode));break;case 4:i=Vr,r=Ma,Vr=n.stateNode.containerInfo,Ma=!0,rg(t,e,n),Vr=i,Ma=r;break;case 0:case 11:case 14:case 15:if(!ns&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&eW(n,e,o),r=r.next}while(r!==i)}rg(t,e,n);break;case 1:if(!ns&&(BI(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){ki(n,e,a)}rg(t,e,n);break;case 21:rg(t,e,n);break;case 22:n.mode&1?(ns=(i=ns)||n.memoizedState!==null,rg(t,e,n),ns=i):rg(t,e,n);break;default:rg(t,e,n)}}function kE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Fse),e.forEach(function(i){var r=zse.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Aa(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Vr=a.stateNode,Ma=!1;break e;case 3:Vr=a.stateNode.containerInfo,Ma=!0;break e;case 4:Vr=a.stateNode.containerInfo,Ma=!0;break e}a=a.return}if(Vr===null)throw Error(lt(160));_O(s,o,r),Vr=null,Ma=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){ki(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)TO(e,t),e=e.sibling}function TO(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Aa(e,t),ul(t),i&4){try{Zm(3,t,t.return),m2(3,t)}catch(y){ki(t,t.return,y)}try{Zm(5,t,t.return)}catch(y){ki(t,t.return,y)}}break;case 1:Aa(e,t),ul(t),i&512&&n!==null&&BI(n,n.return);break;case 5:if(Aa(e,t),ul(t),i&512&&n!==null&&BI(n,n.return),t.flags&32){var r=t.stateNode;try{qm(r,"")}catch(y){ki(t,t.return,y)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&rP(r,s),SN(a,o);var c=SN(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?cP(r,d):u==="dangerouslySetInnerHTML"?aP(r,d):u==="children"?qm(r,d):aV(r,u,d,c)}switch(a){case"input":vN(r,s);break;case"textarea":sP(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var I=s.value;I!=null?XI(r,!!s.multiple,I,!1):h!==!!s.multiple&&(s.defaultValue!=null?XI(r,!!s.multiple,s.defaultValue,!0):XI(r,!!s.multiple,s.multiple?[]:"",!1))}r[aA]=s}catch(y){ki(t,t.return,y)}}break;case 6:if(Aa(e,t),ul(t),i&4){if(t.stateNode===null)throw Error(lt(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(y){ki(t,t.return,y)}}break;case 3:if(Aa(e,t),ul(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{nA(e.containerInfo)}catch(y){ki(t,t.return,y)}break;case 4:Aa(e,t),ul(t);break;case 13:Aa(e,t),ul(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(kV=Oi())),i&4&&kE(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(ns=(c=ns)||u,Aa(e,t),ns=c):Aa(e,t),ul(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Wt=t,u=t.child;u!==null;){for(d=Wt=u;Wt!==null;){switch(h=Wt,I=h.child,h.tag){case 0:case 11:case 14:case 15:Zm(4,h,h.return);break;case 1:BI(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){i=h,n=h.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){ki(i,n,y)}}break;case 5:BI(h,h.return);break;case 22:if(h.memoizedState!==null){KE(d);continue}}I!==null?(I.return=h,Wt=I):KE(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=lP("display",o))}catch(y){ki(t,t.return,y)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(y){ki(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Aa(e,t),ul(t),i&4&&kE(t);break;case 21:break;default:Aa(e,t),ul(t)}}function ul(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FO(n)){var i=n;break e}n=n.return}throw Error(lt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(qm(r,""),i.flags&=-33);var s=YE(t);iW(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=YE(t);nW(t,a,o);break;default:throw Error(lt(161))}}catch(l){ki(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Tse(t,e,n){Wt=t,XO(t)}function XO(t,e,n){for(var i=(t.mode&1)!==0;Wt!==null;){var r=Wt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||yb;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||ns;a=yb;var c=ns;if(yb=o,(ns=l)&&!c)for(Wt=r;Wt!==null;)o=Wt,l=o.child,o.tag===22&&o.memoizedState!==null?LE(r):l!==null?(l.return=o,Wt=l):LE(r);for(;s!==null;)Wt=s,XO(s),s=s.sibling;Wt=r,yb=a,ns=c}HE(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Wt=s):HE(t)}}function HE(t){for(;Wt!==null;){var e=Wt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ns||m2(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ns)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Za(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&GE(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}GE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&nA(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}ns||e.flags&512&&tW(e)}catch(h){ki(e,e.return,h)}}if(e===t){Wt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Wt=n;break}Wt=e.return}}function KE(t){for(;Wt!==null;){var e=Wt;if(e===t){Wt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Wt=n;break}Wt=e.return}}function LE(t){for(;Wt!==null;){var e=Wt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{m2(4,e)}catch(l){ki(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){ki(e,r,l)}}var s=e.return;try{tW(e)}catch(l){ki(e,s,l)}break;case 5:var o=e.return;try{tW(e)}catch(l){ki(e,o,l)}}}catch(l){ki(e,e.return,l)}if(e===t){Wt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Wt=a;break}Wt=e.return}}var Xse=Math.ceil,qx=zc.ReactCurrentDispatcher,EV=zc.ReactCurrentOwner,ea=zc.ReactCurrentBatchConfig,Yn=0,Br=null,tr=null,_r=0,fo=0,SI=hu(0),ur=0,hA=null,jd=0,A2=0,YV=0,Rm=null,Os=null,kV=0,xf=1/0,hc=null,$x=!1,rW=null,Og=null,bb=!1,Tg=null,ew=0,Nm=0,sW=null,gx=-1,ux=0;function ws(){return Yn&6?Oi():gx!==-1?gx:gx=Oi()}function Dg(t){return t.mode&1?Yn&2&&_r!==0?_r&-_r:yse.transition!==null?(ux===0&&(ux=bP()),ux):(t=ei,t!==0||(t=window.event,t=t===void 0?16:ZP(t.type)),t):1}function La(t,e,n,i){if(50<Nm)throw Nm=0,sW=null,Error(lt(185));w0(t,n,i),(!(Yn&2)||t!==Br)&&(t===Br&&(!(Yn&2)&&(A2|=n),ur===4&&xg(t,_r)),eo(t,i),n===1&&Yn===0&&!(e.mode&1)&&(xf=Oi()+500,f2&&Iu()))}function eo(t,e){var n=t.callbackNode;yre(t,e);var i=Xx(t,t===Br?_r:0);if(i===0)n!==null&&qX(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&qX(n),e===1)t.tag===0?Ase(zE.bind(null,t)):OP(zE.bind(null,t)),fse(function(){!(Yn&6)&&Iu()}),n=null;else{switch(vP(i)){case 1:n=dV;break;case 4:n=AP;break;case 16:n=Tx;break;case 536870912:n=yP;break;default:n=Tx}n=jO(n,EO.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function EO(t,e){if(gx=-1,ux=0,Yn&6)throw Error(lt(327));var n=t.callbackNode;if(KI()&&t.callbackNode!==n)return null;var i=Xx(t,t===Br?_r:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=tw(t,i);else{e=i;var r=Yn;Yn|=2;var s=kO();(Br!==t||_r!==e)&&(hc=null,xf=Oi()+500,Vd(t,e));do try{kse();break}catch(a){YO(t,a)}while(!0);GV(),qx.current=s,Yn=r,tr!==null?e=0:(Br=null,_r=0,e=ur)}if(e!==0){if(e===2&&(r=MN(t),r!==0&&(i=r,e=oW(t,r))),e===1)throw n=hA,Vd(t,0),xg(t,i),eo(t,Oi()),n;if(e===6)xg(t,i);else{if(r=t.current.alternate,!(i&30)&&!Ese(r)&&(e=tw(t,i),e===2&&(s=MN(t),s!==0&&(i=s,e=oW(t,s))),e===1))throw n=hA,Vd(t,0),xg(t,i),eo(t,Oi()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(lt(345));case 2:td(t,Os,hc);break;case 3:if(xg(t,i),(i&130023424)===i&&(e=kV+500-Oi(),10<e)){if(Xx(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ws(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=kN(td.bind(null,t,Os,hc),e);break}td(t,Os,hc);break;case 4:if(xg(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Ka(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Oi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Xse(i/1960))-i,10<i){t.timeoutHandle=kN(td.bind(null,t,Os,hc),i);break}td(t,Os,hc);break;case 5:td(t,Os,hc);break;default:throw Error(lt(329))}}}return eo(t,Oi()),t.callbackNode===n?EO.bind(null,t):null}function oW(t,e){var n=Rm;return t.current.memoizedState.isDehydrated&&(Vd(t,e).flags|=256),t=tw(t,e),t!==2&&(e=Os,Os=n,e!==null&&aW(e)),t}function aW(t){Os===null?Os=t:Os.push.apply(Os,t)}function Ese(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Ja(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xg(t,e){for(e&=~YV,e&=~A2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ka(e),i=1<<n;t[n]=-1,e&=~i}}function zE(t){if(Yn&6)throw Error(lt(327));KI();var e=Xx(t,0);if(!(e&1))return eo(t,Oi()),null;var n=tw(t,e);if(t.tag!==0&&n===2){var i=MN(t);i!==0&&(e=i,n=oW(t,i))}if(n===1)throw n=hA,Vd(t,0),xg(t,e),eo(t,Oi()),n;if(n===6)throw Error(lt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,td(t,Os,hc),eo(t,Oi()),null}function HV(t,e){var n=Yn;Yn|=1;try{return t(e)}finally{Yn=n,Yn===0&&(xf=Oi()+500,f2&&Iu())}}function Pd(t){Tg!==null&&Tg.tag===0&&!(Yn&6)&&KI();var e=Yn;Yn|=1;var n=ea.transition,i=ei;try{if(ea.transition=null,ei=1,t)return t()}finally{ei=i,ea.transition=n,Yn=e,!(Yn&6)&&Iu()}}function KV(){fo=SI.current,vi(SI)}function Vd(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ise(n)),tr!==null)for(n=tr.return;n!==null;){var i=n;switch(vV(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Kx();break;case 3:bf(),vi(qs),vi(os),WV();break;case 5:NV(i);break;case 4:bf();break;case 13:vi(Ri);break;case 19:vi(Ri);break;case 10:BV(i.type._context);break;case 22:case 23:KV()}n=n.return}if(Br=t,tr=t=Ug(t.current,null),_r=fo=e,ur=0,hA=null,YV=A2=jd=0,Os=Rm=null,hd!==null){for(e=0;e<hd.length;e++)if(n=hd[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}hd=null}return t}function YO(t,e){do{var n=tr;try{if(GV(),ax.current=Qx,Jx){for(var i=_i.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Jx=!1}if(zd=0,xr=lr=_i=null,Sm=!1,gA=0,EV.current=null,n===null||n.return===null){ur=1,hA=e,tr=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=_r,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var I=WE(o);if(I!==null){I.flags&=-257,ME(I,o,a,s,e),I.mode&1&&NE(s,c,e),e=I,l=c;var p=e.updateQueue;if(p===null){var y=new Set;y.add(l),e.updateQueue=y}else p.add(l);break e}else{if(!(e&1)){NE(s,c,e),LV();break e}l=Error(lt(426))}}else if(Gi&&a.mode&1){var A=WE(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),ME(A,o,a,s,e),xV(vf(l,a));break e}}s=l=vf(l,a),ur!==4&&(ur=2),Rm===null?Rm=[s]:Rm.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=vO(s,l,e);wE(s,m);break e;case 1:a=l;var b=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Og===null||!Og.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=xO(s,a,e);wE(s,w);break e}}s=s.return}while(s!==null)}KO(n)}catch(x){e=x,tr===n&&n!==null&&(tr=n=n.return);continue}break}while(!0)}function kO(){var t=qx.current;return qx.current=Qx,t===null?Qx:t}function LV(){(ur===0||ur===3||ur===2)&&(ur=4),Br===null||!(jd&268435455)&&!(A2&268435455)||xg(Br,_r)}function tw(t,e){var n=Yn;Yn|=2;var i=kO();(Br!==t||_r!==e)&&(hc=null,Vd(t,e));do try{Yse();break}catch(r){YO(t,r)}while(!0);if(GV(),Yn=n,qx.current=i,tr!==null)throw Error(lt(261));return Br=null,_r=0,ur}function Yse(){for(;tr!==null;)HO(tr)}function kse(){for(;tr!==null&&!ure();)HO(tr)}function HO(t){var e=zO(t.alternate,t,fo);t.memoizedProps=t.pendingProps,e===null?KO(t):tr=e,EV.current=null}function KO(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Vse(n,e),n!==null){n.flags&=32767,tr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ur=6,tr=null;return}}else if(n=Mse(n,e,fo),n!==null){tr=n;return}if(e=e.sibling,e!==null){tr=e;return}tr=e=t}while(e!==null);ur===0&&(ur=5)}function td(t,e,n){var i=ei,r=ea.transition;try{ea.transition=null,ei=1,Hse(t,e,n,i)}finally{ea.transition=r,ei=i}return null}function Hse(t,e,n,i){do KI();while(Tg!==null);if(Yn&6)throw Error(lt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(lt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(bre(t,s),t===Br&&(tr=Br=null,_r=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||bb||(bb=!0,jO(Tx,function(){return KI(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ea.transition,ea.transition=null;var o=ei;ei=1;var a=Yn;Yn|=4,EV.current=null,_se(t,n),TO(n,t),ase(EN),Ex=!!XN,EN=XN=null,t.current=n,Tse(n),dre(),Yn=a,ei=o,ea.transition=s}else t.current=n;if(bb&&(bb=!1,Tg=t,ew=r),s=t.pendingLanes,s===0&&(Og=null),fre(n.stateNode),eo(t,Oi()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if($x)throw $x=!1,t=rW,rW=null,t;return ew&1&&t.tag!==0&&KI(),s=t.pendingLanes,s&1?t===sW?Nm++:(Nm=0,sW=t):Nm=0,Iu(),null}function KI(){if(Tg!==null){var t=vP(ew),e=ea.transition,n=ei;try{if(ea.transition=null,ei=16>t?16:t,Tg===null)var i=!1;else{if(t=Tg,Tg=null,ew=0,Yn&6)throw Error(lt(331));var r=Yn;for(Yn|=4,Wt=t.current;Wt!==null;){var s=Wt,o=s.child;if(Wt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Wt=c;Wt!==null;){var u=Wt;switch(u.tag){case 0:case 11:case 15:Zm(8,u,s)}var d=u.child;if(d!==null)d.return=u,Wt=d;else for(;Wt!==null;){u=Wt;var h=u.sibling,I=u.return;if(VO(u),u===c){Wt=null;break}if(h!==null){h.return=I,Wt=h;break}Wt=I}}}var p=s.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var A=y.sibling;y.sibling=null,y=A}while(y!==null)}}Wt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Wt=o;else e:for(;Wt!==null;){if(s=Wt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zm(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,Wt=m;break e}Wt=s.return}}var b=t.current;for(Wt=b;Wt!==null;){o=Wt;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,Wt=v;else e:for(o=b;Wt!==null;){if(a=Wt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:m2(9,a)}}catch(x){ki(a,a.return,x)}if(a===o){Wt=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Wt=w;break e}Wt=a.return}}if(Yn=r,Iu(),Rl&&typeof Rl.onPostCommitFiberRoot=="function")try{Rl.onPostCommitFiberRoot(g2,t)}catch{}i=!0}return i}finally{ei=n,ea.transition=e}}return!1}function jE(t,e,n){e=vf(n,e),e=vO(t,e,1),t=Pg(t,e,1),e=ws(),t!==null&&(w0(t,1,e),eo(t,e))}function ki(t,e,n){if(t.tag===3)jE(t,t,n);else for(;e!==null;){if(e.tag===3){jE(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Og===null||!Og.has(i))){t=vf(n,t),t=xO(e,t,1),e=Pg(e,t,1),t=ws(),e!==null&&(w0(e,1,t),eo(e,t));break}}e=e.return}}function Kse(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ws(),t.pingedLanes|=t.suspendedLanes&n,Br===t&&(_r&n)===n&&(ur===4||ur===3&&(_r&130023424)===_r&&500>Oi()-kV?Vd(t,0):YV|=n),eo(t,e)}function LO(t,e){e===0&&(t.mode&1?(e=ub,ub<<=1,!(ub&130023424)&&(ub=4194304)):e=1);var n=ws();t=_c(t,e),t!==null&&(w0(t,e,n),eo(t,n))}function Lse(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LO(t,n)}function zse(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(lt(314))}i!==null&&i.delete(e),LO(t,n)}var zO;zO=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qs.current)Js=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Js=!1,Wse(t,e,n);Js=!!(t.flags&131072)}else Js=!1,Gi&&e.flags&1048576&&DP(e,jx,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;cx(t,e),t=e.pendingProps;var r=mf(e,os.current);HI(e,n),r=VV(null,e,i,t,r,n);var s=FV();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$s(i)?(s=!0,Lx(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ZV(e),r.updater=p2,e.stateNode=r,r._reactInternals=e,ON(e,i,t,n),e=JN(null,e,i,!0,s,n)):(e.tag=0,Gi&&s&&bV(e),Cs(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(cx(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Pse(i),t=Za(i,t),r){case 0:e=UN(null,e,i,t,n);break e;case 1:e=_E(null,e,i,t,n);break e;case 11:e=VE(null,e,i,t,n);break e;case 14:e=FE(null,e,i,Za(i.type,t),n);break e}throw Error(lt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Za(i,r),UN(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Za(i,r),_E(t,e,i,r,n);case 3:e:{if(SO(e),t===null)throw Error(lt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,eO(t,e),Dx(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=vf(Error(lt(423)),e),e=TE(t,e,i,n,r);break e}else if(i!==r){r=vf(Error(lt(424)),e),e=TE(t,e,i,n,r);break e}else for(Ao=jg(e.stateNode.containerInfo.firstChild),vo=e,Gi=!0,Ta=null,n=qP(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Af(),i===r){e=Tc(t,e,n);break e}Cs(t,e,i,n)}e=e.child}return e;case 5:return tO(e),t===null&&zN(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,YN(i,r)?o=null:s!==null&&YN(i,s)&&(e.flags|=32),BO(t,e),Cs(t,e,o,n),e.child;case 6:return t===null&&zN(e),null;case 13:return ZO(t,e,n);case 4:return RV(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=yf(e,null,i,n):Cs(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Za(i,r),VE(t,e,i,r,n);case 7:return Cs(t,e,e.pendingProps,n),e.child;case 8:return Cs(t,e,e.pendingProps.children,n),e.child;case 12:return Cs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,hi(Px,i._currentValue),i._currentValue=o,s!==null)if(Ja(s.value,o)){if(s.children===r.children&&!qs.current){e=Tc(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Zc(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jN(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(lt(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),jN(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Cs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,HI(e,n),r=oa(r),i=i(r),e.flags|=1,Cs(t,e,i,n),e.child;case 14:return i=e.type,r=Za(i,e.pendingProps),r=Za(i.type,r),FE(t,e,i,r,n);case 15:return wO(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Za(i,r),cx(t,e),e.tag=1,$s(i)?(t=!0,Lx(e)):t=!1,HI(e,n),bO(e,i,r),ON(e,i,r,n),JN(null,e,i,!0,t,n);case 19:return RO(t,e,n);case 22:return GO(t,e,n)}throw Error(lt(156,e.tag))};function jO(t,e){return mP(t,e)}function jse(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qo(t,e,n,i){return new jse(t,e,n,i)}function zV(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pse(t){if(typeof t=="function")return zV(t)?1:0;if(t!=null){if(t=t.$$typeof,t===cV)return 11;if(t===gV)return 14}return 2}function Ug(t,e){var n=t.alternate;return n===null?(n=qo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function dx(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")zV(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pI:return Fd(n.children,r,s,e);case lV:o=8,r|=8;break;case pN:return t=qo(12,n,e,r|2),t.elementType=pN,t.lanes=s,t;case mN:return t=qo(13,n,e,r),t.elementType=mN,t.lanes=s,t;case AN:return t=qo(19,n,e,r),t.elementType=AN,t.lanes=s,t;case tP:return y2(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $j:o=10;break e;case eP:o=9;break e;case cV:o=11;break e;case gV:o=14;break e;case mg:o=16,i=null;break e}throw Error(lt(130,t==null?t:typeof t,""))}return e=qo(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Fd(t,e,n,i){return t=qo(7,t,i,e),t.lanes=n,t}function y2(t,e,n,i){return t=qo(22,t,i,e),t.elementType=tP,t.lanes=n,t.stateNode={isHidden:!1},t}function rZ(t,e,n){return t=qo(6,t,null,e),t.lanes=n,t}function sZ(t,e,n){return e=qo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ose(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Y1(0),this.expirationTimes=Y1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Y1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function jV(t,e,n,i,r,s,o,a,l){return t=new Ose(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=qo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ZV(s),t}function Dse(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:CI,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function PO(t){if(!t)return eu;t=t._reactInternals;e:{if(lh(t)!==t||t.tag!==1)throw Error(lt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(lt(171))}if(t.tag===1){var n=t.type;if($s(n))return PP(t,n,e)}return e}function OO(t,e,n,i,r,s,o,a,l){return t=jV(n,i,!0,t,r,s,o,a,l),t.context=PO(null),n=t.current,i=ws(),r=Dg(n),s=Zc(i,r),s.callback=e??null,Pg(n,s,r),t.current.lanes=r,w0(t,r,i),eo(t,i),t}function b2(t,e,n,i){var r=e.current,s=ws(),o=Dg(r);return n=PO(n),e.context===null?e.context=n:e.pendingContext=n,e=Zc(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Pg(r,e,o),t!==null&&(La(t,r,o,s),ox(t,r,o)),o}function nw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function PE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function PV(t,e){PE(t,e),(t=t.alternate)&&PE(t,e)}function Use(){return null}var DO=typeof reportError=="function"?reportError:function(t){console.error(t)};function OV(t){this._internalRoot=t}v2.prototype.render=OV.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(lt(409));b2(t,e,null,null)};v2.prototype.unmount=OV.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pd(function(){b2(null,t,null,null)}),e[Fc]=null}};function v2(t){this._internalRoot=t}v2.prototype.unstable_scheduleHydration=function(t){if(t){var e=GP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vg.length&&e!==0&&e<vg[n].priority;n++);vg.splice(n,0,t),n===0&&SP(t)}};function DV(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function x2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function OE(){}function Jse(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=nw(o);s.call(c)}}var o=OO(e,i,t,0,null,!1,!1,"",OE);return t._reactRootContainer=o,t[Fc]=o.current,sA(t.nodeType===8?t.parentNode:t),Pd(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=nw(l);a.call(c)}}var l=jV(t,0,!1,null,null,!1,!1,"",OE);return t._reactRootContainer=l,t[Fc]=l.current,sA(t.nodeType===8?t.parentNode:t),Pd(function(){b2(e,l,n,i)}),l}function w2(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=nw(o);a.call(l)}}b2(e,o,t,r)}else o=Jse(n,e,t,r,i);return nw(o)}xP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=um(e.pendingLanes);n!==0&&(hV(e,n|1),eo(e,Oi()),!(Yn&6)&&(xf=Oi()+500,Iu()))}break;case 13:Pd(function(){var i=_c(t,1);if(i!==null){var r=ws();La(i,t,1,r)}}),PV(t,1)}};IV=function(t){if(t.tag===13){var e=_c(t,134217728);if(e!==null){var n=ws();La(e,t,134217728,n)}PV(t,134217728)}};wP=function(t){if(t.tag===13){var e=Dg(t),n=_c(t,e);if(n!==null){var i=ws();La(n,t,e,i)}PV(t,e)}};GP=function(){return ei};BP=function(t,e){var n=ei;try{return ei=t,e()}finally{ei=n}};RN=function(t,e,n){switch(e){case"input":if(vN(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=I2(i);if(!r)throw Error(lt(90));iP(i),vN(i,r)}}}break;case"textarea":sP(t,n);break;case"select":e=n.value,e!=null&&XI(t,!!n.multiple,e,!1)}};dP=HV;hP=Pd;var Qse={usingClientEntryPoint:!1,Events:[B0,bI,I2,gP,uP,HV]},Sp={findFiberByHostInstance:dd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qse={bundleType:Sp.bundleType,version:Sp.version,rendererPackageName:Sp.rendererPackageName,rendererConfig:Sp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=CP(t),t===null?null:t.stateNode},findFiberByHostInstance:Sp.findFiberByHostInstance||Use,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vb.isDisabled&&vb.supportsFiber)try{g2=vb.inject(qse),Rl=vb}catch{}}Zo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qse;Zo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!DV(e))throw Error(lt(200));return Dse(t,e,null,n)};Zo.createRoot=function(t,e){if(!DV(t))throw Error(lt(299));var n=!1,i="",r=DO;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=jV(t,1,!1,null,null,n,!1,i,r),t[Fc]=e.current,sA(t.nodeType===8?t.parentNode:t),new OV(e)};Zo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(lt(188)):(t=Object.keys(t).join(","),Error(lt(268,t)));return t=CP(e),t=t===null?null:t.stateNode,t};Zo.flushSync=function(t){return Pd(t)};Zo.hydrate=function(t,e,n){if(!x2(e))throw Error(lt(200));return w2(null,t,e,!0,n)};Zo.hydrateRoot=function(t,e,n){if(!DV(t))throw Error(lt(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=DO;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=OO(e,null,t,1,n??null,r,!1,s,o),t[Fc]=e.current,sA(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new v2(e)};Zo.render=function(t,e,n){if(!x2(e))throw Error(lt(200));return w2(null,t,e,!1,n)};Zo.unmountComponentAtNode=function(t){if(!x2(t))throw Error(lt(40));return t._reactRootContainer?(Pd(function(){w2(null,null,t,!1,function(){t._reactRootContainer=null,t[Fc]=null})}),!0):!1};Zo.unstable_batchedUpdates=HV;Zo.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!x2(n))throw Error(lt(200));if(t==null||t._reactInternals===void 0)throw Error(lt(38));return w2(t,e,n,!1,i)};Zo.version="18.3.1-next-f1338f8080-20240426";function UO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UO)}catch(t){console.error(t)}}UO(),Uj.exports=Zo;var ch=Uj.exports;const $se=Pn(ch);var UV,DE=ch;UV=DE.createRoot,DE.hydrateRoot;function eoe(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,i,r,s,o=[],a="",l=t.split("/");for(l[0]||l.shift();r=l.shift();)n=r[0],n==="*"?(o.push(n),a+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(i=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~i?i:~s?s:r.length)),a+=~i&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(a+=(~i?"?":"")+"\\"+r.substring(s))):a+="/"+r;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var JO={exports:{}},QO={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wf=S;function toe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var noe=typeof Object.is=="function"?Object.is:toe,ioe=wf.useState,roe=wf.useEffect,soe=wf.useLayoutEffect,ooe=wf.useDebugValue;function aoe(t,e){var n=e(),i=ioe({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return soe(function(){r.value=n,r.getSnapshot=e,oZ(r)&&s({inst:r})},[t,n,e]),roe(function(){return oZ(r)&&s({inst:r}),t(function(){oZ(r)&&s({inst:r})})},[t]),ooe(n),n}function oZ(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!noe(t,n)}catch{return!0}}function loe(t,e){return e()}var coe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?loe:aoe;QO.useSyncExternalStore=wf.useSyncExternalStore!==void 0?wf.useSyncExternalStore:coe;JO.exports=QO;var goe=JO.exports;const uoe=Oj.useInsertionEffect,doe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",hoe=doe?S.useLayoutEffect:S.useEffect,Ioe=uoe||hoe,qO=t=>{const e=S.useRef([t,(...n)=>e[0](...n)]).current;return Ioe(()=>{e[0]=t}),e[1]},foe="popstate",JV="pushState",QV="replaceState",Coe="hashchange",UE=[foe,JV,QV,Coe],poe=t=>{for(const e of UE)addEventListener(e,t);return()=>{for(const e of UE)removeEventListener(e,t)}},$O=(t,e)=>goe.useSyncExternalStore(poe,t,e),moe=()=>location.search,Aoe=({ssrSearch:t=""}={})=>$O(moe,()=>t),JE=()=>location.pathname,yoe=({ssrPath:t}={})=>$O(JE,t?()=>t:JE),boe=(t,{replace:e=!1,state:n=null}={})=>history[e?QV:JV](n,"",t),voe=(t={})=>[yoe(t),boe],QE=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[QE]>"u"){for(const t of[JV,QV]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),i=new Event(t);return i.arguments=arguments,dispatchEvent(i),n}}Object.defineProperty(window,QE,{value:!0})}const xoe=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",eD=(t="")=>t==="/"?"":t,woe=(t,e)=>t[0]==="~"?t.slice(1):eD(e)+t,Goe=(t="",e)=>xoe(qE(eD(t)),qE(e)),qE=t=>{try{return decodeURI(t)}catch{return t}},tD={hook:voe,searchHook:Aoe,parser:eoe,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:t=>t},nD=S.createContext(tD),Z0=()=>S.useContext(nD),iD={},rD=S.createContext(iD),Boe=()=>S.useContext(rD),G2=t=>{const[e,n]=t.hook(t);return[Goe(t.base,e),qO((i,r)=>n(woe(i,t.base),r))]},Soe=()=>G2(Z0()),sD=(t,e,n,i)=>{const{pattern:r,keys:s}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",i),o=r.exec(n)||[],[a,...l]=o;return a!==void 0?[!0,(()=>{const c=s!==!1?Object.fromEntries(s.map((d,h)=>[d,l[h]])):o.groups;let u={...l};return c&&Object.assign(u,c),u})(),...i?[a]:[]]:[!1,null]},Zoe=({children:t,...e})=>{var u,d;const n=Z0(),i=e.hook?tD:n;let r=i;const[s,o]=((u=e.ssrPath)==null?void 0:u.split("?"))??[];o&&(e.ssrSearch=o,e.ssrPath=s),e.hrefs=e.hrefs??((d=e.hook)==null?void 0:d.hrefs);let a=S.useRef({}),l=a.current,c=l;for(let h in i){const I=h==="base"?i[h]+(e[h]||""):e[h]||i[h];l===c&&I!==c[h]&&(a.current=c={...c}),c[h]=I,I!==i[h]&&(r=c)}return S.createElement(nD.Provider,{value:r,children:t})},$E=({children:t,component:e},n)=>e?S.createElement(e,{params:n}):typeof t=="function"?t(n):t,Roe=t=>{let e=S.useRef(iD),n=e.current;for(const i in t)t[i]!==n[i]&&(n=t);return Object.keys(t).length===0&&(n=t),e.current=n},gs=({path:t,nest:e,match:n,...i})=>{const r=Z0(),[s]=G2(r),[o,a,l]=n??sD(r.parser,t,s,e),c=Roe({...Boe(),...a});if(!o)return null;const u=l?S.createElement(Zoe,{base:l},$E(i,c)):$E(i,c);return S.createElement(rD.Provider,{value:c,children:u})},xb=S.forwardRef((t,e)=>{const n=Z0(),[i,r]=G2(n),{to:s="",href:o=s,onClick:a,asChild:l,children:c,className:u,replace:d,state:h,...I}=t,p=qO(A=>{A.ctrlKey||A.metaKey||A.altKey||A.shiftKey||A.button!==0||(a==null||a(A),A.defaultPrevented||(A.preventDefault(),r(o,t)))}),y=n.hrefs(o[0]==="~"?o.slice(1):n.base+o,n);return l&&S.isValidElement(c)?S.cloneElement(c,{onClick:p,href:y}):S.createElement("a",{...I,onClick:p,href:y,className:u!=null&&u.call?u(i===o):u,children:c,ref:e})}),oD=t=>Array.isArray(t)?t.flatMap(e=>oD(e&&e.type===S.Fragment?e.props.children:e)):[t],Noe=({children:t,location:e})=>{const n=Z0(),[i]=G2(n);for(const r of oD(t)){let s=0;if(S.isValidElement(r)&&(s=sD(n.parser,r.props.path,e||i,r.props.nest))[0])return S.cloneElement(r,{match:s})}return null};var GC=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Od=typeof window>"u"||"Deno"in globalThis;function Po(){}function Woe(t,e){return typeof t=="function"?t(e):t}function lW(t){return typeof t=="number"&&t>=0&&t!==1/0}function aD(t,e){return Math.max(t+(e||0)-Date.now(),0)}function LI(t,e){return typeof t=="function"?t(e):t}function Xa(t,e){return typeof t=="function"?t(e):t}function eY(t,e){const{type:n="all",exact:i,fetchStatus:r,predicate:s,queryKey:o,stale:a}=t;if(o){if(i){if(e.queryHash!==qV(o,e.options))return!1}else if(!IA(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||s&&!s(e))}function tY(t,e){const{exact:n,status:i,predicate:r,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Dd(e.options.mutationKey)!==Dd(s))return!1}else if(!IA(e.options.mutationKey,s))return!1}return!(i&&e.state.status!==i||r&&!r(e))}function qV(t,e){return((e==null?void 0:e.queryKeyHashFn)||Dd)(t)}function Dd(t){return JSON.stringify(t,(e,n)=>cW(n)?Object.keys(n).sort().reduce((i,r)=>(i[r]=n[r],i),{}):n)}function IA(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!IA(t[n],e[n])):!1}function lD(t,e){if(t===e)return t;const n=nY(t)&&nY(e);if(n||cW(t)&&cW(e)){const i=n?t:Object.keys(t),r=i.length,s=n?e:Object.keys(e),o=s.length,a=n?[]:{};let l=0;for(let c=0;c<o;c++){const u=n?c:s[c];(!n&&i.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(a[u]=void 0,l++):(a[u]=lD(t[u],e[u]),a[u]===t[u]&&t[u]!==void 0&&l++)}return r===o&&l===r?t:a}return e}function iw(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function nY(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function cW(t){if(!iY(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!iY(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function iY(t){return Object.prototype.toString.call(t)==="[object Object]"}function Moe(t){return new Promise(e=>{setTimeout(e,t)})}function gW(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?lD(t,e):e}function Voe(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function Foe(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var $V=Symbol();function cD(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===$V?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Bd,Bg,rf,Sj,_oe=(Sj=class extends GC{constructor(){super();qt(this,Bd);qt(this,Bg);qt(this,rf);Zt(this,rf,e=>{if(!Od&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ue(this,Bg)||this.setEventListener(ue(this,rf))}onUnsubscribe(){var e;this.hasListeners()||((e=ue(this,Bg))==null||e.call(this),Zt(this,Bg,void 0))}setEventListener(e){var n;Zt(this,rf,e),(n=ue(this,Bg))==null||n.call(this),Zt(this,Bg,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){ue(this,Bd)!==e&&(Zt(this,Bd,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof ue(this,Bd)=="boolean"?ue(this,Bd):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Bd=new WeakMap,Bg=new WeakMap,rf=new WeakMap,Sj),e5=new _oe,sf,Sg,of,Zj,Toe=(Zj=class extends GC{constructor(){super();qt(this,sf,!0);qt(this,Sg);qt(this,of);Zt(this,of,e=>{if(!Od&&window.addEventListener){const n=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){ue(this,Sg)||this.setEventListener(ue(this,of))}onUnsubscribe(){var e;this.hasListeners()||((e=ue(this,Sg))==null||e.call(this),Zt(this,Sg,void 0))}setEventListener(e){var n;Zt(this,of,e),(n=ue(this,Sg))==null||n.call(this),Zt(this,Sg,e(this.setOnline.bind(this)))}setOnline(e){ue(this,sf)!==e&&(Zt(this,sf,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return ue(this,sf)}},sf=new WeakMap,Sg=new WeakMap,of=new WeakMap,Zj),rw=new Toe;function uW(){let t,e;const n=new Promise((r,s)=>{t=r,e=s});n.status="pending",n.catch(()=>{});function i(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{i({status:"fulfilled",value:r}),t(r)},n.reject=r=>{i({status:"rejected",reason:r}),e(r)},n}function Xoe(t){return Math.min(1e3*2**t,3e4)}function gD(t){return(t??"online")==="online"?rw.isOnline():!0}var uD=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function aZ(t){return t instanceof uD}function dD(t){let e=!1,n=0,i=!1,r;const s=uW(),o=y=>{var A;i||(h(new uD(y)),(A=t.abort)==null||A.call(t))},a=()=>{e=!0},l=()=>{e=!1},c=()=>e5.isFocused()&&(t.networkMode==="always"||rw.isOnline())&&t.canRun(),u=()=>gD(t.networkMode)&&t.canRun(),d=y=>{var A;i||(i=!0,(A=t.onSuccess)==null||A.call(t,y),r==null||r(),s.resolve(y))},h=y=>{var A;i||(i=!0,(A=t.onError)==null||A.call(t,y),r==null||r(),s.reject(y))},I=()=>new Promise(y=>{var A;r=m=>{(i||c())&&y(m)},(A=t.onPause)==null||A.call(t)}).then(()=>{var y;r=void 0,i||(y=t.onContinue)==null||y.call(t)}),p=()=>{if(i)return;let y;const A=n===0?t.initialPromise:void 0;try{y=A??t.fn()}catch(m){y=Promise.reject(m)}Promise.resolve(y).then(d).catch(m=>{var B;if(i)return;const b=t.retry??(Od?0:3),v=t.retryDelay??Xoe,w=typeof v=="function"?v(n,m):v,x=b===!0||typeof b=="number"&&n<b||typeof b=="function"&&b(n,m);if(e||!x){h(m);return}n++,(B=t.onFail)==null||B.call(t,n,m),Moe(w).then(()=>c()?void 0:I()).then(()=>{e?h(m):p()})})};return{promise:s,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?p():I().then(p),s)}}function Eoe(){let t=[],e=0,n=a=>{a()},i=a=>{a()},r=a=>setTimeout(a,0);const s=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{i(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{s(()=>{a(...l)})},schedule:s,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{i=a},setScheduler:a=>{r=a}}}var cr=Eoe(),Sd,Rj,hD=(Rj=class{constructor(){qt(this,Sd)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),lW(this.gcTime)&&Zt(this,Sd,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Od?1/0:5*60*1e3))}clearGcTimeout(){ue(this,Sd)&&(clearTimeout(ue(this,Sd)),Zt(this,Sd,void 0))}},Sd=new WeakMap,Rj),af,lf,jo,Ur,A0,Zd,Wa,dc,Nj,Yoe=(Nj=class extends hD{constructor(e){super();qt(this,Wa);qt(this,af);qt(this,lf);qt(this,jo);qt(this,Ur);qt(this,A0);qt(this,Zd);Zt(this,Zd,!1),Zt(this,A0,e.defaultOptions),this.setOptions(e.options),this.observers=[],Zt(this,jo,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Zt(this,af,koe(this.options)),this.state=e.state??ue(this,af),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=ue(this,Ur))==null?void 0:e.promise}setOptions(e){this.options={...ue(this,A0),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,jo).remove(this)}setData(e,n){const i=gW(this.state.data,e,this.options);return vn(this,Wa,dc).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(e,n){vn(this,Wa,dc).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var i,r;const n=(i=ue(this,Ur))==null?void 0:i.promise;return(r=ue(this,Ur))==null||r.cancel(e),n?n.then(Po).catch(Po):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,af))}isActive(){return this.observers.some(e=>Xa(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$V||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!aD(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=ue(this,Ur))==null||n.continue()}onOnline(){var n;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=ue(this,Ur))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),ue(this,jo).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(ue(this,Ur)&&(ue(this,Zd)?ue(this,Ur).cancel({revert:!0}):ue(this,Ur).cancelRetry()),this.scheduleGc()),ue(this,jo).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vn(this,Wa,dc).call(this,{type:"invalidate"})}fetch(e,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ue(this,Ur))return ue(this,Ur).continueRetry(),ue(this,Ur).promise}if(e&&this.setOptions(e),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const i=new AbortController,r=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(Zt(this,Zd,!0),i.signal)})},s=()=>{const d=cD(this.options,n),h={queryKey:this.queryKey,meta:this.meta};return r(h),Zt(this,Zd,!1),this.options.persister?this.options.persister(d,h,this):d(h)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:s};r(o),(l=this.options.behavior)==null||l.onFetch(o,this),Zt(this,lf,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&vn(this,Wa,dc).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,I,p,y;aZ(d)&&d.silent||vn(this,Wa,dc).call(this,{type:"error",error:d}),aZ(d)||((I=(h=ue(this,jo).config).onError)==null||I.call(h,d,this),(y=(p=ue(this,jo).config).onSettled)==null||y.call(p,this.state.data,d,this)),this.scheduleGc()};return Zt(this,Ur,dD({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:i.abort.bind(i),onSuccess:d=>{var h,I,p,y;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(A){a(A);return}(I=(h=ue(this,jo).config).onSuccess)==null||I.call(h,d,this),(y=(p=ue(this,jo).config).onSettled)==null||y.call(p,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{vn(this,Wa,dc).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{vn(this,Wa,dc).call(this,{type:"pause"})},onContinue:()=>{vn(this,Wa,dc).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),ue(this,Ur).start()}},af=new WeakMap,lf=new WeakMap,jo=new WeakMap,Ur=new WeakMap,A0=new WeakMap,Zd=new WeakMap,Wa=new WeakSet,dc=function(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...ID(i.data,this.options),fetchMeta:e.meta??null};case"success":return{...i,data:e.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=e.error;return aZ(r)&&r.revert&&ue(this,lf)?{...ue(this,lf),fetchStatus:"idle"}:{...i,error:r,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),cr.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),ue(this,jo).notify({query:this,type:"updated",action:e})})},Nj);function ID(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gD(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function koe(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Al,Wj,Hoe=(Wj=class extends GC{constructor(e={}){super();qt(this,Al);this.config=e,Zt(this,Al,new Map)}build(e,n,i){const r=n.queryKey,s=n.queryHash??qV(r,n);let o=this.get(s);return o||(o=new Yoe({cache:this,queryKey:r,queryHash:s,options:e.defaultQueryOptions(n),state:i,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){ue(this,Al).has(e.queryHash)||(ue(this,Al).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=ue(this,Al).get(e.queryHash);n&&(e.destroy(),n===e&&ue(this,Al).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){cr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return ue(this,Al).get(e)}getAll(){return[...ue(this,Al).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(i=>eY(n,i))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(i=>eY(e,i)):n}notify(e){cr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){cr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){cr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Al=new WeakMap,Wj),yl,Is,Rd,bl,fg,Mj,Koe=(Mj=class extends hD{constructor(e){super();qt(this,bl);qt(this,yl);qt(this,Is);qt(this,Rd);this.mutationId=e.mutationId,Zt(this,Is,e.mutationCache),Zt(this,yl,[]),this.state=e.state||fD(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){ue(this,yl).includes(e)||(ue(this,yl).push(e),this.clearGcTimeout(),ue(this,Is).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Zt(this,yl,ue(this,yl).filter(n=>n!==e)),this.scheduleGc(),ue(this,Is).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){ue(this,yl).length||(this.state.status==="pending"?this.scheduleGc():ue(this,Is).remove(this))}continue(){var e;return((e=ue(this,Rd))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var r,s,o,a,l,c,u,d,h,I,p,y,A,m,b,v,w,x,B,Z;Zt(this,Rd,dD({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(N,W)=>{vn(this,bl,fg).call(this,{type:"failed",failureCount:N,error:W})},onPause:()=>{vn(this,bl,fg).call(this,{type:"pause"})},onContinue:()=>{vn(this,bl,fg).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,Is).canRun(this)}));const n=this.state.status==="pending",i=!ue(this,Rd).canStart();try{if(!n){vn(this,bl,fg).call(this,{type:"pending",variables:e,isPaused:i}),await((s=(r=ue(this,Is).config).onMutate)==null?void 0:s.call(r,e,this));const W=await((a=(o=this.options).onMutate)==null?void 0:a.call(o,e));W!==this.state.context&&vn(this,bl,fg).call(this,{type:"pending",context:W,variables:e,isPaused:i})}const N=await ue(this,Rd).start();return await((c=(l=ue(this,Is).config).onSuccess)==null?void 0:c.call(l,N,e,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,N,e,this.state.context)),await((I=(h=ue(this,Is).config).onSettled)==null?void 0:I.call(h,N,null,this.state.variables,this.state.context,this)),await((y=(p=this.options).onSettled)==null?void 0:y.call(p,N,null,e,this.state.context)),vn(this,bl,fg).call(this,{type:"success",data:N}),N}catch(N){try{throw await((m=(A=ue(this,Is).config).onError)==null?void 0:m.call(A,N,e,this.state.context,this)),await((v=(b=this.options).onError)==null?void 0:v.call(b,N,e,this.state.context)),await((x=(w=ue(this,Is).config).onSettled)==null?void 0:x.call(w,void 0,N,this.state.variables,this.state.context,this)),await((Z=(B=this.options).onSettled)==null?void 0:Z.call(B,void 0,N,e,this.state.context)),N}finally{vn(this,bl,fg).call(this,{type:"error",error:N})}}finally{ue(this,Is).runNext(this)}}},yl=new WeakMap,Is=new WeakMap,Rd=new WeakMap,bl=new WeakSet,fg=function(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),cr.batch(()=>{ue(this,yl).forEach(i=>{i.onMutationUpdate(e)}),ue(this,Is).notify({mutation:this,type:"updated",action:e})})},Mj);function fD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Io,y0,Vj,Loe=(Vj=class extends GC{constructor(e={}){super();qt(this,Io);qt(this,y0);this.config=e,Zt(this,Io,new Map),Zt(this,y0,Date.now())}build(e,n,i){const r=new Koe({mutationCache:this,mutationId:++rb(this,y0)._,options:e.defaultMutationOptions(n),state:i});return this.add(r),r}add(e){const n=wb(e),i=ue(this,Io).get(n)??[];i.push(e),ue(this,Io).set(n,i),this.notify({type:"added",mutation:e})}remove(e){var i;const n=wb(e);if(ue(this,Io).has(n)){const r=(i=ue(this,Io).get(n))==null?void 0:i.filter(s=>s!==e);r&&(r.length===0?ue(this,Io).delete(n):ue(this,Io).set(n,r))}this.notify({type:"removed",mutation:e})}canRun(e){var i;const n=(i=ue(this,Io).get(wb(e)))==null?void 0:i.find(r=>r.state.status==="pending");return!n||n===e}runNext(e){var i;const n=(i=ue(this,Io).get(wb(e)))==null?void 0:i.find(r=>r!==e&&r.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){cr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...ue(this,Io).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(i=>tY(n,i))}findAll(e={}){return this.getAll().filter(n=>tY(e,n))}notify(e){cr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return cr.batch(()=>Promise.all(e.map(n=>n.continue().catch(Po))))}},Io=new WeakMap,y0=new WeakMap,Vj);function wb(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function rY(t){return{onFetch:(e,n)=>{var u,d,h,I,p;const i=e.options,r=(h=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,s=((I=e.state.data)==null?void 0:I.pages)||[],o=((p=e.state.data)==null?void 0:p.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let y=!1;const A=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},m=cD(e.options,e.fetchOptions),b=async(v,w,x)=>{if(y)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const B={queryKey:e.queryKey,pageParam:w,direction:x?"backward":"forward",meta:e.options.meta};A(B);const Z=await m(B),{maxPages:N}=e.options,W=x?Foe:Voe;return{pages:W(v.pages,Z,N),pageParams:W(v.pageParams,w,N)}};if(r&&s.length){const v=r==="backward",w=v?zoe:sY,x={pages:s,pageParams:o},B=w(i,x);a=await b(x,B,v)}else{const v=t??s.length;do{const w=l===0?o[0]??i.initialPageParam:sY(i,a);if(l>0&&w==null)break;a=await b(a,w),l++}while(l<v)}return a};e.options.persister?e.fetchFn=()=>{var y,A;return(A=(y=e.options).persister)==null?void 0:A.call(y,c,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function sY(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function zoe(t,{pages:e,pageParams:n}){var i;return e.length>0?(i=t.getPreviousPageParam)==null?void 0:i.call(t,e[0],e,n[0],n):void 0}var Yi,Zg,Rg,cf,gf,Ng,uf,df,Fj,joe=(Fj=class{constructor(t={}){qt(this,Yi);qt(this,Zg);qt(this,Rg);qt(this,cf);qt(this,gf);qt(this,Ng);qt(this,uf);qt(this,df);Zt(this,Yi,t.queryCache||new Hoe),Zt(this,Zg,t.mutationCache||new Loe),Zt(this,Rg,t.defaultOptions||{}),Zt(this,cf,new Map),Zt(this,gf,new Map),Zt(this,Ng,0)}mount(){rb(this,Ng)._++,ue(this,Ng)===1&&(Zt(this,uf,e5.subscribe(async t=>{t&&(await this.resumePausedMutations(),ue(this,Yi).onFocus())})),Zt(this,df,rw.subscribe(async t=>{t&&(await this.resumePausedMutations(),ue(this,Yi).onOnline())})))}unmount(){var t,e;rb(this,Ng)._--,ue(this,Ng)===0&&((t=ue(this,uf))==null||t.call(this),Zt(this,uf,void 0),(e=ue(this,df))==null||e.call(this),Zt(this,df,void 0))}isFetching(t){return ue(this,Yi).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return ue(this,Zg).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ue(this,Yi).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),i=ue(this,Yi).build(this,n);return t.revalidateIfStale&&i.isStaleByTime(LI(n.staleTime,i))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return ue(this,Yi).findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),r=ue(this,Yi).get(i.queryHash),s=r==null?void 0:r.state.data,o=Woe(e,s);if(o!==void 0)return ue(this,Yi).build(this,i).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return cr.batch(()=>ue(this,Yi).findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ue(this,Yi).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=ue(this,Yi);cr.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=ue(this,Yi),i={type:"active",...t};return cr.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries(i,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},i=cr.batch(()=>ue(this,Yi).findAll(t).map(r=>r.cancel(n)));return Promise.all(i).then(Po).catch(Po)}invalidateQueries(t={},e={}){return cr.batch(()=>{if(ue(this,Yi).findAll(t).forEach(i=>{i.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},i=cr.batch(()=>ue(this,Yi).findAll(t).filter(r=>!r.isDisabled()).map(r=>{let s=r.fetch(void 0,n);return n.throwOnError||(s=s.catch(Po)),r.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(i).then(Po)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=ue(this,Yi).build(this,e);return n.isStaleByTime(LI(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Po).catch(Po)}fetchInfiniteQuery(t){return t.behavior=rY(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Po).catch(Po)}ensureInfiniteQueryData(t){return t.behavior=rY(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return rw.isOnline()?ue(this,Zg).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,Yi)}getMutationCache(){return ue(this,Zg)}getDefaultOptions(){return ue(this,Rg)}setDefaultOptions(t){Zt(this,Rg,t)}setQueryDefaults(t,e){ue(this,cf).set(Dd(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...ue(this,cf).values()];let n={};return e.forEach(i=>{IA(t,i.queryKey)&&(n={...n,...i.defaultOptions})}),n}setMutationDefaults(t,e){ue(this,gf).set(Dd(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...ue(this,gf).values()];let n={};return e.forEach(i=>{IA(t,i.mutationKey)&&(n={...n,...i.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...ue(this,Rg).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=qV(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===$V&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...ue(this,Rg).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){ue(this,Yi).clear(),ue(this,Zg).clear()}},Yi=new WeakMap,Zg=new WeakMap,Rg=new WeakMap,cf=new WeakMap,gf=new WeakMap,Ng=new WeakMap,uf=new WeakMap,df=new WeakMap,Fj),Ls,Mn,b0,fs,Nd,hf,Wg,vl,v0,If,ff,Wd,Md,Mg,Cf,Jn,hm,dW,hW,IW,fW,CW,pW,mW,CD,_j,Poe=(_j=class extends GC{constructor(e,n){super();qt(this,Jn);qt(this,Ls);qt(this,Mn);qt(this,b0);qt(this,fs);qt(this,Nd);qt(this,hf);qt(this,Wg);qt(this,vl);qt(this,v0);qt(this,If);qt(this,ff);qt(this,Wd);qt(this,Md);qt(this,Mg);qt(this,Cf,new Set);this.options=n,Zt(this,Ls,e),Zt(this,vl,null),Zt(this,Wg,uW()),this.options.experimental_prefetchInRender||ue(this,Wg).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ue(this,Mn).addObserver(this),oY(ue(this,Mn),this.options)?vn(this,Jn,hm).call(this):this.updateResult(),vn(this,Jn,fW).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return AW(ue(this,Mn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return AW(ue(this,Mn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,vn(this,Jn,CW).call(this),vn(this,Jn,pW).call(this),ue(this,Mn).removeObserver(this)}setOptions(e,n){const i=this.options,r=ue(this,Mn);if(this.options=ue(this,Ls).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Xa(this.options.enabled,ue(this,Mn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");vn(this,Jn,mW).call(this),ue(this,Mn).setOptions(this.options),i._defaulted&&!iw(this.options,i)&&ue(this,Ls).getQueryCache().notify({type:"observerOptionsUpdated",query:ue(this,Mn),observer:this});const s=this.hasListeners();s&&aY(ue(this,Mn),r,this.options,i)&&vn(this,Jn,hm).call(this),this.updateResult(n),s&&(ue(this,Mn)!==r||Xa(this.options.enabled,ue(this,Mn))!==Xa(i.enabled,ue(this,Mn))||LI(this.options.staleTime,ue(this,Mn))!==LI(i.staleTime,ue(this,Mn)))&&vn(this,Jn,dW).call(this);const o=vn(this,Jn,hW).call(this);s&&(ue(this,Mn)!==r||Xa(this.options.enabled,ue(this,Mn))!==Xa(i.enabled,ue(this,Mn))||o!==ue(this,Mg))&&vn(this,Jn,IW).call(this,o)}getOptimisticResult(e){const n=ue(this,Ls).getQueryCache().build(ue(this,Ls),e),i=this.createResult(n,e);return Doe(this,i)&&(Zt(this,fs,i),Zt(this,hf,this.options),Zt(this,Nd,ue(this,Mn).state)),i}getCurrentResult(){return ue(this,fs)}trackResult(e,n){const i={};return Object.keys(e).forEach(r=>{Object.defineProperty(i,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),n==null||n(r),e[r])})}),i}trackProp(e){ue(this,Cf).add(e)}getCurrentQuery(){return ue(this,Mn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=ue(this,Ls).defaultQueryOptions(e),i=ue(this,Ls).getQueryCache().build(ue(this,Ls),n);return i.fetch().then(()=>this.createResult(i,n))}fetch(e){return vn(this,Jn,hm).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),ue(this,fs)))}createResult(e,n){var N;const i=ue(this,Mn),r=this.options,s=ue(this,fs),o=ue(this,Nd),a=ue(this,hf),c=e!==i?e.state:ue(this,b0),{state:u}=e;let d={...u},h=!1,I;if(n._optimisticResults){const W=this.hasListeners(),M=!W&&oY(e,n),F=W&&aY(e,i,n,r);(M||F)&&(d={...d,...ID(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:y,status:A}=d;if(n.select&&d.data!==void 0)if(s&&d.data===(o==null?void 0:o.data)&&n.select===ue(this,v0))I=ue(this,If);else try{Zt(this,v0,n.select),I=n.select(d.data),I=gW(s==null?void 0:s.data,I,n),Zt(this,If,I),Zt(this,vl,null)}catch(W){Zt(this,vl,W)}else I=d.data;if(n.placeholderData!==void 0&&I===void 0&&A==="pending"){let W;if(s!=null&&s.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))W=s.data;else if(W=typeof n.placeholderData=="function"?n.placeholderData((N=ue(this,ff))==null?void 0:N.state.data,ue(this,ff)):n.placeholderData,n.select&&W!==void 0)try{W=n.select(W),Zt(this,vl,null)}catch(M){Zt(this,vl,M)}W!==void 0&&(A="success",I=gW(s==null?void 0:s.data,W,n),h=!0)}ue(this,vl)&&(p=ue(this,vl),I=ue(this,If),y=Date.now(),A="error");const m=d.fetchStatus==="fetching",b=A==="pending",v=A==="error",w=b&&m,x=I!==void 0,Z={status:A,fetchStatus:d.fetchStatus,isPending:b,isSuccess:A==="success",isError:v,isInitialLoading:w,isLoading:w,data:I,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:m,isRefetching:m&&!b,isLoadingError:v&&!x,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:v&&x,isStale:t5(e,n),refetch:this.refetch,promise:ue(this,Wg)};if(this.options.experimental_prefetchInRender){const W=T=>{Z.status==="error"?T.reject(Z.error):Z.data!==void 0&&T.resolve(Z.data)},M=()=>{const T=Zt(this,Wg,Z.promise=uW());W(T)},F=ue(this,Wg);switch(F.status){case"pending":e.queryHash===i.queryHash&&W(F);break;case"fulfilled":(Z.status==="error"||Z.data!==F.value)&&M();break;case"rejected":(Z.status!=="error"||Z.error!==F.reason)&&M();break}}return Z}updateResult(e){const n=ue(this,fs),i=this.createResult(ue(this,Mn),this.options);if(Zt(this,Nd,ue(this,Mn).state),Zt(this,hf,this.options),ue(this,Nd).data!==void 0&&Zt(this,ff,ue(this,Mn)),iw(i,n))return;Zt(this,fs,i);const r={},s=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,a=typeof o=="function"?o():o;if(a==="all"||!a&&!ue(this,Cf).size)return!0;const l=new Set(a??ue(this,Cf));return this.options.throwOnError&&l.add("error"),Object.keys(ue(this,fs)).some(c=>{const u=c;return ue(this,fs)[u]!==n[u]&&l.has(u)})};(e==null?void 0:e.listeners)!==!1&&s()&&(r.listeners=!0),vn(this,Jn,CD).call(this,{...r,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&vn(this,Jn,fW).call(this)}},Ls=new WeakMap,Mn=new WeakMap,b0=new WeakMap,fs=new WeakMap,Nd=new WeakMap,hf=new WeakMap,Wg=new WeakMap,vl=new WeakMap,v0=new WeakMap,If=new WeakMap,ff=new WeakMap,Wd=new WeakMap,Md=new WeakMap,Mg=new WeakMap,Cf=new WeakMap,Jn=new WeakSet,hm=function(e){vn(this,Jn,mW).call(this);let n=ue(this,Mn).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Po)),n},dW=function(){vn(this,Jn,CW).call(this);const e=LI(this.options.staleTime,ue(this,Mn));if(Od||ue(this,fs).isStale||!lW(e))return;const i=aD(ue(this,fs).dataUpdatedAt,e)+1;Zt(this,Wd,setTimeout(()=>{ue(this,fs).isStale||this.updateResult()},i))},hW=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ue(this,Mn)):this.options.refetchInterval)??!1},IW=function(e){vn(this,Jn,pW).call(this),Zt(this,Mg,e),!(Od||Xa(this.options.enabled,ue(this,Mn))===!1||!lW(ue(this,Mg))||ue(this,Mg)===0)&&Zt(this,Md,setInterval(()=>{(this.options.refetchIntervalInBackground||e5.isFocused())&&vn(this,Jn,hm).call(this)},ue(this,Mg)))},fW=function(){vn(this,Jn,dW).call(this),vn(this,Jn,IW).call(this,vn(this,Jn,hW).call(this))},CW=function(){ue(this,Wd)&&(clearTimeout(ue(this,Wd)),Zt(this,Wd,void 0))},pW=function(){ue(this,Md)&&(clearInterval(ue(this,Md)),Zt(this,Md,void 0))},mW=function(){const e=ue(this,Ls).getQueryCache().build(ue(this,Ls),this.options);if(e===ue(this,Mn))return;const n=ue(this,Mn);Zt(this,Mn,e),Zt(this,b0,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},CD=function(e){cr.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(ue(this,fs))}),ue(this,Ls).getQueryCache().notify({query:ue(this,Mn),type:"observerResultsUpdated"})})},_j);function Ooe(t,e){return Xa(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function oY(t,e){return Ooe(t,e)||t.state.data!==void 0&&AW(t,e,e.refetchOnMount)}function AW(t,e,n){if(Xa(e.enabled,t)!==!1){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&t5(t,e)}return!1}function aY(t,e,n,i){return(t!==e||Xa(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&t5(t,n)}function t5(t,e){return Xa(e.enabled,t)!==!1&&t.isStaleByTime(LI(e.staleTime,t))}function Doe(t,e){return!iw(t.getCurrentResult(),e)}var Vg,Fg,zs,pc,Mc,hx,yW,Tj,Uoe=(Tj=class extends GC{constructor(n,i){super();qt(this,Mc);qt(this,Vg);qt(this,Fg);qt(this,zs);qt(this,pc);Zt(this,Vg,n),this.setOptions(i),this.bindMethods(),vn(this,Mc,hx).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const i=this.options;this.options=ue(this,Vg).defaultMutationOptions(n),iw(this.options,i)||ue(this,Vg).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ue(this,zs),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&Dd(i.mutationKey)!==Dd(this.options.mutationKey)?this.reset():((r=ue(this,zs))==null?void 0:r.state.status)==="pending"&&ue(this,zs).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=ue(this,zs))==null||n.removeObserver(this)}onMutationUpdate(n){vn(this,Mc,hx).call(this),vn(this,Mc,yW).call(this,n)}getCurrentResult(){return ue(this,Fg)}reset(){var n;(n=ue(this,zs))==null||n.removeObserver(this),Zt(this,zs,void 0),vn(this,Mc,hx).call(this),vn(this,Mc,yW).call(this)}mutate(n,i){var r;return Zt(this,pc,i),(r=ue(this,zs))==null||r.removeObserver(this),Zt(this,zs,ue(this,Vg).getMutationCache().build(ue(this,Vg),this.options)),ue(this,zs).addObserver(this),ue(this,zs).execute(n)}},Vg=new WeakMap,Fg=new WeakMap,zs=new WeakMap,pc=new WeakMap,Mc=new WeakSet,hx=function(){var i;const n=((i=ue(this,zs))==null?void 0:i.state)??fD();Zt(this,Fg,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},yW=function(n){cr.batch(()=>{var i,r,s,o,a,l,c,u;if(ue(this,pc)&&this.hasListeners()){const d=ue(this,Fg).variables,h=ue(this,Fg).context;(n==null?void 0:n.type)==="success"?((r=(i=ue(this,pc)).onSuccess)==null||r.call(i,n.data,d,h),(o=(s=ue(this,pc)).onSettled)==null||o.call(s,n.data,null,d,h)):(n==null?void 0:n.type)==="error"&&((l=(a=ue(this,pc)).onError)==null||l.call(a,n.error,d,h),(u=(c=ue(this,pc)).onSettled)==null||u.call(c,void 0,n.error,d,h))}this.listeners.forEach(d=>{d(ue(this,Fg))})})},Tj),pD=S.createContext(void 0),mD=t=>{const e=S.useContext(pD);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},AD=({client:t,children:e})=>(S.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),g.jsx(pD.Provider,{value:t,children:e})),yD=S.createContext(!1),Joe=()=>S.useContext(yD);yD.Provider;function Qoe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var qoe=S.createContext(Qoe()),$oe=()=>S.useContext(qoe);function bD(t,e){return typeof t=="function"?t(...e):!!t}function bW(){}var eae=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},tae=t=>{S.useEffect(()=>{t.clearReset()},[t])},nae=({result:t,errorResetBoundary:e,throwOnError:n,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&bD(n,[t.error,i]),iae=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},rae=(t,e)=>t.isLoading&&t.isFetching&&!e,sae=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,lY=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function oae(t,e,n){var u,d,h,I,p;const i=mD(),r=Joe(),s=$oe(),o=i.defaultQueryOptions(t);(d=(u=i.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||d.call(u,o),o._optimisticResults=r?"isRestoring":"optimistic",iae(o),eae(o,s),tae(s);const a=!i.getQueryCache().get(o.queryHash),[l]=S.useState(()=>new e(i,o)),c=l.getOptimisticResult(o);if(S.useSyncExternalStore(S.useCallback(y=>{const A=r?bW:l.subscribe(cr.batchCalls(y));return l.updateResult(),A},[l,r]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),S.useEffect(()=>{l.setOptions(o,{listeners:!1})},[o,l]),sae(o,c))throw lY(o,l,s);if(nae({result:c,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash)}))throw c.error;if((I=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||I.call(h,o,c),o.experimental_prefetchInRender&&!Od&&rae(c,r)){const y=a?lY(o,l,s):(p=i.getQueryCache().get(o.queryHash))==null?void 0:p.promise;y==null||y.catch(bW).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?c:l.trackResult(c)}function vD(t,e){return oae(t,Poe)}function aae(t,e){const n=mD(),[i]=S.useState(()=>new Uoe(n,t));S.useEffect(()=>{i.setOptions(t)},[i,t]);const r=S.useSyncExternalStore(S.useCallback(o=>i.subscribe(cr.batchCalls(o)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),s=S.useCallback((o,a)=>{i.mutate(o,a).catch(bW)},[i]);if(r.error&&bD(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:s,mutateAsync:r.mutate}}async function xD(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}async function lae(t,e,n){const i=await fetch(e,{method:t,headers:n?{"Content-Type":"application/json"}:{},body:n?JSON.stringify(n):void 0,credentials:"include"});return await xD(i),i}const cae=({on401:t})=>async({queryKey:e})=>{const n=await fetch(e.join("/"),{credentials:"include"});return t==="returnNull"&&n.status===401?null:(await xD(n),await n.json())},n5=new joe({defaultOptions:{queries:{queryFn:cae({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),gae=1,uae=1e6;let lZ=0;function dae(){return lZ=(lZ+1)%Number.MAX_SAFE_INTEGER,lZ.toString()}const cZ=new Map,cY=t=>{if(cZ.has(t))return;const e=setTimeout(()=>{cZ.delete(t),Wm({type:"REMOVE_TOAST",toastId:t})},uae);cZ.set(t,e)},hae=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,gae)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?cY(n):t.toasts.forEach(i=>{cY(i.id)}),{...t,toasts:t.toasts.map(i=>i.id===n||n===void 0?{...i,open:!1}:i)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Ix=[];let fx={toasts:[]};function Wm(t){fx=hae(fx,t),Ix.forEach(e=>{e(fx)})}function Iae({...t}){const e=dae(),n=r=>Wm({type:"UPDATE_TOAST",toast:{...r,id:e}}),i=()=>Wm({type:"DISMISS_TOAST",toastId:e});return Wm({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||i()}}}),{id:e,dismiss:i,update:n}}function wD(){const[t,e]=S.useState(fx);return S.useEffect(()=>(Ix.push(e),()=>{const n=Ix.indexOf(e);n>-1&&Ix.splice(n,1)}),[t]),{...t,toast:Iae,dismiss:n=>Wm({type:"DISMISS_TOAST",toastId:n})}}function ht(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function gY(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function B2(...t){return e=>{let n=!1;const i=t.map(r=>{const s=gY(r,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():gY(t[r],null)}}}}function Gn(...t){return S.useCallback(B2(...t),t)}function fae(t,e){const n=S.createContext(e),i=s=>{const{children:o,...a}=s,l=S.useMemo(()=>a,Object.values(a));return g.jsx(n.Provider,{value:l,children:o})};i.displayName=t+"Provider";function r(s){const o=S.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[i,r]}function Ns(t,e=[]){let n=[];function i(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];const c=d=>{var m;const{scope:h,children:I,...p}=d,y=((m=h==null?void 0:h[t])==null?void 0:m[l])||a,A=S.useMemo(()=>p,Object.values(p));return g.jsx(y.Provider,{value:A,children:I})};c.displayName=s+"Provider";function u(d,h){var y;const I=((y=h==null?void 0:h[t])==null?void 0:y[l])||a,p=S.useContext(I);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const r=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[i,Cae(r,...e)]}function Cae(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function tu(t){const e=pae(t),n=S.forwardRef((i,r)=>{const{children:s,...o}=i,a=S.Children.toArray(s),l=a.find(Aae);if(l){const c=l.props.children,u=a.map(d=>d===l?S.Children.count(c)>1?S.Children.only(null):S.isValidElement(c)?c.props.children:null:d);return g.jsx(e,{...o,ref:r,children:S.isValidElement(c)?S.cloneElement(c,void 0,u):null})}return g.jsx(e,{...o,ref:r,children:s})});return n.displayName=`${t}.Slot`,n}var i5=tu("Slot");function pae(t){const e=S.forwardRef((n,i)=>{const{children:r,...s}=n;if(S.isValidElement(r)){const o=bae(r),a=yae(s,r.props);return r.type!==S.Fragment&&(a.ref=i?B2(i,o):o),S.cloneElement(r,a)}return S.Children.count(r)>1?S.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var GD=Symbol("radix.slottable");function mae(t){const e=({children:n})=>g.jsx(g.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=GD,e}function Aae(t){return S.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===GD}function yae(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{s(...a),r(...a)}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function bae(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function R0(t){const e=t+"CollectionProvider",[n,i]=Ns(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:A,children:m}=y,b=$.useRef(null),v=$.useRef(new Map).current;return g.jsx(r,{scope:A,itemMap:v,collectionRef:b,children:m})};o.displayName=e;const a=t+"CollectionSlot",l=tu(a),c=$.forwardRef((y,A)=>{const{scope:m,children:b}=y,v=s(a,m),w=Gn(A,v.collectionRef);return g.jsx(l,{ref:w,children:b})});c.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",h=tu(u),I=$.forwardRef((y,A)=>{const{scope:m,children:b,...v}=y,w=$.useRef(null),x=Gn(A,w),B=s(u,m);return $.useEffect(()=>(B.itemMap.set(w,{ref:w,...v}),()=>void B.itemMap.delete(w))),g.jsx(h,{[d]:"",ref:x,children:b})});I.displayName=u;function p(y){const A=s(t+"CollectionConsumer",y);return $.useCallback(()=>{const b=A.collectionRef.current;if(!b)return[];const v=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(A.itemMap.values()).sort((B,Z)=>v.indexOf(B.ref.current)-v.indexOf(Z.ref.current))},[A.collectionRef,A.itemMap])}return[{Provider:o,Slot:c,ItemSlot:I},p,i]}var vae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ht=vae.reduce((t,e)=>{const n=tu(`Primitive.${e}`),i=S.forwardRef((r,s)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(l,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...t,[e]:i}},{});function r5(t,e){t&&ch.flushSync(()=>t.dispatchEvent(e))}function Er(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}function xae(t,e=globalThis==null?void 0:globalThis.document){const n=Er(t);S.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var wae="DismissableLayer",vW="dismissableLayer.update",Gae="dismissableLayer.pointerDownOutside",Bae="dismissableLayer.focusOutside",uY,BD=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),gh=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,c=S.useContext(BD),[u,d]=S.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,I]=S.useState({}),p=Gn(e,Z=>d(Z)),y=Array.from(c.layers),[A]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),m=y.indexOf(A),b=u?y.indexOf(u):-1,v=c.layersWithOutsidePointerEventsDisabled.size>0,w=b>=m,x=Zae(Z=>{const N=Z.target,W=[...c.branches].some(M=>M.contains(N));!w||W||(r==null||r(Z),o==null||o(Z),Z.defaultPrevented||a==null||a())},h),B=Rae(Z=>{const N=Z.target;[...c.branches].some(M=>M.contains(N))||(s==null||s(Z),o==null||o(Z),Z.defaultPrevented||a==null||a())},h);return xae(Z=>{b===c.layers.size-1&&(i==null||i(Z),!Z.defaultPrevented&&a&&(Z.preventDefault(),a()))},h),S.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(uY=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),dY(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=uY)}},[u,h,n,c]),S.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),dY())},[u,c]),S.useEffect(()=>{const Z=()=>I({});return document.addEventListener(vW,Z),()=>document.removeEventListener(vW,Z)},[]),g.jsx(Ht.div,{...l,ref:p,style:{pointerEvents:v?w?"auto":"none":void 0,...t.style},onFocusCapture:ht(t.onFocusCapture,B.onFocusCapture),onBlurCapture:ht(t.onBlurCapture,B.onBlurCapture),onPointerDownCapture:ht(t.onPointerDownCapture,x.onPointerDownCapture)})});gh.displayName=wae;var Sae="DismissableLayerBranch",SD=S.forwardRef((t,e)=>{const n=S.useContext(BD),i=S.useRef(null),r=Gn(e,i);return S.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),g.jsx(Ht.div,{...t,ref:r})});SD.displayName=Sae;function Zae(t,e=globalThis==null?void 0:globalThis.document){const n=Er(t),i=S.useRef(!1),r=S.useRef(()=>{});return S.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){ZD(Gae,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function Rae(t,e=globalThis==null?void 0:globalThis.document){const n=Er(t),i=S.useRef(!1);return S.useEffect(()=>{const r=s=>{s.target&&!i.current&&ZD(Bae,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function dY(){const t=new CustomEvent(vW);document.dispatchEvent(t)}function ZD(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?r5(r,s):r.dispatchEvent(s)}var Nae=gh,Wae=SD,Ir=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},Mae="Portal",BC=S.forwardRef((t,e)=>{var a;const{container:n,...i}=t,[r,s]=S.useState(!1);Ir(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?$se.createPortal(g.jsx(Ht.div,{...i,ref:e}),o):null});BC.displayName=Mae;function Vae(t,e){return S.useReducer((n,i)=>e[n][i]??n,t)}var No=t=>{const{present:e,children:n}=t,i=Fae(e),r=typeof n=="function"?n({present:i.isPresent}):S.Children.only(n),s=Gn(i.ref,_ae(r));return typeof n=="function"||i.isPresent?S.cloneElement(r,{ref:s}):null};No.displayName="Presence";function Fae(t){const[e,n]=S.useState(),i=S.useRef({}),r=S.useRef(t),s=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Vae(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const c=Gb(i.current);s.current=a==="mounted"?c:"none"},[a]),Ir(()=>{const c=i.current,u=r.current;if(u!==t){const h=s.current,I=Gb(c);t?l("MOUNT"):I==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==I?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),Ir(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=I=>{const y=Gb(i.current).includes(I.animationName);if(I.target===e&&y&&(l("ANIMATION_END"),!r.current)){const A=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=A)})}},h=I=>{I.target===e&&(s.current=Gb(i.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(c=>{c&&(i.current=getComputedStyle(c)),n(c)},[])}}function Gb(t){return(t==null?void 0:t.animationName)||"none"}function _ae(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Qa({prop:t,defaultProp:e,onChange:n=()=>{}}){const[i,r]=Tae({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:i,a=Er(n),l=S.useCallback(c=>{if(s){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else r(c)},[s,t,r,a]);return[o,l]}function Tae({defaultProp:t,onChange:e}){const n=S.useState(t),[i]=n,r=S.useRef(i),s=Er(e);return S.useEffect(()=>{r.current!==i&&(s(i),r.current=i)},[i,r,s]),n}var Xae="VisuallyHidden",N0=S.forwardRef((t,e)=>g.jsx(Ht.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));N0.displayName=Xae;var Eae=N0,s5="ToastProvider",[o5,Yae,kae]=R0("Toast"),[RD,yQe]=Ns("Toast",[kae]),[Hae,S2]=RD(s5),ND=t=>{const{__scopeToast:e,label:n="Notification",duration:i=5e3,swipeDirection:r="right",swipeThreshold:s=50,children:o}=t,[a,l]=S.useState(null),[c,u]=S.useState(0),d=S.useRef(!1),h=S.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${s5}\`. Expected non-empty \`string\`.`),g.jsx(o5.Provider,{scope:e,children:g.jsx(Hae,{scope:e,label:n,duration:i,swipeDirection:r,swipeThreshold:s,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:S.useCallback(()=>u(I=>I+1),[]),onToastRemove:S.useCallback(()=>u(I=>I-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};ND.displayName=s5;var WD="ToastViewport",Kae=["F8"],xW="toast.viewportPause",wW="toast.viewportResume",MD=S.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:i=Kae,label:r="Notifications ({hotkey})",...s}=t,o=S2(WD,n),a=Yae(n),l=S.useRef(null),c=S.useRef(null),u=S.useRef(null),d=S.useRef(null),h=Gn(e,d,o.onViewportChange),I=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;S.useEffect(()=>{const A=m=>{var v;i.length!==0&&i.every(w=>m[w]||m.code===w)&&((v=d.current)==null||v.focus())};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[i]),S.useEffect(()=>{const A=l.current,m=d.current;if(p&&A&&m){const b=()=>{if(!o.isClosePausedRef.current){const B=new CustomEvent(xW);m.dispatchEvent(B),o.isClosePausedRef.current=!0}},v=()=>{if(o.isClosePausedRef.current){const B=new CustomEvent(wW);m.dispatchEvent(B),o.isClosePausedRef.current=!1}},w=B=>{!A.contains(B.relatedTarget)&&v()},x=()=>{A.contains(document.activeElement)||v()};return A.addEventListener("focusin",b),A.addEventListener("focusout",w),A.addEventListener("pointermove",b),A.addEventListener("pointerleave",x),window.addEventListener("blur",b),window.addEventListener("focus",v),()=>{A.removeEventListener("focusin",b),A.removeEventListener("focusout",w),A.removeEventListener("pointermove",b),A.removeEventListener("pointerleave",x),window.removeEventListener("blur",b),window.removeEventListener("focus",v)}}},[p,o.isClosePausedRef]);const y=S.useCallback(({tabbingDirection:A})=>{const b=a().map(v=>{const w=v.ref.current,x=[w,...tle(w)];return A==="forwards"?x:x.reverse()});return(A==="forwards"?b.reverse():b).flat()},[a]);return S.useEffect(()=>{const A=d.current;if(A){const m=b=>{var x,B,Z;const v=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!v){const N=document.activeElement,W=b.shiftKey;if(b.target===A&&W){(x=c.current)==null||x.focus();return}const T=y({tabbingDirection:W?"backwards":"forwards"}),H=T.findIndex(K=>K===N);gZ(T.slice(H+1))?b.preventDefault():W?(B=c.current)==null||B.focus():(Z=u.current)==null||Z.focus()}};return A.addEventListener("keydown",m),()=>A.removeEventListener("keydown",m)}},[a,y]),g.jsxs(Wae,{ref:l,role:"region","aria-label":r.replace("{hotkey}",I),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&g.jsx(GW,{ref:c,onFocusFromOutsideViewport:()=>{const A=y({tabbingDirection:"forwards"});gZ(A)}}),g.jsx(o5.Slot,{scope:n,children:g.jsx(Ht.ol,{tabIndex:-1,...s,ref:h})}),p&&g.jsx(GW,{ref:u,onFocusFromOutsideViewport:()=>{const A=y({tabbingDirection:"backwards"});gZ(A)}})]})});MD.displayName=WD;var VD="ToastFocusProxy",GW=S.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...r}=t,s=S2(VD,n);return g.jsx(N0,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=s.viewport)!=null&&c.contains(a))&&i()}})});GW.displayName=VD;var Z2="Toast",Lae="toast.swipeStart",zae="toast.swipeMove",jae="toast.swipeCancel",Pae="toast.swipeEnd",FD=S.forwardRef((t,e)=>{const{forceMount:n,open:i,defaultOpen:r,onOpenChange:s,...o}=t,[a=!0,l]=Qa({prop:i,defaultProp:r,onChange:s});return g.jsx(No,{present:n||a,children:g.jsx(Uae,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Er(t.onPause),onResume:Er(t.onResume),onSwipeStart:ht(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ht(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ht(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ht(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});FD.displayName=Z2;var[Oae,Dae]=RD(Z2,{onClose(){}}),Uae=S.forwardRef((t,e)=>{const{__scopeToast:n,type:i="foreground",duration:r,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:I,...p}=t,y=S2(Z2,n),[A,m]=S.useState(null),b=Gn(e,K=>m(K)),v=S.useRef(null),w=S.useRef(null),x=r||y.duration,B=S.useRef(0),Z=S.useRef(x),N=S.useRef(0),{onToastAdd:W,onToastRemove:M}=y,F=Er(()=>{var z;(A==null?void 0:A.contains(document.activeElement))&&((z=y.viewport)==null||z.focus()),o()}),T=S.useCallback(K=>{!K||K===1/0||(window.clearTimeout(N.current),B.current=new Date().getTime(),N.current=window.setTimeout(F,K))},[F]);S.useEffect(()=>{const K=y.viewport;if(K){const z=()=>{T(Z.current),c==null||c()},j=()=>{const O=new Date().getTime()-B.current;Z.current=Z.current-O,window.clearTimeout(N.current),l==null||l()};return K.addEventListener(xW,j),K.addEventListener(wW,z),()=>{K.removeEventListener(xW,j),K.removeEventListener(wW,z)}}},[y.viewport,x,l,c,T]),S.useEffect(()=>{s&&!y.isClosePausedRef.current&&T(x)},[s,x,y.isClosePausedRef,T]),S.useEffect(()=>(W(),()=>M()),[W,M]);const H=S.useMemo(()=>A?HD(A):null,[A]);return y.viewport?g.jsxs(g.Fragment,{children:[H&&g.jsx(Jae,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:H}),g.jsx(Oae,{scope:n,onClose:F,children:ch.createPortal(g.jsx(o5.ItemSlot,{scope:n,children:g.jsx(Nae,{asChild:!0,onEscapeKeyDown:ht(a,()=>{y.isFocusedToastEscapeKeyDownRef.current||F(),y.isFocusedToastEscapeKeyDownRef.current=!1}),children:g.jsx(Ht.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":y.swipeDirection,...p,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ht(t.onKeyDown,K=>{K.key==="Escape"&&(a==null||a(K.nativeEvent),K.nativeEvent.defaultPrevented||(y.isFocusedToastEscapeKeyDownRef.current=!0,F()))}),onPointerDown:ht(t.onPointerDown,K=>{K.button===0&&(v.current={x:K.clientX,y:K.clientY})}),onPointerMove:ht(t.onPointerMove,K=>{if(!v.current)return;const z=K.clientX-v.current.x,j=K.clientY-v.current.y,O=!!w.current,_=["left","right"].includes(y.swipeDirection),E=["left","up"].includes(y.swipeDirection)?Math.min:Math.max,P=_?E(0,z):0,q=_?0:E(0,j),re=K.pointerType==="touch"?10:2,de={x:P,y:q},Re={originalEvent:K,delta:de};O?(w.current=de,Bb(zae,d,Re,{discrete:!1})):hY(de,y.swipeDirection,re)?(w.current=de,Bb(Lae,u,Re,{discrete:!1}),K.target.setPointerCapture(K.pointerId)):(Math.abs(z)>re||Math.abs(j)>re)&&(v.current=null)}),onPointerUp:ht(t.onPointerUp,K=>{const z=w.current,j=K.target;if(j.hasPointerCapture(K.pointerId)&&j.releasePointerCapture(K.pointerId),w.current=null,v.current=null,z){const O=K.currentTarget,_={originalEvent:K,delta:z};hY(z,y.swipeDirection,y.swipeThreshold)?Bb(Pae,I,_,{discrete:!0}):Bb(jae,h,_,{discrete:!0}),O.addEventListener("click",E=>E.preventDefault(),{once:!0})}})})})}),y.viewport)})]}):null}),Jae=t=>{const{__scopeToast:e,children:n,...i}=t,r=S2(Z2,e),[s,o]=S.useState(!1),[a,l]=S.useState(!1);return $ae(()=>o(!0)),S.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:g.jsx(BC,{asChild:!0,children:g.jsx(N0,{...i,children:s&&g.jsxs(g.Fragment,{children:[r.label," ",n]})})})},Qae="ToastTitle",_D=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Ht.div,{...i,ref:e})});_D.displayName=Qae;var qae="ToastDescription",TD=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Ht.div,{...i,ref:e})});TD.displayName=qae;var XD="ToastAction",ED=S.forwardRef((t,e)=>{const{altText:n,...i}=t;return n.trim()?g.jsx(kD,{altText:n,asChild:!0,children:g.jsx(a5,{...i,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${XD}\`. Expected non-empty \`string\`.`),null)});ED.displayName=XD;var YD="ToastClose",a5=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t,r=Dae(YD,n);return g.jsx(kD,{asChild:!0,children:g.jsx(Ht.button,{type:"button",...i,ref:e,onClick:ht(t.onClick,r.onClose)})})});a5.displayName=YD;var kD=S.forwardRef((t,e)=>{const{__scopeToast:n,altText:i,...r}=t;return g.jsx(Ht.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...r,ref:e})});function HD(t){const e=[];return Array.from(t.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&e.push(i.textContent),ele(i)){const r=i.ariaHidden||i.hidden||i.style.display==="none",s=i.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const o=i.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...HD(i))}}),e}function Bb(t,e,n,{discrete:i}){const r=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?r5(r,s):r.dispatchEvent(s)}var hY=(t,e,n=0)=>{const i=Math.abs(t.x),r=Math.abs(t.y),s=i>r;return e==="left"||e==="right"?s&&i>n:!s&&r>n};function $ae(t=()=>{}){const e=Er(t);Ir(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[e])}function ele(t){return t.nodeType===t.ELEMENT_NODE}function tle(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function gZ(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var nle=ND,KD=MD,LD=FD,zD=_D,jD=TD,PD=ED,OD=a5;function DD(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=DD(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function ln(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=DD(t))&&(i&&(i+=" "),i+=e);return i}const IY=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,fY=ln,SC=(t,e)=>n=>{var i;if((e==null?void 0:e.variants)==null)return fY(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:s}=e,o=Object.keys(r).map(c=>{const u=n==null?void 0:n[c],d=s==null?void 0:s[c];if(u===null)return null;const h=IY(u)||IY(d);return r[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((c,u)=>{let{class:d,className:h,...I}=u;return Object.entries(I).every(p=>{let[y,A]=p;return Array.isArray(A)?A.includes({...s,...a}[y]):{...s,...a}[y]===A})?[...c,d,h]:c},[]);return fY(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ile=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),UD=(...t)=>t.filter((e,n,i)=>!!e&&i.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sle=S.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},l)=>S.createElement("svg",{ref:l,...rle,width:e,height:e,stroke:t,strokeWidth:i?Number(n)*24/Number(e):n,className:UD("lucide",r),...a},[...o.map(([c,u])=>S.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=(t,e)=>{const n=S.forwardRef(({className:i,...r},s)=>S.createElement(sle,{ref:s,iconNode:e,className:UD(`lucide-${ile(t)}`,i),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Et("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ole=Et("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=Et("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ale=Et("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=Et("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=Et("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=Et("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=Et("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=Et("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lle=Et("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cle=Et("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gle=Et("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Et("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CY=Et("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ule=Et("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=Et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=Et("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uZ=Et("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=Et("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=Et("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dle=Et("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hle=Et("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=Et("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BW=Et("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ile=Et("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=Et("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fle=Et("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cle=Et("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=Et("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ple=Et("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mle=Et("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ale=Et("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yle=Et("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AY=Et("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ble=Et("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=Et("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=Et("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vle=Et("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xle=Et("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SW=Et("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=Et("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wle=Et("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=Et("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=Et("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=Et("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Et("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=Et("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=Et("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=Et("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gle=Et("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=Et("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=Et("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=Et("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=Et("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ble=Et("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=Et("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZW=Et("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=Et("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=Et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Et("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sle=Et("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zle=Et("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),u5="-",Rle=t=>{const e=Wle(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=t;return{getClassGroupId:o=>{const a=o.split(u5);return a[0]===""&&a.length!==1&&a.shift(),iU(a,e)||Nle(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&i[o]?[...l,...i[o]]:l}}},iU=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],i=e.nextPart.get(n),r=i?iU(t.slice(1),i):void 0;if(r)return r;if(e.validators.length===0)return;const s=t.join(u5);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId},vY=/^\[(.+)\]$/,Nle=t=>{if(vY.test(t)){const e=vY.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Wle=t=>{const{theme:e,prefix:n}=t,i={nextPart:new Map,validators:[]};return Vle(Object.entries(t.classGroups),n).forEach(([s,o])=>{RW(o,i,s,e)}),i},RW=(t,e,n,i)=>{t.forEach(r=>{if(typeof r=="string"){const s=r===""?e:xY(e,r);s.classGroupId=n;return}if(typeof r=="function"){if(Mle(r)){RW(r(i),e,n,i);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([s,o])=>{RW(o,xY(e,s),n,i)})})},xY=(t,e)=>{let n=t;return e.split(u5).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},Mle=t=>t.isThemeGetter,Vle=(t,e)=>e?t.map(([n,i])=>{const r=i.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[n,r]}):t,Fle=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,i=new Map;const r=(s,o)=>{n.set(s,o),e++,e>t&&(e=0,i=n,n=new Map)};return{get(s){let o=n.get(s);if(o!==void 0)return o;if((o=i.get(s))!==void 0)return r(s,o),o},set(s,o){n.has(s)?n.set(s,o):r(s,o)}}},rU="!",_le=t=>{const{separator:e,experimentalParseClassName:n}=t,i=e.length===1,r=e[0],s=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let A=0;A<a.length;A++){let m=a[A];if(c===0){if(m===r&&(i||a.slice(A,A+s)===e)){l.push(a.slice(u,A)),u=A+s;continue}if(m==="/"){d=A;continue}}m==="["?c++:m==="]"&&c--}const h=l.length===0?a:a.substring(u),I=h.startsWith(rU),p=I?h.substring(1):h,y=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:I,baseClassName:p,maybePostfixModifierPosition:y}};return n?a=>n({className:a,parseClassName:o}):o},Tle=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(i=>{i[0]==="["?(e.push(...n.sort(),i),n=[]):n.push(i)}),e.push(...n.sort()),e},Xle=t=>({cache:Fle(t.cacheSize),parseClassName:_le(t),...Rle(t)}),Ele=/\s+/,Yle=(t,e)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:r}=e,s=[],o=t.trim().split(Ele);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:I}=n(c);let p=!!I,y=i(p?h.substring(0,I):h);if(!y){if(!p){a=c+(a.length>0?" "+a:a);continue}if(y=i(h),!y){a=c+(a.length>0?" "+a:a);continue}p=!1}const A=Tle(u).join(":"),m=d?A+rU:A,b=m+y;if(s.includes(b))continue;s.push(b);const v=r(y,p);for(let w=0;w<v.length;++w){const x=v[w];s.push(m+x)}a=c+(a.length>0?" "+a:a)}return a};function kle(){let t=0,e,n,i="";for(;t<arguments.length;)(e=arguments[t++])&&(n=sU(e))&&(i&&(i+=" "),i+=n);return i}const sU=t=>{if(typeof t=="string")return t;let e,n="";for(let i=0;i<t.length;i++)t[i]&&(e=sU(t[i]))&&(n&&(n+=" "),n+=e);return n};function Hle(t,...e){let n,i,r,s=o;function o(l){const c=e.reduce((u,d)=>d(u),t());return n=Xle(c),i=n.cache.get,r=n.cache.set,s=a,a(l)}function a(l){const c=i(l);if(c)return c;const u=Yle(l,n);return r(l,u),u}return function(){return s(kle.apply(null,arguments))}}const fi=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},oU=/^\[(?:([a-z-]+):)?(.+)\]$/i,Kle=/^\d+\/\d+$/,Lle=new Set(["px","full","screen"]),zle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jle=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ple=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ole=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Dle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ic=t=>PI(t)||Lle.has(t)||Kle.test(t),sg=t=>RC(t,"length",nce),PI=t=>!!t&&!Number.isNaN(Number(t)),dZ=t=>RC(t,"number",PI),Zp=t=>!!t&&Number.isInteger(Number(t)),Ule=t=>t.endsWith("%")&&PI(t.slice(0,-1)),pn=t=>oU.test(t),og=t=>zle.test(t),Jle=new Set(["length","size","percentage"]),Qle=t=>RC(t,Jle,aU),qle=t=>RC(t,"position",aU),$le=new Set(["image","url"]),ece=t=>RC(t,$le,rce),tce=t=>RC(t,"",ice),Rp=()=>!0,RC=(t,e,n)=>{const i=oU.exec(t);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):n(i[2]):!1},nce=t=>jle.test(t)&&!Ple.test(t),aU=()=>!1,ice=t=>Ole.test(t),rce=t=>Dle.test(t),sce=()=>{const t=fi("colors"),e=fi("spacing"),n=fi("blur"),i=fi("brightness"),r=fi("borderColor"),s=fi("borderRadius"),o=fi("borderSpacing"),a=fi("borderWidth"),l=fi("contrast"),c=fi("grayscale"),u=fi("hueRotate"),d=fi("invert"),h=fi("gap"),I=fi("gradientColorStops"),p=fi("gradientColorStopPositions"),y=fi("inset"),A=fi("margin"),m=fi("opacity"),b=fi("padding"),v=fi("saturate"),w=fi("scale"),x=fi("sepia"),B=fi("skew"),Z=fi("space"),N=fi("translate"),W=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",pn,e],T=()=>[pn,e],H=()=>["",ic,sg],K=()=>["auto",PI,pn],z=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],j=()=>["solid","dashed","dotted","double","none"],O=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],_=()=>["start","end","center","between","around","evenly","stretch"],E=()=>["","0",pn],P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>[PI,pn];return{cacheSize:500,separator:":",theme:{colors:[Rp],spacing:[ic,sg],blur:["none","",og,pn],brightness:q(),borderColor:[t],borderRadius:["none","","full",og,pn],borderSpacing:T(),borderWidth:H(),contrast:q(),grayscale:E(),hueRotate:q(),invert:E(),gap:T(),gradientColorStops:[t],gradientColorStopPositions:[Ule,sg],inset:F(),margin:F(),opacity:q(),padding:T(),saturate:q(),scale:q(),sepia:E(),skew:q(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",pn]}],container:["container"],columns:[{columns:[og]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...z(),pn]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Zp,pn]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",pn]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",Zp,pn]}],"grid-cols":[{"grid-cols":[Rp]}],"col-start-end":[{col:["auto",{span:["full",Zp,pn]},pn]}],"col-start":[{"col-start":K()}],"col-end":[{"col-end":K()}],"grid-rows":[{"grid-rows":[Rp]}],"row-start-end":[{row:["auto",{span:[Zp,pn]},pn]}],"row-start":[{"row-start":K()}],"row-end":[{"row-end":K()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",pn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",pn]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",..._()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",..._(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[..._(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[A]}],mx:[{mx:[A]}],my:[{my:[A]}],ms:[{ms:[A]}],me:[{me:[A]}],mt:[{mt:[A]}],mr:[{mr:[A]}],mb:[{mb:[A]}],ml:[{ml:[A]}],"space-x":[{"space-x":[Z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",pn,e]}],"min-w":[{"min-w":[pn,e,"min","max","fit"]}],"max-w":[{"max-w":[pn,e,"none","full","min","max","fit","prose",{screen:[og]},og]}],h:[{h:[pn,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[pn,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[pn,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[pn,e,"auto","min","max","fit"]}],"font-size":[{text:["base",og,sg]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",dZ]}],"font-family":[{font:[Rp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",pn]}],"line-clamp":[{"line-clamp":["none",PI,dZ]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ic,pn]}],"list-image":[{"list-image":["none",pn]}],"list-style-type":[{list:["none","disc","decimal",pn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...j(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ic,sg]}],"underline-offset":[{"underline-offset":["auto",ic,pn]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...z(),qle]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Qle]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ece]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[I]}],"gradient-via":[{via:[I]}],"gradient-to":[{to:[I]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[...j(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:j()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...j()]}],"outline-offset":[{"outline-offset":[ic,pn]}],"outline-w":[{outline:[ic,sg]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[ic,sg]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",og,tce]}],"shadow-color":[{shadow:[Rp]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":[...O(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":O()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",og,pn]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[x]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[x]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",pn]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",pn]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",pn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Zp,pn]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",pn]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pn]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pn]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ic,sg,dZ]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},oce=Hle(sce);function At(...t){return oce(ln(t))}const ace=nle,lU=S.forwardRef(({className:t,...e},n)=>g.jsx(KD,{ref:n,className:At("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));lU.displayName=KD.displayName;const lce=SC("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),cU=S.forwardRef(({className:t,variant:e,...n},i)=>g.jsx(LD,{ref:i,className:At(lce({variant:e}),t),...n}));cU.displayName=LD.displayName;const cce=S.forwardRef(({className:t,...e},n)=>g.jsx(PD,{ref:n,className:At("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));cce.displayName=PD.displayName;const gU=S.forwardRef(({className:t,...e},n)=>g.jsx(OD,{ref:n,className:At("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:g.jsx(g5,{className:"h-4 w-4"})}));gU.displayName=OD.displayName;const uU=S.forwardRef(({className:t,...e},n)=>g.jsx(zD,{ref:n,className:At("text-sm font-semibold",t),...e}));uU.displayName=zD.displayName;const dU=S.forwardRef(({className:t,...e},n)=>g.jsx(jD,{ref:n,className:At("text-sm opacity-90",t),...e}));dU.displayName=jD.displayName;function hU(){const{toasts:t}=wD();return g.jsxs(ace,{children:[t.map(function({id:e,title:n,description:i,action:r,...s}){return g.jsxs(cU,{...s,children:[g.jsxs("div",{className:"grid gap-1",children:[n&&g.jsx(uU,{children:n}),i&&g.jsx(dU,{children:i})]}),r,g.jsx(gU,{})]},e)}),g.jsx(lU,{})]})}var gce=Oj[" useId ".trim().toString()]||(()=>{}),uce=0;function na(t){const[e,n]=S.useState(gce());return Ir(()=>{n(i=>i??String(uce++))},[t]),e?`radix-${e}`:""}const dce=["top","right","bottom","left"],nu=Math.min,po=Math.max,ow=Math.round,Sb=Math.floor,Wl=t=>({x:t,y:t}),hce={left:"right",right:"left",bottom:"top",top:"bottom"},Ice={start:"end",end:"start"};function NW(t,e,n){return po(t,nu(e,n))}function Ec(t,e){return typeof t=="function"?t(e):t}function Yc(t){return t.split("-")[0]}function NC(t){return t.split("-")[1]}function d5(t){return t==="x"?"y":"x"}function h5(t){return t==="y"?"height":"width"}function iu(t){return["top","bottom"].includes(Yc(t))?"y":"x"}function I5(t){return d5(iu(t))}function fce(t,e,n){n===void 0&&(n=!1);const i=NC(t),r=I5(t),s=h5(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=aw(o)),[o,aw(o)]}function Cce(t){const e=aw(t);return[WW(t),e,WW(e)]}function WW(t){return t.replace(/start|end/g,e=>Ice[e])}function pce(t,e,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function mce(t,e,n,i){const r=NC(t);let s=pce(Yc(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(WW)))),s}function aw(t){return t.replace(/left|right|bottom|top/g,e=>hce[e])}function Ace(t){return{top:0,right:0,bottom:0,left:0,...t}}function IU(t){return typeof t!="number"?Ace(t):{top:t,right:t,bottom:t,left:t}}function lw(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function wY(t,e,n){let{reference:i,floating:r}=t;const s=iu(e),o=I5(e),a=h5(o),l=Yc(e),c=s==="y",u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[a]/2-r[a]/2;let I;switch(l){case"top":I={x:u,y:i.y-r.height};break;case"bottom":I={x:u,y:i.y+i.height};break;case"right":I={x:i.x+i.width,y:d};break;case"left":I={x:i.x-r.width,y:d};break;default:I={x:i.x,y:i.y}}switch(NC(e)){case"start":I[o]-=h*(n&&c?-1:1);break;case"end":I[o]+=h*(n&&c?-1:1);break}return I}const yce=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=wY(c,i,l),h=i,I={},p=0;for(let y=0;y<a.length;y++){const{name:A,fn:m}=a[y],{x:b,y:v,data:w,reset:x}=await m({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:I,rects:c,platform:o,elements:{reference:t,floating:e}});u=b??u,d=v??d,I={...I,[A]:{...I[A],...w}},x&&p<=50&&(p++,typeof x=="object"&&(x.placement&&(h=x.placement),x.rects&&(c=x.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):x.rects),{x:u,y:d}=wY(c,h,l)),y=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:I}};async function mA(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:I=0}=Ec(e,t),p=IU(I),A=a[h?d==="floating"?"reference":"floating":d],m=lw(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(A)))==null||n?A:A.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=d==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,v=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),w=await(s.isElement==null?void 0:s.isElement(v))?await(s.getScale==null?void 0:s.getScale(v))||{x:1,y:1}:{x:1,y:1},x=lw(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:v,strategy:l}):b);return{top:(m.top-x.top+p.top)/w.y,bottom:(x.bottom-m.bottom+p.bottom)/w.y,left:(m.left-x.left+p.left)/w.x,right:(x.right-m.right+p.right)/w.x}}const bce=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Ec(t,e)||{};if(c==null)return{};const d=IU(u),h={x:n,y:i},I=I5(r),p=h5(I),y=await o.getDimensions(c),A=I==="y",m=A?"top":"left",b=A?"bottom":"right",v=A?"clientHeight":"clientWidth",w=s.reference[p]+s.reference[I]-h[I]-s.floating[p],x=h[I]-s.reference[I],B=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let Z=B?B[v]:0;(!Z||!await(o.isElement==null?void 0:o.isElement(B)))&&(Z=a.floating[v]||s.floating[p]);const N=w/2-x/2,W=Z/2-y[p]/2-1,M=nu(d[m],W),F=nu(d[b],W),T=M,H=Z-y[p]-F,K=Z/2-y[p]/2+N,z=NW(T,K,H),j=!l.arrow&&NC(r)!=null&&K!==z&&s.reference[p]/2-(K<T?M:F)-y[p]/2<0,O=j?K<T?K-T:K-H:0;return{[I]:h[I]+O,data:{[I]:z,centerOffset:K-z-O,...j&&{alignmentOffset:O}},reset:j}}}),vce=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:I="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:y=!0,...A}=Ec(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const m=Yc(r),b=iu(a),v=Yc(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),x=h||(v||!y?[aw(a)]:Cce(a)),B=p!=="none";!h&&B&&x.push(...mce(a,y,p,w));const Z=[a,...x],N=await mA(e,A),W=[];let M=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&W.push(N[m]),d){const K=fce(r,o,w);W.push(N[K[0]],N[K[1]])}if(M=[...M,{placement:r,overflows:W}],!W.every(K=>K<=0)){var F,T;const K=(((F=s.flip)==null?void 0:F.index)||0)+1,z=Z[K];if(z)return{data:{index:K,overflows:M},reset:{placement:z}};let j=(T=M.filter(O=>O.overflows[0]<=0).sort((O,_)=>O.overflows[1]-_.overflows[1])[0])==null?void 0:T.placement;if(!j)switch(I){case"bestFit":{var H;const O=(H=M.filter(_=>{if(B){const E=iu(_.placement);return E===b||E==="y"}return!0}).map(_=>[_.placement,_.overflows.filter(E=>E>0).reduce((E,P)=>E+P,0)]).sort((_,E)=>_[1]-E[1])[0])==null?void 0:H[0];O&&(j=O);break}case"initialPlacement":j=a;break}if(r!==j)return{reset:{placement:j}}}return{}}}};function GY(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function BY(t){return dce.some(e=>t[e]>=0)}const xce=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=Ec(t,e);switch(i){case"referenceHidden":{const s=await mA(e,{...r,elementContext:"reference"}),o=GY(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:BY(o)}}}case"escaped":{const s=await mA(e,{...r,altBoundary:!0}),o=GY(s,n.floating);return{data:{escapedOffsets:o,escaped:BY(o)}}}default:return{}}}}};async function wce(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Yc(n),a=NC(n),l=iu(n)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,d=Ec(e,t);let{mainAxis:h,crossAxis:I,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(I=a==="end"?p*-1:p),l?{x:I*u,y:h*c}:{x:h*c,y:I*u}}const Gce=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await wce(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},Bce=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:A=>{let{x:m,y:b}=A;return{x:m,y:b}}},...l}=Ec(t,e),c={x:n,y:i},u=await mA(e,l),d=iu(Yc(r)),h=d5(d);let I=c[h],p=c[d];if(s){const A=h==="y"?"top":"left",m=h==="y"?"bottom":"right",b=I+u[A],v=I-u[m];I=NW(b,I,v)}if(o){const A=d==="y"?"top":"left",m=d==="y"?"bottom":"right",b=p+u[A],v=p-u[m];p=NW(b,p,v)}const y=a.fn({...e,[h]:I,[d]:p});return{...y,data:{x:y.x-n,y:y.y-i,enabled:{[h]:s,[d]:o}}}}}},Sce=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Ec(t,e),u={x:n,y:i},d=iu(r),h=d5(d);let I=u[h],p=u[d];const y=Ec(a,e),A=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const v=h==="y"?"height":"width",w=s.reference[h]-s.floating[v]+A.mainAxis,x=s.reference[h]+s.reference[v]-A.mainAxis;I<w?I=w:I>x&&(I=x)}if(c){var m,b;const v=h==="y"?"width":"height",w=["top","left"].includes(Yc(r)),x=s.reference[d]-s.floating[v]+(w&&((m=o.offset)==null?void 0:m[d])||0)+(w?0:A.crossAxis),B=s.reference[d]+s.reference[v]+(w?0:((b=o.offset)==null?void 0:b[d])||0)-(w?A.crossAxis:0);p<x?p=x:p>B&&(p=B)}return{[h]:I,[d]:p}}}},Zce=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:r,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Ec(t,e),u=await mA(e,c),d=Yc(r),h=NC(r),I=iu(r)==="y",{width:p,height:y}=s.floating;let A,m;d==="top"||d==="bottom"?(A=d,m=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(m=d,A=h==="end"?"top":"bottom");const b=y-u.top-u.bottom,v=p-u.left-u.right,w=nu(y-u[A],b),x=nu(p-u[m],v),B=!e.middlewareData.shift;let Z=w,N=x;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(N=v),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(Z=b),B&&!h){const M=po(u.left,0),F=po(u.right,0),T=po(u.top,0),H=po(u.bottom,0);I?N=p-2*(M!==0||F!==0?M+F:po(u.left,u.right)):Z=y-2*(T!==0||H!==0?T+H:po(u.top,u.bottom))}await l({...e,availableWidth:N,availableHeight:Z});const W=await o.getDimensions(a.floating);return p!==W.width||y!==W.height?{reset:{rects:!0}}:{}}}};function W2(){return typeof window<"u"}function WC(t){return fU(t)?(t.nodeName||"").toLowerCase():"#document"}function xo(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function zl(t){var e;return(e=(fU(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function fU(t){return W2()?t instanceof Node||t instanceof xo(t).Node:!1}function qa(t){return W2()?t instanceof Element||t instanceof xo(t).Element:!1}function El(t){return W2()?t instanceof HTMLElement||t instanceof xo(t).HTMLElement:!1}function SY(t){return!W2()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof xo(t).ShadowRoot}function V0(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=$a(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function Rce(t){return["table","td","th"].includes(WC(t))}function M2(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function f5(t){const e=C5(),n=qa(t)?$a(t):t;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function Nce(t){let e=ru(t);for(;El(e)&&!Bf(e);){if(f5(e))return e;if(M2(e))return null;e=ru(e)}return null}function C5(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Bf(t){return["html","body","#document"].includes(WC(t))}function $a(t){return xo(t).getComputedStyle(t)}function V2(t){return qa(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ru(t){if(WC(t)==="html")return t;const e=t.assignedSlot||t.parentNode||SY(t)&&t.host||zl(t);return SY(e)?e.host:e}function CU(t){const e=ru(t);return Bf(e)?t.ownerDocument?t.ownerDocument.body:t.body:El(e)&&V0(e)?e:CU(e)}function AA(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=CU(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=xo(r);if(s){const a=MW(o);return e.concat(o,o.visualViewport||[],V0(r)?r:[],a&&n?AA(a):[])}return e.concat(r,AA(r,[],n))}function MW(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function pU(t){const e=$a(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=El(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=ow(n)!==s||ow(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function p5(t){return qa(t)?t:t.contextElement}function OI(t){const e=p5(t);if(!El(e))return Wl(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=pU(e);let o=(s?ow(n.width):n.width)/i,a=(s?ow(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Wce=Wl(0);function mU(t){const e=xo(t);return!C5()||!e.visualViewport?Wce:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Mce(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==xo(t)?!1:e}function Jd(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=p5(t);let o=Wl(1);e&&(i?qa(i)&&(o=OI(i)):o=OI(t));const a=Mce(s,n,i)?mU(s):Wl(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,d=r.height/o.y;if(s){const h=xo(s),I=i&&qa(i)?xo(i):i;let p=h,y=MW(p);for(;y&&i&&I!==p;){const A=OI(y),m=y.getBoundingClientRect(),b=$a(y),v=m.left+(y.clientLeft+parseFloat(b.paddingLeft))*A.x,w=m.top+(y.clientTop+parseFloat(b.paddingTop))*A.y;l*=A.x,c*=A.y,u*=A.x,d*=A.y,l+=v,c+=w,p=xo(y),y=MW(p)}}return lw({width:u,height:d,x:l,y:c})}function m5(t,e){const n=V2(t).scrollLeft;return e?e.left+n:Jd(zl(t)).left+n}function AU(t,e,n){n===void 0&&(n=!1);const i=t.getBoundingClientRect(),r=i.left+e.scrollLeft-(n?0:m5(t,i)),s=i.top+e.scrollTop;return{x:r,y:s}}function Vce(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=zl(i),a=e?M2(e.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Wl(1);const u=Wl(0),d=El(i);if((d||!d&&!s)&&((WC(i)!=="body"||V0(o))&&(l=V2(i)),El(i))){const I=Jd(i);c=OI(i),u.x=I.x+i.clientLeft,u.y=I.y+i.clientTop}const h=o&&!d&&!s?AU(o,l,!0):Wl(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Fce(t){return Array.from(t.getClientRects())}function _ce(t){const e=zl(t),n=V2(t),i=t.ownerDocument.body,r=po(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=po(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+m5(t);const a=-n.scrollTop;return $a(i).direction==="rtl"&&(o+=po(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function Tce(t,e){const n=xo(t),i=zl(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const c=C5();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function Xce(t,e){const n=Jd(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=El(t)?OI(t):Wl(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function ZY(t,e,n){let i;if(e==="viewport")i=Tce(t,n);else if(e==="document")i=_ce(zl(t));else if(qa(e))i=Xce(e,n);else{const r=mU(t);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return lw(i)}function yU(t,e){const n=ru(t);return n===e||!qa(n)||Bf(n)?!1:$a(n).position==="fixed"||yU(n,e)}function Ece(t,e){const n=e.get(t);if(n)return n;let i=AA(t,[],!1).filter(a=>qa(a)&&WC(a)!=="body"),r=null;const s=$a(t).position==="fixed";let o=s?ru(t):t;for(;qa(o)&&!Bf(o);){const a=$a(o),l=f5(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||V0(o)&&!l&&yU(t,o))?i=i.filter(u=>u!==o):r=a,o=ru(o)}return e.set(t,i),i}function Yce(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[...n==="clippingAncestors"?M2(e)?[]:Ece(e,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,u)=>{const d=ZY(e,u,r);return c.top=po(d.top,c.top),c.right=nu(d.right,c.right),c.bottom=nu(d.bottom,c.bottom),c.left=po(d.left,c.left),c},ZY(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function kce(t){const{width:e,height:n}=pU(t);return{width:e,height:n}}function Hce(t,e,n){const i=El(e),r=zl(e),s=n==="fixed",o=Jd(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Wl(0);if(i||!i&&!s)if((WC(e)!=="body"||V0(r))&&(a=V2(e)),i){const h=Jd(e,!0,s,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else r&&(l.x=m5(r));const c=r&&!i&&!s?AU(r,a):Wl(0),u=o.left+a.scrollLeft-l.x-c.x,d=o.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:o.width,height:o.height}}function hZ(t){return $a(t).position==="static"}function RY(t,e){if(!El(t)||$a(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return zl(t)===n&&(n=n.ownerDocument.body),n}function bU(t,e){const n=xo(t);if(M2(t))return n;if(!El(t)){let r=ru(t);for(;r&&!Bf(r);){if(qa(r)&&!hZ(r))return r;r=ru(r)}return n}let i=RY(t,e);for(;i&&Rce(i)&&hZ(i);)i=RY(i,e);return i&&Bf(i)&&hZ(i)&&!f5(i)?n:i||Nce(t)||n}const Kce=async function(t){const e=this.getOffsetParent||bU,n=this.getDimensions,i=await n(t.floating);return{reference:Hce(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Lce(t){return $a(t).direction==="rtl"}const zce={convertOffsetParentRelativeRectToViewportRelativeRect:Vce,getDocumentElement:zl,getClippingRect:Yce,getOffsetParent:bU,getElementRects:Kce,getClientRects:Fce,getDimensions:kce,getScale:OI,isElement:qa,isRTL:Lce};function vU(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function jce(t,e){let n=null,i;const r=zl(t);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:I}=c;if(a||e(),!h||!I)return;const p=Sb(d),y=Sb(r.clientWidth-(u+h)),A=Sb(r.clientHeight-(d+I)),m=Sb(u),v={rootMargin:-p+"px "+-y+"px "+-A+"px "+-m+"px",threshold:po(0,nu(1,l))||1};let w=!0;function x(B){const Z=B[0].intersectionRatio;if(Z!==l){if(!w)return o();Z?o(!1,Z):i=setTimeout(()=>{o(!1,1e-7)},1e3)}Z===1&&!vU(c,t.getBoundingClientRect())&&o(),w=!1}try{n=new IntersectionObserver(x,{...v,root:r.ownerDocument})}catch{n=new IntersectionObserver(x,v)}n.observe(t)}return o(!0),s}function Pce(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=p5(t),u=r||s?[...c?AA(c):[],...AA(e)]:[];u.forEach(m=>{r&&m.addEventListener("scroll",n,{passive:!0}),s&&m.addEventListener("resize",n)});const d=c&&a?jce(c,n):null;let h=-1,I=null;o&&(I=new ResizeObserver(m=>{let[b]=m;b&&b.target===c&&I&&(I.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=I)==null||v.observe(e)})),n()}),c&&!l&&I.observe(c),I.observe(e));let p,y=l?Jd(t):null;l&&A();function A(){const m=Jd(t);y&&!vU(y,m)&&n(),y=m,p=requestAnimationFrame(A)}return n(),()=>{var m;u.forEach(b=>{r&&b.removeEventListener("scroll",n),s&&b.removeEventListener("resize",n)}),d==null||d(),(m=I)==null||m.disconnect(),I=null,l&&cancelAnimationFrame(p)}}const Oce=Gce,Dce=Bce,Uce=vce,Jce=Zce,Qce=xce,NY=bce,qce=Sce,$ce=(t,e,n)=>{const i=new Map,r={platform:zce,...n},s={...r.platform,_c:i};return yce(t,e,{...r,platform:s})};var Cx=typeof document<"u"?S.useLayoutEffect:S.useEffect;function cw(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!cw(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!cw(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function xU(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function WY(t,e){const n=xU(t);return Math.round(e*n)/n}function IZ(t){const e=S.useRef(t);return Cx(()=>{e.current=t}),e}function ege(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=S.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,I]=S.useState(i);cw(h,i)||I(i);const[p,y]=S.useState(null),[A,m]=S.useState(null),b=S.useCallback(_=>{_!==B.current&&(B.current=_,y(_))},[]),v=S.useCallback(_=>{_!==Z.current&&(Z.current=_,m(_))},[]),w=s||p,x=o||A,B=S.useRef(null),Z=S.useRef(null),N=S.useRef(u),W=l!=null,M=IZ(l),F=IZ(r),T=IZ(c),H=S.useCallback(()=>{if(!B.current||!Z.current)return;const _={placement:e,strategy:n,middleware:h};F.current&&(_.platform=F.current),$ce(B.current,Z.current,_).then(E=>{const P={...E,isPositioned:T.current!==!1};K.current&&!cw(N.current,P)&&(N.current=P,ch.flushSync(()=>{d(P)}))})},[h,e,n,F,T]);Cx(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(_=>({..._,isPositioned:!1})))},[c]);const K=S.useRef(!1);Cx(()=>(K.current=!0,()=>{K.current=!1}),[]),Cx(()=>{if(w&&(B.current=w),x&&(Z.current=x),w&&x){if(M.current)return M.current(w,x,H);H()}},[w,x,H,M,W]);const z=S.useMemo(()=>({reference:B,floating:Z,setReference:b,setFloating:v}),[b,v]),j=S.useMemo(()=>({reference:w,floating:x}),[w,x]),O=S.useMemo(()=>{const _={position:n,left:0,top:0};if(!j.floating)return _;const E=WY(j.floating,u.x),P=WY(j.floating,u.y);return a?{..._,transform:"translate("+E+"px, "+P+"px)",...xU(j.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:E,top:P}},[n,a,j.floating,u.x,u.y]);return S.useMemo(()=>({...u,update:H,refs:z,elements:j,floatingStyles:O}),[u,H,z,j,O])}const tge=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?NY({element:i.current,padding:r}).fn(n):{}:i?NY({element:i,padding:r}).fn(n):{}}}},nge=(t,e)=>({...Oce(t),options:[t,e]}),ige=(t,e)=>({...Dce(t),options:[t,e]}),rge=(t,e)=>({...qce(t),options:[t,e]}),sge=(t,e)=>({...Uce(t),options:[t,e]}),oge=(t,e)=>({...Jce(t),options:[t,e]}),age=(t,e)=>({...Qce(t),options:[t,e]}),lge=(t,e)=>({...tge(t),options:[t,e]});var cge="Arrow",wU=S.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return g.jsx(Ht.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});wU.displayName=cge;var gge=wU;function A5(t){const[e,n]=S.useState(void 0);return Ir(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var y5="Popper",[GU,fu]=Ns(y5),[uge,BU]=GU(y5),SU=t=>{const{__scopePopper:e,children:n}=t,[i,r]=S.useState(null);return g.jsx(uge,{scope:e,anchor:i,onAnchorChange:r,children:n})};SU.displayName=y5;var ZU="PopperAnchor",RU=S.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=BU(ZU,n),o=S.useRef(null),a=Gn(e,o);return S.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g.jsx(Ht.div,{...r,ref:a})});RU.displayName=ZU;var b5="PopperContent",[dge,hge]=GU(b5),NU=S.forwardRef((t,e)=>{var he,Me,be,xe,Ge,pe;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:I="optimized",onPlaced:p,...y}=t,A=BU(b5,n),[m,b]=S.useState(null),v=Gn(e,Oe=>b(Oe)),[w,x]=S.useState(null),B=A5(w),Z=(B==null?void 0:B.width)??0,N=(B==null?void 0:B.height)??0,W=i+(s!=="center"?"-"+s:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},F=Array.isArray(c)?c:[c],T=F.length>0,H={padding:M,boundary:F.filter(fge),altBoundary:T},{refs:K,floatingStyles:z,placement:j,isPositioned:O,middlewareData:_}=ege({strategy:"fixed",placement:W,whileElementsMounted:(...Oe)=>Pce(...Oe,{animationFrame:I==="always"}),elements:{reference:A.anchor},middleware:[nge({mainAxis:r+N,alignmentAxis:o}),l&&ige({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?rge():void 0,...H}),l&&sge({...H}),oge({...H,apply:({elements:Oe,rects:ve,availableWidth:U,availableHeight:We})=>{const{width:Xe,height:Qe}=ve.reference,Le=Oe.floating.style;Le.setProperty("--radix-popper-available-width",`${U}px`),Le.setProperty("--radix-popper-available-height",`${We}px`),Le.setProperty("--radix-popper-anchor-width",`${Xe}px`),Le.setProperty("--radix-popper-anchor-height",`${Qe}px`)}}),w&&lge({element:w,padding:a}),Cge({arrowWidth:Z,arrowHeight:N}),h&&age({strategy:"referenceHidden",...H})]}),[E,P]=VU(j),q=Er(p);Ir(()=>{O&&(q==null||q())},[O,q]);const re=(he=_.arrow)==null?void 0:he.x,de=(Me=_.arrow)==null?void 0:Me.y,Re=((be=_.arrow)==null?void 0:be.centerOffset)!==0,[Pe,ae]=S.useState();return Ir(()=>{m&&ae(window.getComputedStyle(m).zIndex)},[m]),g.jsx("div",{ref:K.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:O?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pe,"--radix-popper-transform-origin":[(xe=_.transformOrigin)==null?void 0:xe.x,(Ge=_.transformOrigin)==null?void 0:Ge.y].join(" "),...((pe=_.hide)==null?void 0:pe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:g.jsx(dge,{scope:n,placedSide:E,onArrowChange:x,arrowX:re,arrowY:de,shouldHideArrow:Re,children:g.jsx(Ht.div,{"data-side":E,"data-align":P,...y,ref:v,style:{...y.style,animation:O?void 0:"none"}})})})});NU.displayName=b5;var WU="PopperArrow",Ige={top:"bottom",right:"left",bottom:"top",left:"right"},MU=S.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=hge(WU,i),o=Ige[s.placedSide];return g.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:g.jsx(gge,{...r,ref:n,style:{...r.style,display:"block"}})})});MU.displayName=WU;function fge(t){return t!==null}var Cge=t=>({name:"transformOrigin",options:t,fn(e){var A,m,b;const{placement:n,rects:i,middlewareData:r}=e,o=((A=r.arrow)==null?void 0:A.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=VU(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((m=r.arrow)==null?void 0:m.x)??0)+a/2,I=(((b=r.arrow)==null?void 0:b.y)??0)+l/2;let p="",y="";return c==="bottom"?(p=o?d:`${h}px`,y=`${-l}px`):c==="top"?(p=o?d:`${h}px`,y=`${i.floating.height+l}px`):c==="right"?(p=`${-l}px`,y=o?d:`${I}px`):c==="left"&&(p=`${i.floating.width+l}px`,y=o?d:`${I}px`),{data:{x:p,y}}}});function VU(t){const[e,n="center"]=t.split("-");return[e,n]}var F2=SU,F0=RU,_2=NU,T2=MU,[X2,bQe]=Ns("Tooltip",[fu]),E2=fu(),FU="TooltipProvider",pge=700,VW="tooltip.open",[mge,v5]=X2(FU),_U=t=>{const{__scopeTooltip:e,delayDuration:n=pge,skipDelayDuration:i=300,disableHoverableContent:r=!1,children:s}=t,o=S.useRef(!0),a=S.useRef(!1),l=S.useRef(0);return S.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),g.jsx(mge,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:S.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:S.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,i)},[i]),isPointerInTransitRef:a,onPointerInTransitChange:S.useCallback(c=>{a.current=c},[]),disableHoverableContent:r,children:s})};_U.displayName=FU;var Y2="Tooltip",[Age,k2]=X2(Y2),TU=t=>{const{__scopeTooltip:e,children:n,open:i,defaultOpen:r=!1,onOpenChange:s,disableHoverableContent:o,delayDuration:a}=t,l=v5(Y2,t.__scopeTooltip),c=E2(e),[u,d]=S.useState(null),h=na(),I=S.useRef(0),p=o??l.disableHoverableContent,y=a??l.delayDuration,A=S.useRef(!1),[m=!1,b]=Qa({prop:i,defaultProp:r,onChange:Z=>{Z?(l.onOpen(),document.dispatchEvent(new CustomEvent(VW))):l.onClose(),s==null||s(Z)}}),v=S.useMemo(()=>m?A.current?"delayed-open":"instant-open":"closed",[m]),w=S.useCallback(()=>{window.clearTimeout(I.current),I.current=0,A.current=!1,b(!0)},[b]),x=S.useCallback(()=>{window.clearTimeout(I.current),I.current=0,b(!1)},[b]),B=S.useCallback(()=>{window.clearTimeout(I.current),I.current=window.setTimeout(()=>{A.current=!0,b(!0),I.current=0},y)},[y,b]);return S.useEffect(()=>()=>{I.current&&(window.clearTimeout(I.current),I.current=0)},[]),g.jsx(F2,{...c,children:g.jsx(Age,{scope:e,contentId:h,open:m,stateAttribute:v,trigger:u,onTriggerChange:d,onTriggerEnter:S.useCallback(()=>{l.isOpenDelayedRef.current?B():w()},[l.isOpenDelayedRef,B,w]),onTriggerLeave:S.useCallback(()=>{p?x():(window.clearTimeout(I.current),I.current=0)},[x,p]),onOpen:w,onClose:x,disableHoverableContent:p,children:n})})};TU.displayName=Y2;var FW="TooltipTrigger",XU=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...i}=t,r=k2(FW,n),s=v5(FW,n),o=E2(n),a=S.useRef(null),l=Gn(e,a,r.onTriggerChange),c=S.useRef(!1),u=S.useRef(!1),d=S.useCallback(()=>c.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),g.jsx(F0,{asChild:!0,...o,children:g.jsx(Ht.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...i,ref:l,onPointerMove:ht(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(r.onTriggerEnter(),u.current=!0)}),onPointerLeave:ht(t.onPointerLeave,()=>{r.onTriggerLeave(),u.current=!1}),onPointerDown:ht(t.onPointerDown,()=>{r.open&&r.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ht(t.onFocus,()=>{c.current||r.onOpen()}),onBlur:ht(t.onBlur,r.onClose),onClick:ht(t.onClick,r.onClose)})})});XU.displayName=FW;var yge="TooltipPortal",[vQe,bge]=X2(yge,{forceMount:void 0}),Sf="TooltipContent",EU=S.forwardRef((t,e)=>{const n=bge(Sf,t.__scopeTooltip),{forceMount:i=n.forceMount,side:r="top",...s}=t,o=k2(Sf,t.__scopeTooltip);return g.jsx(No,{present:i||o.open,children:o.disableHoverableContent?g.jsx(YU,{side:r,...s,ref:e}):g.jsx(vge,{side:r,...s,ref:e})})}),vge=S.forwardRef((t,e)=>{const n=k2(Sf,t.__scopeTooltip),i=v5(Sf,t.__scopeTooltip),r=S.useRef(null),s=Gn(e,r),[o,a]=S.useState(null),{trigger:l,onClose:c}=n,u=r.current,{onPointerInTransitChange:d}=i,h=S.useCallback(()=>{a(null),d(!1)},[d]),I=S.useCallback((p,y)=>{const A=p.currentTarget,m={x:p.clientX,y:p.clientY},b=Sge(m,A.getBoundingClientRect()),v=Zge(m,b),w=Rge(y.getBoundingClientRect()),x=Wge([...v,...w]);a(x),d(!0)},[d]);return S.useEffect(()=>()=>h(),[h]),S.useEffect(()=>{if(l&&u){const p=A=>I(A,u),y=A=>I(A,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",y),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",y)}}},[l,u,I,h]),S.useEffect(()=>{if(o){const p=y=>{const A=y.target,m={x:y.clientX,y:y.clientY},b=(l==null?void 0:l.contains(A))||(u==null?void 0:u.contains(A)),v=!Nge(m,o);b?h():v&&(h(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,h]),g.jsx(YU,{...t,ref:s})}),[xge,wge]=X2(Y2,{isInside:!1}),Gge=mae("TooltipContent"),YU=S.forwardRef((t,e)=>{const{__scopeTooltip:n,children:i,"aria-label":r,onEscapeKeyDown:s,onPointerDownOutside:o,...a}=t,l=k2(Sf,n),c=E2(n),{onClose:u}=l;return S.useEffect(()=>(document.addEventListener(VW,u),()=>document.removeEventListener(VW,u)),[u]),S.useEffect(()=>{if(l.trigger){const d=h=>{const I=h.target;I!=null&&I.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),g.jsx(gh,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:g.jsxs(_2,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[g.jsx(Gge,{children:i}),g.jsx(xge,{scope:n,isInside:!0,children:g.jsx(Eae,{id:l.contentId,role:"tooltip",children:r||i})})]})})});EU.displayName=Sf;var kU="TooltipArrow",Bge=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...i}=t,r=E2(n);return wge(kU,n).isInside?null:g.jsx(T2,{...r,...i,ref:e})});Bge.displayName=kU;function Sge(t,e){const n=Math.abs(e.top-t.y),i=Math.abs(e.bottom-t.y),r=Math.abs(e.right-t.x),s=Math.abs(e.left-t.x);switch(Math.min(n,i,r,s)){case s:return"left";case r:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function Zge(t,e,n=5){const i=[];switch(e){case"top":i.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":i.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":i.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":i.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return i}function Rge(t){const{top:e,right:n,bottom:i,left:r}=t;return[{x:r,y:e},{x:n,y:e},{x:n,y:i},{x:r,y:i}]}function Nge(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>i!=u>i&&n<(c-a)*(i-l)/(u-l)+a&&(r=!r)}return r}function Wge(t){const e=t.slice();return e.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),Mge(e)}function Mge(t){if(t.length<=1)return t.slice();const e=[];for(let i=0;i<t.length;i++){const r=t[i];for(;e.length>=2;){const s=e[e.length-1],o=e[e.length-2];if((s.x-o.x)*(r.y-o.y)>=(s.y-o.y)*(r.x-o.x))e.pop();else break}e.push(r)}e.pop();const n=[];for(let i=t.length-1;i>=0;i--){const r=t[i];for(;n.length>=2;){const s=n[n.length-1],o=n[n.length-2];if((s.x-o.x)*(r.y-o.y)>=(s.y-o.y)*(r.x-o.x))n.pop();else break}n.push(r)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var Vge=_U,Fge=TU,_ge=XU,HU=EU;const x5=Vge,Tge=Fge,Xge=_ge,KU=S.forwardRef(({className:t,sideOffset:e=4,...n},i)=>g.jsx(HU,{ref:i,sideOffset:e,className:At("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n}));KU.displayName=HU.displayName;const fZ=768;function Ege(){const[t,e]=S.useState(void 0);return S.useEffect(()=>{const n=window.matchMedia(`(max-width: ${fZ-1}px)`),i=()=>{e(window.innerWidth<fZ)};return n.addEventListener("change",i),e(window.innerWidth<fZ),()=>n.removeEventListener("change",i)},[]),!!t}const Yge=SC("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Mt=S.forwardRef(({className:t,variant:e,size:n,asChild:i=!1,...r},s)=>{const o=i?i5:"button";return g.jsx(o,{className:At(Yge({variant:e,size:n,className:t})),ref:s,...r})});Mt.displayName="Button";const Ra=S.forwardRef(({className:t,type:e,...n},i)=>g.jsx("input",{type:e,className:At("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:i,...n}));Ra.displayName="Input";var kge="Separator",MY="horizontal",Hge=["horizontal","vertical"],LU=S.forwardRef((t,e)=>{const{decorative:n,orientation:i=MY,...r}=t,s=Kge(i)?i:MY,a=n?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return g.jsx(Ht.div,{"data-orientation":s,...a,...r,ref:e})});LU.displayName=kge;function Kge(t){return Hge.includes(t)}var zU=LU;const px=S.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...i},r)=>g.jsx(zU,{ref:r,decorative:n,orientation:e,className:At("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...i}));px.displayName=zU.displayName;var CZ="focusScope.autoFocusOnMount",pZ="focusScope.autoFocusOnUnmount",VY={bubbles:!1,cancelable:!0},Lge="FocusScope",_0=S.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=t,[a,l]=S.useState(null),c=Er(r),u=Er(s),d=S.useRef(null),h=Gn(e,y=>l(y)),I=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(i){let y=function(v){if(I.paused||!a)return;const w=v.target;a.contains(w)?d.current=w:Cg(d.current,{select:!0})},A=function(v){if(I.paused||!a)return;const w=v.relatedTarget;w!==null&&(a.contains(w)||Cg(d.current,{select:!0}))},m=function(v){if(document.activeElement===document.body)for(const x of v)x.removedNodes.length>0&&Cg(a)};document.addEventListener("focusin",y),document.addEventListener("focusout",A);const b=new MutationObserver(m);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",A),b.disconnect()}}},[i,a,I.paused]),S.useEffect(()=>{if(a){_Y.add(I);const y=document.activeElement;if(!a.contains(y)){const m=new CustomEvent(CZ,VY);a.addEventListener(CZ,c),a.dispatchEvent(m),m.defaultPrevented||(zge(Uge(jU(a)),{select:!0}),document.activeElement===y&&Cg(a))}return()=>{a.removeEventListener(CZ,c),setTimeout(()=>{const m=new CustomEvent(pZ,VY);a.addEventListener(pZ,u),a.dispatchEvent(m),m.defaultPrevented||Cg(y??document.body,{select:!0}),a.removeEventListener(pZ,u),_Y.remove(I)},0)}}},[a,c,u,I]);const p=S.useCallback(y=>{if(!n&&!i||I.paused)return;const A=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,m=document.activeElement;if(A&&m){const b=y.currentTarget,[v,w]=jge(b);v&&w?!y.shiftKey&&m===w?(y.preventDefault(),n&&Cg(v,{select:!0})):y.shiftKey&&m===v&&(y.preventDefault(),n&&Cg(w,{select:!0})):m===b&&y.preventDefault()}},[n,i,I.paused]);return g.jsx(Ht.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})});_0.displayName=Lge;function zge(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(Cg(i,{select:e}),document.activeElement!==n)return}function jge(t){const e=jU(t),n=FY(e,t),i=FY(e.reverse(),t);return[n,i]}function jU(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function FY(t,e){for(const n of t)if(!Pge(n,{upTo:e}))return n}function Pge(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Oge(t){return t instanceof HTMLInputElement&&"select"in t}function Cg(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Oge(t)&&e&&t.select()}}var _Y=Dge();function Dge(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=TY(t,e),t.unshift(e)},remove(e){var n;t=TY(t,e),(n=t[0])==null||n.resume()}}}function TY(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function Uge(t){return t.filter(e=>e.tagName!=="A")}var mZ=0;function H2(){S.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??XY()),document.body.insertAdjacentElement("beforeend",t[1]??XY()),mZ++,()=>{mZ===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),mZ--}},[])}function XY(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var wl=function(){return wl=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wl.apply(this,arguments)};function PU(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function Jge(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var mx="right-scroll-bar-position",Ax="width-before-scroll-bar",Qge="with-scroll-bars-hidden",qge="--removed-body-scroll-bar-size";function AZ(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function $ge(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var eue=typeof window<"u"?S.useLayoutEffect:S.useEffect,EY=new WeakMap;function tue(t,e){var n=$ge(null,function(i){return t.forEach(function(r){return AZ(r,i)})});return eue(function(){var i=EY.get(n);if(i){var r=new Set(i),s=new Set(t),o=n.current;r.forEach(function(a){s.has(a)||AZ(a,null)}),s.forEach(function(a){r.has(a)||AZ(a,o)})}EY.set(n,t)},[t]),n}function nue(t){return t}function iue(t,e){e===void 0&&(e=nue);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return r}function rue(t){t===void 0&&(t={});var e=iue(null);return e.options=wl({async:!0,ssr:!1},t),e}var OU=function(t){var e=t.sideCar,n=PU(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return S.createElement(i,wl({},n))};OU.isSideCarExport=!0;function sue(t,e){return t.useMedium(e),OU}var DU=rue(),yZ=function(){},K2=S.forwardRef(function(t,e){var n=S.useRef(null),i=S.useState({onScrollCapture:yZ,onWheelCapture:yZ,onTouchMoveCapture:yZ}),r=i[0],s=i[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,I=t.noIsolation,p=t.inert,y=t.allowPinchZoom,A=t.as,m=A===void 0?"div":A,b=t.gapMode,v=PU(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=h,x=tue([n,e]),B=wl(wl({},v),r);return S.createElement(S.Fragment,null,u&&S.createElement(w,{sideCar:DU,removeScrollBar:c,shards:d,noIsolation:I,inert:p,setCallbacks:s,allowPinchZoom:!!y,lockRef:n,gapMode:b}),o?S.cloneElement(S.Children.only(a),wl(wl({},B),{ref:x})):S.createElement(m,wl({},B,{className:l,ref:x}),a))});K2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};K2.classNames={fullWidth:Ax,zeroRight:mx};var oue=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function aue(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=oue();return e&&t.setAttribute("nonce",e),t}function lue(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function cue(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var gue=function(){var t=0,e=null;return{add:function(n){t==0&&(e=aue())&&(lue(e,n),cue(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},uue=function(){var t=gue();return function(e,n){S.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},UU=function(){var t=uue(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},due={left:0,top:0,right:0,gap:0},bZ=function(t){return parseInt(t||"",10)||0},hue=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[bZ(n),bZ(i),bZ(r)]},Iue=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return due;var e=hue(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},fue=UU(),DI="data-scroll-locked",Cue=function(t,e,n,i){var r=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Qge,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(DI,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(mx,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(Ax,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(mx," .").concat(mx,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(Ax," .").concat(Ax,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(DI,`] {
    `).concat(qge,": ").concat(a,`px;
  }
`)},YY=function(){var t=parseInt(document.body.getAttribute(DI)||"0",10);return isFinite(t)?t:0},pue=function(){S.useEffect(function(){return document.body.setAttribute(DI,(YY()+1).toString()),function(){var t=YY()-1;t<=0?document.body.removeAttribute(DI):document.body.setAttribute(DI,t.toString())}},[])},mue=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;pue();var s=S.useMemo(function(){return Iue(r)},[r]);return S.createElement(fue,{styles:Cue(s,!e,r,n?"":"!important")})},_W=!1;if(typeof window<"u")try{var Zb=Object.defineProperty({},"passive",{get:function(){return _W=!0,!0}});window.addEventListener("test",Zb,Zb),window.removeEventListener("test",Zb,Zb)}catch{_W=!1}var Yh=_W?{passive:!1}:!1,Aue=function(t){return t.tagName==="TEXTAREA"},JU=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Aue(t)&&n[e]==="visible")},yue=function(t){return JU(t,"overflowY")},bue=function(t){return JU(t,"overflowX")},kY=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=QU(t,i);if(r){var s=qU(t,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},vue=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},xue=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},QU=function(t,e){return t==="v"?yue(e):bue(e)},qU=function(t,e){return t==="v"?vue(e):xue(e)},wue=function(t,e){return t==="h"&&e==="rtl"?-1:1},Gue=function(t,e,n,i,r){var s=wue(t,window.getComputedStyle(e).direction),o=s*i,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,h=0;do{var I=qU(t,a),p=I[0],y=I[1],A=I[2],m=y-A-s*p;(p||m)&&QU(t,a)&&(d+=m,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(d)<1||!r)||!u&&(Math.abs(h)<1||!r))&&(c=!0),c},Rb=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},HY=function(t){return[t.deltaX,t.deltaY]},KY=function(t){return t&&"current"in t?t.current:t},Bue=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Sue=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Zue=0,kh=[];function Rue(t){var e=S.useRef([]),n=S.useRef([0,0]),i=S.useRef(),r=S.useState(Zue++)[0],s=S.useState(UU)[0],o=S.useRef(t);S.useEffect(function(){o.current=t},[t]),S.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var y=Jge([t.lockRef.current],(t.shards||[]).map(KY),!0).filter(Boolean);return y.forEach(function(A){return A.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),y.forEach(function(A){return A.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=S.useCallback(function(y,A){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!o.current.allowPinchZoom;var m=Rb(y),b=n.current,v="deltaX"in y?y.deltaX:b[0]-m[0],w="deltaY"in y?y.deltaY:b[1]-m[1],x,B=y.target,Z=Math.abs(v)>Math.abs(w)?"h":"v";if("touches"in y&&Z==="h"&&B.type==="range")return!1;var N=kY(Z,B);if(!N)return!0;if(N?x=Z:(x=Z==="v"?"h":"v",N=kY(Z,B)),!N)return!1;if(!i.current&&"changedTouches"in y&&(v||w)&&(i.current=x),!x)return!0;var W=i.current||x;return Gue(W,A,y,W==="h"?v:w,!0)},[]),l=S.useCallback(function(y){var A=y;if(!(!kh.length||kh[kh.length-1]!==s)){var m="deltaY"in A?HY(A):Rb(A),b=e.current.filter(function(x){return x.name===A.type&&(x.target===A.target||A.target===x.shadowParent)&&Bue(x.delta,m)})[0];if(b&&b.should){A.cancelable&&A.preventDefault();return}if(!b){var v=(o.current.shards||[]).map(KY).filter(Boolean).filter(function(x){return x.contains(A.target)}),w=v.length>0?a(A,v[0]):!o.current.noIsolation;w&&A.cancelable&&A.preventDefault()}}},[]),c=S.useCallback(function(y,A,m,b){var v={name:y,delta:A,target:m,should:b,shadowParent:Nue(m)};e.current.push(v),setTimeout(function(){e.current=e.current.filter(function(w){return w!==v})},1)},[]),u=S.useCallback(function(y){n.current=Rb(y),i.current=void 0},[]),d=S.useCallback(function(y){c(y.type,HY(y),y.target,a(y,t.lockRef.current))},[]),h=S.useCallback(function(y){c(y.type,Rb(y),y.target,a(y,t.lockRef.current))},[]);S.useEffect(function(){return kh.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Yh),document.addEventListener("touchmove",l,Yh),document.addEventListener("touchstart",u,Yh),function(){kh=kh.filter(function(y){return y!==s}),document.removeEventListener("wheel",l,Yh),document.removeEventListener("touchmove",l,Yh),document.removeEventListener("touchstart",u,Yh)}},[]);var I=t.removeScrollBar,p=t.inert;return S.createElement(S.Fragment,null,p?S.createElement(s,{styles:Sue(r)}):null,I?S.createElement(mue,{gapMode:t.gapMode}):null)}function Nue(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Wue=sue(DU,Rue);var T0=S.forwardRef(function(t,e){return S.createElement(K2,wl({},t,{ref:e,sideCar:Wue}))});T0.classNames=K2.classNames;var Mue=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Hh=new WeakMap,Nb=new WeakMap,Wb={},vZ=0,$U=function(t){return t&&(t.host||$U(t.parentNode))},Vue=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=$U(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Fue=function(t,e,n,i){var r=Vue(e,Array.isArray(t)?t:[t]);Wb[n]||(Wb[n]=new WeakMap);var s=Wb[n],o=[],a=new Set,l=new Set(r),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};r.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var I=h.getAttribute(i),p=I!==null&&I!=="false",y=(Hh.get(h)||0)+1,A=(s.get(h)||0)+1;Hh.set(h,y),s.set(h,A),o.push(h),y===1&&p&&Nb.set(h,!0),A===1&&h.setAttribute(n,"true"),p||h.setAttribute(i,"true")}catch(m){console.error("aria-hidden: cannot operate on ",h,m)}})};return u(e),a.clear(),vZ++,function(){o.forEach(function(d){var h=Hh.get(d)-1,I=s.get(d)-1;Hh.set(d,h),s.set(d,I),h||(Nb.has(d)||d.removeAttribute(i),Nb.delete(d)),I||d.removeAttribute(n)}),vZ--,vZ||(Hh=new WeakMap,Hh=new WeakMap,Nb=new WeakMap,Wb={})}},L2=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=Mue(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),Fue(i,r,n,"aria-hidden")):function(){return null}},w5="Dialog",[e4,xQe]=Ns(w5),[_ue,el]=e4(w5),t4=t=>{const{__scopeDialog:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!0}=t,a=S.useRef(null),l=S.useRef(null),[c=!1,u]=Qa({prop:i,defaultProp:r,onChange:s});return g.jsx(_ue,{scope:e,triggerRef:a,contentRef:l,contentId:na(),titleId:na(),descriptionId:na(),open:c,onOpenChange:u,onOpenToggle:S.useCallback(()=>u(d=>!d),[u]),modal:o,children:n})};t4.displayName=w5;var n4="DialogTrigger",i4=S.forwardRef((t,e)=>{const{__scopeDialog:n,...i}=t,r=el(n4,n),s=Gn(e,r.triggerRef);return g.jsx(Ht.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":S5(r.open),...i,ref:s,onClick:ht(t.onClick,r.onOpenToggle)})});i4.displayName=n4;var G5="DialogPortal",[Tue,r4]=e4(G5,{forceMount:void 0}),s4=t=>{const{__scopeDialog:e,forceMount:n,children:i,container:r}=t,s=el(G5,e);return g.jsx(Tue,{scope:e,forceMount:n,children:S.Children.map(i,o=>g.jsx(No,{present:n||s.open,children:g.jsx(BC,{asChild:!0,container:r,children:o})}))})};s4.displayName=G5;var gw="DialogOverlay",o4=S.forwardRef((t,e)=>{const n=r4(gw,t.__scopeDialog),{forceMount:i=n.forceMount,...r}=t,s=el(gw,t.__scopeDialog);return s.modal?g.jsx(No,{present:i||s.open,children:g.jsx(Eue,{...r,ref:e})}):null});o4.displayName=gw;var Xue=tu("DialogOverlay.RemoveScroll"),Eue=S.forwardRef((t,e)=>{const{__scopeDialog:n,...i}=t,r=el(gw,n);return g.jsx(T0,{as:Xue,allowPinchZoom:!0,shards:[r.contentRef],children:g.jsx(Ht.div,{"data-state":S5(r.open),...i,ref:e,style:{pointerEvents:"auto",...i.style}})})}),Qd="DialogContent",a4=S.forwardRef((t,e)=>{const n=r4(Qd,t.__scopeDialog),{forceMount:i=n.forceMount,...r}=t,s=el(Qd,t.__scopeDialog);return g.jsx(No,{present:i||s.open,children:s.modal?g.jsx(Yue,{...r,ref:e}):g.jsx(kue,{...r,ref:e})})});a4.displayName=Qd;var Yue=S.forwardRef((t,e)=>{const n=el(Qd,t.__scopeDialog),i=S.useRef(null),r=Gn(e,n.contentRef,i);return S.useEffect(()=>{const s=i.current;if(s)return L2(s)},[]),g.jsx(l4,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ht(t.onCloseAutoFocus,s=>{var o;s.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ht(t.onPointerDownOutside,s=>{const o=s.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&s.preventDefault()}),onFocusOutside:ht(t.onFocusOutside,s=>s.preventDefault())})}),kue=S.forwardRef((t,e)=>{const n=el(Qd,t.__scopeDialog),i=S.useRef(!1),r=S.useRef(!1);return g.jsx(l4,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),l4=S.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,...o}=t,a=el(Qd,n),l=S.useRef(null),c=Gn(e,l);return H2(),g.jsxs(g.Fragment,{children:[g.jsx(_0,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:g.jsx(gh,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":S5(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),g.jsxs(g.Fragment,{children:[g.jsx(Hue,{titleId:a.titleId}),g.jsx(Lue,{contentRef:l,descriptionId:a.descriptionId})]})]})}),B5="DialogTitle",c4=S.forwardRef((t,e)=>{const{__scopeDialog:n,...i}=t,r=el(B5,n);return g.jsx(Ht.h2,{id:r.titleId,...i,ref:e})});c4.displayName=B5;var g4="DialogDescription",u4=S.forwardRef((t,e)=>{const{__scopeDialog:n,...i}=t,r=el(g4,n);return g.jsx(Ht.p,{id:r.descriptionId,...i,ref:e})});u4.displayName=g4;var d4="DialogClose",h4=S.forwardRef((t,e)=>{const{__scopeDialog:n,...i}=t,r=el(d4,n);return g.jsx(Ht.button,{type:"button",...i,ref:e,onClick:ht(t.onClick,()=>r.onOpenChange(!1))})});h4.displayName=d4;function S5(t){return t?"open":"closed"}var I4="DialogTitleWarning",[wQe,f4]=fae(I4,{contentName:Qd,titleName:B5,docsSlug:"dialog"}),Hue=({titleId:t})=>{const e=f4(I4),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return S.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Kue="DialogDescriptionWarning",Lue=({contentRef:t,descriptionId:e})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${f4(Kue).contentName}}.`;return S.useEffect(()=>{var s;const r=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(i))},[i,t,e]),null},C4=t4,zue=i4,p4=s4,z2=o4,j2=a4,P2=c4,O2=u4,m4=h4;const jue=C4,Pue=p4,A4=S.forwardRef(({className:t,...e},n)=>g.jsx(z2,{className:At("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));A4.displayName=z2.displayName;const Oue=SC("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),y4=S.forwardRef(({side:t="right",className:e,children:n,...i},r)=>g.jsxs(Pue,{children:[g.jsx(A4,{}),g.jsxs(j2,{ref:r,className:At(Oue({side:t}),e),...i,children:[n,g.jsxs(m4,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[g.jsx(g5,{className:"h-4 w-4"}),g.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));y4.displayName=j2.displayName;const b4=({className:t,...e})=>g.jsx("div",{className:At("flex flex-col space-y-2 text-center sm:text-left",t),...e});b4.displayName="SheetHeader";const v4=S.forwardRef(({className:t,...e},n)=>g.jsx(P2,{ref:n,className:At("text-lg font-semibold text-foreground",t),...e}));v4.displayName=P2.displayName;const x4=S.forwardRef(({className:t,...e},n)=>g.jsx(O2,{ref:n,className:At("text-sm text-muted-foreground",t),...e}));x4.displayName=O2.displayName;const Due="sidebar_state",Uue=60*60*24*7,Jue="16rem",Que="18rem",que="3rem",$ue="b",w4=S.createContext(null);function Z5(){const t=S.useContext(w4);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}function ede({defaultOpen:t=!0,open:e,onOpenChange:n,className:i,style:r,children:s,...o}){const a=Ege(),[l,c]=S.useState(!1),[u,d]=S.useState(t),h=e??u,I=S.useCallback(m=>{const b=typeof m=="function"?m(h):m;n?n(b):d(b),document.cookie=`${Due}=${b}; path=/; max-age=${Uue}`},[n,h]),p=S.useCallback(()=>a?c(m=>!m):I(m=>!m),[a,I,c]);S.useEffect(()=>{const m=b=>{b.key===$ue&&(b.metaKey||b.ctrlKey)&&(b.preventDefault(),p())};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[p]);const y=h?"expanded":"collapsed",A=S.useMemo(()=>({state:y,open:h,setOpen:I,isMobile:a,openMobile:l,setOpenMobile:c,toggleSidebar:p}),[y,h,I,a,l,c,p]);return g.jsx(w4.Provider,{value:A,children:g.jsx(x5,{delayDuration:0,children:g.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":Jue,"--sidebar-width-icon":que,...r},className:At("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",i),...o,children:s})})})}function tde({side:t="left",variant:e="sidebar",collapsible:n="offcanvas",className:i,children:r,...s}){const{isMobile:o,state:a,openMobile:l,setOpenMobile:c}=Z5();return n==="none"?g.jsx("div",{"data-slot":"sidebar",className:At("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",i),...s,children:r}):o?g.jsx(jue,{open:l,onOpenChange:c,...s,children:g.jsxs(y4,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":Que},side:t,children:[g.jsxs(b4,{className:"sr-only",children:[g.jsx(v4,{children:"Sidebar"}),g.jsx(x4,{children:"Displays the mobile sidebar."})]}),g.jsx("div",{className:"flex h-full w-full flex-col",children:r})]})}):g.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":a,"data-collapsible":a==="collapsed"?n:"","data-variant":e,"data-side":t,"data-slot":"sidebar",children:[g.jsx("div",{"data-slot":"sidebar-gap",className:At("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",e==="floating"||e==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),g.jsx("div",{"data-slot":"sidebar-container",className:At("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",e==="floating"||e==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",i),...s,children:g.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:r})})]})}function nde({className:t,onClick:e,...n}){const{toggleSidebar:i}=Z5();return g.jsxs(Mt,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:At("h-7 w-7",t),onClick:r=>{e==null||e(r),i()},...n,children:[g.jsx(ble,{}),g.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function ide({className:t,...e}){return g.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:At("flex flex-col gap-2 p-2",t),...e})}function rde({className:t,...e}){return g.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:At("flex flex-col gap-2 p-2",t),...e})}function sde({className:t,...e}){return g.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:At("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...e})}function xZ({className:t,...e}){return g.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:At("relative flex w-full min-w-0 flex-col p-2",t),...e})}function wZ({className:t,asChild:e=!1,...n}){const i=e?i5:"div";return g.jsx(i,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:At("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...n})}function GZ({className:t,...e}){return g.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:At("w-full text-sm",t),...e})}function Mb({className:t,...e}){return g.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:At("flex w-full min-w-0 flex-col gap-1",t),...e})}function Vb({className:t,...e}){return g.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:At("group/menu-item relative",t),...e})}const ode=SC("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function Fb({asChild:t=!1,isActive:e=!1,variant:n="default",size:i="default",tooltip:r,className:s,...o}){const a=t?i5:"button",{isMobile:l,state:c}=Z5(),u=g.jsx(a,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":i,"data-active":e,className:At(ode({variant:n,size:i}),s),...o});return r?(typeof r=="string"&&(r={children:r}),g.jsxs(Tge,{children:[g.jsx(Xge,{asChild:!0,children:u}),g.jsx(KU,{side:"right",align:"center",hidden:c!=="collapsed"||l,...r})]})):u}const BZ=[{title:"Dashboard",url:"/",icon:ple},{title:"Furnaces",url:"/furnaces",icon:Gf},{title:"Digital Twin",url:"/digital-twin",icon:ale},{title:"Scrap AI",url:"/scrap-ai",icon:zI},{title:"Emissions",url:"/emissions",icon:to},{title:"Maintenance",url:"/maintenance",icon:ZC},{title:"History",url:"/history",icon:Cle},{title:"Reports",url:"/reports",icon:BW},{title:"IoT Simulation",url:"/iot-simulation",icon:jI},{title:"AR Guide",url:"/ar-guide",icon:nU},{title:"Multi-Furnace",url:"/multi-furnace",icon:CA},{title:"Alerts",url:"/alerts",icon:fA}];function ade(){const[t]=Soe();return g.jsxs(tde,{className:"border-r border-sidebar-border",children:[g.jsx(ide,{className:"border-b border-sidebar-border p-6",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("img",{src:"/vijay.png",alt:"Logo",className:"w-16 h-16 rounded-md"}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-lg font-bold text-sidebar-foreground",children:"EcoSteel AI"}),g.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:"Industry 4.0"})]})]})}),g.jsxs(sde,{className:"p-4",children:[g.jsxs(xZ,{children:[g.jsx(wZ,{className:"text-xs text-muted-foreground uppercase tracking-wider mb-2",children:"Operations"}),g.jsx(GZ,{children:g.jsx(Mb,{children:BZ.slice(0,3).map(e=>g.jsx(Vb,{children:g.jsx(Fb,{asChild:!0,isActive:t===e.url,"data-testid":`link-${e.title.toLowerCase().replace(/\s+/g,"-")}`,children:g.jsxs(xb,{href:e.url,children:[g.jsx(e.icon,{className:"w-4 h-4"}),g.jsx("span",{children:e.title})]})})},e.url))})})]}),g.jsxs(xZ,{className:"mt-6",children:[g.jsx(wZ,{className:"text-xs text-muted-foreground uppercase tracking-wider mb-2",children:"Intelligence"}),g.jsx(GZ,{children:g.jsx(Mb,{children:BZ.slice(3,7).map(e=>g.jsx(Vb,{children:g.jsx(Fb,{asChild:!0,isActive:t===e.url,"data-testid":`link-${e.title.toLowerCase().replace(/\s+/g,"-")}`,children:g.jsxs(xb,{href:e.url,children:[g.jsx(e.icon,{className:"w-4 h-4"}),g.jsx("span",{children:e.title})]})})},e.url))})})]}),g.jsxs(xZ,{className:"mt-6",children:[g.jsx(wZ,{className:"text-xs text-muted-foreground uppercase tracking-wider mb-2",children:"Analytics"}),g.jsx(GZ,{children:g.jsx(Mb,{children:BZ.slice(7,11).map(e=>g.jsx(Vb,{children:g.jsx(Fb,{asChild:!0,isActive:t===e.url,"data-testid":`link-${e.title.toLowerCase().replace(/\s+/g,"-")}`,children:g.jsxs(xb,{href:e.url,children:[g.jsx(e.icon,{className:"w-4 h-4"}),g.jsx("span",{children:e.title})]})})},e.url))})})]})]}),g.jsx(rde,{className:"border-t border-sidebar-border p-4",children:g.jsx(Mb,{children:g.jsx(Vb,{children:g.jsx(Fb,{asChild:!0,"data-testid":"link-settings",children:g.jsxs(xb,{href:"/settings",children:[g.jsx(W0,{className:"w-4 h-4"}),g.jsx("span",{children:"Settings"})]})})})})})]})}const Ye=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",t),...e}));Ye.displayName="Card";const tt=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("flex flex-col space-y-1.5 p-6",t),...e}));tt.displayName="CardHeader";const nt=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("text-2xl font-semibold leading-none tracking-tight",t),...e}));nt.displayName="CardTitle";const lde=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("text-sm text-muted-foreground",t),...e}));lde.displayName="CardDescription";const ke=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("p-6 pt-0",t),...e}));ke.displayName="CardContent";const cde=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:At("flex items-center p-6 pt-0",t),...e}));cde.displayName="CardFooter";function gde(){return g.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-white",children:g.jsx(Ye,{className:"w-full max-w-md mx-4",children:g.jsxs(ke,{className:"pt-6",children:[g.jsxs("div",{className:"flex mb-4 gap-2",children:[g.jsx(gle,{className:"h-8 w-8 text-red-500"}),g.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),g.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}var ude="Label",G4=S.forwardRef((t,e)=>g.jsx(Ht.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));G4.displayName=ude;var B4=G4;const dde=SC("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ar=S.forwardRef(({className:t,...e},n)=>g.jsx(B4,{ref:n,className:At(dde(),t),...e}));ar.displayName=B4.displayName;const hde=SC("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function nn({className:t,variant:e,...n}){return g.jsx("div",{className:At(hde({variant:e}),t),...n})}const LY=[{id:"operator",title:"Plant Operator",description:"Monitor and control furnace operations in real-time",icon:Gf,color:"bg-blue-100 text-blue-800 border-blue-200",permissions:["View Dashboard","Control Furnaces","Monitor Sensors","Log Events"]},{id:"engineer",title:"Maintenance Engineer",description:"Perform maintenance tasks and troubleshoot equipment",icon:ZC,color:"bg-green-100 text-green-800 border-green-200",permissions:["All Operator permissions","Maintenance Scheduling","Equipment Diagnostics","Safety Overrides"]},{id:"manager",title:"Plant Manager",description:"Oversee plant operations and make strategic decisions",icon:Mm,color:"bg-purple-100 text-purple-800 border-purple-200",permissions:["All permissions","User Management","Reports & Analytics","System Configuration"]}];function Ide(){var c;const[t,e]=S.useState(null),[n,i]=S.useState(""),[r,s]=S.useState(""),[o,a]=S.useState(!1),l=async()=>{a(!0),setTimeout(()=>{a(!1),console.log("Login successful with role:",t)},1500)};return g.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:g.jsxs("div",{className:"w-full max-w-6xl",children:[g.jsxs("div",{className:"text-center mb-8",children:[g.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[g.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl flex items-center justify-center",children:g.jsx(Gf,{className:"w-8 h-8 text-white"})}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"EcoSteel AI"}),g.jsx("p",{className:"text-lg text-gray-600",children:"Industry 4.0 Steel Plant Intelligence"})]})]}),g.jsxs("div",{className:"max-w-2xl mx-auto",children:[g.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Advanced Furnace Monitoring & Control"}),g.jsx("p",{className:"text-gray-600",children:"Real-time AI-powered steel production optimization for modern industrial facilities. Monitor emissions, predict maintenance, and maximize efficiency with cutting-edge technology."})]}),g.jsxs("div",{className:"flex items-center justify-center gap-6 mt-6",children:[g.jsxs(nn,{variant:"outline",className:"px-3 py-1",children:[g.jsx(Xc,{className:"w-4 h-4 mr-1"}),"Real-time Monitoring"]}),g.jsxs(nn,{variant:"outline",className:"px-3 py-1",children:[g.jsx(Mm,{className:"w-4 h-4 mr-1"}),"AI-Powered Analytics"]}),g.jsxs(nn,{variant:"outline",className:"px-3 py-1",children:[g.jsx(ZC,{className:"w-4 h-4 mr-1"}),"Predictive Maintenance"]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(sw,{className:"w-5 h-5"}),"Select Your Role"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose your role to access appropriate features and permissions"})]}),g.jsx(ke,{className:"space-y-4",children:LY.map(u=>g.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${t===u.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>e(u.id),children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("div",{className:`p-2 rounded-lg ${u.color}`,children:g.jsx(u.icon,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"font-semibold text-gray-900",children:u.title}),g.jsx("p",{className:"text-sm text-gray-600 mb-2",children:u.description}),g.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.permissions.slice(0,2).map((d,h)=>g.jsx(nn,{variant:"secondary",className:"text-xs",children:d},h)),u.permissions.length>2&&g.jsxs(nn,{variant:"secondary",className:"text-xs",children:["+",u.permissions.length-2," more"]})]})]})]})},u.id))})]}),g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(mle,{className:"w-5 h-5"}),"Authentication"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your credentials to access the system"})]}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"username",children:"Username"}),g.jsx(Ra,{id:"username",type:"text",placeholder:"Enter your username",value:n,onChange:u=>i(u.target.value)})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"password",children:"Password"}),g.jsx(Ra,{id:"password",type:"password",placeholder:"Enter your password",value:r,onChange:u=>s(u.target.value)})]}),t&&g.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Mm,{className:"w-4 h-4 text-blue-600"}),g.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["Logging in as: ",(c=LY.find(u=>u.id===t))==null?void 0:c.title]})]})}),g.jsx(Mt,{className:"w-full",onClick:l,disabled:!t||!n||!r||o,children:o?"Authenticating...":"Login to EcoSteel AI"}),g.jsx("div",{className:"text-center",children:g.jsx(Mt,{variant:"ghost",className:"text-sm",children:"Forgot password?"})})]})]})]}),g.jsxs("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[g.jsx(Ye,{className:"text-center",children:g.jsxs(ke,{className:"p-6",children:[g.jsx(Gf,{className:"w-12 h-12 mx-auto mb-4 text-orange-600"}),g.jsx("h3",{className:"font-semibold mb-2",children:"Furnace Monitoring"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Real-time temperature, pressure, and emissions tracking across all furnaces"})]})}),g.jsx(Ye,{className:"text-center",children:g.jsxs(ke,{className:"p-6",children:[g.jsx(Xc,{className:"w-12 h-12 mx-auto mb-4 text-blue-600"}),g.jsx("h3",{className:"font-semibold mb-2",children:"AI Vision"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Computer vision analysis of scrap materials with OpenCV ML models"})]})}),g.jsx(Ye,{className:"text-center",children:g.jsxs(ke,{className:"p-6",children:[g.jsx(Mm,{className:"w-12 h-12 mx-auto mb-4 text-green-600"}),g.jsx("h3",{className:"font-semibold mb-2",children:"Predictive Maintenance"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"AI-driven equipment health monitoring and maintenance scheduling"})]})})]}),g.jsxs("div",{className:"text-center mt-8 text-sm text-muted-foreground",children:[g.jsx("p",{children:" 2024 EcoSteel AI - Industry 4.0 Steel Plant Intelligence Platform"}),g.jsx("p",{className:"mt-1",children:"Version 2.1.0 | Last updated: January 2024"})]})]})})}function uw(t,[e,n]){return Math.min(n,Math.max(e,t))}var fde=S.createContext(void 0);function X0(t){const e=S.useContext(fde);return t||e||"ltr"}function R5(t){const e=S.useRef({value:t,previous:t});return S.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Cde=[" ","Enter","ArrowUp","ArrowDown"],pde=[" ","Enter"],E0="Select",[D2,U2,mde]=R0(E0),[MC,GQe]=Ns(E0,[mde,fu]),J2=fu(),[Ade,Cu]=MC(E0),[yde,bde]=MC(E0),S4=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:I,form:p}=t,y=J2(e),[A,m]=S.useState(null),[b,v]=S.useState(null),[w,x]=S.useState(!1),B=X0(c),[Z=!1,N]=Qa({prop:i,defaultProp:r,onChange:s}),[W,M]=Qa({prop:o,defaultProp:a,onChange:l}),F=S.useRef(null),T=A?p||!!A.closest("form"):!0,[H,K]=S.useState(new Set),z=Array.from(H).map(j=>j.props.value).join(";");return g.jsx(F2,{...y,children:g.jsxs(Ade,{required:I,scope:e,trigger:A,onTriggerChange:m,valueNode:b,onValueNodeChange:v,valueNodeHasChildren:w,onValueNodeHasChildrenChange:x,contentId:na(),value:W,onValueChange:M,open:Z,onOpenChange:N,dir:B,triggerPointerDownPosRef:F,disabled:h,children:[g.jsx(D2.Provider,{scope:e,children:g.jsx(yde,{scope:t.__scopeSelect,onNativeOptionAdd:S.useCallback(j=>{K(O=>new Set(O).add(j))},[]),onNativeOptionRemove:S.useCallback(j=>{K(O=>{const _=new Set(O);return _.delete(j),_})},[]),children:n})}),T?g.jsxs(q4,{"aria-hidden":!0,required:I,tabIndex:-1,name:u,autoComplete:d,value:W,onChange:j=>M(j.target.value),disabled:h,form:p,children:[W===void 0?g.jsx("option",{value:""}):null,Array.from(H)]},z):null]})})};S4.displayName=E0;var Z4="SelectTrigger",R4=S.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=J2(n),o=Cu(Z4,n),a=o.disabled||i,l=Gn(e,o.onTriggerChange),c=U2(n),u=S.useRef("touch"),[d,h,I]=$4(y=>{const A=c().filter(v=>!v.disabled),m=A.find(v=>v.value===o.value),b=eJ(A,y,m);b!==void 0&&o.onValueChange(b.value)}),p=y=>{a||(o.onOpenChange(!0),I()),y&&(o.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return g.jsx(F0,{asChild:!0,...s,children:g.jsx(Ht.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":Q4(o.value)?"":void 0,...r,ref:l,onClick:ht(r.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&p(y)}),onPointerDown:ht(r.onPointerDown,y=>{u.current=y.pointerType;const A=y.target;A.hasPointerCapture(y.pointerId)&&A.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(p(y),y.preventDefault())}),onKeyDown:ht(r.onKeyDown,y=>{const A=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&h(y.key),!(A&&y.key===" ")&&Cde.includes(y.key)&&(p(),y.preventDefault())})})})});R4.displayName=Z4;var N4="SelectValue",W4=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:o="",...a}=t,l=Cu(N4,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=Gn(e,l.onValueNodeChange);return Ir(()=>{c(u)},[c,u]),g.jsx(Ht.span,{...a,ref:d,style:{pointerEvents:"none"},children:Q4(l.value)?g.jsx(g.Fragment,{children:o}):s})});W4.displayName=N4;var vde="SelectIcon",M4=S.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return g.jsx(Ht.span,{"aria-hidden":!0,...r,ref:e,children:i||""})});M4.displayName=vde;var xde="SelectPortal",V4=t=>g.jsx(BC,{asChild:!0,...t});V4.displayName=xde;var qd="SelectContent",F4=S.forwardRef((t,e)=>{const n=Cu(qd,t.__scopeSelect),[i,r]=S.useState();if(Ir(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?ch.createPortal(g.jsx(_4,{scope:t.__scopeSelect,children:g.jsx(D2.Slot,{scope:t.__scopeSelect,children:g.jsx("div",{children:t.children})})}),s):null}return g.jsx(T4,{...t,ref:e})});F4.displayName=qd;var Sa=10,[_4,pu]=MC(qd),wde="SelectContentImpl",Gde=tu("SelectContent.RemoveScroll"),T4=S.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:I,sticky:p,hideWhenDetached:y,avoidCollisions:A,...m}=t,b=Cu(qd,n),[v,w]=S.useState(null),[x,B]=S.useState(null),Z=Gn(e,he=>w(he)),[N,W]=S.useState(null),[M,F]=S.useState(null),T=U2(n),[H,K]=S.useState(!1),z=S.useRef(!1);S.useEffect(()=>{if(v)return L2(v)},[v]),H2();const j=S.useCallback(he=>{const[Me,...be]=T().map(pe=>pe.ref.current),[xe]=be.slice(-1),Ge=document.activeElement;for(const pe of he)if(pe===Ge||(pe==null||pe.scrollIntoView({block:"nearest"}),pe===Me&&x&&(x.scrollTop=0),pe===xe&&x&&(x.scrollTop=x.scrollHeight),pe==null||pe.focus(),document.activeElement!==Ge))return},[T,x]),O=S.useCallback(()=>j([N,v]),[j,N,v]);S.useEffect(()=>{H&&O()},[H,O]);const{onOpenChange:_,triggerPointerDownPosRef:E}=b;S.useEffect(()=>{if(v){let he={x:0,y:0};const Me=xe=>{var Ge,pe;he={x:Math.abs(Math.round(xe.pageX)-(((Ge=E.current)==null?void 0:Ge.x)??0)),y:Math.abs(Math.round(xe.pageY)-(((pe=E.current)==null?void 0:pe.y)??0))}},be=xe=>{he.x<=10&&he.y<=10?xe.preventDefault():v.contains(xe.target)||_(!1),document.removeEventListener("pointermove",Me),E.current=null};return E.current!==null&&(document.addEventListener("pointermove",Me),document.addEventListener("pointerup",be,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Me),document.removeEventListener("pointerup",be,{capture:!0})}}},[v,_,E]),S.useEffect(()=>{const he=()=>_(!1);return window.addEventListener("blur",he),window.addEventListener("resize",he),()=>{window.removeEventListener("blur",he),window.removeEventListener("resize",he)}},[_]);const[P,q]=$4(he=>{const Me=T().filter(Ge=>!Ge.disabled),be=Me.find(Ge=>Ge.ref.current===document.activeElement),xe=eJ(Me,he,be);xe&&setTimeout(()=>xe.ref.current.focus())}),re=S.useCallback((he,Me,be)=>{const xe=!z.current&&!be;(b.value!==void 0&&b.value===Me||xe)&&(W(he),xe&&(z.current=!0))},[b.value]),de=S.useCallback(()=>v==null?void 0:v.focus(),[v]),Re=S.useCallback((he,Me,be)=>{const xe=!z.current&&!be;(b.value!==void 0&&b.value===Me||xe)&&F(he)},[b.value]),Pe=i==="popper"?TW:X4,ae=Pe===TW?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:I,sticky:p,hideWhenDetached:y,avoidCollisions:A}:{};return g.jsx(_4,{scope:n,content:v,viewport:x,onViewportChange:B,itemRefCallback:re,selectedItem:N,onItemLeave:de,itemTextRefCallback:Re,focusSelectedItem:O,selectedItemText:M,position:i,isPositioned:H,searchRef:P,children:g.jsx(T0,{as:Gde,allowPinchZoom:!0,children:g.jsx(_0,{asChild:!0,trapped:b.open,onMountAutoFocus:he=>{he.preventDefault()},onUnmountAutoFocus:ht(r,he=>{var Me;(Me=b.trigger)==null||Me.focus({preventScroll:!0}),he.preventDefault()}),children:g.jsx(gh,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:he=>he.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:g.jsx(Pe,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:he=>he.preventDefault(),...m,...ae,onPlaced:()=>K(!0),ref:Z,style:{display:"flex",flexDirection:"column",outline:"none",...m.style},onKeyDown:ht(m.onKeyDown,he=>{const Me=he.ctrlKey||he.altKey||he.metaKey;if(he.key==="Tab"&&he.preventDefault(),!Me&&he.key.length===1&&q(he.key),["ArrowUp","ArrowDown","Home","End"].includes(he.key)){let xe=T().filter(Ge=>!Ge.disabled).map(Ge=>Ge.ref.current);if(["ArrowUp","End"].includes(he.key)&&(xe=xe.slice().reverse()),["ArrowUp","ArrowDown"].includes(he.key)){const Ge=he.target,pe=xe.indexOf(Ge);xe=xe.slice(pe+1)}setTimeout(()=>j(xe)),he.preventDefault()}})})})})})})});T4.displayName=wde;var Bde="SelectItemAlignedPosition",X4=S.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=Cu(qd,n),o=pu(qd,n),[a,l]=S.useState(null),[c,u]=S.useState(null),d=Gn(e,Z=>u(Z)),h=U2(n),I=S.useRef(!1),p=S.useRef(!0),{viewport:y,selectedItem:A,selectedItemText:m,focusSelectedItem:b}=o,v=S.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&y&&A&&m){const Z=s.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),W=s.valueNode.getBoundingClientRect(),M=m.getBoundingClientRect();if(s.dir!=="rtl"){const Ge=M.left-N.left,pe=W.left-Ge,Oe=Z.left-pe,ve=Z.width+Oe,U=Math.max(ve,N.width),We=window.innerWidth-Sa,Xe=uw(pe,[Sa,Math.max(Sa,We-U)]);a.style.minWidth=ve+"px",a.style.left=Xe+"px"}else{const Ge=N.right-M.right,pe=window.innerWidth-W.right-Ge,Oe=window.innerWidth-Z.right-pe,ve=Z.width+Oe,U=Math.max(ve,N.width),We=window.innerWidth-Sa,Xe=uw(pe,[Sa,Math.max(Sa,We-U)]);a.style.minWidth=ve+"px",a.style.right=Xe+"px"}const F=h(),T=window.innerHeight-Sa*2,H=y.scrollHeight,K=window.getComputedStyle(c),z=parseInt(K.borderTopWidth,10),j=parseInt(K.paddingTop,10),O=parseInt(K.borderBottomWidth,10),_=parseInt(K.paddingBottom,10),E=z+j+H+_+O,P=Math.min(A.offsetHeight*5,E),q=window.getComputedStyle(y),re=parseInt(q.paddingTop,10),de=parseInt(q.paddingBottom,10),Re=Z.top+Z.height/2-Sa,Pe=T-Re,ae=A.offsetHeight/2,he=A.offsetTop+ae,Me=z+j+he,be=E-Me;if(Me<=Re){const Ge=F.length>0&&A===F[F.length-1].ref.current;a.style.bottom="0px";const pe=c.clientHeight-y.offsetTop-y.offsetHeight,Oe=Math.max(Pe,ae+(Ge?de:0)+pe+O),ve=Me+Oe;a.style.height=ve+"px"}else{const Ge=F.length>0&&A===F[0].ref.current;a.style.top="0px";const Oe=Math.max(Re,z+y.offsetTop+(Ge?re:0)+ae)+be;a.style.height=Oe+"px",y.scrollTop=Me-Re+y.offsetTop}a.style.margin=`${Sa}px 0`,a.style.minHeight=P+"px",a.style.maxHeight=T+"px",i==null||i(),requestAnimationFrame(()=>I.current=!0)}},[h,s.trigger,s.valueNode,a,c,y,A,m,s.dir,i]);Ir(()=>v(),[v]);const[w,x]=S.useState();Ir(()=>{c&&x(window.getComputedStyle(c).zIndex)},[c]);const B=S.useCallback(Z=>{Z&&p.current===!0&&(v(),b==null||b(),p.current=!1)},[v,b]);return g.jsx(Zde,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:I,onScrollButtonChange:B,children:g.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:g.jsx(Ht.div,{...r,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});X4.displayName=Bde;var Sde="SelectPopperPosition",TW=S.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=Sa,...s}=t,o=J2(n);return g.jsx(_2,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});TW.displayName=Sde;var[Zde,N5]=MC(qd,{}),XW="SelectViewport",E4=S.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=pu(XW,n),o=N5(XW,n),a=Gn(e,s.onViewportChange),l=S.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),g.jsx(D2.Slot,{scope:n,children:g.jsx(Ht.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:ht(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const I=Math.abs(l.current-u.scrollTop);if(I>0){const p=window.innerHeight-Sa*2,y=parseFloat(d.style.minHeight),A=parseFloat(d.style.height),m=Math.max(y,A);if(m<p){const b=m+I,v=Math.min(p,b),w=b-v;d.style.height=v+"px",d.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});E4.displayName=XW;var Y4="SelectGroup",[Rde,Nde]=MC(Y4),Wde=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=na();return g.jsx(Rde,{scope:n,id:r,children:g.jsx(Ht.div,{role:"group","aria-labelledby":r,...i,ref:e})})});Wde.displayName=Y4;var k4="SelectLabel",H4=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=Nde(k4,n);return g.jsx(Ht.div,{id:r.id,...i,ref:e})});H4.displayName=k4;var dw="SelectItem",[Mde,K4]=MC(dw),L4=S.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...o}=t,a=Cu(dw,n),l=pu(dw,n),c=a.value===i,[u,d]=S.useState(s??""),[h,I]=S.useState(!1),p=Gn(e,b=>{var v;return(v=l.itemRefCallback)==null?void 0:v.call(l,b,i,r)}),y=na(),A=S.useRef("touch"),m=()=>{r||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(Mde,{scope:n,value:i,disabled:r,textId:y,isSelected:c,onItemTextChange:S.useCallback(b=>{d(v=>v||((b==null?void 0:b.textContent)??"").trim())},[]),children:g.jsx(D2.ItemSlot,{scope:n,value:i,disabled:r,textValue:u,children:g.jsx(Ht.div,{role:"option","aria-labelledby":y,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:p,onFocus:ht(o.onFocus,()=>I(!0)),onBlur:ht(o.onBlur,()=>I(!1)),onClick:ht(o.onClick,()=>{A.current!=="mouse"&&m()}),onPointerUp:ht(o.onPointerUp,()=>{A.current==="mouse"&&m()}),onPointerDown:ht(o.onPointerDown,b=>{A.current=b.pointerType}),onPointerMove:ht(o.onPointerMove,b=>{var v;A.current=b.pointerType,r?(v=l.onItemLeave)==null||v.call(l):A.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ht(o.onPointerLeave,b=>{var v;b.currentTarget===document.activeElement&&((v=l.onItemLeave)==null||v.call(l))}),onKeyDown:ht(o.onKeyDown,b=>{var w;((w=l.searchRef)==null?void 0:w.current)!==""&&b.key===" "||(pde.includes(b.key)&&m(),b.key===" "&&b.preventDefault())})})})})});L4.displayName=dw;var Im="SelectItemText",z4=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,o=Cu(Im,n),a=pu(Im,n),l=K4(Im,n),c=bde(Im,n),[u,d]=S.useState(null),h=Gn(e,m=>d(m),l.onItemTextChange,m=>{var b;return(b=a.itemTextRefCallback)==null?void 0:b.call(a,m,l.value,l.disabled)}),I=u==null?void 0:u.textContent,p=S.useMemo(()=>g.jsx("option",{value:l.value,disabled:l.disabled,children:I},l.value),[l.disabled,l.value,I]),{onNativeOptionAdd:y,onNativeOptionRemove:A}=c;return Ir(()=>(y(p),()=>A(p)),[y,A,p]),g.jsxs(g.Fragment,{children:[g.jsx(Ht.span,{id:l.textId,...s,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ch.createPortal(s.children,o.valueNode):null]})});z4.displayName=Im;var j4="SelectItemIndicator",P4=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return K4(j4,n).isSelected?g.jsx(Ht.span,{"aria-hidden":!0,...i,ref:e}):null});P4.displayName=j4;var EW="SelectScrollUpButton",O4=S.forwardRef((t,e)=>{const n=pu(EW,t.__scopeSelect),i=N5(EW,t.__scopeSelect),[r,s]=S.useState(!1),o=Gn(e,i.onScrollButtonChange);return Ir(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(U4,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});O4.displayName=EW;var YW="SelectScrollDownButton",D4=S.forwardRef((t,e)=>{const n=pu(YW,t.__scopeSelect),i=N5(YW,t.__scopeSelect),[r,s]=S.useState(!1),o=Gn(e,i.onScrollButtonChange);return Ir(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(U4,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});D4.displayName=YW;var U4=S.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=pu("SelectScrollButton",n),o=S.useRef(null),a=U2(n),l=S.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return S.useEffect(()=>()=>l(),[l]),Ir(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),g.jsx(Ht.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:ht(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:ht(r.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:ht(r.onPointerLeave,()=>{l()})})}),Vde="SelectSeparator",J4=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return g.jsx(Ht.div,{"aria-hidden":!0,...i,ref:e})});J4.displayName=Vde;var kW="SelectArrow",Fde=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=J2(n),s=Cu(kW,n),o=pu(kW,n);return s.open&&o.position==="popper"?g.jsx(T2,{...r,...i,ref:e}):null});Fde.displayName=kW;function Q4(t){return t===""||t===void 0}var q4=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=S.useRef(null),s=Gn(e,r),o=R5(n);return S.useEffect(()=>{const a=r.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==n&&u){const d=new Event("change",{bubbles:!0});u.call(a,n),a.dispatchEvent(d)}},[o,n]),g.jsx(N0,{asChild:!0,children:g.jsx("select",{...i,ref:s,defaultValue:n})})});q4.displayName="BubbleSelect";function $4(t){const e=Er(t),n=S.useRef(""),i=S.useRef(0),r=S.useCallback(o=>{const a=n.current+o;e(a),function l(c){n.current=c,window.clearTimeout(i.current),c!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=S.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return S.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function eJ(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=_de(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function _de(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var Tde=S4,tJ=R4,Xde=W4,Ede=M4,Yde=V4,nJ=F4,kde=E4,iJ=H4,rJ=L4,Hde=z4,Kde=P4,sJ=O4,oJ=D4,aJ=J4;const Ml=Tde,Vl=Xde,za=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(tJ,{ref:i,className:At("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,g.jsx(Ede,{asChild:!0,children:g.jsx(QD,{className:"h-4 w-4 opacity-50"})})]}));za.displayName=tJ.displayName;const lJ=S.forwardRef(({className:t,...e},n)=>g.jsx(sJ,{ref:n,className:At("flex cursor-default items-center justify-center py-1",t),...e,children:g.jsx(cle,{className:"h-4 w-4"})}));lJ.displayName=sJ.displayName;const cJ=S.forwardRef(({className:t,...e},n)=>g.jsx(oJ,{ref:n,className:At("flex cursor-default items-center justify-center py-1",t),...e,children:g.jsx(QD,{className:"h-4 w-4"})}));cJ.displayName=oJ.displayName;const ja=S.forwardRef(({className:t,children:e,position:n="popper",...i},r)=>g.jsx(Yde,{children:g.jsxs(nJ,{ref:r,className:At("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[g.jsx(lJ,{}),g.jsx(kde,{className:At("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),g.jsx(cJ,{})]})}));ja.displayName=nJ.displayName;const Lde=S.forwardRef(({className:t,...e},n)=>g.jsx(iJ,{ref:n,className:At("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));Lde.displayName=iJ.displayName;const An=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(rJ,{ref:i,className:At("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(Kde,{children:g.jsx(JD,{className:"h-4 w-4"})})}),g.jsx(Hde,{children:e})]}));An.displayName=rJ.displayName;const zde=S.forwardRef(({className:t,...e},n)=>g.jsx(aJ,{ref:n,className:At("-mx-1 my-1 h-px bg-muted",t),...e}));zde.displayName=aJ.displayName;var W5="Avatar",[jde,BQe]=Ns(W5),[Pde,gJ]=jde(W5),uJ=S.forwardRef((t,e)=>{const{__scopeAvatar:n,...i}=t,[r,s]=S.useState("idle");return g.jsx(Pde,{scope:n,imageLoadingStatus:r,onImageLoadingStatusChange:s,children:g.jsx(Ht.span,{...i,ref:e})})});uJ.displayName=W5;var dJ="AvatarImage",hJ=S.forwardRef((t,e)=>{const{__scopeAvatar:n,src:i,onLoadingStatusChange:r=()=>{},...s}=t,o=gJ(dJ,n),a=Ode(i,s),l=Er(c=>{r(c),o.onImageLoadingStatusChange(c)});return Ir(()=>{a!=="idle"&&l(a)},[a,l]),a==="loaded"?g.jsx(Ht.img,{...s,ref:e,src:i}):null});hJ.displayName=dJ;var IJ="AvatarFallback",fJ=S.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:i,...r}=t,s=gJ(IJ,n),[o,a]=S.useState(i===void 0);return S.useEffect(()=>{if(i!==void 0){const l=window.setTimeout(()=>a(!0),i);return()=>window.clearTimeout(l)}},[i]),o&&s.imageLoadingStatus!=="loaded"?g.jsx(Ht.span,{...r,ref:e}):null});fJ.displayName=IJ;function zY(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Ode(t,{referrerPolicy:e,crossOrigin:n}){const i=Ude(),r=S.useRef(null),s=i?(r.current||(r.current=new window.Image),r.current):null,[o,a]=S.useState(()=>zY(s,t));return Ir(()=>{a(zY(s,t))},[s,t]),Ir(()=>{const l=d=>()=>{a(d)};if(!s)return;const c=l("loaded"),u=l("error");return s.addEventListener("load",c),s.addEventListener("error",u),e&&(s.referrerPolicy=e),typeof n=="string"&&(s.crossOrigin=n),()=>{s.removeEventListener("load",c),s.removeEventListener("error",u)}},[s,n,e]),o}function Dde(){return()=>{}}function Ude(){return S.useSyncExternalStore(Dde,()=>!0,()=>!1)}var CJ=uJ,pJ=hJ,mJ=fJ;const AJ=S.forwardRef(({className:t,...e},n)=>g.jsx(CJ,{ref:n,className:At(`
      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10
      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,t),...e}));AJ.displayName=CJ.displayName;const Jde=S.forwardRef(({className:t,...e},n)=>g.jsx(pJ,{ref:n,className:At("aspect-square h-full w-full",t),...e}));Jde.displayName=pJ.displayName;const yJ=S.forwardRef(({className:t,...e},n)=>g.jsx(mJ,{ref:n,className:At("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));yJ.displayName=mJ.displayName;var SZ="rovingFocusGroup.onEntryFocus",Qde={bubbles:!1,cancelable:!0},Q2="RovingFocusGroup",[HW,bJ,qde]=R0(Q2),[$de,q2]=Ns(Q2,[qde]),[ehe,the]=$de(Q2),vJ=S.forwardRef((t,e)=>g.jsx(HW.Provider,{scope:t.__scopeRovingFocusGroup,children:g.jsx(HW.Slot,{scope:t.__scopeRovingFocusGroup,children:g.jsx(nhe,{...t,ref:e})})}));vJ.displayName=Q2;var nhe=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=S.useRef(null),I=Gn(e,h),p=X0(s),[y=null,A]=Qa({prop:o,defaultProp:a,onChange:l}),[m,b]=S.useState(!1),v=Er(c),w=bJ(n),x=S.useRef(!1),[B,Z]=S.useState(0);return S.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(SZ,v),()=>N.removeEventListener(SZ,v)},[v]),g.jsx(ehe,{scope:n,orientation:i,dir:p,loop:r,currentTabStopId:y,onItemFocus:S.useCallback(N=>A(N),[A]),onItemShiftTab:S.useCallback(()=>b(!0),[]),onFocusableItemAdd:S.useCallback(()=>Z(N=>N+1),[]),onFocusableItemRemove:S.useCallback(()=>Z(N=>N-1),[]),children:g.jsx(Ht.div,{tabIndex:m||B===0?-1:0,"data-orientation":i,...d,ref:I,style:{outline:"none",...t.style},onMouseDown:ht(t.onMouseDown,()=>{x.current=!0}),onFocus:ht(t.onFocus,N=>{const W=!x.current;if(N.target===N.currentTarget&&W&&!m){const M=new CustomEvent(SZ,Qde);if(N.currentTarget.dispatchEvent(M),!M.defaultPrevented){const F=w().filter(j=>j.focusable),T=F.find(j=>j.active),H=F.find(j=>j.id===y),z=[T,H,...F].filter(Boolean).map(j=>j.ref.current);GJ(z,u)}}x.current=!1}),onBlur:ht(t.onBlur,()=>b(!1))})})}),xJ="RovingFocusGroupItem",wJ=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,...o}=t,a=na(),l=s||a,c=the(xJ,n),u=c.currentTabStopId===l,d=bJ(n),{onFocusableItemAdd:h,onFocusableItemRemove:I}=c;return S.useEffect(()=>{if(i)return h(),()=>I()},[i,h,I]),g.jsx(HW.ItemSlot,{scope:n,id:l,focusable:i,active:r,children:g.jsx(Ht.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:ht(t.onMouseDown,p=>{i?c.onItemFocus(l):p.preventDefault()}),onFocus:ht(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:ht(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const y=she(p,c.orientation,c.dir);if(y!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let m=d().filter(b=>b.focusable).map(b=>b.ref.current);if(y==="last")m.reverse();else if(y==="prev"||y==="next"){y==="prev"&&m.reverse();const b=m.indexOf(p.currentTarget);m=c.loop?ohe(m,b+1):m.slice(b+1)}setTimeout(()=>GJ(m))}})})})});wJ.displayName=xJ;var ihe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rhe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function she(t,e,n){const i=rhe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return ihe[i]}function GJ(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function ohe(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var BJ=vJ,SJ=wJ,KW=["Enter"," "],ahe=["ArrowDown","PageUp","Home"],ZJ=["ArrowUp","PageDown","End"],lhe=[...ahe,...ZJ],che={ltr:[...KW,"ArrowRight"],rtl:[...KW,"ArrowLeft"]},ghe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Y0="Menu",[yA,uhe,dhe]=R0(Y0),[uh,RJ]=Ns(Y0,[dhe,fu,q2]),$2=fu(),NJ=q2(),[hhe,dh]=uh(Y0),[Ihe,k0]=uh(Y0),WJ=t=>{const{__scopeMenu:e,open:n=!1,children:i,dir:r,onOpenChange:s,modal:o=!0}=t,a=$2(e),[l,c]=S.useState(null),u=S.useRef(!1),d=Er(s),h=X0(r);return S.useEffect(()=>{const I=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",I,{capture:!0}),()=>{document.removeEventListener("keydown",I,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),g.jsx(F2,{...a,children:g.jsx(hhe,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:c,children:g.jsx(Ihe,{scope:e,onClose:S.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:o,children:i})})})};WJ.displayName=Y0;var fhe="MenuAnchor",M5=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=$2(n);return g.jsx(F0,{...r,...i,ref:e})});M5.displayName=fhe;var V5="MenuPortal",[Che,MJ]=uh(V5,{forceMount:void 0}),VJ=t=>{const{__scopeMenu:e,forceMount:n,children:i,container:r}=t,s=dh(V5,e);return g.jsx(Che,{scope:e,forceMount:n,children:g.jsx(No,{present:n||s.open,children:g.jsx(BC,{asChild:!0,container:r,children:i})})})};VJ.displayName=V5;var ia="MenuContent",[phe,F5]=uh(ia),FJ=S.forwardRef((t,e)=>{const n=MJ(ia,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=dh(ia,t.__scopeMenu),o=k0(ia,t.__scopeMenu);return g.jsx(yA.Provider,{scope:t.__scopeMenu,children:g.jsx(No,{present:i||s.open,children:g.jsx(yA.Slot,{scope:t.__scopeMenu,children:o.modal?g.jsx(mhe,{...r,ref:e}):g.jsx(Ahe,{...r,ref:e})})})})}),mhe=S.forwardRef((t,e)=>{const n=dh(ia,t.__scopeMenu),i=S.useRef(null),r=Gn(e,i);return S.useEffect(()=>{const s=i.current;if(s)return L2(s)},[]),g.jsx(_5,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ht(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Ahe=S.forwardRef((t,e)=>{const n=dh(ia,t.__scopeMenu);return g.jsx(_5,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),yhe=tu("MenuContent.ScrollLock"),_5=S.forwardRef((t,e)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:I,disableOutsideScroll:p,...y}=t,A=dh(ia,n),m=k0(ia,n),b=$2(n),v=NJ(n),w=uhe(n),[x,B]=S.useState(null),Z=S.useRef(null),N=Gn(e,Z,A.onContentChange),W=S.useRef(0),M=S.useRef(""),F=S.useRef(0),T=S.useRef(null),H=S.useRef("right"),K=S.useRef(0),z=p?T0:S.Fragment,j=p?{as:yhe,allowPinchZoom:!0}:void 0,O=E=>{var he,Me;const P=M.current+E,q=w().filter(be=>!be.disabled),re=document.activeElement,de=(he=q.find(be=>be.ref.current===re))==null?void 0:he.textValue,Re=q.map(be=>be.textValue),Pe=Mhe(Re,P,de),ae=(Me=q.find(be=>be.textValue===Pe))==null?void 0:Me.ref.current;(function be(xe){M.current=xe,window.clearTimeout(W.current),xe!==""&&(W.current=window.setTimeout(()=>be(""),1e3))})(P),ae&&setTimeout(()=>ae.focus())};S.useEffect(()=>()=>window.clearTimeout(W.current),[]),H2();const _=S.useCallback(E=>{var q,re;return H.current===((q=T.current)==null?void 0:q.side)&&Fhe(E,(re=T.current)==null?void 0:re.area)},[]);return g.jsx(phe,{scope:n,searchRef:M,onItemEnter:S.useCallback(E=>{_(E)&&E.preventDefault()},[_]),onItemLeave:S.useCallback(E=>{var P;_(E)||((P=Z.current)==null||P.focus(),B(null))},[_]),onTriggerLeave:S.useCallback(E=>{_(E)&&E.preventDefault()},[_]),pointerGraceTimerRef:F,onPointerGraceIntentChange:S.useCallback(E=>{T.current=E},[]),children:g.jsx(z,{...j,children:g.jsx(_0,{asChild:!0,trapped:r,onMountAutoFocus:ht(s,E=>{var P;E.preventDefault(),(P=Z.current)==null||P.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:g.jsx(gh,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:I,children:g.jsx(BJ,{asChild:!0,...v,dir:m.dir,orientation:"vertical",loop:i,currentTabStopId:x,onCurrentTabStopIdChange:B,onEntryFocus:ht(l,E=>{m.isUsingKeyboardRef.current||E.preventDefault()}),preventScrollOnEntryFocus:!0,children:g.jsx(_2,{role:"menu","aria-orientation":"vertical","data-state":JJ(A.open),"data-radix-menu-content":"",dir:m.dir,...b,...y,ref:N,style:{outline:"none",...y.style},onKeyDown:ht(y.onKeyDown,E=>{const q=E.target.closest("[data-radix-menu-content]")===E.currentTarget,re=E.ctrlKey||E.altKey||E.metaKey,de=E.key.length===1;q&&(E.key==="Tab"&&E.preventDefault(),!re&&de&&O(E.key));const Re=Z.current;if(E.target!==Re||!lhe.includes(E.key))return;E.preventDefault();const ae=w().filter(he=>!he.disabled).map(he=>he.ref.current);ZJ.includes(E.key)&&ae.reverse(),Nhe(ae)}),onBlur:ht(t.onBlur,E=>{E.currentTarget.contains(E.target)||(window.clearTimeout(W.current),M.current="")}),onPointerMove:ht(t.onPointerMove,bA(E=>{const P=E.target,q=K.current!==E.clientX;if(E.currentTarget.contains(P)&&q){const re=E.clientX>K.current?"right":"left";H.current=re,K.current=E.clientX}}))})})})})})})});FJ.displayName=ia;var bhe="MenuGroup",T5=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Ht.div,{role:"group",...i,ref:e})});T5.displayName=bhe;var vhe="MenuLabel",_J=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Ht.div,{...i,ref:e})});_J.displayName=vhe;var hw="MenuItem",jY="menu.itemSelect",eB=S.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:i,...r}=t,s=S.useRef(null),o=k0(hw,t.__scopeMenu),a=F5(hw,t.__scopeMenu),l=Gn(e,s),c=S.useRef(!1),u=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(jY,{bubbles:!0,cancelable:!0});d.addEventListener(jY,I=>i==null?void 0:i(I),{once:!0}),r5(d,h),h.defaultPrevented?c.current=!1:o.onClose()}};return g.jsx(TJ,{...r,ref:l,disabled:n,onClick:ht(t.onClick,u),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),c.current=!0},onPointerUp:ht(t.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:ht(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||KW.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});eB.displayName=hw;var TJ=S.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...s}=t,o=F5(hw,n),a=NJ(n),l=S.useRef(null),c=Gn(e,l),[u,d]=S.useState(!1),[h,I]=S.useState("");return S.useEffect(()=>{const p=l.current;p&&I((p.textContent??"").trim())},[s.children]),g.jsx(yA.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:g.jsx(SJ,{asChild:!0,...a,focusable:!i,children:g.jsx(Ht.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:c,onPointerMove:ht(t.onPointerMove,bA(p=>{i?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ht(t.onPointerLeave,bA(p=>o.onItemLeave(p))),onFocus:ht(t.onFocus,()=>d(!0)),onBlur:ht(t.onBlur,()=>d(!1))})})})}),xhe="MenuCheckboxItem",XJ=S.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return g.jsx(KJ,{scope:t.__scopeMenu,checked:n,children:g.jsx(eB,{role:"menuitemcheckbox","aria-checked":Iw(n)?"mixed":n,...r,ref:e,"data-state":E5(n),onSelect:ht(r.onSelect,()=>i==null?void 0:i(Iw(n)?!0:!n),{checkForDefaultPrevented:!1})})})});XJ.displayName=xhe;var EJ="MenuRadioGroup",[whe,Ghe]=uh(EJ,{value:void 0,onValueChange:()=>{}}),YJ=S.forwardRef((t,e)=>{const{value:n,onValueChange:i,...r}=t,s=Er(i);return g.jsx(whe,{scope:t.__scopeMenu,value:n,onValueChange:s,children:g.jsx(T5,{...r,ref:e})})});YJ.displayName=EJ;var kJ="MenuRadioItem",HJ=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=Ghe(kJ,t.__scopeMenu),s=n===r.value;return g.jsx(KJ,{scope:t.__scopeMenu,checked:s,children:g.jsx(eB,{role:"menuitemradio","aria-checked":s,...i,ref:e,"data-state":E5(s),onSelect:ht(i.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});HJ.displayName=kJ;var X5="MenuItemIndicator",[KJ,Bhe]=uh(X5,{checked:!1}),LJ=S.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:i,...r}=t,s=Bhe(X5,n);return g.jsx(No,{present:i||Iw(s.checked)||s.checked===!0,children:g.jsx(Ht.span,{...r,ref:e,"data-state":E5(s.checked)})})});LJ.displayName=X5;var She="MenuSeparator",zJ=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Ht.div,{role:"separator","aria-orientation":"horizontal",...i,ref:e})});zJ.displayName=She;var Zhe="MenuArrow",jJ=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=$2(n);return g.jsx(T2,{...r,...i,ref:e})});jJ.displayName=Zhe;var Rhe="MenuSub",[SQe,PJ]=uh(Rhe),fm="MenuSubTrigger",OJ=S.forwardRef((t,e)=>{const n=dh(fm,t.__scopeMenu),i=k0(fm,t.__scopeMenu),r=PJ(fm,t.__scopeMenu),s=F5(fm,t.__scopeMenu),o=S.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:t.__scopeMenu},u=S.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return S.useEffect(()=>u,[u]),S.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),g.jsx(M5,{asChild:!0,...c,children:g.jsx(TJ,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":JJ(n.open),...t,ref:B2(e,r.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ht(t.onPointerMove,bA(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ht(t.onPointerLeave,bA(d=>{var I,p;u();const h=(I=n.content)==null?void 0:I.getBoundingClientRect();if(h){const y=(p=n.content)==null?void 0:p.dataset.side,A=y==="right",m=A?-5:5,b=h[A?"left":"right"],v=h[A?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+m,y:d.clientY},{x:b,y:h.top},{x:v,y:h.top},{x:v,y:h.bottom},{x:b,y:h.bottom}],side:y}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ht(t.onKeyDown,d=>{var I;const h=s.searchRef.current!=="";t.disabled||h&&d.key===" "||che[i.dir].includes(d.key)&&(n.onOpenChange(!0),(I=n.content)==null||I.focus(),d.preventDefault())})})})});OJ.displayName=fm;var DJ="MenuSubContent",UJ=S.forwardRef((t,e)=>{const n=MJ(ia,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=dh(ia,t.__scopeMenu),o=k0(ia,t.__scopeMenu),a=PJ(DJ,t.__scopeMenu),l=S.useRef(null),c=Gn(e,l);return g.jsx(yA.Provider,{scope:t.__scopeMenu,children:g.jsx(No,{present:i||s.open,children:g.jsx(yA.Slot,{scope:t.__scopeMenu,children:g.jsx(_5,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ht(t.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ht(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ht(t.onKeyDown,u=>{var I;const d=u.currentTarget.contains(u.target),h=ghe[o.dir].includes(u.key);d&&h&&(s.onOpenChange(!1),(I=a.trigger)==null||I.focus(),u.preventDefault())})})})})})});UJ.displayName=DJ;function JJ(t){return t?"open":"closed"}function Iw(t){return t==="indeterminate"}function E5(t){return Iw(t)?"indeterminate":t?"checked":"unchecked"}function Nhe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function Whe(t,e){return t.map((n,i)=>t[(e+i)%t.length])}function Mhe(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=Whe(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function Vhe(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>i!=u>i&&n<(c-a)*(i-l)/(u-l)+a&&(r=!r)}return r}function Fhe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return Vhe(n,e)}function bA(t){return e=>e.pointerType==="mouse"?t(e):void 0}var _he=WJ,The=M5,Xhe=VJ,Ehe=FJ,Yhe=T5,khe=_J,Hhe=eB,Khe=XJ,Lhe=YJ,zhe=HJ,jhe=LJ,Phe=zJ,Ohe=jJ,Dhe=OJ,Uhe=UJ,Y5="DropdownMenu",[Jhe,ZQe]=Ns(Y5,[RJ]),Ws=RJ(),[Qhe,QJ]=Jhe(Y5),qJ=t=>{const{__scopeDropdownMenu:e,children:n,dir:i,open:r,defaultOpen:s,onOpenChange:o,modal:a=!0}=t,l=Ws(e),c=S.useRef(null),[u=!1,d]=Qa({prop:r,defaultProp:s,onChange:o});return g.jsx(Qhe,{scope:e,triggerId:na(),triggerRef:c,contentId:na(),open:u,onOpenChange:d,onOpenToggle:S.useCallback(()=>d(h=>!h),[d]),modal:a,children:g.jsx(_he,{...l,open:u,onOpenChange:d,dir:i,modal:a,children:n})})};qJ.displayName=Y5;var $J="DropdownMenuTrigger",eQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,s=QJ($J,n),o=Ws(n);return g.jsx(The,{asChild:!0,...o,children:g.jsx(Ht.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:B2(e,s.triggerRef),onPointerDown:ht(t.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ht(t.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});eQ.displayName=$J;var qhe="DropdownMenuPortal",tQ=t=>{const{__scopeDropdownMenu:e,...n}=t,i=Ws(e);return g.jsx(Xhe,{...i,...n})};tQ.displayName=qhe;var nQ="DropdownMenuContent",iQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=QJ(nQ,n),s=Ws(n),o=S.useRef(!1);return g.jsx(Ehe,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...i,ref:e,onCloseAutoFocus:ht(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:ht(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!r.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});iQ.displayName=nQ;var $he="DropdownMenuGroup",eIe=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Yhe,{...r,...i,ref:e})});eIe.displayName=$he;var tIe="DropdownMenuLabel",rQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(khe,{...r,...i,ref:e})});rQ.displayName=tIe;var nIe="DropdownMenuItem",sQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Hhe,{...r,...i,ref:e})});sQ.displayName=nIe;var iIe="DropdownMenuCheckboxItem",oQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Khe,{...r,...i,ref:e})});oQ.displayName=iIe;var rIe="DropdownMenuRadioGroup",sIe=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Lhe,{...r,...i,ref:e})});sIe.displayName=rIe;var oIe="DropdownMenuRadioItem",aQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(zhe,{...r,...i,ref:e})});aQ.displayName=oIe;var aIe="DropdownMenuItemIndicator",lQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(jhe,{...r,...i,ref:e})});lQ.displayName=aIe;var lIe="DropdownMenuSeparator",cQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Phe,{...r,...i,ref:e})});cQ.displayName=lIe;var cIe="DropdownMenuArrow",gIe=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Ohe,{...r,...i,ref:e})});gIe.displayName=cIe;var uIe="DropdownMenuSubTrigger",gQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Dhe,{...r,...i,ref:e})});gQ.displayName=uIe;var dIe="DropdownMenuSubContent",uQ=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=Ws(n);return g.jsx(Uhe,{...r,...i,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});uQ.displayName=dIe;var hIe=qJ,IIe=eQ,fIe=tQ,dQ=iQ,hQ=rQ,IQ=sQ,fQ=oQ,CQ=aQ,pQ=lQ,mQ=cQ,AQ=gQ,yQ=uQ;const CIe=hIe,pIe=IIe,mIe=S.forwardRef(({className:t,inset:e,children:n,...i},r)=>g.jsxs(AQ,{ref:r,className:At("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...i,children:[n,g.jsx(lle,{className:"ml-auto"})]}));mIe.displayName=AQ.displayName;const AIe=S.forwardRef(({className:t,...e},n)=>g.jsx(yQ,{ref:n,className:At("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));AIe.displayName=yQ.displayName;const bQ=S.forwardRef(({className:t,sideOffset:e=4,...n},i)=>g.jsx(fIe,{children:g.jsx(dQ,{ref:i,sideOffset:e,className:At("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));bQ.displayName=dQ.displayName;const yx=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(IQ,{ref:i,className:At("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...n}));yx.displayName=IQ.displayName;const yIe=S.forwardRef(({className:t,children:e,checked:n,...i},r)=>g.jsxs(fQ,{ref:r,className:At("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(pQ,{children:g.jsx(JD,{className:"h-4 w-4"})})}),e]}));yIe.displayName=fQ.displayName;const bIe=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(CQ,{ref:i,className:At("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(pQ,{children:g.jsx(ule,{className:"h-2 w-2 fill-current"})})}),e]}));bIe.displayName=CQ.displayName;const vQ=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(hQ,{ref:i,className:At("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));vQ.displayName=hQ.displayName;const LW=S.forwardRef(({className:t,...e},n)=>g.jsx(mQ,{ref:n,className:At("-mx-1 my-1 h-px bg-muted",t),...e}));LW.displayName=mQ.displayName;var k5="Tabs",[vIe,RQe]=Ns(k5,[q2]),xQ=q2(),[xIe,H5]=vIe(k5),wQ=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=X0(a),[d,h]=Qa({prop:i,onChange:r,defaultProp:s});return g.jsx(xIe,{scope:n,baseId:na(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l,children:g.jsx(Ht.div,{dir:u,"data-orientation":o,...c,ref:e})})});wQ.displayName=k5;var GQ="TabsList",BQ=S.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=H5(GQ,n),o=xQ(n);return g.jsx(BJ,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:g.jsx(Ht.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});BQ.displayName=GQ;var SQ="TabsTrigger",ZQ=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,o=H5(SQ,n),a=xQ(n),l=WQ(o.baseId,i),c=MQ(o.baseId,i),u=i===o.value;return g.jsx(SJ,{asChild:!0,...a,focusable:!r,active:u,children:g.jsx(Ht.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:ht(t.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:ht(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:ht(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!r&&d&&o.onValueChange(i)})})})});ZQ.displayName=SQ;var RQ="TabsContent",NQ=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=t,a=H5(RQ,n),l=WQ(a.baseId,i),c=MQ(a.baseId,i),u=i===a.value,d=S.useRef(u);return S.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),g.jsx(No,{present:r||u,children:({present:h})=>g.jsx(Ht.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});NQ.displayName=RQ;function WQ(t,e){return`${t}-trigger-${e}`}function MQ(t,e){return`${t}-content-${e}`}var wIe=wQ,VQ=BQ,FQ=ZQ,_Q=NQ;const VC=wIe,hh=S.forwardRef(({className:t,...e},n)=>g.jsx(VQ,{ref:n,className:At("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));hh.displayName=VQ.displayName;const di=S.forwardRef(({className:t,...e},n)=>g.jsx(FQ,{ref:n,className:At("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));di.displayName=FQ.displayName;const ri=S.forwardRef(({className:t,...e},n)=>g.jsx(_Q,{ref:n,className:At("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));ri.displayName=_Q.displayName;var K5="Popover",[TQ,NQe]=Ns(K5,[fu]),H0=fu(),[GIe,mu]=TQ(K5),XQ=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=t,a=H0(e),l=S.useRef(null),[c,u]=S.useState(!1),[d=!1,h]=Qa({prop:i,defaultProp:r,onChange:s});return g.jsx(F2,{...a,children:g.jsx(GIe,{scope:e,contentId:na(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:S.useCallback(()=>h(I=>!I),[h]),hasCustomAnchor:c,onCustomAnchorAdd:S.useCallback(()=>u(!0),[]),onCustomAnchorRemove:S.useCallback(()=>u(!1),[]),modal:o,children:n})})};XQ.displayName=K5;var EQ="PopoverAnchor",BIe=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=mu(EQ,n),s=H0(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return S.useEffect(()=>(o(),()=>a()),[o,a]),g.jsx(F0,{...s,...i,ref:e})});BIe.displayName=EQ;var YQ="PopoverTrigger",kQ=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=mu(YQ,n),s=H0(n),o=Gn(e,r.triggerRef),a=g.jsx(Ht.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":jQ(r.open),...i,ref:o,onClick:ht(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:g.jsx(F0,{asChild:!0,...s,children:a})});kQ.displayName=YQ;var L5="PopoverPortal",[SIe,ZIe]=TQ(L5,{forceMount:void 0}),HQ=t=>{const{__scopePopover:e,forceMount:n,children:i,container:r}=t,s=mu(L5,e);return g.jsx(SIe,{scope:e,forceMount:n,children:g.jsx(No,{present:n||s.open,children:g.jsx(BC,{asChild:!0,container:r,children:i})})})};HQ.displayName=L5;var Zf="PopoverContent",KQ=S.forwardRef((t,e)=>{const n=ZIe(Zf,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=mu(Zf,t.__scopePopover);return g.jsx(No,{present:i||s.open,children:s.modal?g.jsx(NIe,{...r,ref:e}):g.jsx(WIe,{...r,ref:e})})});KQ.displayName=Zf;var RIe=tu("PopoverContent.RemoveScroll"),NIe=S.forwardRef((t,e)=>{const n=mu(Zf,t.__scopePopover),i=S.useRef(null),r=Gn(e,i),s=S.useRef(!1);return S.useEffect(()=>{const o=i.current;if(o)return L2(o)},[]),g.jsx(T0,{as:RIe,allowPinchZoom:!0,children:g.jsx(LQ,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ht(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ht(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ht(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),WIe=S.forwardRef((t,e)=>{const n=mu(Zf,t.__scopePopover),i=S.useRef(!1),r=S.useRef(!1);return g.jsx(LQ,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),LQ=S.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=mu(Zf,n),I=H0(n);return H2(),g.jsx(_0,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:g.jsx(gh,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:g.jsx(_2,{"data-state":jQ(h.open),role:"dialog",id:h.contentId,...I,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),zQ="PopoverClose",MIe=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=mu(zQ,n);return g.jsx(Ht.button,{type:"button",...i,ref:e,onClick:ht(t.onClick,()=>r.onOpenChange(!1))})});MIe.displayName=zQ;var VIe="PopoverArrow",FIe=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=H0(n);return g.jsx(T2,{...r,...i,ref:e})});FIe.displayName=VIe;function jQ(t){return t?"open":"closed"}var _Ie=XQ,TIe=kQ,XIe=HQ,PQ=KQ;const EIe=_Ie,YIe=TIe,OQ=S.forwardRef(({className:t,align:e="center",sideOffset:n=4,...i},r)=>g.jsx(XIe,{children:g.jsx(PQ,{ref:r,align:e,sideOffset:n,className:At("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...i})}));OQ.displayName=PQ.displayName;var kIe=Array.isArray,io=kIe,HIe=typeof sb=="object"&&sb&&sb.Object===Object&&sb,DQ=HIe,KIe=DQ,LIe=typeof self=="object"&&self&&self.Object===Object&&self,zIe=KIe||LIe||Function("return this")(),jl=zIe,jIe=jl,PIe=jIe.Symbol,K0=PIe,PY=K0,UQ=Object.prototype,OIe=UQ.hasOwnProperty,DIe=UQ.toString,Np=PY?PY.toStringTag:void 0;function UIe(t){var e=OIe.call(t,Np),n=t[Np];try{t[Np]=void 0;var i=!0}catch{}var r=DIe.call(t);return i&&(e?t[Np]=n:delete t[Np]),r}var JIe=UIe,QIe=Object.prototype,qIe=QIe.toString;function $Ie(t){return qIe.call(t)}var efe=$Ie,OY=K0,tfe=JIe,nfe=efe,ife="[object Null]",rfe="[object Undefined]",DY=OY?OY.toStringTag:void 0;function sfe(t){return t==null?t===void 0?rfe:ife:DY&&DY in Object(t)?tfe(t):nfe(t)}var jc=sfe;function ofe(t){return t!=null&&typeof t=="object"}var Pc=ofe,afe=jc,lfe=Pc,cfe="[object Symbol]";function gfe(t){return typeof t=="symbol"||lfe(t)&&afe(t)==cfe}var FC=gfe,ufe=io,dfe=FC,hfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ife=/^\w*$/;function ffe(t,e){if(ufe(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||dfe(t)?!0:Ife.test(t)||!hfe.test(t)||e!=null&&t in Object(e)}var z5=ffe;function Cfe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Au=Cfe;const _C=Pn(Au);var pfe=jc,mfe=Au,Afe="[object AsyncFunction]",yfe="[object Function]",bfe="[object GeneratorFunction]",vfe="[object Proxy]";function xfe(t){if(!mfe(t))return!1;var e=pfe(t);return e==yfe||e==bfe||e==Afe||e==vfe}var j5=xfe;const $t=Pn(j5);var wfe=jl,Gfe=wfe["__core-js_shared__"],Bfe=Gfe,ZZ=Bfe,UY=function(){var t=/[^.]+$/.exec(ZZ&&ZZ.keys&&ZZ.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Sfe(t){return!!UY&&UY in t}var Zfe=Sfe,Rfe=Function.prototype,Nfe=Rfe.toString;function Wfe(t){if(t!=null){try{return Nfe.call(t)}catch{}try{return t+""}catch{}}return""}var JQ=Wfe,Mfe=j5,Vfe=Zfe,Ffe=Au,_fe=JQ,Tfe=/[\\^$.*+?()[\]{}|]/g,Xfe=/^\[object .+?Constructor\]$/,Efe=Function.prototype,Yfe=Object.prototype,kfe=Efe.toString,Hfe=Yfe.hasOwnProperty,Kfe=RegExp("^"+kfe.call(Hfe).replace(Tfe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Lfe(t){if(!Ffe(t)||Vfe(t))return!1;var e=Mfe(t)?Kfe:Xfe;return e.test(_fe(t))}var zfe=Lfe;function jfe(t,e){return t==null?void 0:t[e]}var Pfe=jfe,Ofe=zfe,Dfe=Pfe;function Ufe(t,e){var n=Dfe(t,e);return Ofe(n)?n:void 0}var Ih=Ufe,Jfe=Ih,Qfe=Jfe(Object,"create"),tB=Qfe,JY=tB;function qfe(){this.__data__=JY?JY(null):{},this.size=0}var $fe=qfe;function eCe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var tCe=eCe,nCe=tB,iCe="__lodash_hash_undefined__",rCe=Object.prototype,sCe=rCe.hasOwnProperty;function oCe(t){var e=this.__data__;if(nCe){var n=e[t];return n===iCe?void 0:n}return sCe.call(e,t)?e[t]:void 0}var aCe=oCe,lCe=tB,cCe=Object.prototype,gCe=cCe.hasOwnProperty;function uCe(t){var e=this.__data__;return lCe?e[t]!==void 0:gCe.call(e,t)}var dCe=uCe,hCe=tB,ICe="__lodash_hash_undefined__";function fCe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=hCe&&e===void 0?ICe:e,this}var CCe=fCe,pCe=$fe,mCe=tCe,ACe=aCe,yCe=dCe,bCe=CCe;function TC(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}TC.prototype.clear=pCe;TC.prototype.delete=mCe;TC.prototype.get=ACe;TC.prototype.has=yCe;TC.prototype.set=bCe;var vCe=TC;function xCe(){this.__data__=[],this.size=0}var wCe=xCe;function GCe(t,e){return t===e||t!==t&&e!==e}var P5=GCe,BCe=P5;function SCe(t,e){for(var n=t.length;n--;)if(BCe(t[n][0],e))return n;return-1}var nB=SCe,ZCe=nB,RCe=Array.prototype,NCe=RCe.splice;function WCe(t){var e=this.__data__,n=ZCe(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():NCe.call(e,n,1),--this.size,!0}var MCe=WCe,VCe=nB;function FCe(t){var e=this.__data__,n=VCe(e,t);return n<0?void 0:e[n][1]}var _Ce=FCe,TCe=nB;function XCe(t){return TCe(this.__data__,t)>-1}var ECe=XCe,YCe=nB;function kCe(t,e){var n=this.__data__,i=YCe(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var HCe=kCe,KCe=wCe,LCe=MCe,zCe=_Ce,jCe=ECe,PCe=HCe;function XC(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}XC.prototype.clear=KCe;XC.prototype.delete=LCe;XC.prototype.get=zCe;XC.prototype.has=jCe;XC.prototype.set=PCe;var iB=XC,OCe=Ih,DCe=jl,UCe=OCe(DCe,"Map"),O5=UCe,QY=vCe,JCe=iB,QCe=O5;function qCe(){this.size=0,this.__data__={hash:new QY,map:new(QCe||JCe),string:new QY}}var $Ce=qCe;function epe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var tpe=epe,npe=tpe;function ipe(t,e){var n=t.__data__;return npe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var rB=ipe,rpe=rB;function spe(t){var e=rpe(this,t).delete(t);return this.size-=e?1:0,e}var ope=spe,ape=rB;function lpe(t){return ape(this,t).get(t)}var cpe=lpe,gpe=rB;function upe(t){return gpe(this,t).has(t)}var dpe=upe,hpe=rB;function Ipe(t,e){var n=hpe(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var fpe=Ipe,Cpe=$Ce,ppe=ope,mpe=cpe,Ape=dpe,ype=fpe;function EC(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}EC.prototype.clear=Cpe;EC.prototype.delete=ppe;EC.prototype.get=mpe;EC.prototype.has=Ape;EC.prototype.set=ype;var D5=EC,QQ=D5,bpe="Expected a function";function U5(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(bpe);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(U5.Cache||QQ),n}U5.Cache=QQ;var qQ=U5;const vpe=Pn(qQ);var xpe=qQ,wpe=500;function Gpe(t){var e=xpe(t,function(i){return n.size===wpe&&n.clear(),i}),n=e.cache;return e}var Bpe=Gpe,Spe=Bpe,Zpe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rpe=/\\(\\)?/g,Npe=Spe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Zpe,function(n,i,r,s){e.push(r?s.replace(Rpe,"$1"):i||n)}),e}),Wpe=Npe;function Mpe(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var J5=Mpe,qY=K0,Vpe=J5,Fpe=io,_pe=FC,Tpe=1/0,$Y=qY?qY.prototype:void 0,ek=$Y?$Y.toString:void 0;function $Q(t){if(typeof t=="string")return t;if(Fpe(t))return Vpe(t,$Q)+"";if(_pe(t))return ek?ek.call(t):"";var e=t+"";return e=="0"&&1/t==-Tpe?"-0":e}var Xpe=$Q,Epe=Xpe;function Ype(t){return t==null?"":Epe(t)}var e8=Ype,kpe=io,Hpe=z5,Kpe=Wpe,Lpe=e8;function zpe(t,e){return kpe(t)?t:Hpe(t,e)?[t]:Kpe(Lpe(t))}var t8=zpe,jpe=FC,Ppe=1/0;function Ope(t){if(typeof t=="string"||jpe(t))return t;var e=t+"";return e=="0"&&1/t==-Ppe?"-0":e}var sB=Ope,Dpe=t8,Upe=sB;function Jpe(t,e){e=Dpe(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[Upe(e[n++])];return n&&n==i?t:void 0}var Q5=Jpe,Qpe=Q5;function qpe(t,e,n){var i=t==null?void 0:Qpe(t,e);return i===void 0?n:i}var n8=qpe;const wo=Pn(n8);function $pe(t){return t==null}var eme=$pe;const en=Pn(eme);var tme=jc,nme=io,ime=Pc,rme="[object String]";function sme(t){return typeof t=="string"||!nme(t)&&ime(t)&&tme(t)==rme}var ome=sme;const L0=Pn(ome);var i8={exports:{}},ti={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q5=Symbol.for("react.element"),$5=Symbol.for("react.portal"),oB=Symbol.for("react.fragment"),aB=Symbol.for("react.strict_mode"),lB=Symbol.for("react.profiler"),cB=Symbol.for("react.provider"),gB=Symbol.for("react.context"),ame=Symbol.for("react.server_context"),uB=Symbol.for("react.forward_ref"),dB=Symbol.for("react.suspense"),hB=Symbol.for("react.suspense_list"),IB=Symbol.for("react.memo"),fB=Symbol.for("react.lazy"),lme=Symbol.for("react.offscreen"),r8;r8=Symbol.for("react.module.reference");function ua(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case q5:switch(t=t.type,t){case oB:case lB:case aB:case dB:case hB:return t;default:switch(t=t&&t.$$typeof,t){case ame:case gB:case uB:case fB:case IB:case cB:return t;default:return e}}case $5:return e}}}ti.ContextConsumer=gB;ti.ContextProvider=cB;ti.Element=q5;ti.ForwardRef=uB;ti.Fragment=oB;ti.Lazy=fB;ti.Memo=IB;ti.Portal=$5;ti.Profiler=lB;ti.StrictMode=aB;ti.Suspense=dB;ti.SuspenseList=hB;ti.isAsyncMode=function(){return!1};ti.isConcurrentMode=function(){return!1};ti.isContextConsumer=function(t){return ua(t)===gB};ti.isContextProvider=function(t){return ua(t)===cB};ti.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===q5};ti.isForwardRef=function(t){return ua(t)===uB};ti.isFragment=function(t){return ua(t)===oB};ti.isLazy=function(t){return ua(t)===fB};ti.isMemo=function(t){return ua(t)===IB};ti.isPortal=function(t){return ua(t)===$5};ti.isProfiler=function(t){return ua(t)===lB};ti.isStrictMode=function(t){return ua(t)===aB};ti.isSuspense=function(t){return ua(t)===dB};ti.isSuspenseList=function(t){return ua(t)===hB};ti.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===oB||t===lB||t===aB||t===dB||t===hB||t===lme||typeof t=="object"&&t!==null&&(t.$$typeof===fB||t.$$typeof===IB||t.$$typeof===cB||t.$$typeof===gB||t.$$typeof===uB||t.$$typeof===r8||t.getModuleId!==void 0)};ti.typeOf=ua;i8.exports=ti;var cme=i8.exports,gme=jc,ume=Pc,dme="[object Number]";function hme(t){return typeof t=="number"||ume(t)&&gme(t)==dme}var s8=hme;const Ime=Pn(s8);var fme=s8;function Cme(t){return fme(t)&&t!=+t}var pme=Cme;const YC=Pn(pme);var ys=function(e){return e===0?0:e>0?1:-1},fd=function(e){return L0(e)&&e.indexOf("%")===e.length-1},ut=function(e){return Ime(e)&&!YC(e)},dr=function(e){return ut(e)||L0(e)},mme=0,yu=function(e){var n=++mme;return"".concat(e||"").concat(n)},bs=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ut(e)&&!L0(e))return i;var s;if(fd(e)){var o=e.indexOf("%");s=n*parseFloat(e.slice(0,o))/100}else s=+e;return YC(s)&&(s=i),r&&s>n&&(s=n),s},wg=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},Ame=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,i={},r=0;r<n;r++)if(!i[e[r]])i[e[r]]=!0;else return!0;return!1},Ni=function(e,n){return ut(e)&&ut(n)?function(i){return e+i*(n-e)}:function(){return n}};function fw(t,e,n){return!t||!t.length?null:t.find(function(i){return i&&(typeof e=="function"?e(i):wo(i,e))===n})}var yme=function(e){if(!e||!e.length)return null;for(var n=e.length,i=0,r=0,s=0,o=0,a=1/0,l=-1/0,c=0,u=0,d=0;d<n;d++)c=e[d].cx||0,u=e[d].cy||0,i+=c,r+=u,s+=c*u,o+=c*c,a=Math.min(a,c),l=Math.max(l,c);var h=n*o!==i*i?(n*s-i*r)/(n*o-i*i):0;return{xmin:a,xmax:l,a:h,b:(r-h*i)/n}};function UI(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var i in e)if({}.hasOwnProperty.call(e,i)&&!{}.hasOwnProperty.call(t,i))return!1;return!0}function zW(t){"@babel/helpers - typeof";return zW=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zW(t)}var bme=["viewBox","children"],vme=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],tk=["points","pathLength"],RZ={svg:bme,polygon:tk,polyline:tk},eF=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Cw=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(S.isValidElement(e)&&(i=e.props),!_C(i))return null;var r={};return Object.keys(i).forEach(function(s){eF.includes(s)&&(r[s]=n||function(o){return i[s](i,o)})}),r},xme=function(e,n,i){return function(r){return e(n,i,r),null}},su=function(e,n,i){if(!_C(e)||zW(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(s){var o=e[s];eF.includes(s)&&typeof o=="function"&&(r||(r={}),r[s]=xme(o,n,i))}),r},wme=["children"],Gme=["children"];function nk(t,e){if(t==null)return{};var n=Bme(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function Bme(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function jW(t){"@babel/helpers - typeof";return jW=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jW(t)}var ik={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Rc=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},rk=null,NZ=null,tF=function t(e){if(e===rk&&Array.isArray(NZ))return NZ;var n=[];return S.Children.forEach(e,function(i){en(i)||(cme.isFragment(i)?n=n.concat(t(i.props.children)):n.push(i))}),NZ=n,rk=e,n};function Gs(t,e){var n=[],i=[];return Array.isArray(e)?i=e.map(function(r){return Rc(r)}):i=[Rc(e)],tF(t).forEach(function(r){var s=wo(r,"type.displayName")||wo(r,"type.name");i.indexOf(s)!==-1&&n.push(r)}),n}function Co(t,e){var n=Gs(t,e);return n&&n[0]}var sk=function(e){if(!e||!e.props)return!1;var n=e.props,i=n.width,r=n.height;return!(!ut(i)||i<=0||!ut(r)||r<=0)},Sme=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Zme=function(e){return e&&e.type&&L0(e.type)&&Sme.indexOf(e.type)>=0},o8=function(e){return e&&jW(e)==="object"&&"clipDot"in e},Rme=function(e,n,i,r){var s,o=(s=RZ==null?void 0:RZ[r])!==null&&s!==void 0?s:[];return n.startsWith("data-")||!$t(e)&&(r&&o.includes(n)||vme.includes(n))||i&&eF.includes(n)},Yt=function(e,n,i){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(S.isValidElement(e)&&(r=e.props),!_C(r))return null;var s={};return Object.keys(r).forEach(function(o){var a;Rme((a=r)===null||a===void 0?void 0:a[o],o,n,i)&&(s[o]=r[o])}),s},PW=function t(e,n){if(e===n)return!0;var i=S.Children.count(e);if(i!==S.Children.count(n))return!1;if(i===0)return!0;if(i===1)return ok(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var r=0;r<i;r++){var s=e[r],o=n[r];if(Array.isArray(s)||Array.isArray(o)){if(!t(s,o))return!1}else if(!ok(s,o))return!1}return!0},ok=function(e,n){if(en(e)&&en(n))return!0;if(!en(e)&&!en(n)){var i=e.props||{},r=i.children,s=nk(i,wme),o=n.props||{},a=o.children,l=nk(o,Gme);return r&&a?UI(s,l)&&PW(r,a):!r&&!a?UI(s,l):!1}return!1},ak=function(e,n){var i=[],r={};return tF(e).forEach(function(s,o){if(Zme(s))i.push(s);else if(s){var a=Rc(s.type),l=n[a]||{},c=l.handler,u=l.once;if(c&&(!u||!r[a])){var d=c(s,a,o);i.push(d),r[a]=!0}}}),i},Nme=function(e){var n=e&&e.type;return n&&ik[n]?ik[n]:null},Wme=function(e,n){return tF(n).indexOf(e)},Mme=["children","width","height","viewBox","className","style","title","desc"];function OW(){return OW=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},OW.apply(this,arguments)}function Vme(t,e){if(t==null)return{};var n=Fme(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function Fme(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function DW(t){var e=t.children,n=t.width,i=t.height,r=t.viewBox,s=t.className,o=t.style,a=t.title,l=t.desc,c=Vme(t,Mme),u=r||{width:n,height:i,x:0,y:0},d=ln("recharts-surface",s);return $.createElement("svg",OW({},Yt(c,!0,"svg"),{className:d,width:n,height:i,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),$.createElement("title",null,a),$.createElement("desc",null,l),e)}var _me=["children","className"];function UW(){return UW=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},UW.apply(this,arguments)}function Tme(t,e){if(t==null)return{};var n=Xme(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function Xme(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var fn=$.forwardRef(function(t,e){var n=t.children,i=t.className,r=Tme(t,_me),s=ln("recharts-layer",i);return $.createElement("g",UW({className:s},Yt(r,!0),{ref:e}),n)}),Pa=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s]};function Eme(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}var Yme=Eme,kme=Yme;function Hme(t,e,n){var i=t.length;return n=n===void 0?i:n,!e&&n>=i?t:kme(t,e,n)}var Kme=Hme,Lme="\\ud800-\\udfff",zme="\\u0300-\\u036f",jme="\\ufe20-\\ufe2f",Pme="\\u20d0-\\u20ff",Ome=zme+jme+Pme,Dme="\\ufe0e\\ufe0f",Ume="\\u200d",Jme=RegExp("["+Ume+Lme+Ome+Dme+"]");function Qme(t){return Jme.test(t)}var a8=Qme;function qme(t){return t.split("")}var $me=qme,l8="\\ud800-\\udfff",eAe="\\u0300-\\u036f",tAe="\\ufe20-\\ufe2f",nAe="\\u20d0-\\u20ff",iAe=eAe+tAe+nAe,rAe="\\ufe0e\\ufe0f",sAe="["+l8+"]",JW="["+iAe+"]",QW="\\ud83c[\\udffb-\\udfff]",oAe="(?:"+JW+"|"+QW+")",c8="[^"+l8+"]",g8="(?:\\ud83c[\\udde6-\\uddff]){2}",u8="[\\ud800-\\udbff][\\udc00-\\udfff]",aAe="\\u200d",d8=oAe+"?",h8="["+rAe+"]?",lAe="(?:"+aAe+"(?:"+[c8,g8,u8].join("|")+")"+h8+d8+")*",cAe=h8+d8+lAe,gAe="(?:"+[c8+JW+"?",JW,g8,u8,sAe].join("|")+")",uAe=RegExp(QW+"(?="+QW+")|"+gAe+cAe,"g");function dAe(t){return t.match(uAe)||[]}var hAe=dAe,IAe=$me,fAe=a8,CAe=hAe;function pAe(t){return fAe(t)?CAe(t):IAe(t)}var mAe=pAe,AAe=Kme,yAe=a8,bAe=mAe,vAe=e8;function xAe(t){return function(e){e=vAe(e);var n=yAe(e)?bAe(e):void 0,i=n?n[0]:e.charAt(0),r=n?AAe(n,1).join(""):e.slice(1);return i[t]()+r}}var wAe=xAe,GAe=wAe,BAe=GAe("toUpperCase"),SAe=BAe;const CB=Pn(SAe);function ci(t){return function(){return t}}const I8=Math.cos,pw=Math.sin,tl=Math.sqrt,mw=Math.PI,pB=2*mw,qW=Math.PI,$W=2*qW,nd=1e-6,ZAe=$W-nd;function f8(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function RAe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return f8;const n=10**e;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let NAe=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?f8:RAe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,s,o){this._append`C${+e},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,i,r,s){if(e=+e,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=i-e,c=r-n,u=o-e,d=a-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>nd)if(!(Math.abs(d*l-c*u)>nd)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let I=i-o,p=r-a,y=l*l+c*c,A=I*I+p*p,m=Math.sqrt(y),b=Math.sqrt(h),v=s*Math.tan((qW-Math.acos((y+h-A)/(2*m*b)))/2),w=v/b,x=v/m;Math.abs(w-1)>nd&&this._append`L${e+w*u},${n+w*d}`,this._append`A${s},${s},0,0,${+(d*I>u*p)},${this._x1=e+x*l},${this._y1=n+x*c}`}}arc(e,n,i,r,s,o){if(e=+e,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),l=i*Math.sin(r),c=e+a,u=n+l,d=1^o,h=o?r-s:s-r;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>nd||Math.abs(this._y1-u)>nd)&&this._append`L${c},${u}`,i&&(h<0&&(h=h%$W+$W),h>ZAe?this._append`A${i},${i},0,1,${d},${e-a},${n-l}A${i},${i},0,1,${d},${this._x1=c},${this._y1=u}`:h>nd&&this._append`A${i},${i},0,${+(h>=qW)},${d},${this._x1=e+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function nF(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new NAe(e)}function iF(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function C8(t){this._context=t}C8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function mB(t){return new C8(t)}function p8(t){return t[0]}function m8(t){return t[1]}function A8(t,e){var n=ci(!0),i=null,r=mB,s=null,o=nF(a);t=typeof t=="function"?t:t===void 0?p8:ci(t),e=typeof e=="function"?e:e===void 0?m8:ci(e);function a(l){var c,u=(l=iF(l)).length,d,h=!1,I;for(i==null&&(s=r(I=o())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+t(d,c,l),+e(d,c,l));if(I)return s=null,I+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:ci(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:ci(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:ci(!!l),a):n},a.curve=function(l){return arguments.length?(r=l,i!=null&&(s=r(i)),a):r},a.context=function(l){return arguments.length?(l==null?i=s=null:s=r(i=l),a):i},a}function _b(t,e,n){var i=null,r=ci(!0),s=null,o=mB,a=null,l=nF(c);t=typeof t=="function"?t:t===void 0?p8:ci(+t),e=typeof e=="function"?e:ci(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?m8:ci(+n);function c(d){var h,I,p,y=(d=iF(d)).length,A,m=!1,b,v=new Array(y),w=new Array(y);for(s==null&&(a=o(b=l())),h=0;h<=y;++h){if(!(h<y&&r(A=d[h],h,d))===m)if(m=!m)I=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=h-1;p>=I;--p)a.point(v[p],w[p]);a.lineEnd(),a.areaEnd()}m&&(v[h]=+t(A,h,d),w[h]=+e(A,h,d),a.point(i?+i(A,h,d):v[h],n?+n(A,h,d):w[h]))}if(b)return a=null,b+""||null}function u(){return A8().defined(r).curve(o).context(s)}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:ci(+d),i=null,c):t},c.x0=function(d){return arguments.length?(t=typeof d=="function"?d:ci(+d),c):t},c.x1=function(d){return arguments.length?(i=d==null?null:typeof d=="function"?d:ci(+d),c):i},c.y=function(d){return arguments.length?(e=typeof d=="function"?d:ci(+d),n=null,c):e},c.y0=function(d){return arguments.length?(e=typeof d=="function"?d:ci(+d),c):e},c.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:ci(+d),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(i).y(e)},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:ci(!!d),c):r},c.curve=function(d){return arguments.length?(o=d,s!=null&&(a=o(s)),c):o},c.context=function(d){return arguments.length?(d==null?s=a=null:a=o(s=d),c):s},c}class y8{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function WAe(t){return new y8(t,!0)}function MAe(t){return new y8(t,!1)}const rF={draw(t,e){const n=tl(e/mw);t.moveTo(n,0),t.arc(0,0,n,0,pB)}},VAe={draw(t,e){const n=tl(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},b8=tl(1/3),FAe=b8*2,_Ae={draw(t,e){const n=tl(e/FAe),i=n*b8;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},TAe={draw(t,e){const n=tl(e),i=-n/2;t.rect(i,i,n,n)}},XAe=.8908130915292852,v8=pw(mw/10)/pw(7*mw/10),EAe=pw(pB/10)*v8,YAe=-I8(pB/10)*v8,kAe={draw(t,e){const n=tl(e*XAe),i=EAe*n,r=YAe*n;t.moveTo(0,-n),t.lineTo(i,r);for(let s=1;s<5;++s){const o=pB*s/5,a=I8(o),l=pw(o);t.lineTo(l*n,-a*n),t.lineTo(a*i-l*r,l*i+a*r)}t.closePath()}},WZ=tl(3),HAe={draw(t,e){const n=-tl(e/(WZ*3));t.moveTo(0,n*2),t.lineTo(-WZ*n,-n),t.lineTo(WZ*n,-n),t.closePath()}},ko=-.5,Ho=tl(3)/2,eM=1/tl(12),KAe=(eM/2+1)*3,LAe={draw(t,e){const n=tl(e/KAe),i=n/2,r=n*eM,s=i,o=n*eM+n,a=-s,l=o;t.moveTo(i,r),t.lineTo(s,o),t.lineTo(a,l),t.lineTo(ko*i-Ho*r,Ho*i+ko*r),t.lineTo(ko*s-Ho*o,Ho*s+ko*o),t.lineTo(ko*a-Ho*l,Ho*a+ko*l),t.lineTo(ko*i+Ho*r,ko*r-Ho*i),t.lineTo(ko*s+Ho*o,ko*o-Ho*s),t.lineTo(ko*a+Ho*l,ko*l-Ho*a),t.closePath()}};function zAe(t,e){let n=null,i=nF(r);t=typeof t=="function"?t:ci(t||rF),e=typeof e=="function"?e:ci(e===void 0?64:+e);function r(){let s;if(n||(n=s=i()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(t=typeof s=="function"?s:ci(s),r):t},r.size=function(s){return arguments.length?(e=typeof s=="function"?s:ci(+s),r):e},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function Aw(){}function yw(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function x8(t){this._context=t}x8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:yw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:yw(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function jAe(t){return new x8(t)}function w8(t){this._context=t}w8.prototype={areaStart:Aw,areaEnd:Aw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:yw(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function PAe(t){return new w8(t)}function G8(t){this._context=t}G8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:yw(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function OAe(t){return new G8(t)}function B8(t){this._context=t}B8.prototype={areaStart:Aw,areaEnd:Aw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function DAe(t){return new B8(t)}function lk(t){return t<0?-1:1}function ck(t,e,n){var i=t._x1-t._x0,r=e-t._x1,s=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(lk(s)+lk(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function gk(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function MZ(t,e,n){var i=t._x0,r=t._y0,s=t._x1,o=t._y1,a=(s-i)/3;t._context.bezierCurveTo(i+a,r+a*e,s-a,o-a*n,s,o)}function bw(t){this._context=t}bw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:MZ(this,this._t0,gk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,MZ(this,gk(this,n=ck(this,t,e)),n);break;default:MZ(this,this._t0,n=ck(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function S8(t){this._context=new Z8(t)}(S8.prototype=Object.create(bw.prototype)).point=function(t,e){bw.prototype.point.call(this,e,t)};function Z8(t){this._context=t}Z8.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,s){this._context.bezierCurveTo(e,t,i,n,s,r)}};function UAe(t){return new bw(t)}function JAe(t){return new S8(t)}function R8(t){this._context=t}R8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var i=uk(t),r=uk(e),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function uk(t){var e,n=t.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)r[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)i=r[e]/s[e-1],s[e]-=i,o[e]-=i*o[e-1];for(r[n-1]=o[n-1]/s[n-1],e=n-2;e>=0;--e)r[e]=(o[e]-r[e+1])/s[e];for(s[n-1]=(t[n]+r[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-r[e+1];return[r,s]}function QAe(t){return new R8(t)}function AB(t,e){this._context=t,this._t=e}AB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function qAe(t){return new AB(t,.5)}function $Ae(t){return new AB(t,0)}function e0e(t){return new AB(t,1)}function Rf(t,e){if((o=t.length)>1)for(var n=1,i,r,s=t[e[0]],o,a=s.length;n<o;++n)for(r=s,s=t[e[n]],i=0;i<a;++i)s[i][1]+=s[i][0]=isNaN(r[i][1])?r[i][0]:r[i][1]}function tM(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function t0e(t,e){return t[e]}function n0e(t){const e=[];return e.key=t,e}function i0e(){var t=ci([]),e=tM,n=Rf,i=t0e;function r(s){var o=Array.from(t.apply(this,arguments),n0e),a,l=o.length,c=-1,u;for(const d of s)for(a=0,++c;a<l;++a)(o[a][c]=[0,+i(d,o[a].key,c,s)]).data=d;for(a=0,u=iF(e(o));a<l;++a)o[u[a]].index=a;return n(o,u),o}return r.keys=function(s){return arguments.length?(t=typeof s=="function"?s:ci(Array.from(s)),r):t},r.value=function(s){return arguments.length?(i=typeof s=="function"?s:ci(+s),r):i},r.order=function(s){return arguments.length?(e=s==null?tM:typeof s=="function"?s:ci(Array.from(s)),r):e},r.offset=function(s){return arguments.length?(n=s??Rf,r):n},r}function r0e(t,e){if((i=t.length)>0){for(var n,i,r=0,s=t[0].length,o;r<s;++r){for(o=n=0;n<i;++n)o+=t[n][r][1]||0;if(o)for(n=0;n<i;++n)t[n][r][1]/=o}Rf(t,e)}}function s0e(t,e){if((r=t.length)>0){for(var n=0,i=t[e[0]],r,s=i.length;n<s;++n){for(var o=0,a=0;o<r;++o)a+=t[o][n][1]||0;i[n][1]+=i[n][0]=-a/2}Rf(t,e)}}function o0e(t,e){if(!(!((o=t.length)>0)||!((s=(r=t[e[0]]).length)>0))){for(var n=0,i=1,r,s,o;i<s;++i){for(var a=0,l=0,c=0;a<o;++a){for(var u=t[e[a]],d=u[i][1]||0,h=u[i-1][1]||0,I=(d-h)/2,p=0;p<a;++p){var y=t[e[p]],A=y[i][1]||0,m=y[i-1][1]||0;I+=A-m}l+=d,c+=I*d}r[i-1][1]+=r[i-1][0]=n,l&&(n-=c/l)}r[i-1][1]+=r[i-1][0]=n,Rf(t,e)}}function vA(t){"@babel/helpers - typeof";return vA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vA(t)}var a0e=["type","size","sizeType"];function nM(){return nM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},nM.apply(this,arguments)}function dk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function hk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dk(Object(n),!0).forEach(function(i){l0e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function l0e(t,e,n){return e=c0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c0e(t){var e=g0e(t,"string");return vA(e)=="symbol"?e:e+""}function g0e(t,e){if(vA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(vA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function u0e(t,e){if(t==null)return{};var n=d0e(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function d0e(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var N8={symbolCircle:rF,symbolCross:VAe,symbolDiamond:_Ae,symbolSquare:TAe,symbolStar:kAe,symbolTriangle:HAe,symbolWye:LAe},h0e=Math.PI/180,I0e=function(e){var n="symbol".concat(CB(e));return N8[n]||rF},f0e=function(e,n,i){if(n==="area")return e;switch(i){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*h0e;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},C0e=function(e,n){N8["symbol".concat(CB(e))]=n},yB=function(e){var n=e.type,i=n===void 0?"circle":n,r=e.size,s=r===void 0?64:r,o=e.sizeType,a=o===void 0?"area":o,l=u0e(e,a0e),c=hk(hk({},l),{},{type:i,size:s,sizeType:a}),u=function(){var A=I0e(i),m=zAe().type(A).size(f0e(s,a,i));return m()},d=c.className,h=c.cx,I=c.cy,p=Yt(c,!0);return h===+h&&I===+I&&s===+s?$.createElement("path",nM({},p,{className:ln("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(I,")"),d:u()})):null};yB.registerSymbol=C0e;function Nf(t){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(t)}function iM(){return iM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},iM.apply(this,arguments)}function Ik(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function p0e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ik(Object(n),!0).forEach(function(i){xA(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ik(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function m0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A0e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,M8(i.key),i)}}function y0e(t,e,n){return e&&A0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function b0e(t,e,n){return e=vw(e),v0e(t,W8()?Reflect.construct(e,n||[],vw(t).constructor):e.apply(t,n))}function v0e(t,e){if(e&&(Nf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x0e(t)}function x0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W8=function(){return!!t})()}function vw(t){return vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},vw(t)}function w0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rM(t,e)}function rM(t,e){return rM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},rM(t,e)}function xA(t,e,n){return e=M8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M8(t){var e=G0e(t,"string");return Nf(e)=="symbol"?e:e+""}function G0e(t,e){if(Nf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Nf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ko=32,sF=function(t){function e(){return m0e(this,e),b0e(this,e,arguments)}return w0e(e,t),y0e(e,[{key:"renderIcon",value:function(i){var r=this.props.inactiveColor,s=Ko/2,o=Ko/6,a=Ko/3,l=i.inactive?r:i.color;if(i.type==="plainline")return $.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:s,x2:Ko,y2:s,className:"recharts-legend-icon"});if(i.type==="line")return $.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*a,",").concat(s,`
            H`).concat(Ko,"M").concat(2*a,",").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(a,",").concat(s),className:"recharts-legend-icon"});if(i.type==="rect")return $.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ko/8,"h").concat(Ko,"v").concat(Ko*3/4,"h").concat(-Ko,"z"),className:"recharts-legend-icon"});if($.isValidElement(i.legendIcon)){var c=p0e({},i);return delete c.legendIcon,$.cloneElement(i.legendIcon,c)}return $.createElement(yB,{fill:l,cx:s,cy:s,size:Ko,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,r=this.props,s=r.payload,o=r.iconSize,a=r.layout,l=r.formatter,c=r.inactiveColor,u={x:0,y:0,width:Ko,height:Ko},d={display:a==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(I,p){var y=I.formatter||l,A=ln(xA(xA({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",I.inactive));if(I.type==="none")return null;var m=$t(I.value)?null:I.value;Pa(!$t(I.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=I.inactive?c:I.color;return $.createElement("li",iM({className:A,style:d,key:"legend-item-".concat(p)},su(i.props,I,p)),$.createElement(DW,{width:o,height:o,viewBox:u,style:h},i.renderIcon(I)),$.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(m,I,p):m))})}},{key:"render",value:function(){var i=this.props,r=i.payload,s=i.layout,o=i.align;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:s==="horizontal"?o:"left"};return $.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(S.PureComponent);xA(sF,"displayName","Legend");xA(sF,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var B0e=iB;function S0e(){this.__data__=new B0e,this.size=0}var Z0e=S0e;function R0e(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var N0e=R0e;function W0e(t){return this.__data__.get(t)}var M0e=W0e;function V0e(t){return this.__data__.has(t)}var F0e=V0e,_0e=iB,T0e=O5,X0e=D5,E0e=200;function Y0e(t,e){var n=this.__data__;if(n instanceof _0e){var i=n.__data__;if(!T0e||i.length<E0e-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new X0e(i)}return n.set(t,e),this.size=n.size,this}var k0e=Y0e,H0e=iB,K0e=Z0e,L0e=N0e,z0e=M0e,j0e=F0e,P0e=k0e;function kC(t){var e=this.__data__=new H0e(t);this.size=e.size}kC.prototype.clear=K0e;kC.prototype.delete=L0e;kC.prototype.get=z0e;kC.prototype.has=j0e;kC.prototype.set=P0e;var V8=kC,O0e="__lodash_hash_undefined__";function D0e(t){return this.__data__.set(t,O0e),this}var U0e=D0e;function J0e(t){return this.__data__.has(t)}var Q0e=J0e,q0e=D5,$0e=U0e,eye=Q0e;function xw(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new q0e;++e<n;)this.add(t[e])}xw.prototype.add=xw.prototype.push=$0e;xw.prototype.has=eye;var F8=xw;function tye(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var _8=tye;function nye(t,e){return t.has(e)}var T8=nye,iye=F8,rye=_8,sye=T8,oye=1,aye=2;function lye(t,e,n,i,r,s){var o=n&oye,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var d=-1,h=!0,I=n&aye?new iye:void 0;for(s.set(t,e),s.set(e,t);++d<a;){var p=t[d],y=e[d];if(i)var A=o?i(y,p,d,e,t,s):i(p,y,d,t,e,s);if(A!==void 0){if(A)continue;h=!1;break}if(I){if(!rye(e,function(m,b){if(!sye(I,b)&&(p===m||r(p,m,n,i,s)))return I.push(b)})){h=!1;break}}else if(!(p===y||r(p,y,n,i,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var X8=lye,cye=jl,gye=cye.Uint8Array,uye=gye;function dye(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var hye=dye;function Iye(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var oF=Iye,fk=K0,Ck=uye,fye=P5,Cye=X8,pye=hye,mye=oF,Aye=1,yye=2,bye="[object Boolean]",vye="[object Date]",xye="[object Error]",wye="[object Map]",Gye="[object Number]",Bye="[object RegExp]",Sye="[object Set]",Zye="[object String]",Rye="[object Symbol]",Nye="[object ArrayBuffer]",Wye="[object DataView]",pk=fk?fk.prototype:void 0,VZ=pk?pk.valueOf:void 0;function Mye(t,e,n,i,r,s,o){switch(n){case Wye:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Nye:return!(t.byteLength!=e.byteLength||!s(new Ck(t),new Ck(e)));case bye:case vye:case Gye:return fye(+t,+e);case xye:return t.name==e.name&&t.message==e.message;case Bye:case Zye:return t==e+"";case wye:var a=pye;case Sye:var l=i&Aye;if(a||(a=mye),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=yye,o.set(t,e);var u=Cye(a(t),a(e),i,r,s,o);return o.delete(t),u;case Rye:if(VZ)return VZ.call(t)==VZ.call(e)}return!1}var Vye=Mye;function Fye(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var E8=Fye,_ye=E8,Tye=io;function Xye(t,e,n){var i=e(t);return Tye(t)?i:_ye(i,n(t))}var Eye=Xye;function Yye(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var kye=Yye;function Hye(){return[]}var Kye=Hye,Lye=kye,zye=Kye,jye=Object.prototype,Pye=jye.propertyIsEnumerable,mk=Object.getOwnPropertySymbols,Oye=mk?function(t){return t==null?[]:(t=Object(t),Lye(mk(t),function(e){return Pye.call(t,e)}))}:zye,Dye=Oye;function Uye(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var Jye=Uye,Qye=jc,qye=Pc,$ye="[object Arguments]";function ebe(t){return qye(t)&&Qye(t)==$ye}var tbe=ebe,Ak=tbe,nbe=Pc,Y8=Object.prototype,ibe=Y8.hasOwnProperty,rbe=Y8.propertyIsEnumerable,sbe=Ak(function(){return arguments}())?Ak:function(t){return nbe(t)&&ibe.call(t,"callee")&&!rbe.call(t,"callee")},aF=sbe,ww={exports:{}};function obe(){return!1}var abe=obe;ww.exports;(function(t,e){var n=jl,i=abe,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===r,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||i;t.exports=c})(ww,ww.exports);var k8=ww.exports,lbe=9007199254740991,cbe=/^(?:0|[1-9]\d*)$/;function gbe(t,e){var n=typeof t;return e=e??lbe,!!e&&(n=="number"||n!="symbol"&&cbe.test(t))&&t>-1&&t%1==0&&t<e}var lF=gbe,ube=9007199254740991;function dbe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ube}var cF=dbe,hbe=jc,Ibe=cF,fbe=Pc,Cbe="[object Arguments]",pbe="[object Array]",mbe="[object Boolean]",Abe="[object Date]",ybe="[object Error]",bbe="[object Function]",vbe="[object Map]",xbe="[object Number]",wbe="[object Object]",Gbe="[object RegExp]",Bbe="[object Set]",Sbe="[object String]",Zbe="[object WeakMap]",Rbe="[object ArrayBuffer]",Nbe="[object DataView]",Wbe="[object Float32Array]",Mbe="[object Float64Array]",Vbe="[object Int8Array]",Fbe="[object Int16Array]",_be="[object Int32Array]",Tbe="[object Uint8Array]",Xbe="[object Uint8ClampedArray]",Ebe="[object Uint16Array]",Ybe="[object Uint32Array]",pi={};pi[Wbe]=pi[Mbe]=pi[Vbe]=pi[Fbe]=pi[_be]=pi[Tbe]=pi[Xbe]=pi[Ebe]=pi[Ybe]=!0;pi[Cbe]=pi[pbe]=pi[Rbe]=pi[mbe]=pi[Nbe]=pi[Abe]=pi[ybe]=pi[bbe]=pi[vbe]=pi[xbe]=pi[wbe]=pi[Gbe]=pi[Bbe]=pi[Sbe]=pi[Zbe]=!1;function kbe(t){return fbe(t)&&Ibe(t.length)&&!!pi[hbe(t)]}var Hbe=kbe;function Kbe(t){return function(e){return t(e)}}var H8=Kbe,Gw={exports:{}};Gw.exports;(function(t,e){var n=DQ,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,s=r&&r.exports===i,o=s&&n.process,a=function(){try{var l=r&&r.require&&r.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(Gw,Gw.exports);var Lbe=Gw.exports,zbe=Hbe,jbe=H8,yk=Lbe,bk=yk&&yk.isTypedArray,Pbe=bk?jbe(bk):zbe,K8=Pbe,Obe=Jye,Dbe=aF,Ube=io,Jbe=k8,Qbe=lF,qbe=K8,$be=Object.prototype,eve=$be.hasOwnProperty;function tve(t,e){var n=Ube(t),i=!n&&Dbe(t),r=!n&&!i&&Jbe(t),s=!n&&!i&&!r&&qbe(t),o=n||i||r||s,a=o?Obe(t.length,String):[],l=a.length;for(var c in t)(e||eve.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Qbe(c,l)))&&a.push(c);return a}var nve=tve,ive=Object.prototype;function rve(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||ive;return t===n}var sve=rve;function ove(t,e){return function(n){return t(e(n))}}var L8=ove,ave=L8,lve=ave(Object.keys,Object),cve=lve,gve=sve,uve=cve,dve=Object.prototype,hve=dve.hasOwnProperty;function Ive(t){if(!gve(t))return uve(t);var e=[];for(var n in Object(t))hve.call(t,n)&&n!="constructor"&&e.push(n);return e}var fve=Ive,Cve=j5,pve=cF;function mve(t){return t!=null&&pve(t.length)&&!Cve(t)}var z0=mve,Ave=nve,yve=fve,bve=z0;function vve(t){return bve(t)?Ave(t):yve(t)}var bB=vve,xve=Eye,wve=Dye,Gve=bB;function Bve(t){return xve(t,Gve,wve)}var Sve=Bve,vk=Sve,Zve=1,Rve=Object.prototype,Nve=Rve.hasOwnProperty;function Wve(t,e,n,i,r,s){var o=n&Zve,a=vk(t),l=a.length,c=vk(e),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=a[d];if(!(o?h in e:Nve.call(e,h)))return!1}var I=s.get(t),p=s.get(e);if(I&&p)return I==e&&p==t;var y=!0;s.set(t,e),s.set(e,t);for(var A=o;++d<l;){h=a[d];var m=t[h],b=e[h];if(i)var v=o?i(b,m,h,e,t,s):i(m,b,h,t,e,s);if(!(v===void 0?m===b||r(m,b,n,i,s):v)){y=!1;break}A||(A=h=="constructor")}if(y&&!A){var w=t.constructor,x=e.constructor;w!=x&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof x=="function"&&x instanceof x)&&(y=!1)}return s.delete(t),s.delete(e),y}var Mve=Wve,Vve=Ih,Fve=jl,_ve=Vve(Fve,"DataView"),Tve=_ve,Xve=Ih,Eve=jl,Yve=Xve(Eve,"Promise"),kve=Yve,Hve=Ih,Kve=jl,Lve=Hve(Kve,"Set"),z8=Lve,zve=Ih,jve=jl,Pve=zve(jve,"WeakMap"),Ove=Pve,sM=Tve,oM=O5,aM=kve,lM=z8,cM=Ove,j8=jc,HC=JQ,xk="[object Map]",Dve="[object Object]",wk="[object Promise]",Gk="[object Set]",Bk="[object WeakMap]",Sk="[object DataView]",Uve=HC(sM),Jve=HC(oM),Qve=HC(aM),qve=HC(lM),$ve=HC(cM),id=j8;(sM&&id(new sM(new ArrayBuffer(1)))!=Sk||oM&&id(new oM)!=xk||aM&&id(aM.resolve())!=wk||lM&&id(new lM)!=Gk||cM&&id(new cM)!=Bk)&&(id=function(t){var e=j8(t),n=e==Dve?t.constructor:void 0,i=n?HC(n):"";if(i)switch(i){case Uve:return Sk;case Jve:return xk;case Qve:return wk;case qve:return Gk;case $ve:return Bk}return e});var exe=id,FZ=V8,txe=X8,nxe=Vye,ixe=Mve,Zk=exe,Rk=io,Nk=k8,rxe=K8,sxe=1,Wk="[object Arguments]",Mk="[object Array]",Tb="[object Object]",oxe=Object.prototype,Vk=oxe.hasOwnProperty;function axe(t,e,n,i,r,s){var o=Rk(t),a=Rk(e),l=o?Mk:Zk(t),c=a?Mk:Zk(e);l=l==Wk?Tb:l,c=c==Wk?Tb:c;var u=l==Tb,d=c==Tb,h=l==c;if(h&&Nk(t)){if(!Nk(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new FZ),o||rxe(t)?txe(t,e,n,i,r,s):nxe(t,e,l,n,i,r,s);if(!(n&sxe)){var I=u&&Vk.call(t,"__wrapped__"),p=d&&Vk.call(e,"__wrapped__");if(I||p){var y=I?t.value():t,A=p?e.value():e;return s||(s=new FZ),r(y,A,n,i,s)}}return h?(s||(s=new FZ),ixe(t,e,n,i,r,s)):!1}var lxe=axe,cxe=lxe,Fk=Pc;function P8(t,e,n,i,r){return t===e?!0:t==null||e==null||!Fk(t)&&!Fk(e)?t!==t&&e!==e:cxe(t,e,n,i,P8,r)}var gF=P8,gxe=V8,uxe=gF,dxe=1,hxe=2;function Ixe(t,e,n,i){var r=n.length,s=r,o=!i;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var l=a[0],c=t[l],u=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var d=new gxe;if(i)var h=i(c,u,l,t,e,d);if(!(h===void 0?uxe(u,c,dxe|hxe,i,d):h))return!1}}return!0}var fxe=Ixe,Cxe=Au;function pxe(t){return t===t&&!Cxe(t)}var O8=pxe,mxe=O8,Axe=bB;function yxe(t){for(var e=Axe(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,mxe(r)]}return e}var bxe=yxe;function vxe(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var D8=vxe,xxe=fxe,wxe=bxe,Gxe=D8;function Bxe(t){var e=wxe(t);return e.length==1&&e[0][2]?Gxe(e[0][0],e[0][1]):function(n){return n===t||xxe(n,t,e)}}var Sxe=Bxe;function Zxe(t,e){return t!=null&&e in Object(t)}var Rxe=Zxe,Nxe=t8,Wxe=aF,Mxe=io,Vxe=lF,Fxe=cF,_xe=sB;function Txe(t,e,n){e=Nxe(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=_xe(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&Fxe(r)&&Vxe(o,r)&&(Mxe(t)||Wxe(t)))}var Xxe=Txe,Exe=Rxe,Yxe=Xxe;function kxe(t,e){return t!=null&&Yxe(t,e,Exe)}var Hxe=kxe,Kxe=gF,Lxe=n8,zxe=Hxe,jxe=z5,Pxe=O8,Oxe=D8,Dxe=sB,Uxe=1,Jxe=2;function Qxe(t,e){return jxe(t)&&Pxe(e)?Oxe(Dxe(t),e):function(n){var i=Lxe(n,t);return i===void 0&&i===e?zxe(n,t):Kxe(e,i,Uxe|Jxe)}}var qxe=Qxe;function $xe(t){return t}var KC=$xe;function ewe(t){return function(e){return e==null?void 0:e[t]}}var twe=ewe,nwe=Q5;function iwe(t){return function(e){return nwe(e,t)}}var rwe=iwe,swe=twe,owe=rwe,awe=z5,lwe=sB;function cwe(t){return awe(t)?swe(lwe(t)):owe(t)}var gwe=cwe,uwe=Sxe,dwe=qxe,hwe=KC,Iwe=io,fwe=gwe;function Cwe(t){return typeof t=="function"?t:t==null?hwe:typeof t=="object"?Iwe(t)?dwe(t[0],t[1]):uwe(t):fwe(t)}var Pl=Cwe;function pwe(t,e,n,i){for(var r=t.length,s=n+(i?1:-1);i?s--:++s<r;)if(e(t[s],s,t))return s;return-1}var U8=pwe;function mwe(t){return t!==t}var Awe=mwe;function ywe(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}var bwe=ywe,vwe=U8,xwe=Awe,wwe=bwe;function Gwe(t,e,n){return e===e?wwe(t,e,n):vwe(t,xwe,n)}var Bwe=Gwe,Swe=Bwe;function Zwe(t,e){var n=t==null?0:t.length;return!!n&&Swe(t,e,0)>-1}var Rwe=Zwe;function Nwe(t,e,n){for(var i=-1,r=t==null?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}var Wwe=Nwe;function Mwe(){}var Vwe=Mwe,_Z=z8,Fwe=Vwe,_we=oF,Twe=1/0,Xwe=_Z&&1/_we(new _Z([,-0]))[1]==Twe?function(t){return new _Z(t)}:Fwe,Ewe=Xwe,Ywe=F8,kwe=Rwe,Hwe=Wwe,Kwe=T8,Lwe=Ewe,zwe=oF,jwe=200;function Pwe(t,e,n){var i=-1,r=kwe,s=t.length,o=!0,a=[],l=a;if(n)o=!1,r=Hwe;else if(s>=jwe){var c=e?null:Lwe(t);if(c)return zwe(c);o=!1,r=Kwe,l=new Ywe}else l=e?[]:a;e:for(;++i<s;){var u=t[i],d=e?e(u):u;if(u=n||u!==0?u:0,o&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),a.push(u)}else r(l,d,n)||(l!==a&&l.push(d),a.push(u))}return a}var Owe=Pwe,Dwe=Pl,Uwe=Owe;function Jwe(t,e){return t&&t.length?Uwe(t,Dwe(e)):[]}var Qwe=Jwe;const _k=Pn(Qwe);function J8(t,e,n){return e===!0?_k(t,n):$t(e)?_k(t,e):t}function Wf(t){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wf(t)}var qwe=["ref"];function Tk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function rc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Tk(Object(n),!0).forEach(function(i){vB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xk(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,q8(i.key),i)}}function eGe(t,e,n){return e&&Xk(t.prototype,e),n&&Xk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tGe(t,e,n){return e=Bw(e),nGe(t,Q8()?Reflect.construct(e,n||[],Bw(t).constructor):e.apply(t,n))}function nGe(t,e){if(e&&(Wf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iGe(t)}function iGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Q8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q8=function(){return!!t})()}function Bw(t){return Bw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Bw(t)}function rGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gM(t,e)}function gM(t,e){return gM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},gM(t,e)}function vB(t,e,n){return e=q8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q8(t){var e=sGe(t,"string");return Wf(e)=="symbol"?e:e+""}function sGe(t,e){if(Wf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Wf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oGe(t,e){if(t==null)return{};var n=aGe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function aGe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function lGe(t){return t.value}function cGe(t,e){if($.isValidElement(t))return $.cloneElement(t,e);if(typeof t=="function")return $.createElement(t,e);e.ref;var n=oGe(e,qwe);return $.createElement(sF,n)}var Ek=1,JI=function(t){function e(){var n;$we(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=tGe(this,e,[].concat(r)),vB(n,"lastBoundingBox",{width:-1,height:-1}),n}return rGe(e,t),eGe(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>Ek||Math.abs(r.height-this.lastBoundingBox.height)>Ek)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,i&&i(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?rc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var r=this.props,s=r.layout,o=r.align,a=r.verticalAlign,l=r.margin,c=r.chartWidth,u=r.chartHeight,d,h;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(o==="center"&&s==="vertical"){var I=this.getBBoxSnapshot();d={left:((c||0)-I.width)/2}}else d=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(a==="middle"){var p=this.getBBoxSnapshot();h={top:((u||0)-p.height)/2}}else h=a==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return rc(rc({},d),h)}},{key:"render",value:function(){var i=this,r=this.props,s=r.content,o=r.width,a=r.height,l=r.wrapperStyle,c=r.payloadUniqBy,u=r.payload,d=rc(rc({position:"absolute",width:o||"auto",height:a||"auto"},this.getDefaultPosition(l)),l);return $.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(I){i.wrapperNode=I}},cGe(s,rc(rc({},this.props),{},{payload:J8(u,c,lGe)})))}}],[{key:"getWithHeight",value:function(i,r){var s=rc(rc({},this.defaultProps),i.props),o=s.layout;return o==="vertical"&&ut(i.props.height)?{height:i.props.height}:o==="horizontal"?{width:i.props.width||r}:null}}])}(S.PureComponent);vB(JI,"displayName","Legend");vB(JI,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Yk=K0,gGe=aF,uGe=io,kk=Yk?Yk.isConcatSpreadable:void 0;function dGe(t){return uGe(t)||gGe(t)||!!(kk&&t&&t[kk])}var hGe=dGe,IGe=E8,fGe=hGe;function $8(t,e,n,i,r){var s=-1,o=t.length;for(n||(n=fGe),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?$8(a,e-1,n,i,r):IGe(r,a):i||(r[r.length]=a)}return r}var e7=$8;function CGe(t){return function(e,n,i){for(var r=-1,s=Object(e),o=i(e),a=o.length;a--;){var l=o[t?a:++r];if(n(s[l],l,s)===!1)break}return e}}var pGe=CGe,mGe=pGe,AGe=mGe(),yGe=AGe,bGe=yGe,vGe=bB;function xGe(t,e){return t&&bGe(t,e,vGe)}var t7=xGe,wGe=z0;function GGe(t,e){return function(n,i){if(n==null)return n;if(!wGe(n))return t(n,i);for(var r=n.length,s=e?r:-1,o=Object(n);(e?s--:++s<r)&&i(o[s],s,o)!==!1;);return n}}var BGe=GGe,SGe=t7,ZGe=BGe,RGe=ZGe(SGe),uF=RGe,NGe=uF,WGe=z0;function MGe(t,e){var n=-1,i=WGe(t)?Array(t.length):[];return NGe(t,function(r,s,o){i[++n]=e(r,s,o)}),i}var n7=MGe;function VGe(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var FGe=VGe,Hk=FC;function _Ge(t,e){if(t!==e){var n=t!==void 0,i=t===null,r=t===t,s=Hk(t),o=e!==void 0,a=e===null,l=e===e,c=Hk(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!s&&!c&&t<e||c&&n&&r&&!i&&!s||a&&n&&r||!o&&r||!l)return-1}return 0}var TGe=_Ge,XGe=TGe;function EGe(t,e,n){for(var i=-1,r=t.criteria,s=e.criteria,o=r.length,a=n.length;++i<o;){var l=XGe(r[i],s[i]);if(l){if(i>=a)return l;var c=n[i];return l*(c=="desc"?-1:1)}}return t.index-e.index}var YGe=EGe,TZ=J5,kGe=Q5,HGe=Pl,KGe=n7,LGe=FGe,zGe=H8,jGe=YGe,PGe=KC,OGe=io;function DGe(t,e,n){e.length?e=TZ(e,function(s){return OGe(s)?function(o){return kGe(o,s.length===1?s[0]:s)}:s}):e=[PGe];var i=-1;e=TZ(e,zGe(HGe));var r=KGe(t,function(s,o,a){var l=TZ(e,function(c){return c(s)});return{criteria:l,index:++i,value:s}});return LGe(r,function(s,o){return jGe(s,o,n)})}var UGe=DGe;function JGe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var QGe=JGe,qGe=QGe,Kk=Math.max;function $Ge(t,e,n){return e=Kk(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=Kk(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),qGe(t,this,a)}}var e2e=$Ge;function t2e(t){return function(){return t}}var n2e=t2e,i2e=Ih,r2e=function(){try{var t=i2e(Object,"defineProperty");return t({},"",{}),t}catch{}}(),i7=r2e,s2e=n2e,Lk=i7,o2e=KC,a2e=Lk?function(t,e){return Lk(t,"toString",{configurable:!0,enumerable:!1,value:s2e(e),writable:!0})}:o2e,l2e=a2e,c2e=800,g2e=16,u2e=Date.now;function d2e(t){var e=0,n=0;return function(){var i=u2e(),r=g2e-(i-n);if(n=i,r>0){if(++e>=c2e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var h2e=d2e,I2e=l2e,f2e=h2e,C2e=f2e(I2e),p2e=C2e,m2e=KC,A2e=e2e,y2e=p2e;function b2e(t,e){return y2e(A2e(t,e,m2e),t+"")}var v2e=b2e,x2e=P5,w2e=z0,G2e=lF,B2e=Au;function S2e(t,e,n){if(!B2e(n))return!1;var i=typeof e;return(i=="number"?w2e(n)&&G2e(e,n.length):i=="string"&&e in n)?x2e(n[e],t):!1}var xB=S2e,Z2e=e7,R2e=UGe,N2e=v2e,zk=xB,W2e=N2e(function(t,e){if(t==null)return[];var n=e.length;return n>1&&zk(t,e[0],e[1])?e=[]:n>2&&zk(e[0],e[1],e[2])&&(e=[e[0]]),R2e(t,Z2e(e,1),[])}),M2e=W2e;const dF=Pn(M2e);function wA(t){"@babel/helpers - typeof";return wA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wA(t)}function uM(){return uM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},uM.apply(this,arguments)}function V2e(t,e){return X2e(t)||T2e(t,e)||_2e(t,e)||F2e()}function F2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _2e(t,e){if(t){if(typeof t=="string")return jk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jk(t,e)}}function jk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function T2e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function X2e(t){if(Array.isArray(t))return t}function Pk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function XZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pk(Object(n),!0).forEach(function(i){E2e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function E2e(t,e,n){return e=Y2e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y2e(t){var e=k2e(t,"string");return wA(e)=="symbol"?e:e+""}function k2e(t,e){if(wA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(wA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H2e(t){return Array.isArray(t)&&dr(t[0])&&dr(t[1])?t.join(" ~ "):t}var K2e=function(e){var n=e.separator,i=n===void 0?" : ":n,r=e.contentStyle,s=r===void 0?{}:r,o=e.itemStyle,a=o===void 0?{}:o,l=e.labelStyle,c=l===void 0?{}:l,u=e.payload,d=e.formatter,h=e.itemSorter,I=e.wrapperClassName,p=e.labelClassName,y=e.label,A=e.labelFormatter,m=e.accessibilityLayer,b=m===void 0?!1:m,v=function(){if(u&&u.length){var T={padding:0,margin:0},H=(h?dF(u,h):u).map(function(K,z){if(K.type==="none")return null;var j=XZ({display:"block",paddingTop:4,paddingBottom:4,color:K.color||"#000"},a),O=K.formatter||d||H2e,_=K.value,E=K.name,P=_,q=E;if(O&&P!=null&&q!=null){var re=O(_,E,K,z,u);if(Array.isArray(re)){var de=V2e(re,2);P=de[0],q=de[1]}else P=re}return $.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:j},dr(q)?$.createElement("span",{className:"recharts-tooltip-item-name"},q):null,dr(q)?$.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,$.createElement("span",{className:"recharts-tooltip-item-value"},P),$.createElement("span",{className:"recharts-tooltip-item-unit"},K.unit||""))});return $.createElement("ul",{className:"recharts-tooltip-item-list",style:T},H)}return null},w=XZ({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),x=XZ({margin:0},c),B=!en(y),Z=B?y:"",N=ln("recharts-default-tooltip",I),W=ln("recharts-tooltip-label",p);B&&A&&u!==void 0&&u!==null&&(Z=A(y,u));var M=b?{role:"status","aria-live":"assertive"}:{};return $.createElement("div",uM({className:N,style:w},M),$.createElement("p",{className:W,style:x},$.isValidElement(Z)?Z:"".concat(Z)),v())};function GA(t){"@babel/helpers - typeof";return GA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GA(t)}function Xb(t,e,n){return e=L2e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L2e(t){var e=z2e(t,"string");return GA(e)=="symbol"?e:e+""}function z2e(t,e){if(GA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(GA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wp="recharts-tooltip-wrapper",j2e={visibility:"hidden"};function P2e(t){var e=t.coordinate,n=t.translateX,i=t.translateY;return ln(Wp,Xb(Xb(Xb(Xb({},"".concat(Wp,"-right"),ut(n)&&e&&ut(e.x)&&n>=e.x),"".concat(Wp,"-left"),ut(n)&&e&&ut(e.x)&&n<e.x),"".concat(Wp,"-bottom"),ut(i)&&e&&ut(e.y)&&i>=e.y),"".concat(Wp,"-top"),ut(i)&&e&&ut(e.y)&&i<e.y))}function Ok(t){var e=t.allowEscapeViewBox,n=t.coordinate,i=t.key,r=t.offsetTopLeft,s=t.position,o=t.reverseDirection,a=t.tooltipDimension,l=t.viewBox,c=t.viewBoxDimension;if(s&&ut(s[i]))return s[i];var u=n[i]-a-r,d=n[i]+r;if(e[i])return o[i]?u:d;if(o[i]){var h=u,I=l[i];return h<I?Math.max(d,l[i]):Math.max(u,l[i])}var p=d+a,y=l[i]+c;return p>y?Math.max(u,l[i]):Math.max(d,l[i])}function O2e(t){var e=t.translateX,n=t.translateY,i=t.useTranslate3d;return{transform:i?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function D2e(t){var e=t.allowEscapeViewBox,n=t.coordinate,i=t.offsetTopLeft,r=t.position,s=t.reverseDirection,o=t.tooltipBox,a=t.useTranslate3d,l=t.viewBox,c,u,d;return o.height>0&&o.width>0&&n?(u=Ok({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:i,position:r,reverseDirection:s,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),d=Ok({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:i,position:r,reverseDirection:s,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),c=O2e({translateX:u,translateY:d,useTranslate3d:a})):c=j2e,{cssProperties:c,cssClasses:P2e({translateX:u,translateY:d,coordinate:n})}}function Mf(t){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(t)}function Dk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Uk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Dk(Object(n),!0).forEach(function(i){hM(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function U2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J2e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s7(i.key),i)}}function Q2e(t,e,n){return e&&J2e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function q2e(t,e,n){return e=Sw(e),$2e(t,r7()?Reflect.construct(e,n||[],Sw(t).constructor):e.apply(t,n))}function $2e(t,e){if(e&&(Mf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eBe(t)}function eBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r7(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r7=function(){return!!t})()}function Sw(t){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Sw(t)}function tBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dM(t,e)}function dM(t,e){return dM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},dM(t,e)}function hM(t,e,n){return e=s7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s7(t){var e=nBe(t,"string");return Mf(e)=="symbol"?e:e+""}function nBe(t,e){if(Mf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Mf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jk=1,iBe=function(t){function e(){var n;U2e(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=q2e(this,e,[].concat(r)),hM(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),hM(n,"handleKeyDown",function(o){if(o.key==="Escape"){var a,l,c,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&a!==void 0?a:0,y:(c=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0}})}}),n}return tBe(e,t),Q2e(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>Jk||Math.abs(i.height-this.state.lastBoundingBox.height)>Jk)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,r=this.props,s=r.active,o=r.allowEscapeViewBox,a=r.animationDuration,l=r.animationEasing,c=r.children,u=r.coordinate,d=r.hasPayload,h=r.isAnimationActive,I=r.offset,p=r.position,y=r.reverseDirection,A=r.useTranslate3d,m=r.viewBox,b=r.wrapperStyle,v=D2e({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:I,position:p,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:A,viewBox:m}),w=v.cssClasses,x=v.cssProperties,B=Uk(Uk({transition:h&&s?"transform ".concat(a,"ms ").concat(l):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&d?"visible":"hidden",position:"absolute",top:0,left:0},b);return $.createElement("div",{tabIndex:-1,className:w,style:B,ref:function(N){i.wrapperNode=N}},c)}}])}(S.PureComponent),rBe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},ra={isSsr:rBe(),get:function(e){return ra[e]},set:function(e,n){if(typeof e=="string")ra[e]=n;else{var i=Object.keys(e);i&&i.length&&i.forEach(function(r){ra[r]=e[r]})}}};function Vf(t){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vf(t)}function Qk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function qk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Qk(Object(n),!0).forEach(function(i){hF(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function sBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oBe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,a7(i.key),i)}}function aBe(t,e,n){return e&&oBe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lBe(t,e,n){return e=Zw(e),cBe(t,o7()?Reflect.construct(e,n||[],Zw(t).constructor):e.apply(t,n))}function cBe(t,e){if(e&&(Vf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gBe(t)}function gBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o7(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(o7=function(){return!!t})()}function Zw(t){return Zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zw(t)}function uBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IM(t,e)}function IM(t,e){return IM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},IM(t,e)}function hF(t,e,n){return e=a7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a7(t){var e=dBe(t,"string");return Vf(e)=="symbol"?e:e+""}function dBe(t,e){if(Vf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Vf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hBe(t){return t.dataKey}function IBe(t,e){return $.isValidElement(t)?$.cloneElement(t,e):typeof t=="function"?$.createElement(t,e):$.createElement(K2e,e)}var qn=function(t){function e(){return sBe(this,e),lBe(this,e,arguments)}return uBe(e,t),aBe(e,[{key:"render",value:function(){var i=this,r=this.props,s=r.active,o=r.allowEscapeViewBox,a=r.animationDuration,l=r.animationEasing,c=r.content,u=r.coordinate,d=r.filterNull,h=r.isAnimationActive,I=r.offset,p=r.payload,y=r.payloadUniqBy,A=r.position,m=r.reverseDirection,b=r.useTranslate3d,v=r.viewBox,w=r.wrapperStyle,x=p??[];d&&x.length&&(x=J8(p.filter(function(Z){return Z.value!=null&&(Z.hide!==!0||i.props.includeHidden)}),y,hBe));var B=x.length>0;return $.createElement(iBe,{allowEscapeViewBox:o,animationDuration:a,animationEasing:l,isAnimationActive:h,active:s,coordinate:u,hasPayload:B,offset:I,position:A,reverseDirection:m,useTranslate3d:b,viewBox:v,wrapperStyle:w},IBe(c,qk(qk({},this.props),{},{payload:x})))}}])}(S.PureComponent);hF(qn,"displayName","Tooltip");hF(qn,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!ra.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var fBe=jl,CBe=function(){return fBe.Date.now()},pBe=CBe,mBe=/\s/;function ABe(t){for(var e=t.length;e--&&mBe.test(t.charAt(e)););return e}var yBe=ABe,bBe=yBe,vBe=/^\s+/;function xBe(t){return t&&t.slice(0,bBe(t)+1).replace(vBe,"")}var wBe=xBe,GBe=wBe,$k=Au,BBe=FC,eH=NaN,SBe=/^[-+]0x[0-9a-f]+$/i,ZBe=/^0b[01]+$/i,RBe=/^0o[0-7]+$/i,NBe=parseInt;function WBe(t){if(typeof t=="number")return t;if(BBe(t))return eH;if($k(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=$k(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=GBe(t);var n=ZBe.test(t);return n||RBe.test(t)?NBe(t.slice(2),n?2:8):SBe.test(t)?eH:+t}var l7=WBe,MBe=Au,EZ=pBe,tH=l7,VBe="Expected a function",FBe=Math.max,_Be=Math.min;function TBe(t,e,n){var i,r,s,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(VBe);e=tH(e)||0,MBe(n)&&(u=!!n.leading,d="maxWait"in n,s=d?FBe(tH(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function I(B){var Z=i,N=r;return i=r=void 0,c=B,o=t.apply(N,Z),o}function p(B){return c=B,a=setTimeout(m,e),u?I(B):o}function y(B){var Z=B-l,N=B-c,W=e-Z;return d?_Be(W,s-N):W}function A(B){var Z=B-l,N=B-c;return l===void 0||Z>=e||Z<0||d&&N>=s}function m(){var B=EZ();if(A(B))return b(B);a=setTimeout(m,y(B))}function b(B){return a=void 0,h&&i?I(B):(i=r=void 0,o)}function v(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function w(){return a===void 0?o:b(EZ())}function x(){var B=EZ(),Z=A(B);if(i=arguments,r=this,l=B,Z){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(m,e),I(l)}return a===void 0&&(a=setTimeout(m,e)),o}return x.cancel=v,x.flush=w,x}var XBe=TBe,EBe=XBe,YBe=Au,kBe="Expected a function";function HBe(t,e,n){var i=!0,r=!0;if(typeof t!="function")throw new TypeError(kBe);return YBe(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),EBe(t,e,{leading:i,maxWait:e,trailing:r})}var KBe=HBe;const c7=Pn(KBe);function BA(t){"@babel/helpers - typeof";return BA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BA(t)}function nH(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Eb(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nH(Object(n),!0).forEach(function(i){LBe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nH(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function LBe(t,e,n){return e=zBe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zBe(t){var e=jBe(t,"string");return BA(e)=="symbol"?e:e+""}function jBe(t,e){if(BA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(BA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PBe(t,e){return JBe(t)||UBe(t,e)||DBe(t,e)||OBe()}function OBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DBe(t,e){if(t){if(typeof t=="string")return iH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iH(t,e)}}function iH(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function UBe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function JBe(t){if(Array.isArray(t))return t}var Ai=S.forwardRef(function(t,e){var n=t.aspect,i=t.initialDimension,r=i===void 0?{width:-1,height:-1}:i,s=t.width,o=s===void 0?"100%":s,a=t.height,l=a===void 0?"100%":a,c=t.minWidth,u=c===void 0?0:c,d=t.minHeight,h=t.maxHeight,I=t.children,p=t.debounce,y=p===void 0?0:p,A=t.id,m=t.className,b=t.onResize,v=t.style,w=v===void 0?{}:v,x=S.useRef(null),B=S.useRef();B.current=b,S.useImperativeHandle(e,function(){return Object.defineProperty(x.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),x.current},configurable:!0})});var Z=S.useState({containerWidth:r.width,containerHeight:r.height}),N=PBe(Z,2),W=N[0],M=N[1],F=S.useCallback(function(H,K){M(function(z){var j=Math.round(H),O=Math.round(K);return z.containerWidth===j&&z.containerHeight===O?z:{containerWidth:j,containerHeight:O}})},[]);S.useEffect(function(){var H=function(E){var P,q=E[0].contentRect,re=q.width,de=q.height;F(re,de),(P=B.current)===null||P===void 0||P.call(B,re,de)};y>0&&(H=c7(H,y,{trailing:!0,leading:!1}));var K=new ResizeObserver(H),z=x.current.getBoundingClientRect(),j=z.width,O=z.height;return F(j,O),K.observe(x.current),function(){K.disconnect()}},[F,y]);var T=S.useMemo(function(){var H=W.containerWidth,K=W.containerHeight;if(H<0||K<0)return null;Pa(fd(o)||fd(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),Pa(!n||n>0,"The aspect(%s) must be greater than zero.",n);var z=fd(o)?H:o,j=fd(l)?K:l;n&&n>0&&(z?j=z/n:j&&(z=j*n),h&&j>h&&(j=h)),Pa(z>0||j>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,z,j,o,l,u,d,n);var O=!Array.isArray(I)&&Rc(I.type).endsWith("Chart");return $.Children.map(I,function(_){return $.isValidElement(_)?S.cloneElement(_,Eb({width:z,height:j},O?{style:Eb({height:"100%",width:"100%",maxHeight:j,maxWidth:z},_.props.style)}:{})):_})},[n,I,l,h,d,u,W,o]);return $.createElement("div",{id:A?"".concat(A):void 0,className:ln("recharts-responsive-container",m),style:Eb(Eb({},w),{},{width:o,height:l,minWidth:u,minHeight:d,maxHeight:h}),ref:x},T)}),j0=function(e){return null};j0.displayName="Cell";function SA(t){"@babel/helpers - typeof";return SA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SA(t)}function rH(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function fM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rH(Object(n),!0).forEach(function(i){QBe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rH(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function QBe(t,e,n){return e=qBe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qBe(t){var e=$Be(t,"string");return SA(e)=="symbol"?e:e+""}function $Be(t,e){if(SA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(SA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Kh={widthCache:{},cacheCount:0},eSe=2e3,tSe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},sH="recharts_measurement_span";function nSe(t){var e=fM({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var Vm=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||ra.isSsr)return{width:0,height:0};var i=nSe(n),r=JSON.stringify({text:e,copyStyle:i});if(Kh.widthCache[r])return Kh.widthCache[r];try{var s=document.getElementById(sH);s||(s=document.createElement("span"),s.setAttribute("id",sH),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var o=fM(fM({},tSe),i);Object.assign(s.style,o),s.textContent="".concat(e);var a=s.getBoundingClientRect(),l={width:a.width,height:a.height};return Kh.widthCache[r]=l,++Kh.cacheCount>eSe&&(Kh.cacheCount=0,Kh.widthCache={}),l}catch{return{width:0,height:0}}},iSe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function ZA(t){"@babel/helpers - typeof";return ZA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZA(t)}function Rw(t,e){return aSe(t)||oSe(t,e)||sSe(t,e)||rSe()}function rSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sSe(t,e){if(t){if(typeof t=="string")return oH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oH(t,e)}}function oH(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function oSe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function aSe(t){if(Array.isArray(t))return t}function lSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aH(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,gSe(i.key),i)}}function cSe(t,e,n){return e&&aH(t.prototype,e),n&&aH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gSe(t){var e=uSe(t,"string");return ZA(e)=="symbol"?e:e+""}function uSe(t,e){if(ZA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(ZA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var lH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,dSe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,hSe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,g7={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ISe=Object.keys(g7),ZI="NaN";function fSe(t,e){return t*g7[e]}var Yb=function(){function t(e,n){lSe(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!dSe.test(n)&&(this.num=NaN,this.unit=""),ISe.includes(n)&&(this.num=fSe(e,n),this.unit="px")}return cSe(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,r=(i=hSe.exec(n))!==null&&i!==void 0?i:[],s=Rw(r,3),o=s[1],a=s[2];return new t(parseFloat(o),a??"")}}])}();function u7(t){if(t.includes(ZI))return ZI;for(var e=t;e.includes("*")||e.includes("/");){var n,i=(n=lH.exec(e))!==null&&n!==void 0?n:[],r=Rw(i,4),s=r[1],o=r[2],a=r[3],l=Yb.parse(s??""),c=Yb.parse(a??""),u=o==="*"?l.multiply(c):l.divide(c);if(u.isNaN())return ZI;e=e.replace(lH,u.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,h=(d=cH.exec(e))!==null&&d!==void 0?d:[],I=Rw(h,4),p=I[1],y=I[2],A=I[3],m=Yb.parse(p??""),b=Yb.parse(A??""),v=y==="+"?m.add(b):m.subtract(b);if(v.isNaN())return ZI;e=e.replace(cH,v.toString())}return e}var gH=/\(([^()]*)\)/;function CSe(t){for(var e=t;e.includes("(");){var n=gH.exec(e),i=Rw(n,2),r=i[1];e=e.replace(gH,u7(r))}return e}function pSe(t){var e=t.replace(/\s+/g,"");return e=CSe(e),e=u7(e),e}function mSe(t){try{return pSe(t)}catch{return ZI}}function YZ(t){var e=mSe(t.slice(5,-1));return e===ZI?"":e}var ASe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ySe=["dx","dy","angle","className","breakAll"];function CM(){return CM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},CM.apply(this,arguments)}function uH(t,e){if(t==null)return{};var n=bSe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function bSe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function dH(t,e){return GSe(t)||wSe(t,e)||xSe(t,e)||vSe()}function vSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xSe(t,e){if(t){if(typeof t=="string")return hH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hH(t,e)}}function hH(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function wSe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function GSe(t){if(Array.isArray(t))return t}var d7=/[ \f\n\r\t\v\u2028\u2029]+/,h7=function(e){var n=e.children,i=e.breakAll,r=e.style;try{var s=[];en(n)||(i?s=n.toString().split(""):s=n.toString().split(d7));var o=s.map(function(l){return{word:l,width:Vm(l,r).width}}),a=i?0:Vm("",r).width;return{wordsWithComputedWidth:o,spaceWidth:a}}catch{return null}},BSe=function(e,n,i,r,s){var o=e.maxLines,a=e.children,l=e.style,c=e.breakAll,u=ut(o),d=a,h=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return z.reduce(function(j,O){var _=O.word,E=O.width,P=j[j.length-1];if(P&&(r==null||s||P.width+E+i<Number(r)))P.words.push(_),P.width+=E+i;else{var q={words:[_],width:E};j.push(q)}return j},[])},I=h(n),p=function(z){return z.reduce(function(j,O){return j.width>O.width?j:O})};if(!u)return I;for(var y="",A=function(z){var j=d.slice(0,z),O=h7({breakAll:c,style:l,children:j+y}).wordsWithComputedWidth,_=h(O),E=_.length>o||p(_).width>Number(r);return[E,_]},m=0,b=d.length-1,v=0,w;m<=b&&v<=d.length-1;){var x=Math.floor((m+b)/2),B=x-1,Z=A(B),N=dH(Z,2),W=N[0],M=N[1],F=A(x),T=dH(F,1),H=T[0];if(!W&&!H&&(m=x+1),W&&H&&(b=x-1),!W&&H){w=M;break}v++}return w||I},IH=function(e){var n=en(e)?[]:e.toString().split(d7);return[{words:n}]},SSe=function(e){var n=e.width,i=e.scaleToFit,r=e.children,s=e.style,o=e.breakAll,a=e.maxLines;if((n||i)&&!ra.isSsr){var l,c,u=h7({breakAll:o,children:r,style:s});if(u){var d=u.wordsWithComputedWidth,h=u.spaceWidth;l=d,c=h}else return IH(r);return BSe({breakAll:o,children:r,maxLines:a,style:s},l,c,n,i)}return IH(r)},fH="#808080",$d=function(e){var n=e.x,i=n===void 0?0:n,r=e.y,s=r===void 0?0:r,o=e.lineHeight,a=o===void 0?"1em":o,l=e.capHeight,c=l===void 0?"0.71em":l,u=e.scaleToFit,d=u===void 0?!1:u,h=e.textAnchor,I=h===void 0?"start":h,p=e.verticalAnchor,y=p===void 0?"end":p,A=e.fill,m=A===void 0?fH:A,b=uH(e,ASe),v=S.useMemo(function(){return SSe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:d,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,d,b.style,b.width]),w=b.dx,x=b.dy,B=b.angle,Z=b.className,N=b.breakAll,W=uH(b,ySe);if(!dr(i)||!dr(s))return null;var M=i+(ut(w)?w:0),F=s+(ut(x)?x:0),T;switch(y){case"start":T=YZ("calc(".concat(c,")"));break;case"middle":T=YZ("calc(".concat((v.length-1)/2," * -").concat(a," + (").concat(c," / 2))"));break;default:T=YZ("calc(".concat(v.length-1," * -").concat(a,")"));break}var H=[];if(d){var K=v[0].width,z=b.width;H.push("scale(".concat((ut(z)?z/K:1)/K,")"))}return B&&H.push("rotate(".concat(B,", ").concat(M,", ").concat(F,")")),H.length&&(W.transform=H.join(" ")),$.createElement("text",CM({},Yt(W,!0),{x:M,y:F,className:ln("recharts-text",Z),textAnchor:I,fill:m.includes("url")?fH:m}),v.map(function(j,O){var _=j.words.join(N?"":" ");return $.createElement("tspan",{x:M,dy:O===0?T:a,key:"".concat(_,"-").concat(O)},_)}))};function Jg(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZSe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function IF(t){let e,n,i;t.length!==2?(e=Jg,n=(a,l)=>Jg(t(a),l),i=(a,l)=>t(a)-l):(e=t===Jg||t===ZSe?t:RSe,n=t,i=t);function r(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<0?c=d+1:u=d}while(c<u)}return c}function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function o(a,l,c=0,u=a.length){const d=r(a,l,c,u-1);return d>c&&i(a[d-1],l)>-i(a[d],l)?d-1:d}return{left:r,center:o,right:s}}function RSe(){return 0}function I7(t){return t===null?NaN:+t}function*NSe(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const WSe=IF(Jg),P0=WSe.right;IF(I7).center;class CH extends Map{constructor(e,n=FSe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(pH(this,e))}has(e){return super.has(pH(this,e))}set(e,n){return super.set(MSe(this,e),n)}delete(e){return super.delete(VSe(this,e))}}function pH({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function MSe({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function VSe({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function FSe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function _Se(t=Jg){if(t===Jg)return f7;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||i===0?i:(t(n,n)===0)-(t(e,e)===0)}}function f7(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const TSe=Math.sqrt(50),XSe=Math.sqrt(10),ESe=Math.sqrt(2);function Nw(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=TSe?10:s>=XSe?5:s>=ESe?2:1;let a,l,c;return r<0?(c=Math.pow(10,-r)/o,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*o,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=n&&n<2?Nw(t,e,n*2):[a,l,c]}function pM(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,o]=i?Nw(e,t,n):Nw(t,e,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let c=0;c<a;++c)l[c]=(s-c)/-o;else for(let c=0;c<a;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(r+c)/-o;else for(let c=0;c<a;++c)l[c]=(r+c)*o;return l}function mM(t,e,n){return e=+e,t=+t,n=+n,Nw(t,e,n)[2]}function AM(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?mM(e,t,n):mM(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function mH(t,e){let n;for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function AH(t,e){let n;for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function C7(t,e,n=0,i=1/0,r){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=e&&e<=i))return t;for(r=r===void 0?f7:_Se(r);i>n;){if(i-n>600){const l=i-n+1,c=e-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),I=Math.max(n,Math.floor(e-c*d/l+h)),p=Math.min(i,Math.floor(e+(l-c)*d/l+h));C7(t,e,I,p,r)}const s=t[e];let o=n,a=i;for(Mp(t,n,e),r(t[i],s)>0&&Mp(t,n,i);o<a;){for(Mp(t,o,a),++o,--a;r(t[o],s)<0;)++o;for(;r(t[a],s)>0;)--a}r(t[n],s)===0?Mp(t,n,a):(++a,Mp(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}return t}function Mp(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function YSe(t,e,n){if(t=Float64Array.from(NSe(t)),!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return AH(t);if(e>=1)return mH(t);var i,r=(i-1)*e,s=Math.floor(r),o=mH(C7(t,s).subarray(0,s+1)),a=AH(t.subarray(s+1));return o+(a-o)*(r-s)}}function kSe(t,e,n=I7){if(!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,s=Math.floor(r),o=+n(t[s],s,t),a=+n(t[s+1],s+1,t);return o+(a-o)*(r-s)}}function HSe(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}function da(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Oc(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const yM=Symbol("implicit");function fF(){var t=new CH,e=[],n=[],i=yM;function r(s){let o=t.get(s);if(o===void 0){if(i!==yM)return i;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new CH;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return fF(e,n).unknown(i)},da.apply(r,arguments),r}function RA(){var t=fF().unknown(void 0),e=t.domain,n=t.range,i=0,r=1,s,o,a=!1,l=0,c=0,u=.5;delete t.unknown;function d(){var h=e().length,I=r<i,p=I?r:i,y=I?i:r;s=(y-p)/Math.max(1,h-l+c*2),a&&(s=Math.floor(s)),p+=(y-p-s*(h-l))*u,o=s*(1-l),a&&(p=Math.round(p),o=Math.round(o));var A=HSe(h).map(function(m){return p+s*m});return n(I?A.reverse():A)}return t.domain=function(h){return arguments.length?(e(h),d()):e()},t.range=function(h){return arguments.length?([i,r]=h,i=+i,r=+r,d()):[i,r]},t.rangeRound=function(h){return[i,r]=h,i=+i,r=+r,a=!0,d()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(h){return arguments.length?(a=!!h,d()):a},t.padding=function(h){return arguments.length?(l=Math.min(1,c=+h),d()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},t.paddingOuter=function(h){return arguments.length?(c=+h,d()):c},t.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),d()):u},t.copy=function(){return RA(e(),[i,r]).round(a).paddingInner(l).paddingOuter(c).align(u)},da.apply(d(),arguments)}function p7(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return p7(e())},t}function Fm(){return p7(RA.apply(null,arguments).paddingInner(1))}function CF(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function m7(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function O0(){}var NA=.7,Ww=1/NA,QI="\\s*([+-]?\\d+)\\s*",WA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",KSe=/^#([0-9a-f]{3,8})$/,LSe=new RegExp(`^rgb\\(${QI},${QI},${QI}\\)$`),zSe=new RegExp(`^rgb\\(${Fl},${Fl},${Fl}\\)$`),jSe=new RegExp(`^rgba\\(${QI},${QI},${QI},${WA}\\)$`),PSe=new RegExp(`^rgba\\(${Fl},${Fl},${Fl},${WA}\\)$`),OSe=new RegExp(`^hsl\\(${WA},${Fl},${Fl}\\)$`),DSe=new RegExp(`^hsla\\(${WA},${Fl},${Fl},${WA}\\)$`),yH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};CF(O0,MA,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bH,formatHex:bH,formatHex8:USe,formatHsl:JSe,formatRgb:vH,toString:vH});function bH(){return this.rgb().formatHex()}function USe(){return this.rgb().formatHex8()}function JSe(){return A7(this).formatHsl()}function vH(){return this.rgb().formatRgb()}function MA(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=KSe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xH(e):n===3?new Qs(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?kb(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?kb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=LSe.exec(t))?new Qs(e[1],e[2],e[3],1):(e=zSe.exec(t))?new Qs(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=jSe.exec(t))?kb(e[1],e[2],e[3],e[4]):(e=PSe.exec(t))?kb(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=OSe.exec(t))?BH(e[1],e[2]/100,e[3]/100,1):(e=DSe.exec(t))?BH(e[1],e[2]/100,e[3]/100,e[4]):yH.hasOwnProperty(t)?xH(yH[t]):t==="transparent"?new Qs(NaN,NaN,NaN,0):null}function xH(t){return new Qs(t>>16&255,t>>8&255,t&255,1)}function kb(t,e,n,i){return i<=0&&(t=e=n=NaN),new Qs(t,e,n,i)}function QSe(t){return t instanceof O0||(t=MA(t)),t?(t=t.rgb(),new Qs(t.r,t.g,t.b,t.opacity)):new Qs}function bM(t,e,n,i){return arguments.length===1?QSe(t):new Qs(t,e,n,i??1)}function Qs(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}CF(Qs,bM,m7(O0,{brighter(t){return t=t==null?Ww:Math.pow(Ww,t),new Qs(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?NA:Math.pow(NA,t),new Qs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Qs(_d(this.r),_d(this.g),_d(this.b),Mw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wH,formatHex:wH,formatHex8:qSe,formatRgb:GH,toString:GH}));function wH(){return`#${Cd(this.r)}${Cd(this.g)}${Cd(this.b)}`}function qSe(){return`#${Cd(this.r)}${Cd(this.g)}${Cd(this.b)}${Cd((isNaN(this.opacity)?1:this.opacity)*255)}`}function GH(){const t=Mw(this.opacity);return`${t===1?"rgb(":"rgba("}${_d(this.r)}, ${_d(this.g)}, ${_d(this.b)}${t===1?")":`, ${t})`}`}function Mw(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function _d(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Cd(t){return t=_d(t),(t<16?"0":"")+t.toString(16)}function BH(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ya(t,e,n,i)}function A7(t){if(t instanceof Ya)return new Ya(t.h,t.s,t.l,t.opacity);if(t instanceof O0||(t=MA(t)),!t)return new Ya;if(t instanceof Ya)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ya(o,a,l,t.opacity)}function $Se(t,e,n,i){return arguments.length===1?A7(t):new Ya(t,e,n,i??1)}function Ya(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}CF(Ya,$Se,m7(O0,{brighter(t){return t=t==null?Ww:Math.pow(Ww,t),new Ya(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?NA:Math.pow(NA,t),new Ya(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Qs(kZ(t>=240?t-240:t+120,r,i),kZ(t,r,i),kZ(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Ya(SH(this.h),Hb(this.s),Hb(this.l),Mw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Mw(this.opacity);return`${t===1?"hsl(":"hsla("}${SH(this.h)}, ${Hb(this.s)*100}%, ${Hb(this.l)*100}%${t===1?")":`, ${t})`}`}}));function SH(t){return t=(t||0)%360,t<0?t+360:t}function Hb(t){return Math.max(0,Math.min(1,t||0))}function kZ(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const pF=t=>()=>t;function e1e(t,e){return function(n){return t+n*e}}function t1e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function n1e(t){return(t=+t)==1?y7:function(e,n){return n-e?t1e(e,n,t):pF(isNaN(e)?n:e)}}function y7(t,e){var n=e-t;return n?e1e(t,n):pF(isNaN(t)?e:t)}const ZH=function t(e){var n=n1e(e);function i(r,s){var o=n((r=bM(r)).r,(s=bM(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),c=y7(r.opacity,s.opacity);return function(u){return r.r=o(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return i.gamma=t,i}(1);function i1e(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function r1e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s1e(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=LC(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function o1e(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Vw(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function a1e(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=LC(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var vM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,HZ=new RegExp(vM.source,"g");function l1e(t){return function(){return t}}function c1e(t){return function(e){return t(e)+""}}function g1e(t,e){var n=vM.lastIndex=HZ.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(i=vM.exec(t))&&(r=HZ.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Vw(i,r)})),n=HZ.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?c1e(l[0].x):l1e(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}function LC(t,e){var n=typeof e,i;return e==null||n==="boolean"?pF(e):(n==="number"?Vw:n==="string"?(i=MA(e))?(e=i,ZH):g1e:e instanceof MA?ZH:e instanceof Date?o1e:r1e(e)?i1e:Array.isArray(e)?s1e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?a1e:Vw)(t,e)}function mF(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function u1e(t,e){e===void 0&&(e=t,t=LC);for(var n=0,i=e.length-1,r=e[0],s=new Array(i<0?0:i);n<i;)s[n]=t(r,r=e[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function d1e(t){return function(){return t}}function Fw(t){return+t}var RH=[0,1];function vs(t){return t}function xM(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:d1e(isNaN(e)?NaN:.5)}function h1e(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function I1e(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=xM(r,i),s=n(o,s)):(i=xM(i,r),s=n(s,o)),function(a){return s(i(a))}}function f1e(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=xM(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var l=P0(t,a,1,i)-1;return s[l](r[l](a))}}function D0(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function wB(){var t=RH,e=RH,n=LC,i,r,s,o=vs,a,l,c;function u(){var h=Math.min(t.length,e.length);return o!==vs&&(o=h1e(t[0],t[h-1])),a=h>2?f1e:I1e,l=c=null,d}function d(h){return h==null||isNaN(h=+h)?s:(l||(l=a(t.map(i),e,n)))(i(o(h)))}return d.invert=function(h){return o(r((c||(c=a(e,t.map(i),Vw)))(h)))},d.domain=function(h){return arguments.length?(t=Array.from(h,Fw),u()):t.slice()},d.range=function(h){return arguments.length?(e=Array.from(h),u()):e.slice()},d.rangeRound=function(h){return e=Array.from(h),n=mF,u()},d.clamp=function(h){return arguments.length?(o=h?!0:vs,u()):o!==vs},d.interpolate=function(h){return arguments.length?(n=h,u()):n},d.unknown=function(h){return arguments.length?(s=h,d):s},function(h,I){return i=h,r=I,u()}}function AF(){return wB()(vs,vs)}function C1e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function _w(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Ff(t){return t=_w(Math.abs(t)),t?t[1]:NaN}function p1e(t,e){return function(n,i){for(var r=n.length,s=[],o=0,a=t[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function m1e(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var A1e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function VA(t){if(!(e=A1e.exec(t)))throw new Error("invalid format: "+t);var e;return new yF({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}VA.prototype=yF.prototype;function yF(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}yF.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function y1e(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var b7;function b1e(t,e){var n=_w(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(b7=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+_w(t,Math.max(0,e+s-1))[0]}function NH(t,e){var n=_w(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const WH={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:C1e,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>NH(t*100,e),r:NH,s:b1e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function MH(t){return t}var VH=Array.prototype.map,FH=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function v1e(t){var e=t.grouping===void 0||t.thousands===void 0?MH:p1e(VH.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?MH:m1e(VH.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(d){d=VA(d);var h=d.fill,I=d.align,p=d.sign,y=d.symbol,A=d.zero,m=d.width,b=d.comma,v=d.precision,w=d.trim,x=d.type;x==="n"?(b=!0,x="g"):WH[x]||(v===void 0&&(v=12),w=!0,x="g"),(A||h==="0"&&I==="=")&&(A=!0,h="0",I="=");var B=y==="$"?n:y==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",Z=y==="$"?i:/[%p]/.test(x)?o:"",N=WH[x],W=/[defgprs%]/.test(x);v=v===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function M(F){var T=B,H=Z,K,z,j;if(x==="c")H=N(F)+H,F="";else{F=+F;var O=F<0||1/F<0;if(F=isNaN(F)?l:N(Math.abs(F),v),w&&(F=y1e(F)),O&&+F==0&&p!=="+"&&(O=!1),T=(O?p==="("?p:a:p==="-"||p==="("?"":p)+T,H=(x==="s"?FH[8+b7/3]:"")+H+(O&&p==="("?")":""),W){for(K=-1,z=F.length;++K<z;)if(j=F.charCodeAt(K),48>j||j>57){H=(j===46?r+F.slice(K+1):F.slice(K))+H,F=F.slice(0,K);break}}}b&&!A&&(F=e(F,1/0));var _=T.length+F.length+H.length,E=_<m?new Array(m-_+1).join(h):"";switch(b&&A&&(F=e(E+F,E.length?m-H.length:1/0),E=""),I){case"<":F=T+F+H+E;break;case"=":F=T+E+F+H;break;case"^":F=E.slice(0,_=E.length>>1)+T+F+H+E.slice(_);break;default:F=E+T+F+H;break}return s(F)}return M.toString=function(){return d+""},M}function u(d,h){var I=c((d=VA(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(Ff(h)/3)))*3,y=Math.pow(10,-p),A=FH[8+p/3];return function(m){return I(y*m)+A}}return{format:c,formatPrefix:u}}var Kb,bF,v7;x1e({thousands:",",grouping:[3],currency:["$",""]});function x1e(t){return Kb=v1e(t),bF=Kb.format,v7=Kb.formatPrefix,Kb}function w1e(t){return Math.max(0,-Ff(Math.abs(t)))}function G1e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ff(e)/3)))*3-Ff(Math.abs(t)))}function B1e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ff(e)-Ff(t))+1}function x7(t,e,n,i){var r=AM(t,e,n),s;switch(i=VA(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=G1e(r,o))&&(i.precision=s),v7(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=B1e(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=w1e(r))&&(i.precision=s-(i.type==="%")*2);break}}return bF(i)}function bu(t){var e=t.domain;return t.ticks=function(n){var i=e();return pM(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return x7(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,o=i[r],a=i[s],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=r,r=s,s=c);u-- >0;){if(c=mM(o,a,n),c===l)return i[r]=o,i[s]=a,e(i);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return t},t}function Tw(){var t=AF();return t.copy=function(){return D0(t,Tw())},da.apply(t,arguments),bu(t)}function w7(t){var e;function n(i){return i==null||isNaN(i=+i)?e:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(t=Array.from(i,Fw),n):t.slice()},n.unknown=function(i){return arguments.length?(e=i,n):e},n.copy=function(){return w7(t).unknown(e)},t=arguments.length?Array.from(t,Fw):[0,1],bu(n)}function G7(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],s=t[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),t[n]=e.floor(r),t[i]=e.ceil(s),t}function _H(t){return Math.log(t)}function TH(t){return Math.exp(t)}function S1e(t){return-Math.log(-t)}function Z1e(t){return-Math.exp(-t)}function R1e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function N1e(t){return t===10?R1e:t===Math.E?Math.exp:e=>Math.pow(t,e)}function W1e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function XH(t){return(e,n)=>-t(-e,n)}function vF(t){const e=t(_H,TH),n=e.domain;let i=10,r,s;function o(){return r=W1e(i),s=N1e(i),n()[0]<0?(r=XH(r),s=XH(s),t(S1e,Z1e)):t(_H,TH),e}return e.base=function(a){return arguments.length?(i=+a,o()):i},e.domain=function(a){return arguments.length?(n(a),o()):n()},e.ticks=a=>{const l=n();let c=l[0],u=l[l.length-1];const d=u<c;d&&([c,u]=[u,c]);let h=r(c),I=r(u),p,y;const A=a==null?10:+a;let m=[];if(!(i%1)&&I-h<A){if(h=Math.floor(h),I=Math.ceil(I),c>0){for(;h<=I;++h)for(p=1;p<i;++p)if(y=h<0?p/s(-h):p*s(h),!(y<c)){if(y>u)break;m.push(y)}}else for(;h<=I;++h)for(p=i-1;p>=1;--p)if(y=h>0?p/s(-h):p*s(h),!(y<c)){if(y>u)break;m.push(y)}m.length*2<A&&(m=pM(c,u,A))}else m=pM(h,I,Math.min(I-h,A)).map(s);return d?m.reverse():m},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=VA(l)).precision==null&&(l.trim=!0),l=bF(l)),a===1/0)return l;const c=Math.max(1,i*a/e.ticks().length);return u=>{let d=u/s(Math.round(r(u)));return d*i<i-.5&&(d*=i),d<=c?l(u):""}},e.nice=()=>n(G7(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),e}function B7(){const t=vF(wB()).domain([1,10]);return t.copy=()=>D0(t,B7()).base(t.base()),da.apply(t,arguments),t}function EH(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function YH(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function xF(t){var e=1,n=t(EH(e),YH(e));return n.constant=function(i){return arguments.length?t(EH(e=+i),YH(e)):e},bu(n)}function S7(){var t=xF(wB());return t.copy=function(){return D0(t,S7()).constant(t.constant())},da.apply(t,arguments)}function kH(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function M1e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function V1e(t){return t<0?-t*t:t*t}function wF(t){var e=t(vs,vs),n=1;function i(){return n===1?t(vs,vs):n===.5?t(M1e,V1e):t(kH(n),kH(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},bu(e)}function GF(){var t=wF(wB());return t.copy=function(){return D0(t,GF()).exponent(t.exponent())},da.apply(t,arguments),t}function F1e(){return GF.apply(null,arguments).exponent(.5)}function HH(t){return Math.sign(t)*t*t}function _1e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Z7(){var t=AF(),e=[0,1],n=!1,i;function r(s){var o=_1e(t(s));return isNaN(o)?i:n?Math.round(o):o}return r.invert=function(s){return t.invert(HH(s))},r.domain=function(s){return arguments.length?(t.domain(s),r):t.domain()},r.range=function(s){return arguments.length?(t.range((e=Array.from(s,Fw)).map(HH)),r):e.slice()},r.rangeRound=function(s){return r.range(s).round(!0)},r.round=function(s){return arguments.length?(n=!!s,r):n},r.clamp=function(s){return arguments.length?(t.clamp(s),r):t.clamp()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return Z7(t.domain(),e).round(n).clamp(t.clamp()).unknown(i)},da.apply(r,arguments),bu(r)}function R7(){var t=[],e=[],n=[],i;function r(){var o=0,a=Math.max(1,e.length);for(n=new Array(a-1);++o<a;)n[o-1]=kSe(t,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:e[P0(n,o)]}return s.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let a of o)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Jg),r()},s.range=function(o){return arguments.length?(e=Array.from(o),r()):e.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return R7().domain(t).range(e).unknown(i)},da.apply(s,arguments)}function N7(){var t=0,e=1,n=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[P0(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*e-(l-n)*t)/(n+1);return o}return o.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,a()):[t,e]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var c=r.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,i[0]]:c>=n?[i[n-1],e]:[i[c-1],i[c]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return N7().domain([t,e]).range(r).unknown(s)},da.apply(bu(o),arguments)}function W7(){var t=[.5],e=[0,1],n,i=1;function r(s){return s!=null&&s<=s?e[P0(t,s,0,i)]:n}return r.domain=function(s){return arguments.length?(t=Array.from(s),i=Math.min(t.length,e.length-1),r):t.slice()},r.range=function(s){return arguments.length?(e=Array.from(s),i=Math.min(t.length,e.length-1),r):e.slice()},r.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return W7().domain(t).range(e).unknown(n)},da.apply(r,arguments)}const KZ=new Date,LZ=new Date;function pr(t,e,n,i){function r(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(t(s=new Date(+s)),s),r.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const l=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;let c;do l.push(c=new Date(+s)),e(s,a),t(s);while(c<s&&s<o);return l},r.filter=s=>pr(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););}),n&&(r.count=(s,o)=>(KZ.setTime(+s),LZ.setTime(+o),t(KZ),t(LZ),Math.floor(n(KZ,LZ))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const Xw=pr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Xw.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?pr(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Xw);Xw.range;const bc=1e3,$o=bc*60,vc=$o*60,kc=vc*24,BF=kc*7,KH=kc*30,zZ=kc*365,pd=pr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*bc)},(t,e)=>(e-t)/bc,t=>t.getUTCSeconds());pd.range;const SF=pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bc)},(t,e)=>{t.setTime(+t+e*$o)},(t,e)=>(e-t)/$o,t=>t.getMinutes());SF.range;const ZF=pr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*$o)},(t,e)=>(e-t)/$o,t=>t.getUTCMinutes());ZF.range;const RF=pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bc-t.getMinutes()*$o)},(t,e)=>{t.setTime(+t+e*vc)},(t,e)=>(e-t)/vc,t=>t.getHours());RF.range;const NF=pr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*vc)},(t,e)=>(e-t)/vc,t=>t.getUTCHours());NF.range;const U0=pr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$o)/kc,t=>t.getDate()-1);U0.range;const GB=pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/kc,t=>t.getUTCDate()-1);GB.range;const M7=pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/kc,t=>Math.floor(t/kc));M7.range;function fh(t){return pr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*$o)/BF)}const BB=fh(0),Ew=fh(1),T1e=fh(2),X1e=fh(3),_f=fh(4),E1e=fh(5),Y1e=fh(6);BB.range;Ew.range;T1e.range;X1e.range;_f.range;E1e.range;Y1e.range;function Ch(t){return pr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/BF)}const SB=Ch(0),Yw=Ch(1),k1e=Ch(2),H1e=Ch(3),Tf=Ch(4),K1e=Ch(5),L1e=Ch(6);SB.range;Yw.range;k1e.range;H1e.range;Tf.range;K1e.range;L1e.range;const WF=pr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());WF.range;const MF=pr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());MF.range;const Hc=pr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Hc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:pr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Hc.range;const Kc=pr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Kc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:pr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Kc.range;function V7(t,e,n,i,r,s){const o=[[pd,1,bc],[pd,5,5*bc],[pd,15,15*bc],[pd,30,30*bc],[s,1,$o],[s,5,5*$o],[s,15,15*$o],[s,30,30*$o],[r,1,vc],[r,3,3*vc],[r,6,6*vc],[r,12,12*vc],[i,1,kc],[i,2,2*kc],[n,1,BF],[e,1,KH],[e,3,3*KH],[t,1,zZ]];function a(c,u,d){const h=u<c;h&&([c,u]=[u,c]);const I=d&&typeof d.range=="function"?d:l(c,u,d),p=I?I.range(c,+u+1):[];return h?p.reverse():p}function l(c,u,d){const h=Math.abs(u-c)/d,I=IF(([,,A])=>A).right(o,h);if(I===o.length)return t.every(AM(c/zZ,u/zZ,d));if(I===0)return Xw.every(Math.max(AM(c,u,d),1));const[p,y]=o[h/o[I-1][2]<o[I][2]/h?I-1:I];return p.every(y)}return[a,l]}const[z1e,j1e]=V7(Kc,MF,SB,M7,NF,ZF),[P1e,O1e]=V7(Hc,WF,BB,U0,RF,SF);function jZ(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function PZ(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Vp(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function D1e(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,c=Fp(r),u=_p(r),d=Fp(s),h=_p(s),I=Fp(o),p=_p(o),y=Fp(a),A=_p(a),m=Fp(l),b=_p(l),v={a:O,A:_,b:E,B:P,c:null,d:DH,e:DH,f:pZe,g:SZe,G:RZe,H:IZe,I:fZe,j:CZe,L:F7,m:mZe,M:AZe,p:q,q:re,Q:QH,s:qH,S:yZe,u:bZe,U:vZe,V:xZe,w:wZe,W:GZe,x:null,X:null,y:BZe,Y:ZZe,Z:NZe,"%":JH},w={a:de,A:Re,b:Pe,B:ae,c:null,d:UH,e:UH,f:FZe,g:zZe,G:PZe,H:WZe,I:MZe,j:VZe,L:T7,m:_Ze,M:TZe,p:he,q:Me,Q:QH,s:qH,S:XZe,u:EZe,U:YZe,V:kZe,w:HZe,W:KZe,x:null,X:null,y:LZe,Y:jZe,Z:OZe,"%":JH},x={a:M,A:F,b:T,B:H,c:K,d:PH,e:PH,f:gZe,g:jH,G:zH,H:OH,I:OH,j:oZe,L:cZe,m:sZe,M:aZe,p:W,q:rZe,Q:dZe,s:hZe,S:lZe,u:$1e,U:eZe,V:tZe,w:q1e,W:nZe,x:z,X:j,y:jH,Y:zH,Z:iZe,"%":uZe};v.x=B(n,v),v.X=B(i,v),v.c=B(e,v),w.x=B(n,w),w.X=B(i,w),w.c=B(e,w);function B(be,xe){return function(Ge){var pe=[],Oe=-1,ve=0,U=be.length,We,Xe,Qe;for(Ge instanceof Date||(Ge=new Date(+Ge));++Oe<U;)be.charCodeAt(Oe)===37&&(pe.push(be.slice(ve,Oe)),(Xe=LH[We=be.charAt(++Oe)])!=null?We=be.charAt(++Oe):Xe=We==="e"?" ":"0",(Qe=xe[We])&&(We=Qe(Ge,Xe)),pe.push(We),ve=Oe+1);return pe.push(be.slice(ve,Oe)),pe.join("")}}function Z(be,xe){return function(Ge){var pe=Vp(1900,void 0,1),Oe=N(pe,be,Ge+="",0),ve,U;if(Oe!=Ge.length)return null;if("Q"in pe)return new Date(pe.Q);if("s"in pe)return new Date(pe.s*1e3+("L"in pe?pe.L:0));if(xe&&!("Z"in pe)&&(pe.Z=0),"p"in pe&&(pe.H=pe.H%12+pe.p*12),pe.m===void 0&&(pe.m="q"in pe?pe.q:0),"V"in pe){if(pe.V<1||pe.V>53)return null;"w"in pe||(pe.w=1),"Z"in pe?(ve=PZ(Vp(pe.y,0,1)),U=ve.getUTCDay(),ve=U>4||U===0?Yw.ceil(ve):Yw(ve),ve=GB.offset(ve,(pe.V-1)*7),pe.y=ve.getUTCFullYear(),pe.m=ve.getUTCMonth(),pe.d=ve.getUTCDate()+(pe.w+6)%7):(ve=jZ(Vp(pe.y,0,1)),U=ve.getDay(),ve=U>4||U===0?Ew.ceil(ve):Ew(ve),ve=U0.offset(ve,(pe.V-1)*7),pe.y=ve.getFullYear(),pe.m=ve.getMonth(),pe.d=ve.getDate()+(pe.w+6)%7)}else("W"in pe||"U"in pe)&&("w"in pe||(pe.w="u"in pe?pe.u%7:"W"in pe?1:0),U="Z"in pe?PZ(Vp(pe.y,0,1)).getUTCDay():jZ(Vp(pe.y,0,1)).getDay(),pe.m=0,pe.d="W"in pe?(pe.w+6)%7+pe.W*7-(U+5)%7:pe.w+pe.U*7-(U+6)%7);return"Z"in pe?(pe.H+=pe.Z/100|0,pe.M+=pe.Z%100,PZ(pe)):jZ(pe)}}function N(be,xe,Ge,pe){for(var Oe=0,ve=xe.length,U=Ge.length,We,Xe;Oe<ve;){if(pe>=U)return-1;if(We=xe.charCodeAt(Oe++),We===37){if(We=xe.charAt(Oe++),Xe=x[We in LH?xe.charAt(Oe++):We],!Xe||(pe=Xe(be,Ge,pe))<0)return-1}else if(We!=Ge.charCodeAt(pe++))return-1}return pe}function W(be,xe,Ge){var pe=c.exec(xe.slice(Ge));return pe?(be.p=u.get(pe[0].toLowerCase()),Ge+pe[0].length):-1}function M(be,xe,Ge){var pe=I.exec(xe.slice(Ge));return pe?(be.w=p.get(pe[0].toLowerCase()),Ge+pe[0].length):-1}function F(be,xe,Ge){var pe=d.exec(xe.slice(Ge));return pe?(be.w=h.get(pe[0].toLowerCase()),Ge+pe[0].length):-1}function T(be,xe,Ge){var pe=m.exec(xe.slice(Ge));return pe?(be.m=b.get(pe[0].toLowerCase()),Ge+pe[0].length):-1}function H(be,xe,Ge){var pe=y.exec(xe.slice(Ge));return pe?(be.m=A.get(pe[0].toLowerCase()),Ge+pe[0].length):-1}function K(be,xe,Ge){return N(be,e,xe,Ge)}function z(be,xe,Ge){return N(be,n,xe,Ge)}function j(be,xe,Ge){return N(be,i,xe,Ge)}function O(be){return o[be.getDay()]}function _(be){return s[be.getDay()]}function E(be){return l[be.getMonth()]}function P(be){return a[be.getMonth()]}function q(be){return r[+(be.getHours()>=12)]}function re(be){return 1+~~(be.getMonth()/3)}function de(be){return o[be.getUTCDay()]}function Re(be){return s[be.getUTCDay()]}function Pe(be){return l[be.getUTCMonth()]}function ae(be){return a[be.getUTCMonth()]}function he(be){return r[+(be.getUTCHours()>=12)]}function Me(be){return 1+~~(be.getUTCMonth()/3)}return{format:function(be){var xe=B(be+="",v);return xe.toString=function(){return be},xe},parse:function(be){var xe=Z(be+="",!1);return xe.toString=function(){return be},xe},utcFormat:function(be){var xe=B(be+="",w);return xe.toString=function(){return be},xe},utcParse:function(be){var xe=Z(be+="",!0);return xe.toString=function(){return be},xe}}}var LH={"-":"",_:" ",0:"0"},Rr=/^\s*\d+/,U1e=/^%/,J1e=/[\\^$*+?|[\]().{}]/g;function zn(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function Q1e(t){return t.replace(J1e,"\\$&")}function Fp(t){return new RegExp("^(?:"+t.map(Q1e).join("|")+")","i")}function _p(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function q1e(t,e,n){var i=Rr.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function $1e(t,e,n){var i=Rr.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function eZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function tZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function nZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function zH(t,e,n){var i=Rr.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function jH(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function iZe(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function rZe(t,e,n){var i=Rr.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function sZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function PH(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function oZe(t,e,n){var i=Rr.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function OH(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function aZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function lZe(t,e,n){var i=Rr.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function cZe(t,e,n){var i=Rr.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function gZe(t,e,n){var i=Rr.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function uZe(t,e,n){var i=U1e.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function dZe(t,e,n){var i=Rr.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function hZe(t,e,n){var i=Rr.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function DH(t,e){return zn(t.getDate(),e,2)}function IZe(t,e){return zn(t.getHours(),e,2)}function fZe(t,e){return zn(t.getHours()%12||12,e,2)}function CZe(t,e){return zn(1+U0.count(Hc(t),t),e,3)}function F7(t,e){return zn(t.getMilliseconds(),e,3)}function pZe(t,e){return F7(t,e)+"000"}function mZe(t,e){return zn(t.getMonth()+1,e,2)}function AZe(t,e){return zn(t.getMinutes(),e,2)}function yZe(t,e){return zn(t.getSeconds(),e,2)}function bZe(t){var e=t.getDay();return e===0?7:e}function vZe(t,e){return zn(BB.count(Hc(t)-1,t),e,2)}function _7(t){var e=t.getDay();return e>=4||e===0?_f(t):_f.ceil(t)}function xZe(t,e){return t=_7(t),zn(_f.count(Hc(t),t)+(Hc(t).getDay()===4),e,2)}function wZe(t){return t.getDay()}function GZe(t,e){return zn(Ew.count(Hc(t)-1,t),e,2)}function BZe(t,e){return zn(t.getFullYear()%100,e,2)}function SZe(t,e){return t=_7(t),zn(t.getFullYear()%100,e,2)}function ZZe(t,e){return zn(t.getFullYear()%1e4,e,4)}function RZe(t,e){var n=t.getDay();return t=n>=4||n===0?_f(t):_f.ceil(t),zn(t.getFullYear()%1e4,e,4)}function NZe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+zn(e/60|0,"0",2)+zn(e%60,"0",2)}function UH(t,e){return zn(t.getUTCDate(),e,2)}function WZe(t,e){return zn(t.getUTCHours(),e,2)}function MZe(t,e){return zn(t.getUTCHours()%12||12,e,2)}function VZe(t,e){return zn(1+GB.count(Kc(t),t),e,3)}function T7(t,e){return zn(t.getUTCMilliseconds(),e,3)}function FZe(t,e){return T7(t,e)+"000"}function _Ze(t,e){return zn(t.getUTCMonth()+1,e,2)}function TZe(t,e){return zn(t.getUTCMinutes(),e,2)}function XZe(t,e){return zn(t.getUTCSeconds(),e,2)}function EZe(t){var e=t.getUTCDay();return e===0?7:e}function YZe(t,e){return zn(SB.count(Kc(t)-1,t),e,2)}function X7(t){var e=t.getUTCDay();return e>=4||e===0?Tf(t):Tf.ceil(t)}function kZe(t,e){return t=X7(t),zn(Tf.count(Kc(t),t)+(Kc(t).getUTCDay()===4),e,2)}function HZe(t){return t.getUTCDay()}function KZe(t,e){return zn(Yw.count(Kc(t)-1,t),e,2)}function LZe(t,e){return zn(t.getUTCFullYear()%100,e,2)}function zZe(t,e){return t=X7(t),zn(t.getUTCFullYear()%100,e,2)}function jZe(t,e){return zn(t.getUTCFullYear()%1e4,e,4)}function PZe(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Tf(t):Tf.ceil(t),zn(t.getUTCFullYear()%1e4,e,4)}function OZe(){return"+0000"}function JH(){return"%"}function QH(t){return+t}function qH(t){return Math.floor(+t/1e3)}var Lh,E7,Y7;DZe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function DZe(t){return Lh=D1e(t),E7=Lh.format,Lh.parse,Y7=Lh.utcFormat,Lh.utcParse,Lh}function UZe(t){return new Date(t)}function JZe(t){return t instanceof Date?+t:+new Date(+t)}function VF(t,e,n,i,r,s,o,a,l,c){var u=AF(),d=u.invert,h=u.domain,I=c(".%L"),p=c(":%S"),y=c("%I:%M"),A=c("%I %p"),m=c("%a %d"),b=c("%b %d"),v=c("%B"),w=c("%Y");function x(B){return(l(B)<B?I:a(B)<B?p:o(B)<B?y:s(B)<B?A:i(B)<B?r(B)<B?m:b:n(B)<B?v:w)(B)}return u.invert=function(B){return new Date(d(B))},u.domain=function(B){return arguments.length?h(Array.from(B,JZe)):h().map(UZe)},u.ticks=function(B){var Z=h();return t(Z[0],Z[Z.length-1],B??10)},u.tickFormat=function(B,Z){return Z==null?x:c(Z)},u.nice=function(B){var Z=h();return(!B||typeof B.range!="function")&&(B=e(Z[0],Z[Z.length-1],B??10)),B?h(G7(Z,B)):u},u.copy=function(){return D0(u,VF(t,e,n,i,r,s,o,a,l,c))},u}function QZe(){return da.apply(VF(P1e,O1e,Hc,WF,BB,U0,RF,SF,pd,E7).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function qZe(){return da.apply(VF(z1e,j1e,Kc,MF,SB,GB,NF,ZF,pd,Y7).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ZB(){var t=0,e=1,n,i,r,s,o=vs,a=!1,l;function c(d){return d==null||isNaN(d=+d)?l:o(r===0?.5:(d=(s(d)-n)*r,a?Math.max(0,Math.min(1,d)):d))}c.domain=function(d){return arguments.length?([t,e]=d,n=s(t=+t),i=s(e=+e),r=n===i?0:1/(i-n),c):[t,e]},c.clamp=function(d){return arguments.length?(a=!!d,c):a},c.interpolator=function(d){return arguments.length?(o=d,c):o};function u(d){return function(h){var I,p;return arguments.length?([I,p]=h,o=d(I,p),c):[o(0),o(1)]}}return c.range=u(LC),c.rangeRound=u(mF),c.unknown=function(d){return arguments.length?(l=d,c):l},function(d){return s=d,n=d(t),i=d(e),r=n===i?0:1/(i-n),c}}function vu(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function k7(){var t=bu(ZB()(vs));return t.copy=function(){return vu(t,k7())},Oc.apply(t,arguments)}function H7(){var t=vF(ZB()).domain([1,10]);return t.copy=function(){return vu(t,H7()).base(t.base())},Oc.apply(t,arguments)}function K7(){var t=xF(ZB());return t.copy=function(){return vu(t,K7()).constant(t.constant())},Oc.apply(t,arguments)}function FF(){var t=wF(ZB());return t.copy=function(){return vu(t,FF()).exponent(t.exponent())},Oc.apply(t,arguments)}function $Ze(){return FF.apply(null,arguments).exponent(.5)}function L7(){var t=[],e=vs;function n(i){if(i!=null&&!isNaN(i=+i))return e((P0(t,i,1)-1)/(t.length-1))}return n.domain=function(i){if(!arguments.length)return t.slice();t=[];for(let r of i)r!=null&&!isNaN(r=+r)&&t.push(r);return t.sort(Jg),n},n.interpolator=function(i){return arguments.length?(e=i,n):e},n.range=function(){return t.map((i,r)=>e(r/(t.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(r,s)=>YSe(t,s/i))},n.copy=function(){return L7(e).domain(t)},Oc.apply(n,arguments)}function RB(){var t=0,e=.5,n=1,i=1,r,s,o,a,l,c=vs,u,d=!1,h;function I(y){return isNaN(y=+y)?h:(y=.5+((y=+u(y))-s)*(i*y<i*s?a:l),c(d?Math.max(0,Math.min(1,y)):y))}I.domain=function(y){return arguments.length?([t,e,n]=y,r=u(t=+t),s=u(e=+e),o=u(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,I):[t,e,n]},I.clamp=function(y){return arguments.length?(d=!!y,I):d},I.interpolator=function(y){return arguments.length?(c=y,I):c};function p(y){return function(A){var m,b,v;return arguments.length?([m,b,v]=A,c=u1e(y,[m,b,v]),I):[c(0),c(.5),c(1)]}}return I.range=p(LC),I.rangeRound=p(mF),I.unknown=function(y){return arguments.length?(h=y,I):h},function(y){return u=y,r=y(t),s=y(e),o=y(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,I}}function z7(){var t=bu(RB()(vs));return t.copy=function(){return vu(t,z7())},Oc.apply(t,arguments)}function j7(){var t=vF(RB()).domain([.1,1,10]);return t.copy=function(){return vu(t,j7()).base(t.base())},Oc.apply(t,arguments)}function P7(){var t=xF(RB());return t.copy=function(){return vu(t,P7()).constant(t.constant())},Oc.apply(t,arguments)}function _F(){var t=wF(RB());return t.copy=function(){return vu(t,_F()).exponent(t.exponent())},Oc.apply(t,arguments)}function eRe(){return _F.apply(null,arguments).exponent(.5)}const $H=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:RA,scaleDiverging:z7,scaleDivergingLog:j7,scaleDivergingPow:_F,scaleDivergingSqrt:eRe,scaleDivergingSymlog:P7,scaleIdentity:w7,scaleImplicit:yM,scaleLinear:Tw,scaleLog:B7,scaleOrdinal:fF,scalePoint:Fm,scalePow:GF,scaleQuantile:R7,scaleQuantize:N7,scaleRadial:Z7,scaleSequential:k7,scaleSequentialLog:H7,scaleSequentialPow:FF,scaleSequentialQuantile:L7,scaleSequentialSqrt:$Ze,scaleSequentialSymlog:K7,scaleSqrt:F1e,scaleSymlog:S7,scaleThreshold:W7,scaleTime:QZe,scaleUtc:qZe,tickFormat:x7},Symbol.toStringTag,{value:"Module"}));var tRe=FC;function nRe(t,e,n){for(var i=-1,r=t.length;++i<r;){var s=t[i],o=e(s);if(o!=null&&(a===void 0?o===o&&!tRe(o):n(o,a)))var a=o,l=s}return l}var NB=nRe;function iRe(t,e){return t>e}var O7=iRe,rRe=NB,sRe=O7,oRe=KC;function aRe(t){return t&&t.length?rRe(t,oRe,sRe):void 0}var lRe=aRe;const Xg=Pn(lRe);function cRe(t,e){return t<e}var D7=cRe,gRe=NB,uRe=D7,dRe=KC;function hRe(t){return t&&t.length?gRe(t,dRe,uRe):void 0}var IRe=hRe;const WB=Pn(IRe);var fRe=J5,CRe=Pl,pRe=n7,mRe=io;function ARe(t,e){var n=mRe(t)?fRe:pRe;return n(t,CRe(e))}var yRe=ARe,bRe=e7,vRe=yRe;function xRe(t,e){return bRe(vRe(t,e),1)}var wRe=xRe;const GRe=Pn(wRe);var BRe=gF;function SRe(t,e){return BRe(t,e)}var ZRe=SRe;const ou=Pn(ZRe);var zC=1e9,RRe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},XF,Bi=!0,la="[DecimalError] ",Td=la+"Invalid argument: ",TF=la+"Exponent out of range: ",jC=Math.floor,rd=Math.pow,NRe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,mo,vr=1e7,mi=7,U7=9007199254740991,kw=jC(U7/mi),Vt={};Vt.absoluteValue=Vt.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Vt.comparedTo=Vt.cmp=function(t){var e,n,i,r,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(i=s.d.length,r=t.d.length,e=0,n=i<r?i:r;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return i===r?0:i>r^s.s<0?1:-1};Vt.decimalPlaces=Vt.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*mi;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};Vt.dividedBy=Vt.div=function(t){return Nc(this,new this.constructor(t))};Vt.dividedToIntegerBy=Vt.idiv=function(t){var e=this,n=e.constructor;return ai(Nc(e,new n(t),0,1),n.precision)};Vt.equals=Vt.eq=function(t){return!this.cmp(t)};Vt.exponent=function(){return ir(this)};Vt.greaterThan=Vt.gt=function(t){return this.cmp(t)>0};Vt.greaterThanOrEqualTo=Vt.gte=function(t){return this.cmp(t)>=0};Vt.isInteger=Vt.isint=function(){return this.e>this.d.length-2};Vt.isNegative=Vt.isneg=function(){return this.s<0};Vt.isPositive=Vt.ispos=function(){return this.s>0};Vt.isZero=function(){return this.s===0};Vt.lessThan=Vt.lt=function(t){return this.cmp(t)<0};Vt.lessThanOrEqualTo=Vt.lte=function(t){return this.cmp(t)<1};Vt.logarithm=Vt.log=function(t){var e,n=this,i=n.constructor,r=i.precision,s=r+5;if(t===void 0)t=new i(10);else if(t=new i(t),t.s<1||t.eq(mo))throw Error(la+"NaN");if(n.s<1)throw Error(la+(n.s?"NaN":"-Infinity"));return n.eq(mo)?new i(0):(Bi=!1,e=Nc(FA(n,s),FA(t,s),s),Bi=!0,ai(e,r))};Vt.minus=Vt.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?q7(e,t):J7(e,(t.s=-t.s,t))};Vt.modulo=Vt.mod=function(t){var e,n=this,i=n.constructor,r=i.precision;if(t=new i(t),!t.s)throw Error(la+"NaN");return n.s?(Bi=!1,e=Nc(n,t,0,1).times(t),Bi=!0,n.minus(e)):ai(new i(n),r)};Vt.naturalExponential=Vt.exp=function(){return Q7(this)};Vt.naturalLogarithm=Vt.ln=function(){return FA(this)};Vt.negated=Vt.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Vt.plus=Vt.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?J7(e,t):q7(e,(t.s=-t.s,t))};Vt.precision=Vt.sd=function(t){var e,n,i,r=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Td+t);if(e=ir(r)+1,i=r.d.length-1,n=i*mi+1,i=r.d[i],i){for(;i%10==0;i/=10)n--;for(i=r.d[0];i>=10;i/=10)n++}return t&&e>n?e:n};Vt.squareRoot=Vt.sqrt=function(){var t,e,n,i,r,s,o,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(la+"NaN")}for(t=ir(a),Bi=!1,r=Math.sqrt(+a),r==0||r==1/0?(e=Bl(a.d),(e.length+t)%2==0&&(e+="0"),r=Math.sqrt(e),t=jC((t+1)/2)-(t<0||t%2),r==1/0?e="5e"+t:(e=r.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),i=new l(e)):i=new l(r.toString()),n=l.precision,r=o=n+3;;)if(s=i,i=s.plus(Nc(a,s,o+2)).times(.5),Bl(s.d).slice(0,o)===(e=Bl(i.d)).slice(0,o)){if(e=e.slice(o-3,o+1),r==o&&e=="4999"){if(ai(s,n+1,0),s.times(s).eq(a)){i=s;break}}else if(e!="9999")break;o+=4}return Bi=!0,ai(i,n)};Vt.times=Vt.mul=function(t){var e,n,i,r,s,o,a,l,c,u=this,d=u.constructor,h=u.d,I=(t=new d(t)).d;if(!u.s||!t.s)return new d(0);for(t.s*=u.s,n=u.e+t.e,l=h.length,c=I.length,l<c&&(s=h,h=I,I=s,o=l,l=c,c=o),s=[],o=l+c,i=o;i--;)s.push(0);for(i=c;--i>=0;){for(e=0,r=l+i;r>i;)a=s[r]+I[i]*h[r-i-1]+e,s[r--]=a%vr|0,e=a/vr|0;s[r]=(s[r]+e)%vr|0}for(;!s[--o];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,Bi?ai(t,d.precision):t};Vt.toDecimalPlaces=Vt.todp=function(t,e){var n=this,i=n.constructor;return n=new i(n),t===void 0?n:(Yl(t,0,zC),e===void 0?e=i.rounding:Yl(e,0,8),ai(n,t+ir(n)+1,e))};Vt.toExponential=function(t,e){var n,i=this,r=i.constructor;return t===void 0?n=eh(i,!0):(Yl(t,0,zC),e===void 0?e=r.rounding:Yl(e,0,8),i=ai(new r(i),t+1,e),n=eh(i,!0,t+1)),n};Vt.toFixed=function(t,e){var n,i,r=this,s=r.constructor;return t===void 0?eh(r):(Yl(t,0,zC),e===void 0?e=s.rounding:Yl(e,0,8),i=ai(new s(r),t+ir(r)+1,e),n=eh(i.abs(),!1,t+ir(i)+1),r.isneg()&&!r.isZero()?"-"+n:n)};Vt.toInteger=Vt.toint=function(){var t=this,e=t.constructor;return ai(new e(t),ir(t)+1,e.rounding)};Vt.toNumber=function(){return+this};Vt.toPower=Vt.pow=function(t){var e,n,i,r,s,o,a=this,l=a.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(mo);if(a=new l(a),!a.s){if(t.s<1)throw Error(la+"Infinity");return a}if(a.eq(mo))return a;if(i=l.precision,t.eq(mo))return ai(a,i);if(e=t.e,n=t.d.length-1,o=e>=n,s=a.s,o){if((n=u<0?-u:u)<=U7){for(r=new l(mo),e=Math.ceil(i/mi+4),Bi=!1;n%2&&(r=r.times(a),t9(r.d,e)),n=jC(n/2),n!==0;)a=a.times(a),t9(a.d,e);return Bi=!0,t.s<0?new l(mo).div(r):ai(r,i)}}else if(s<0)throw Error(la+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,a.s=1,Bi=!1,r=t.times(FA(a,i+c)),Bi=!0,r=Q7(r),r.s=s,r};Vt.toPrecision=function(t,e){var n,i,r=this,s=r.constructor;return t===void 0?(n=ir(r),i=eh(r,n<=s.toExpNeg||n>=s.toExpPos)):(Yl(t,1,zC),e===void 0?e=s.rounding:Yl(e,0,8),r=ai(new s(r),t,e),n=ir(r),i=eh(r,t<=n||n<=s.toExpNeg,t)),i};Vt.toSignificantDigits=Vt.tosd=function(t,e){var n=this,i=n.constructor;return t===void 0?(t=i.precision,e=i.rounding):(Yl(t,1,zC),e===void 0?e=i.rounding:Yl(e,0,8)),ai(new i(n),t,e)};Vt.toString=Vt.valueOf=Vt.val=Vt.toJSON=Vt[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=ir(t),n=t.constructor;return eh(t,e<=n.toExpNeg||e>=n.toExpPos)};function J7(t,e){var n,i,r,s,o,a,l,c,u=t.constructor,d=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Bi?ai(e,d):e;if(l=t.d,c=e.d,o=t.e,r=e.e,l=l.slice(),s=o-r,s){for(s<0?(i=l,s=-s,a=c.length):(i=c,r=o,a=l.length),o=Math.ceil(d/mi),a=o>a?o+1:a+1,s>a&&(s=a,i.length=1),i.reverse();s--;)i.push(0);i.reverse()}for(a=l.length,s=c.length,a-s<0&&(s=a,i=c,c=l,l=i),n=0;s;)n=(l[--s]=l[s]+c[s]+n)/vr|0,l[s]%=vr;for(n&&(l.unshift(n),++r),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=r,Bi?ai(e,d):e}function Yl(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Td+t)}function Bl(t){var e,n,i,r=t.length-1,s="",o=t[0];if(r>0){for(s+=o,e=1;e<r;e++)i=t[e]+"",n=mi-i.length,n&&(s+=yg(n)),s+=i;o=t[e],i=o+"",n=mi-i.length,n&&(s+=yg(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Nc=function(){function t(i,r){var s,o=0,a=i.length;for(i=i.slice();a--;)s=i[a]*r+o,i[a]=s%vr|0,o=s/vr|0;return o&&i.unshift(o),i}function e(i,r,s,o){var a,l;if(s!=o)l=s>o?1:-1;else for(a=l=0;a<s;a++)if(i[a]!=r[a]){l=i[a]>r[a]?1:-1;break}return l}function n(i,r,s){for(var o=0;s--;)i[s]-=o,o=i[s]<r[s]?1:0,i[s]=o*vr+i[s]-r[s];for(;!i[0]&&i.length>1;)i.shift()}return function(i,r,s,o){var a,l,c,u,d,h,I,p,y,A,m,b,v,w,x,B,Z,N,W=i.constructor,M=i.s==r.s?1:-1,F=i.d,T=r.d;if(!i.s)return new W(i);if(!r.s)throw Error(la+"Division by zero");for(l=i.e-r.e,Z=T.length,x=F.length,I=new W(M),p=I.d=[],c=0;T[c]==(F[c]||0);)++c;if(T[c]>(F[c]||0)&&--l,s==null?b=s=W.precision:o?b=s+(ir(i)-ir(r))+1:b=s,b<0)return new W(0);if(b=b/mi+2|0,c=0,Z==1)for(u=0,T=T[0],b++;(c<x||u)&&b--;c++)v=u*vr+(F[c]||0),p[c]=v/T|0,u=v%T|0;else{for(u=vr/(T[0]+1)|0,u>1&&(T=t(T,u),F=t(F,u),Z=T.length,x=F.length),w=Z,y=F.slice(0,Z),A=y.length;A<Z;)y[A++]=0;N=T.slice(),N.unshift(0),B=T[0],T[1]>=vr/2&&++B;do u=0,a=e(T,y,Z,A),a<0?(m=y[0],Z!=A&&(m=m*vr+(y[1]||0)),u=m/B|0,u>1?(u>=vr&&(u=vr-1),d=t(T,u),h=d.length,A=y.length,a=e(d,y,h,A),a==1&&(u--,n(d,Z<h?N:T,h))):(u==0&&(a=u=1),d=T.slice()),h=d.length,h<A&&d.unshift(0),n(y,d,A),a==-1&&(A=y.length,a=e(T,y,Z,A),a<1&&(u++,n(y,Z<A?N:T,A))),A=y.length):a===0&&(u++,y=[0]),p[c++]=u,a&&y[0]?y[A++]=F[w]||0:(y=[F[w]],A=1);while((w++<x||y[0]!==void 0)&&b--)}return p[0]||p.shift(),I.e=l,ai(I,o?s+ir(I)+1:s)}}();function Q7(t,e){var n,i,r,s,o,a,l=0,c=0,u=t.constructor,d=u.precision;if(ir(t)>16)throw Error(TF+ir(t));if(!t.s)return new u(mo);for(e==null?(Bi=!1,a=d):a=e,o=new u(.03125);t.abs().gte(.1);)t=t.times(o),c+=5;for(i=Math.log(rd(2,c))/Math.LN10*2+5|0,a+=i,n=r=s=new u(mo),u.precision=a;;){if(r=ai(r.times(t),a),n=n.times(++l),o=s.plus(Nc(r,n,a)),Bl(o.d).slice(0,a)===Bl(s.d).slice(0,a)){for(;c--;)s=ai(s.times(s),a);return u.precision=d,e==null?(Bi=!0,ai(s,d)):s}s=o}}function ir(t){for(var e=t.e*mi,n=t.d[0];n>=10;n/=10)e++;return e}function OZ(t,e,n){if(e>t.LN10.sd())throw Bi=!0,n&&(t.precision=n),Error(la+"LN10 precision limit exceeded");return ai(new t(t.LN10),e)}function yg(t){for(var e="";t--;)e+="0";return e}function FA(t,e){var n,i,r,s,o,a,l,c,u,d=1,h=10,I=t,p=I.d,y=I.constructor,A=y.precision;if(I.s<1)throw Error(la+(I.s?"NaN":"-Infinity"));if(I.eq(mo))return new y(0);if(e==null?(Bi=!1,c=A):c=e,I.eq(10))return e==null&&(Bi=!0),OZ(y,c);if(c+=h,y.precision=c,n=Bl(p),i=n.charAt(0),s=ir(I),Math.abs(s)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)I=I.times(t),n=Bl(I.d),i=n.charAt(0),d++;s=ir(I),i>1?(I=new y("0."+n),s++):I=new y(i+"."+n.slice(1))}else return l=OZ(y,c+2,A).times(s+""),I=FA(new y(i+"."+n.slice(1)),c-h).plus(l),y.precision=A,e==null?(Bi=!0,ai(I,A)):I;for(a=o=I=Nc(I.minus(mo),I.plus(mo),c),u=ai(I.times(I),c),r=3;;){if(o=ai(o.times(u),c),l=a.plus(Nc(o,new y(r),c)),Bl(l.d).slice(0,c)===Bl(a.d).slice(0,c))return a=a.times(2),s!==0&&(a=a.plus(OZ(y,c+2,A).times(s+""))),a=Nc(a,new y(d),c),y.precision=A,e==null?(Bi=!0,ai(a,A)):a;a=l,r+=2}}function e9(t,e){var n,i,r;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charCodeAt(i)===48;)++i;for(r=e.length;e.charCodeAt(r-1)===48;)--r;if(e=e.slice(i,r),e){if(r-=i,n=n-i-1,t.e=jC(n/mi),t.d=[],i=(n+1)%mi,n<0&&(i+=mi),i<r){for(i&&t.d.push(+e.slice(0,i)),r-=mi;i<r;)t.d.push(+e.slice(i,i+=mi));e=e.slice(i),i=mi-e.length}else i-=r;for(;i--;)e+="0";if(t.d.push(+e),Bi&&(t.e>kw||t.e<-kw))throw Error(TF+n)}else t.s=0,t.e=0,t.d=[0];return t}function ai(t,e,n){var i,r,s,o,a,l,c,u,d=t.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(i=e-o,i<0)i+=mi,r=e,c=d[u=0];else{if(u=Math.ceil((i+1)/mi),s=d.length,u>=s)return t;for(c=s=d[u],o=1;s>=10;s/=10)o++;i%=mi,r=i-mi+o}if(n!==void 0&&(s=rd(10,o-r-1),a=c/s%10|0,l=e<0||d[u+1]!==void 0||c%s,l=n<4?(a||l)&&(n==0||n==(t.s<0?3:2)):a>5||a==5&&(n==4||l||n==6&&(i>0?r>0?c/rd(10,o-r):0:d[u-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return l?(s=ir(t),d.length=1,e=e-s-1,d[0]=rd(10,(mi-e%mi)%mi),t.e=jC(-e/mi)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(i==0?(d.length=u,s=1,u--):(d.length=u+1,s=rd(10,mi-i),d[u]=r>0?(c/rd(10,o-r)%rd(10,r)|0)*s:0),l)for(;;)if(u==0){(d[0]+=s)==vr&&(d[0]=1,++t.e);break}else{if(d[u]+=s,d[u]!=vr)break;d[u--]=0,s=1}for(i=d.length;d[--i]===0;)d.pop();if(Bi&&(t.e>kw||t.e<-kw))throw Error(TF+ir(t));return t}function q7(t,e){var n,i,r,s,o,a,l,c,u,d,h=t.constructor,I=h.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new h(t),Bi?ai(e,I):e;if(l=t.d,d=e.d,i=e.e,c=t.e,l=l.slice(),o=c-i,o){for(u=o<0,u?(n=l,o=-o,a=d.length):(n=d,i=c,a=l.length),r=Math.max(Math.ceil(I/mi),a)+2,o>r&&(o=r,n.length=1),n.reverse(),r=o;r--;)n.push(0);n.reverse()}else{for(r=l.length,a=d.length,u=r<a,u&&(a=r),r=0;r<a;r++)if(l[r]!=d[r]){u=l[r]<d[r];break}o=0}for(u&&(n=l,l=d,d=n,e.s=-e.s),a=l.length,r=d.length-a;r>0;--r)l[a++]=0;for(r=d.length;r>o;){if(l[--r]<d[r]){for(s=r;s&&l[--s]===0;)l[s]=vr-1;--l[s],l[r]+=vr}l[r]-=d[r]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--i;return l[0]?(e.d=l,e.e=i,Bi?ai(e,I):e):new h(0)}function eh(t,e,n){var i,r=ir(t),s=Bl(t.d),o=s.length;return e?(n&&(i=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+yg(i):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(r<0?"e":"e+")+r):r<0?(s="0."+yg(-r-1)+s,n&&(i=n-o)>0&&(s+=yg(i))):r>=o?(s+=yg(r+1-o),n&&(i=n-r-1)>0&&(s=s+"."+yg(i))):((i=r+1)<o&&(s=s.slice(0,i)+"."+s.slice(i)),n&&(i=n-o)>0&&(r+1===o&&(s+="."),s+=yg(i))),t.s<0?"-"+s:s}function t9(t,e){if(t.length>e)return t.length=e,!0}function $7(t){var e,n,i;function r(s){var o=this;if(!(o instanceof r))return new r(s);if(o.constructor=r,s instanceof r){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Td+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return e9(o,s.toString())}else if(typeof s!="string")throw Error(Td+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,NRe.test(s))e9(o,s);else throw Error(Td+s)}if(r.prototype=Vt,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.clone=$7,r.config=r.set=WRe,t===void 0&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<i.length;)t.hasOwnProperty(n=i[e++])||(t[n]=this[n]);return r.config(t),r}function WRe(t){if(!t||typeof t!="object")throw Error(la+"Object expected");var e,n,i,r=["precision",1,zC,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<r.length;e+=3)if((i=t[n=r[e]])!==void 0)if(jC(i)===i&&i>=r[e+1]&&i<=r[e+2])this[n]=i;else throw Error(Td+n+": "+i);if((i=t[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(Td+n+": "+i);return this}var XF=$7(RRe);mo=new XF(1);const ni=XF;function MRe(t){return TRe(t)||_Re(t)||FRe(t)||VRe()}function VRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FRe(t,e){if(t){if(typeof t=="string")return wM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wM(t,e)}}function _Re(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function TRe(t){if(Array.isArray(t))return wM(t)}function wM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var XRe=function(e){return e},e6={"@@functional/placeholder":!0},t6=function(e){return e===e6},n9=function(e){return function n(){return arguments.length===0||arguments.length===1&&t6(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},ERe=function t(e,n){return e===1?n:n9(function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];var o=r.filter(function(a){return a!==e6}).length;return o>=e?n.apply(void 0,r):t(e-o,n9(function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];var u=r.map(function(d){return t6(d)?l.shift():d});return n.apply(void 0,MRe(u).concat(l))}))})},MB=function(e){return ERe(e.length,e)},GM=function(e,n){for(var i=[],r=e;r<n;++r)i[r-e]=r;return i},YRe=MB(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),kRe=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(!n.length)return XRe;var r=n.reverse(),s=r[0],o=r.slice(1);return function(){return o.reduce(function(a,l){return l(a)},s.apply(void 0,arguments))}},BM=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},n6=function(e){var n=null,i=null;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n&&s.every(function(a,l){return a===n[l]})||(n=s,i=e.apply(void 0,s)),i}};function HRe(t){var e;return t===0?e=1:e=Math.floor(new ni(t).abs().log(10).toNumber())+1,e}function KRe(t,e,n){for(var i=new ni(t),r=0,s=[];i.lt(e)&&r<1e5;)s.push(i.toNumber()),i=i.add(n),r++;return s}var LRe=MB(function(t,e,n){var i=+t,r=+e;return i+n*(r-i)}),zRe=MB(function(t,e,n){var i=e-+t;return i=i||1/0,(n-t)/i}),jRe=MB(function(t,e,n){var i=e-+t;return i=i||1/0,Math.max(0,Math.min(1,(n-t)/i))});const VB={rangeStep:KRe,getDigitCount:HRe,interpolateNumber:LRe,uninterpolateNumber:zRe,uninterpolateTruncation:jRe};function SM(t){return DRe(t)||ORe(t)||i6(t)||PRe()}function PRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ORe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function DRe(t){if(Array.isArray(t))return ZM(t)}function _A(t,e){return QRe(t)||JRe(t,e)||i6(t,e)||URe()}function URe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i6(t,e){if(t){if(typeof t=="string")return ZM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZM(t,e)}}function ZM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function JRe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],i=!0,r=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(i=(a=o.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(l){r=!0,s=l}finally{try{!i&&o.return!=null&&o.return()}finally{if(r)throw s}}return n}}function QRe(t){if(Array.isArray(t))return t}function r6(t){var e=_A(t,2),n=e[0],i=e[1],r=n,s=i;return n>i&&(r=i,s=n),[r,s]}function s6(t,e,n){if(t.lte(0))return new ni(0);var i=VB.getDigitCount(t.toNumber()),r=new ni(10).pow(i),s=t.div(r),o=i!==1?.05:.1,a=new ni(Math.ceil(s.div(o).toNumber())).add(n).mul(o),l=a.mul(r);return e?l:new ni(Math.ceil(l))}function qRe(t,e,n){var i=1,r=new ni(t);if(!r.isint()&&n){var s=Math.abs(t);s<1?(i=new ni(10).pow(VB.getDigitCount(t)-1),r=new ni(Math.floor(r.div(i).toNumber())).mul(i)):s>1&&(r=new ni(Math.floor(t)))}else t===0?r=new ni(Math.floor((e-1)/2)):n||(r=new ni(Math.floor(t)));var o=Math.floor((e-1)/2),a=kRe(YRe(function(l){return r.add(new ni(l-o).mul(i)).toNumber()}),GM);return a(0,e)}function o6(t,e,n,i){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new ni(0),tickMin:new ni(0),tickMax:new ni(0)};var s=s6(new ni(e).sub(t).div(n-1),i,r),o;t<=0&&e>=0?o=new ni(0):(o=new ni(t).add(e).div(2),o=o.sub(new ni(o).mod(s)));var a=Math.ceil(o.sub(t).div(s).toNumber()),l=Math.ceil(new ni(e).sub(o).div(s).toNumber()),c=a+l+1;return c>n?o6(t,e,n,i,r+1):(c<n&&(l=e>0?l+(n-c):l,a=e>0?a:a+(n-c)),{step:s,tickMin:o.sub(new ni(a).mul(s)),tickMax:o.add(new ni(l).mul(s))})}function $Re(t){var e=_A(t,2),n=e[0],i=e[1],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(r,2),a=r6([n,i]),l=_A(a,2),c=l[0],u=l[1];if(c===-1/0||u===1/0){var d=u===1/0?[c].concat(SM(GM(0,r-1).map(function(){return 1/0}))):[].concat(SM(GM(0,r-1).map(function(){return-1/0})),[u]);return n>i?BM(d):d}if(c===u)return qRe(c,r,s);var h=o6(c,u,o,s),I=h.step,p=h.tickMin,y=h.tickMax,A=VB.rangeStep(p,y.add(new ni(.1).mul(I)),I);return n>i?BM(A):A}function eNe(t,e){var n=_A(t,2),i=n[0],r=n[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=r6([i,r]),a=_A(o,2),l=a[0],c=a[1];if(l===-1/0||c===1/0)return[i,r];if(l===c)return[l];var u=Math.max(e,2),d=s6(new ni(c).sub(l).div(u-1),s,0),h=[].concat(SM(VB.rangeStep(new ni(l),new ni(c).sub(new ni(.99).mul(d)),d)),[c]);return i>r?BM(h):h}var tNe=n6($Re),nNe=n6(eNe),iNe="Invariant failed";function th(t,e){throw new Error(iNe)}var rNe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Xf(t){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xf(t)}function Hw(){return Hw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Hw.apply(this,arguments)}function sNe(t,e){return cNe(t)||lNe(t,e)||aNe(t,e)||oNe()}function oNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aNe(t,e){if(t){if(typeof t=="string")return i9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i9(t,e)}}function i9(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function lNe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function cNe(t){if(Array.isArray(t))return t}function gNe(t,e){if(t==null)return{};var n=uNe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function uNe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function dNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hNe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c6(i.key),i)}}function INe(t,e,n){return e&&hNe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fNe(t,e,n){return e=Kw(e),CNe(t,a6()?Reflect.construct(e,n||[],Kw(t).constructor):e.apply(t,n))}function CNe(t,e){if(e&&(Xf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pNe(t)}function pNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a6=function(){return!!t})()}function Kw(t){return Kw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Kw(t)}function mNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RM(t,e)}function RM(t,e){return RM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},RM(t,e)}function l6(t,e,n){return e=c6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c6(t){var e=ANe(t,"string");return Xf(e)=="symbol"?e:e+""}function ANe(t,e){if(Xf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Xf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PC=function(t){function e(){return dNe(this,e),fNe(this,e,arguments)}return mNe(e,t),INe(e,[{key:"render",value:function(){var i=this.props,r=i.offset,s=i.layout,o=i.width,a=i.dataKey,l=i.data,c=i.dataPointFormatter,u=i.xAxis,d=i.yAxis,h=gNe(i,rNe),I=Yt(h,!1);this.props.direction==="x"&&u.type!=="number"&&th();var p=l.map(function(y){var A=c(y,a),m=A.x,b=A.y,v=A.value,w=A.errorVal;if(!w)return null;var x=[],B,Z;if(Array.isArray(w)){var N=sNe(w,2);B=N[0],Z=N[1]}else B=Z=w;if(s==="vertical"){var W=u.scale,M=b+r,F=M+o,T=M-o,H=W(v-B),K=W(v+Z);x.push({x1:K,y1:F,x2:K,y2:T}),x.push({x1:H,y1:M,x2:K,y2:M}),x.push({x1:H,y1:F,x2:H,y2:T})}else if(s==="horizontal"){var z=d.scale,j=m+r,O=j-o,_=j+o,E=z(v-B),P=z(v+Z);x.push({x1:O,y1:P,x2:_,y2:P}),x.push({x1:j,y1:E,x2:j,y2:P}),x.push({x1:O,y1:E,x2:_,y2:E})}return $.createElement(fn,Hw({className:"recharts-errorBar",key:"bar-".concat(x.map(function(q){return"".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2)}))},I),x.map(function(q){return $.createElement("line",Hw({},q,{key:"line-".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2)}))}))});return $.createElement(fn,{className:"recharts-errorBars"},p)}}])}($.Component);l6(PC,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});l6(PC,"displayName","ErrorBar");function TA(t){"@babel/helpers - typeof";return TA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TA(t)}function r9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Xu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?r9(Object(n),!0).forEach(function(i){yNe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function yNe(t,e,n){return e=bNe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bNe(t){var e=vNe(t,"string");return TA(e)=="symbol"?e:e+""}function vNe(t,e){if(TA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(TA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var g6=function(e){var n=e.children,i=e.formattedGraphicalItems,r=e.legendWidth,s=e.legendContent,o=Co(n,JI);if(!o)return null;var a=JI.defaultProps,l=a!==void 0?Xu(Xu({},a),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:s==="children"?c=(i||[]).reduce(function(u,d){var h=d.item,I=d.props,p=I.sectors||I.data||[];return u.concat(p.map(function(y){return{type:o.props.iconType||h.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(i||[]).map(function(u){var d=u.item,h=d.type.defaultProps,I=h!==void 0?Xu(Xu({},h),d.props):{},p=I.dataKey,y=I.name,A=I.legendType,m=I.hide;return{inactive:m,dataKey:p,type:l.iconType||A||"square",color:EF(d),value:y||p,payload:I}}),Xu(Xu(Xu({},l),JI.getWithHeight(o,r)),{},{payload:c,item:o})};function XA(t){"@babel/helpers - typeof";return XA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XA(t)}function s9(t){return BNe(t)||GNe(t)||wNe(t)||xNe()}function xNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wNe(t,e){if(t){if(typeof t=="string")return NM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NM(t,e)}}function GNe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function BNe(t){if(Array.isArray(t))return NM(t)}function NM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function o9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Hi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o9(Object(n),!0).forEach(function(i){qI(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function qI(t,e,n){return e=SNe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SNe(t){var e=ZNe(t,"string");return XA(e)=="symbol"?e:e+""}function ZNe(t,e){if(XA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(XA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yi(t,e,n){return en(t)||en(e)?n:dr(e)?wo(t,e,n):$t(e)?e(t):n}function _m(t,e,n,i){var r=GRe(t,function(a){return yi(a,e)});if(n==="number"){var s=r.filter(function(a){return ut(a)||parseFloat(a)});return s.length?[WB(s),Xg(s)]:[1/0,-1/0]}var o=i?r.filter(function(a){return!en(a)}):r;return o.map(function(a){return dr(a)||a instanceof Date?a:""})}var RNe=function(e){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,o=-1,a=(n=i==null?void 0:i.length)!==null&&n!==void 0?n:0;if(a<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,c=0;c<a;c++){var u=c>0?r[c-1].coordinate:r[a-1].coordinate,d=r[c].coordinate,h=c>=a-1?r[0].coordinate:r[c+1].coordinate,I=void 0;if(ys(d-u)!==ys(h-d)){var p=[];if(ys(h-d)===ys(l[1]-l[0])){I=h;var y=d+l[1]-l[0];p[0]=Math.min(y,(y+u)/2),p[1]=Math.max(y,(y+u)/2)}else{I=u;var A=h+l[1]-l[0];p[0]=Math.min(d,(A+d)/2),p[1]=Math.max(d,(A+d)/2)}var m=[Math.min(d,(I+d)/2),Math.max(d,(I+d)/2)];if(e>m[0]&&e<=m[1]||e>=p[0]&&e<=p[1]){o=r[c].index;break}}else{var b=Math.min(u,h),v=Math.max(u,h);if(e>(b+d)/2&&e<=(v+d)/2){o=r[c].index;break}}}else for(var w=0;w<a;w++)if(w===0&&e<=(i[w].coordinate+i[w+1].coordinate)/2||w>0&&w<a-1&&e>(i[w].coordinate+i[w-1].coordinate)/2&&e<=(i[w].coordinate+i[w+1].coordinate)/2||w===a-1&&e>(i[w].coordinate+i[w-1].coordinate)/2){o=i[w].index;break}return o},EF=function(e){var n,i=e,r=i.type.displayName,s=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Hi(Hi({},e.type.defaultProps),e.props):e.props,o=s.stroke,a=s.fill,l;switch(r){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:a;break;default:l=a;break}return l},NNe=function(e){var n=e.barSize,i=e.totalSize,r=e.stackGroups,s=r===void 0?{}:r;if(!s)return{};for(var o={},a=Object.keys(s),l=0,c=a.length;l<c;l++)for(var u=s[a[l]].stackGroups,d=Object.keys(u),h=0,I=d.length;h<I;h++){var p=u[d[h]],y=p.items,A=p.cateAxisId,m=y.filter(function(Z){return Rc(Z.type).indexOf("Bar")>=0});if(m&&m.length){var b=m[0].type.defaultProps,v=b!==void 0?Hi(Hi({},b),m[0].props):m[0].props,w=v.barSize,x=v[A];o[x]||(o[x]=[]);var B=en(w)?n:w;o[x].push({item:m[0],stackList:m.slice(1),barSize:en(B)?void 0:bs(B,i,0)})}}return o},WNe=function(e){var n=e.barGap,i=e.barCategoryGap,r=e.bandSize,s=e.sizeList,o=s===void 0?[]:s,a=e.maxBarSize,l=o.length;if(l<1)return null;var c=bs(n,r,0,!0),u,d=[];if(o[0].barSize===+o[0].barSize){var h=!1,I=r/l,p=o.reduce(function(w,x){return w+x.barSize||0},0);p+=(l-1)*c,p>=r&&(p-=(l-1)*c,c=0),p>=r&&I>0&&(h=!0,I*=.9,p=l*I);var y=(r-p)/2>>0,A={offset:y-c,size:0};u=o.reduce(function(w,x){var B={item:x.item,position:{offset:A.offset+A.size+c,size:h?I:x.barSize}},Z=[].concat(s9(w),[B]);return A=Z[Z.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(N){Z.push({item:N,position:A})}),Z},d)}else{var m=bs(i,r,0,!0);r-2*m-(l-1)*c<=0&&(c=0);var b=(r-2*m-(l-1)*c)/l;b>1&&(b>>=0);var v=a===+a?Math.min(b,a):b;u=o.reduce(function(w,x,B){var Z=[].concat(s9(w),[{item:x.item,position:{offset:m+(b+c)*B+(b-v)/2,size:v}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(N){Z.push({item:N,position:Z[Z.length-1].position})}),Z},d)}return u},MNe=function(e,n,i,r){var s=i.children,o=i.width,a=i.margin,l=o-(a.left||0)-(a.right||0),c=g6({children:s,legendWidth:l});if(c){var u=r||{},d=u.width,h=u.height,I=c.align,p=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&p==="middle")&&I!=="center"&&ut(e[I]))return Hi(Hi({},e),{},qI({},I,e[I]+(d||0)));if((y==="horizontal"||y==="vertical"&&I==="center")&&p!=="middle"&&ut(e[p]))return Hi(Hi({},e),{},qI({},p,e[p]+(h||0)))}return e},VNe=function(e,n,i){return en(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},u6=function(e,n,i,r,s){var o=n.props.children,a=Gs(o,PC).filter(function(c){return VNe(r,s,c.props.direction)});if(a&&a.length){var l=a.map(function(c){return c.props.dataKey});return e.reduce(function(c,u){var d=yi(u,i);if(en(d))return c;var h=Array.isArray(d)?[WB(d),Xg(d)]:[d,d],I=l.reduce(function(p,y){var A=yi(u,y,0),m=h[0]-Math.abs(Array.isArray(A)?A[0]:A),b=h[1]+Math.abs(Array.isArray(A)?A[1]:A);return[Math.min(m,p[0]),Math.max(b,p[1])]},[1/0,-1/0]);return[Math.min(I[0],c[0]),Math.max(I[1],c[1])]},[1/0,-1/0])}return null},FNe=function(e,n,i,r,s){var o=n.map(function(a){return u6(e,a,i,s,r)}).filter(function(a){return!en(a)});return o&&o.length?o.reduce(function(a,l){return[Math.min(a[0],l[0]),Math.max(a[1],l[1])]},[1/0,-1/0]):null},d6=function(e,n,i,r,s){var o=n.map(function(l){var c=l.props.dataKey;return i==="number"&&c&&u6(e,l,c,r)||_m(e,c,i,s)});if(i==="number")return o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var a={};return o.reduce(function(l,c){for(var u=0,d=c.length;u<d;u++)a[c[u]]||(a[c[u]]=!0,l.push(c[u]));return l},[])},h6=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},I6=function(e,n,i,r){if(r)return e.map(function(l){return l.coordinate});var s,o,a=e.map(function(l){return l.coordinate===n&&(s=!0),l.coordinate===i&&(o=!0),l.coordinate});return s||a.push(n),o||a.push(i),a},xc=function(e,n,i){if(!e)return null;var r=e.scale,s=e.duplicateDomain,o=e.type,a=e.range,l=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(n||i)&&o==="category"&&r.bandwidth?r.bandwidth()/l:0;if(c=e.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?ys(a[0]-a[1])*2*c:c,n&&(e.ticks||e.niceTicks)){var u=(e.ticks||e.niceTicks).map(function(d){var h=s?s.indexOf(d):d;return{coordinate:r(h)+c,value:d,offset:c}});return u.filter(function(d){return!YC(d.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(d,h){return{coordinate:r(d)+c,value:d,index:h,offset:c}}):r.ticks&&!i?r.ticks(e.tickCount).map(function(d){return{coordinate:r(d)+c,value:d,offset:c}}):r.domain().map(function(d,h){return{coordinate:r(d)+c,value:s?s[d]:d,index:h,offset:c}})},DZ=new WeakMap,Lb=function(e,n){if(typeof n!="function")return e;DZ.has(e)||DZ.set(e,new WeakMap);var i=DZ.get(e);if(i.has(n))return i.get(n);var r=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,r),r},f6=function(e,n,i){var r=e.scale,s=e.type,o=e.layout,a=e.axisType;if(r==="auto")return o==="radial"&&a==="radiusAxis"?{scale:RA(),realScaleType:"band"}:o==="radial"&&a==="angleAxis"?{scale:Tw(),realScaleType:"linear"}:s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:Fm(),realScaleType:"point"}:s==="category"?{scale:RA(),realScaleType:"band"}:{scale:Tw(),realScaleType:"linear"};if(L0(r)){var l="scale".concat(CB(r));return{scale:($H[l]||Fm)(),realScaleType:$H[l]?l:"point"}}return $t(r)?{scale:r}:{scale:Fm(),realScaleType:"point"}},a9=1e-4,C6=function(e){var n=e.domain();if(!(!n||n.length<=2)){var i=n.length,r=e.range(),s=Math.min(r[0],r[1])-a9,o=Math.max(r[0],r[1])+a9,a=e(n[0]),l=e(n[i-1]);(a<s||a>o||l<s||l>o)&&e.domain([n[0],n[i-1]])}},_Ne=function(e,n){if(!e)return null;for(var i=0,r=e.length;i<r;i++)if(e[i].item===n)return e[i].position;return null},TNe=function(e,n){if(!n||n.length!==2||!ut(n[0])||!ut(n[1]))return e;var i=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]),s=[e[0],e[1]];return(!ut(e[0])||e[0]<i)&&(s[0]=i),(!ut(e[1])||e[1]>r)&&(s[1]=r),s[0]>r&&(s[0]=r),s[1]<i&&(s[1]=i),s},XNe=function(e){var n=e.length;if(!(n<=0))for(var i=0,r=e[0].length;i<r;++i)for(var s=0,o=0,a=0;a<n;++a){var l=YC(e[a][i][1])?e[a][i][0]:e[a][i][1];l>=0?(e[a][i][0]=s,e[a][i][1]=s+l,s=e[a][i][1]):(e[a][i][0]=o,e[a][i][1]=o+l,o=e[a][i][1])}},ENe=function(e){var n=e.length;if(!(n<=0))for(var i=0,r=e[0].length;i<r;++i)for(var s=0,o=0;o<n;++o){var a=YC(e[o][i][1])?e[o][i][0]:e[o][i][1];a>=0?(e[o][i][0]=s,e[o][i][1]=s+a,s=e[o][i][1]):(e[o][i][0]=0,e[o][i][1]=0)}},YNe={sign:XNe,expand:r0e,none:Rf,silhouette:s0e,wiggle:o0e,positive:ENe},kNe=function(e,n,i){var r=n.map(function(a){return a.props.dataKey}),s=YNe[i],o=i0e().keys(r).value(function(a,l){return+yi(a,l,0)}).order(tM).offset(s);return o(e)},HNe=function(e,n,i,r,s,o){if(!e)return null;var a=o?n.reverse():n,l={},c=a.reduce(function(d,h){var I,p=(I=h.type)!==null&&I!==void 0&&I.defaultProps?Hi(Hi({},h.type.defaultProps),h.props):h.props,y=p.stackId,A=p.hide;if(A)return d;var m=p[i],b=d[m]||{hasStack:!1,stackGroups:{}};if(dr(y)){var v=b.stackGroups[y]||{numericAxisId:i,cateAxisId:r,items:[]};v.items.push(h),b.hasStack=!0,b.stackGroups[y]=v}else b.stackGroups[yu("_stackId_")]={numericAxisId:i,cateAxisId:r,items:[h]};return Hi(Hi({},d),{},qI({},m,b))},l),u={};return Object.keys(c).reduce(function(d,h){var I=c[h];if(I.hasStack){var p={};I.stackGroups=Object.keys(I.stackGroups).reduce(function(y,A){var m=I.stackGroups[A];return Hi(Hi({},y),{},qI({},A,{numericAxisId:i,cateAxisId:r,items:m.items,stackedData:kNe(e,m.items,s)}))},p)}return Hi(Hi({},d),{},qI({},h,I))},u)},p6=function(e,n){var i=n.realScaleType,r=n.type,s=n.tickCount,o=n.originalDomain,a=n.allowDecimals,l=i||n.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var u=tNe(c,s,a);return e.domain([WB(u),Xg(u)]),{niceTicks:u}}if(s&&r==="number"){var d=e.domain(),h=nNe(d,s,a);return{niceTicks:h}}return null};function Ef(t){var e=t.axis,n=t.ticks,i=t.bandSize,r=t.entry,s=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!en(r[e.dataKey])){var a=fw(n,"value",r[e.dataKey]);if(a)return a.coordinate+i/2}return n[s]?n[s].coordinate+i/2:null}var l=yi(r,en(o)?e.dataKey:o);return en(l)?null:e.scale(l)}var l9=function(e){var n=e.axis,i=e.ticks,r=e.offset,s=e.bandSize,o=e.entry,a=e.index;if(n.type==="category")return i[a]?i[a].coordinate+r:null;var l=yi(o,n.dataKey,n.domain[a]);return en(l)?null:n.scale(l)-s/2+r},KNe=function(e){var n=e.numericAxis,i=n.scale.domain();if(n.type==="number"){var r=Math.min(i[0],i[1]),s=Math.max(i[0],i[1]);return r<=0&&s>=0?0:s<0?s:r}return i[0]},LNe=function(e,n){var i,r=(i=e.type)!==null&&i!==void 0&&i.defaultProps?Hi(Hi({},e.type.defaultProps),e.props):e.props,s=r.stackId;if(dr(s)){var o=n[s];if(o){var a=o.items.indexOf(e);return a>=0?o.stackedData[a]:null}}return null},zNe=function(e){return e.reduce(function(n,i){return[WB(i.concat([n[0]]).filter(ut)),Xg(i.concat([n[1]]).filter(ut))]},[1/0,-1/0])},m6=function(e,n,i){return Object.keys(e).reduce(function(r,s){var o=e[s],a=o.stackedData,l=a.reduce(function(c,u){var d=zNe(u.slice(n,i+1));return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],r[0]),Math.max(l[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},c9=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,g9=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WM=function(e,n,i){if($t(e))return e(n,i);if(!Array.isArray(e))return n;var r=[];if(ut(e[0]))r[0]=i?e[0]:Math.min(e[0],n[0]);else if(c9.test(e[0])){var s=+c9.exec(e[0])[1];r[0]=n[0]-s}else $t(e[0])?r[0]=e[0](n[0]):r[0]=n[0];if(ut(e[1]))r[1]=i?e[1]:Math.max(e[1],n[1]);else if(g9.test(e[1])){var o=+g9.exec(e[1])[1];r[1]=n[1]+o}else $t(e[1])?r[1]=e[1](n[1]):r[1]=n[1];return r},Lw=function(e,n,i){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!i||r>0)return r}if(e&&n&&n.length>=2){for(var s=dF(n,function(d){return d.coordinate}),o=1/0,a=1,l=s.length;a<l;a++){var c=s[a],u=s[a-1];o=Math.min((c.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return i?void 0:0},u9=function(e,n,i){return!e||!e.length||ou(e,wo(i,"type.defaultProps.domain"))?n:e},A6=function(e,n){var i=e.type.defaultProps?Hi(Hi({},e.type.defaultProps),e.props):e.props,r=i.dataKey,s=i.name,o=i.unit,a=i.formatter,l=i.tooltipType,c=i.chartType,u=i.hide;return Hi(Hi({},Yt(e,!1)),{},{dataKey:r,unit:o,formatter:a,name:s||r,color:EF(e),value:yi(n,r),type:l,payload:n,chartType:c,hide:u})};function EA(t){"@babel/helpers - typeof";return EA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EA(t)}function d9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Ic(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d9(Object(n),!0).forEach(function(i){y6(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function y6(t,e,n){return e=jNe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jNe(t){var e=PNe(t,"string");return EA(e)=="symbol"?e:e+""}function PNe(t,e){if(EA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(EA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ONe(t,e){return QNe(t)||JNe(t,e)||UNe(t,e)||DNe()}function DNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UNe(t,e){if(t){if(typeof t=="string")return h9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h9(t,e)}}function h9(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function JNe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function QNe(t){if(Array.isArray(t))return t}var zw=Math.PI/180,qNe=function(e){return e*180/Math.PI},Ii=function(e,n,i,r){return{x:e+Math.cos(-zw*r)*i,y:n+Math.sin(-zw*r)*i}},b6=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(i.left||0)-(i.right||0)),Math.abs(n-(i.top||0)-(i.bottom||0)))/2},$Ne=function(e,n,i,r,s){var o=e.width,a=e.height,l=e.startAngle,c=e.endAngle,u=bs(e.cx,o,o/2),d=bs(e.cy,a,a/2),h=b6(o,a,i),I=bs(e.innerRadius,h,0),p=bs(e.outerRadius,h,h*.8),y=Object.keys(n);return y.reduce(function(A,m){var b=n[m],v=b.domain,w=b.reversed,x;if(en(b.range))r==="angleAxis"?x=[l,c]:r==="radiusAxis"&&(x=[I,p]),w&&(x=[x[1],x[0]]);else{x=b.range;var B=x,Z=ONe(B,2);l=Z[0],c=Z[1]}var N=f6(b,s),W=N.realScaleType,M=N.scale;M.domain(v).range(x),C6(M);var F=p6(M,Ic(Ic({},b),{},{realScaleType:W})),T=Ic(Ic(Ic({},b),F),{},{range:x,radius:p,realScaleType:W,scale:M,cx:u,cy:d,innerRadius:I,outerRadius:p,startAngle:l,endAngle:c});return Ic(Ic({},A),{},y6({},m,T))},{})},eWe=function(e,n){var i=e.x,r=e.y,s=n.x,o=n.y;return Math.sqrt(Math.pow(i-s,2)+Math.pow(r-o,2))},tWe=function(e,n){var i=e.x,r=e.y,s=n.cx,o=n.cy,a=eWe({x:i,y:r},{x:s,y:o});if(a<=0)return{radius:a};var l=(i-s)/a,c=Math.acos(l);return r>o&&(c=2*Math.PI-c),{radius:a,angle:qNe(c),angleInRadian:c}},nWe=function(e){var n=e.startAngle,i=e.endAngle,r=Math.floor(n/360),s=Math.floor(i/360),o=Math.min(r,s);return{startAngle:n-o*360,endAngle:i-o*360}},iWe=function(e,n){var i=n.startAngle,r=n.endAngle,s=Math.floor(i/360),o=Math.floor(r/360),a=Math.min(s,o);return e+a*360},I9=function(e,n){var i=e.x,r=e.y,s=tWe({x:i,y:r},n),o=s.radius,a=s.angle,l=n.innerRadius,c=n.outerRadius;if(o<l||o>c)return!1;if(o===0)return!0;var u=nWe(n),d=u.startAngle,h=u.endAngle,I=a,p;if(d<=h){for(;I>h;)I-=360;for(;I<d;)I+=360;p=I>=d&&I<=h}else{for(;I>d;)I-=360;for(;I<h;)I+=360;p=I>=h&&I<=d}return p?Ic(Ic({},n),{},{radius:o,angle:iWe(I,n)}):null},v6=function(e){return!S.isValidElement(e)&&!$t(e)&&typeof e!="boolean"?e.className:""};function YA(t){"@babel/helpers - typeof";return YA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YA(t)}var rWe=["offset"];function sWe(t){return cWe(t)||lWe(t)||aWe(t)||oWe()}function oWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aWe(t,e){if(t){if(typeof t=="string")return MM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MM(t,e)}}function lWe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cWe(t){if(Array.isArray(t))return MM(t)}function MM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function gWe(t,e){if(t==null)return{};var n=uWe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function uWe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function f9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function or(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f9(Object(n),!0).forEach(function(i){dWe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function dWe(t,e,n){return e=hWe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hWe(t){var e=IWe(t,"string");return YA(e)=="symbol"?e:e+""}function IWe(t,e){if(YA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(YA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kA(){return kA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},kA.apply(this,arguments)}var fWe=function(e){var n=e.value,i=e.formatter,r=en(e.children)?n:e.children;return $t(i)?i(r):r},CWe=function(e,n){var i=ys(n-e),r=Math.min(Math.abs(n-e),360);return i*r},pWe=function(e,n,i){var r=e.position,s=e.viewBox,o=e.offset,a=e.className,l=s,c=l.cx,u=l.cy,d=l.innerRadius,h=l.outerRadius,I=l.startAngle,p=l.endAngle,y=l.clockWise,A=(d+h)/2,m=CWe(I,p),b=m>=0?1:-1,v,w;r==="insideStart"?(v=I+b*o,w=y):r==="insideEnd"?(v=p-b*o,w=!y):r==="end"&&(v=p+b*o,w=y),w=m<=0?w:!w;var x=Ii(c,u,A,v),B=Ii(c,u,A,v+(w?1:-1)*359),Z="M".concat(x.x,",").concat(x.y,`
    A`).concat(A,",").concat(A,",0,1,").concat(w?0:1,`,
    `).concat(B.x,",").concat(B.y),N=en(e.id)?yu("recharts-radial-line-"):e.id;return $.createElement("text",kA({},i,{dominantBaseline:"central",className:ln("recharts-radial-bar-label",a)}),$.createElement("defs",null,$.createElement("path",{id:N,d:Z})),$.createElement("textPath",{xlinkHref:"#".concat(N)},n))},mWe=function(e){var n=e.viewBox,i=e.offset,r=e.position,s=n,o=s.cx,a=s.cy,l=s.innerRadius,c=s.outerRadius,u=s.startAngle,d=s.endAngle,h=(u+d)/2;if(r==="outside"){var I=Ii(o,a,c+i,h),p=I.x,y=I.y;return{x:p,y,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(l+c)/2,m=Ii(o,a,A,h),b=m.x,v=m.y;return{x:b,y:v,textAnchor:"middle",verticalAnchor:"middle"}},AWe=function(e){var n=e.viewBox,i=e.parentViewBox,r=e.offset,s=e.position,o=n,a=o.x,l=o.y,c=o.width,u=o.height,d=u>=0?1:-1,h=d*r,I=d>0?"end":"start",p=d>0?"start":"end",y=c>=0?1:-1,A=y*r,m=y>0?"end":"start",b=y>0?"start":"end";if(s==="top"){var v={x:a+c/2,y:l-d*r,textAnchor:"middle",verticalAnchor:I};return or(or({},v),i?{height:Math.max(l-i.y,0),width:c}:{})}if(s==="bottom"){var w={x:a+c/2,y:l+u+h,textAnchor:"middle",verticalAnchor:p};return or(or({},w),i?{height:Math.max(i.y+i.height-(l+u),0),width:c}:{})}if(s==="left"){var x={x:a-A,y:l+u/2,textAnchor:m,verticalAnchor:"middle"};return or(or({},x),i?{width:Math.max(x.x-i.x,0),height:u}:{})}if(s==="right"){var B={x:a+c+A,y:l+u/2,textAnchor:b,verticalAnchor:"middle"};return or(or({},B),i?{width:Math.max(i.x+i.width-B.x,0),height:u}:{})}var Z=i?{width:c,height:u}:{};return s==="insideLeft"?or({x:a+A,y:l+u/2,textAnchor:b,verticalAnchor:"middle"},Z):s==="insideRight"?or({x:a+c-A,y:l+u/2,textAnchor:m,verticalAnchor:"middle"},Z):s==="insideTop"?or({x:a+c/2,y:l+h,textAnchor:"middle",verticalAnchor:p},Z):s==="insideBottom"?or({x:a+c/2,y:l+u-h,textAnchor:"middle",verticalAnchor:I},Z):s==="insideTopLeft"?or({x:a+A,y:l+h,textAnchor:b,verticalAnchor:p},Z):s==="insideTopRight"?or({x:a+c-A,y:l+h,textAnchor:m,verticalAnchor:p},Z):s==="insideBottomLeft"?or({x:a+A,y:l+u-h,textAnchor:b,verticalAnchor:I},Z):s==="insideBottomRight"?or({x:a+c-A,y:l+u-h,textAnchor:m,verticalAnchor:I},Z):_C(s)&&(ut(s.x)||fd(s.x))&&(ut(s.y)||fd(s.y))?or({x:a+bs(s.x,c),y:l+bs(s.y,u),textAnchor:"end",verticalAnchor:"end"},Z):or({x:a+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},Z)},yWe=function(e){return"cx"in e&&ut(e.cx)};function wr(t){var e=t.offset,n=e===void 0?5:e,i=gWe(t,rWe),r=or({offset:n},i),s=r.viewBox,o=r.position,a=r.value,l=r.children,c=r.content,u=r.className,d=u===void 0?"":u,h=r.textBreakAll;if(!s||en(a)&&en(l)&&!S.isValidElement(c)&&!$t(c))return null;if(S.isValidElement(c))return S.cloneElement(c,r);var I;if($t(c)){if(I=S.createElement(c,r),S.isValidElement(I))return I}else I=fWe(r);var p=yWe(s),y=Yt(r,!0);if(p&&(o==="insideStart"||o==="insideEnd"||o==="end"))return pWe(r,I,y);var A=p?mWe(r):AWe(r);return $.createElement($d,kA({className:ln("recharts-label",d)},y,A,{breakAll:h}),I)}wr.displayName="Label";var x6=function(e){var n=e.cx,i=e.cy,r=e.angle,s=e.startAngle,o=e.endAngle,a=e.r,l=e.radius,c=e.innerRadius,u=e.outerRadius,d=e.x,h=e.y,I=e.top,p=e.left,y=e.width,A=e.height,m=e.clockWise,b=e.labelViewBox;if(b)return b;if(ut(y)&&ut(A)){if(ut(d)&&ut(h))return{x:d,y:h,width:y,height:A};if(ut(I)&&ut(p))return{x:I,y:p,width:y,height:A}}return ut(d)&&ut(h)?{x:d,y:h,width:0,height:0}:ut(n)&&ut(i)?{cx:n,cy:i,startAngle:s||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:u||l||a||0,clockWise:m}:e.viewBox?e.viewBox:{}},bWe=function(e,n){return e?e===!0?$.createElement(wr,{key:"label-implicit",viewBox:n}):dr(e)?$.createElement(wr,{key:"label-implicit",viewBox:n,value:e}):S.isValidElement(e)?e.type===wr?S.cloneElement(e,{key:"label-implicit",viewBox:n}):$.createElement(wr,{key:"label-implicit",content:e,viewBox:n}):$t(e)?$.createElement(wr,{key:"label-implicit",content:e,viewBox:n}):_C(e)?$.createElement(wr,kA({viewBox:n},e,{key:"label-implicit"})):null:null},vWe=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&i&&!e.label)return null;var r=e.children,s=x6(e),o=Gs(r,wr).map(function(l,c){return S.cloneElement(l,{viewBox:n||s,key:"label-".concat(c)})});if(!i)return o;var a=bWe(e.label,n||s);return[a].concat(sWe(o))};wr.parseViewBox=x6;wr.renderCallByParent=vWe;function xWe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var wWe=xWe;const GWe=Pn(wWe);function HA(t){"@babel/helpers - typeof";return HA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HA(t)}var BWe=["valueAccessor"],SWe=["data","dataKey","clockWise","id","textBreakAll"];function ZWe(t){return MWe(t)||WWe(t)||NWe(t)||RWe()}function RWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NWe(t,e){if(t){if(typeof t=="string")return VM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VM(t,e)}}function WWe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function MWe(t){if(Array.isArray(t))return VM(t)}function VM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function jw(){return jw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},jw.apply(this,arguments)}function C9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function p9(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?C9(Object(n),!0).forEach(function(i){VWe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function VWe(t,e,n){return e=FWe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FWe(t){var e=_We(t,"string");return HA(e)=="symbol"?e:e+""}function _We(t,e){if(HA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(HA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m9(t,e){if(t==null)return{};var n=TWe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function TWe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var XWe=function(e){return Array.isArray(e.value)?GWe(e.value):e.value};function Oa(t){var e=t.valueAccessor,n=e===void 0?XWe:e,i=m9(t,BWe),r=i.data,s=i.dataKey,o=i.clockWise,a=i.id,l=i.textBreakAll,c=m9(i,SWe);return!r||!r.length?null:$.createElement(fn,{className:"recharts-label-list"},r.map(function(u,d){var h=en(s)?n(u,d):yi(u&&u.payload,s),I=en(a)?{}:{id:"".concat(a,"-").concat(d)};return $.createElement(wr,jw({},Yt(u,!0),c,I,{parentViewBox:u.parentViewBox,value:h,textBreakAll:l,viewBox:wr.parseViewBox(en(o)?u:p9(p9({},u),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}Oa.displayName="LabelList";function EWe(t,e){return t?t===!0?$.createElement(Oa,{key:"labelList-implicit",data:e}):$.isValidElement(t)||$t(t)?$.createElement(Oa,{key:"labelList-implicit",data:e,content:t}):_C(t)?$.createElement(Oa,jw({data:e},t,{key:"labelList-implicit"})):null:null}function YWe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,r=Gs(i,Oa).map(function(o,a){return S.cloneElement(o,{data:e,key:"labelList-".concat(a)})});if(!n)return r;var s=EWe(t.label,e);return[s].concat(ZWe(r))}Oa.renderCallByParent=YWe;function KA(t){"@babel/helpers - typeof";return KA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KA(t)}function FM(){return FM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},FM.apply(this,arguments)}function A9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function y9(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A9(Object(n),!0).forEach(function(i){kWe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function kWe(t,e,n){return e=HWe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HWe(t){var e=KWe(t,"string");return KA(e)=="symbol"?e:e+""}function KWe(t,e){if(KA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(KA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LWe=function(e,n){var i=ys(n-e),r=Math.min(Math.abs(n-e),359.999);return i*r},zb=function(e){var n=e.cx,i=e.cy,r=e.radius,s=e.angle,o=e.sign,a=e.isExternal,l=e.cornerRadius,c=e.cornerIsExternal,u=l*(a?1:-1)+r,d=Math.asin(l/u)/zw,h=c?s:s+o*d,I=Ii(n,i,u,h),p=Ii(n,i,r,h),y=c?s-o*d:s,A=Ii(n,i,u*Math.cos(d*zw),y);return{center:I,circleTangency:p,lineTangency:A,theta:d}},w6=function(e){var n=e.cx,i=e.cy,r=e.innerRadius,s=e.outerRadius,o=e.startAngle,a=e.endAngle,l=LWe(o,a),c=o+l,u=Ii(n,i,s,o),d=Ii(n,i,s,c),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(r>0){var I=Ii(n,i,r,o),p=Ii(n,i,r,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=c),`,
            `).concat(I.x,",").concat(I.y," Z")}else h+="L ".concat(n,",").concat(i," Z");return h},zWe=function(e){var n=e.cx,i=e.cy,r=e.innerRadius,s=e.outerRadius,o=e.cornerRadius,a=e.forceCornerRadius,l=e.cornerIsExternal,c=e.startAngle,u=e.endAngle,d=ys(u-c),h=zb({cx:n,cy:i,radius:s,angle:c,sign:d,cornerRadius:o,cornerIsExternal:l}),I=h.circleTangency,p=h.lineTangency,y=h.theta,A=zb({cx:n,cy:i,radius:s,angle:u,sign:-d,cornerRadius:o,cornerIsExternal:l}),m=A.circleTangency,b=A.lineTangency,v=A.theta,w=l?Math.abs(c-u):Math.abs(c-u)-y-v;if(w<0)return a?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):w6({cx:n,cy:i,innerRadius:r,outerRadius:s,startAngle:c,endAngle:u});var x="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(I.x,",").concat(I.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(w>180),",").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var B=zb({cx:n,cy:i,radius:r,angle:c,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),Z=B.circleTangency,N=B.lineTangency,W=B.theta,M=zb({cx:n,cy:i,radius:r,angle:u,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),F=M.circleTangency,T=M.lineTangency,H=M.theta,K=l?Math.abs(c-u):Math.abs(c-u)-W-H;if(K<0&&o===0)return"".concat(x,"L").concat(n,",").concat(i,"Z");x+="L".concat(T.x,",").concat(T.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(F.x,",").concat(F.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(K>180),",").concat(+(d>0),",").concat(Z.x,",").concat(Z.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else x+="L".concat(n,",").concat(i,"Z");return x},jWe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},G6=function(e){var n=y9(y9({},jWe),e),i=n.cx,r=n.cy,s=n.innerRadius,o=n.outerRadius,a=n.cornerRadius,l=n.forceCornerRadius,c=n.cornerIsExternal,u=n.startAngle,d=n.endAngle,h=n.className;if(o<s||u===d)return null;var I=ln("recharts-sector",h),p=o-s,y=bs(a,p,0,!0),A;return y>0&&Math.abs(u-d)<360?A=zWe({cx:i,cy:r,innerRadius:s,outerRadius:o,cornerRadius:Math.min(y,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):A=w6({cx:i,cy:r,innerRadius:s,outerRadius:o,startAngle:u,endAngle:d}),$.createElement("path",FM({},Yt(n,!0),{className:I,d:A,role:"img"}))};function LA(t){"@babel/helpers - typeof";return LA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LA(t)}function _M(){return _M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_M.apply(this,arguments)}function b9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function v9(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b9(Object(n),!0).forEach(function(i){PWe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function PWe(t,e,n){return e=OWe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OWe(t){var e=DWe(t,"string");return LA(e)=="symbol"?e:e+""}function DWe(t,e){if(LA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(LA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var x9={curveBasisClosed:PAe,curveBasisOpen:OAe,curveBasis:jAe,curveBumpX:WAe,curveBumpY:MAe,curveLinearClosed:DAe,curveLinear:mB,curveMonotoneX:UAe,curveMonotoneY:JAe,curveNatural:QAe,curveStep:qAe,curveStepAfter:e0e,curveStepBefore:$Ae},jb=function(e){return e.x===+e.x&&e.y===+e.y},Tp=function(e){return e.x},Xp=function(e){return e.y},UWe=function(e,n){if($t(e))return e;var i="curve".concat(CB(e));return(i==="curveMonotone"||i==="curveBump")&&n?x9["".concat(i).concat(n==="vertical"?"Y":"X")]:x9[i]||mB},JWe=function(e){var n=e.type,i=n===void 0?"linear":n,r=e.points,s=r===void 0?[]:r,o=e.baseLine,a=e.layout,l=e.connectNulls,c=l===void 0?!1:l,u=UWe(i,a),d=c?s.filter(function(y){return jb(y)}):s,h;if(Array.isArray(o)){var I=c?o.filter(function(y){return jb(y)}):o,p=d.map(function(y,A){return v9(v9({},y),{},{base:I[A]})});return a==="vertical"?h=_b().y(Xp).x1(Tp).x0(function(y){return y.base.x}):h=_b().x(Tp).y1(Xp).y0(function(y){return y.base.y}),h.defined(jb).curve(u),h(p)}return a==="vertical"&&ut(o)?h=_b().y(Xp).x1(Tp).x0(o):ut(o)?h=_b().x(Tp).y1(Xp).y0(o):h=A8().x(Tp).y(Xp),h.defined(jb).curve(u),h(d)},Qg=function(e){var n=e.className,i=e.points,r=e.path,s=e.pathRef;if((!i||!i.length)&&!r)return null;var o=i&&i.length?JWe(e):r;return $.createElement("path",_M({},Yt(e,!1),Cw(e),{className:ln("recharts-curve",n),d:o,ref:s}))},B6={exports:{}},QWe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",qWe=QWe,$We=qWe;function S6(){}function Z6(){}Z6.resetWarningCache=S6;var eMe=function(){function t(i,r,s,o,a,l){if(l!==$We){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Z6,resetWarningCache:S6};return n.PropTypes=n,n};B6.exports=eMe();var tMe=B6.exports;const Un=Pn(tMe);var nMe=Object.getOwnPropertyNames,iMe=Object.getOwnPropertySymbols,rMe=Object.prototype.hasOwnProperty;function w9(t,e){return function(i,r,s){return t(i,r,s)&&e(i,r,s)}}function Pb(t){return function(n,i,r){if(!n||!i||typeof n!="object"||typeof i!="object")return t(n,i,r);var s=r.cache,o=s.get(n),a=s.get(i);if(o&&a)return o===i&&a===n;s.set(n,i),s.set(i,n);var l=t(n,i,r);return s.delete(n),s.delete(i),l}}function G9(t){return nMe(t).concat(iMe(t))}var sMe=Object.hasOwn||function(t,e){return rMe.call(t,e)};function ph(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var oMe="__v",aMe="__o",lMe="_owner",B9=Object.getOwnPropertyDescriptor,S9=Object.keys;function cMe(t,e,n){var i=t.length;if(e.length!==i)return!1;for(;i-- >0;)if(!n.equals(t[i],e[i],i,i,t,e,n))return!1;return!0}function gMe(t,e){return ph(t.getTime(),e.getTime())}function uMe(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function dMe(t,e){return t===e}function Z9(t,e,n){var i=t.size;if(i!==e.size)return!1;if(!i)return!0;for(var r=new Array(i),s=t.entries(),o,a,l=0;(o=s.next())&&!o.done;){for(var c=e.entries(),u=!1,d=0;(a=c.next())&&!a.done;){if(r[d]){d++;continue}var h=o.value,I=a.value;if(n.equals(h[0],I[0],l,d,t,e,n)&&n.equals(h[1],I[1],h[0],I[0],t,e,n)){u=r[d]=!0;break}d++}if(!u)return!1;l++}return!0}var hMe=ph;function IMe(t,e,n){var i=S9(t),r=i.length;if(S9(e).length!==r)return!1;for(;r-- >0;)if(!R6(t,e,n,i[r]))return!1;return!0}function Ep(t,e,n){var i=G9(t),r=i.length;if(G9(e).length!==r)return!1;for(var s,o,a;r-- >0;)if(s=i[r],!R6(t,e,n,s)||(o=B9(t,s),a=B9(e,s),(o||a)&&(!o||!a||o.configurable!==a.configurable||o.enumerable!==a.enumerable||o.writable!==a.writable)))return!1;return!0}function fMe(t,e){return ph(t.valueOf(),e.valueOf())}function CMe(t,e){return t.source===e.source&&t.flags===e.flags}function R9(t,e,n){var i=t.size;if(i!==e.size)return!1;if(!i)return!0;for(var r=new Array(i),s=t.values(),o,a;(o=s.next())&&!o.done;){for(var l=e.values(),c=!1,u=0;(a=l.next())&&!a.done;){if(!r[u]&&n.equals(o.value,a.value,o.value,a.value,t,e,n)){c=r[u]=!0;break}u++}if(!c)return!1}return!0}function pMe(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function mMe(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function R6(t,e,n,i){return(i===lMe||i===aMe||i===oMe)&&(t.$$typeof||e.$$typeof)?!0:sMe(e,i)&&n.equals(t[i],e[i],i,i,t,e,n)}var AMe="[object Arguments]",yMe="[object Boolean]",bMe="[object Date]",vMe="[object Error]",xMe="[object Map]",wMe="[object Number]",GMe="[object Object]",BMe="[object RegExp]",SMe="[object Set]",ZMe="[object String]",RMe="[object URL]",NMe=Array.isArray,N9=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,W9=Object.assign,WMe=Object.prototype.toString.call.bind(Object.prototype.toString);function MMe(t){var e=t.areArraysEqual,n=t.areDatesEqual,i=t.areErrorsEqual,r=t.areFunctionsEqual,s=t.areMapsEqual,o=t.areNumbersEqual,a=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,c=t.areRegExpsEqual,u=t.areSetsEqual,d=t.areTypedArraysEqual,h=t.areUrlsEqual;return function(p,y,A){if(p===y)return!0;if(p==null||y==null)return!1;var m=typeof p;if(m!==typeof y)return!1;if(m!=="object")return m==="number"?o(p,y,A):m==="function"?r(p,y,A):!1;var b=p.constructor;if(b!==y.constructor)return!1;if(b===Object)return a(p,y,A);if(NMe(p))return e(p,y,A);if(N9!=null&&N9(p))return d(p,y,A);if(b===Date)return n(p,y,A);if(b===RegExp)return c(p,y,A);if(b===Map)return s(p,y,A);if(b===Set)return u(p,y,A);var v=WMe(p);return v===bMe?n(p,y,A):v===BMe?c(p,y,A):v===xMe?s(p,y,A):v===SMe?u(p,y,A):v===GMe?typeof p.then!="function"&&typeof y.then!="function"&&a(p,y,A):v===RMe?h(p,y,A):v===vMe?i(p,y,A):v===AMe?a(p,y,A):v===yMe||v===wMe||v===ZMe?l(p,y,A):!1}}function VMe(t){var e=t.circular,n=t.createCustomConfig,i=t.strict,r={areArraysEqual:i?Ep:cMe,areDatesEqual:gMe,areErrorsEqual:uMe,areFunctionsEqual:dMe,areMapsEqual:i?w9(Z9,Ep):Z9,areNumbersEqual:hMe,areObjectsEqual:i?Ep:IMe,arePrimitiveWrappersEqual:fMe,areRegExpsEqual:CMe,areSetsEqual:i?w9(R9,Ep):R9,areTypedArraysEqual:i?Ep:pMe,areUrlsEqual:mMe};if(n&&(r=W9({},r,n(r))),e){var s=Pb(r.areArraysEqual),o=Pb(r.areMapsEqual),a=Pb(r.areObjectsEqual),l=Pb(r.areSetsEqual);r=W9({},r,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return r}function FMe(t){return function(e,n,i,r,s,o,a){return t(e,n,a)}}function _Me(t){var e=t.circular,n=t.comparator,i=t.createState,r=t.equals,s=t.strict;if(i)return function(l,c){var u=i(),d=u.cache,h=d===void 0?e?new WeakMap:void 0:d,I=u.meta;return n(l,c,{cache:h,equals:r,meta:I,strict:s})};if(e)return function(l,c){return n(l,c,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};var o={cache:void 0,equals:r,meta:void 0,strict:s};return function(l,c){return n(l,c,o)}}var TMe=xu();xu({strict:!0});xu({circular:!0});xu({circular:!0,strict:!0});xu({createInternalComparator:function(){return ph}});xu({strict:!0,createInternalComparator:function(){return ph}});xu({circular:!0,createInternalComparator:function(){return ph}});xu({circular:!0,createInternalComparator:function(){return ph},strict:!0});function xu(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,i=t.createInternalComparator,r=t.createState,s=t.strict,o=s===void 0?!1:s,a=VMe(t),l=MMe(a),c=i?i(l):FMe(l);return _Me({circular:n,comparator:l,createState:r,equals:c,strict:o})}function XMe(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function M9(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function r(s){n<0&&(n=s),s-n>e?(t(s),n=-1):XMe(r)};requestAnimationFrame(i)}function TM(t){"@babel/helpers - typeof";return TM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TM(t)}function EMe(t){return KMe(t)||HMe(t)||kMe(t)||YMe()}function YMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kMe(t,e){if(t){if(typeof t=="string")return V9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V9(t,e)}}function V9(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function HMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KMe(t){if(Array.isArray(t))return t}function LMe(){var t={},e=function(){return null},n=!1,i=function r(s){if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,a=EMe(o),l=a[0],c=a.slice(1);if(typeof l=="number"){M9(r.bind(null,c),l);return}r(l),M9(r.bind(null,c));return}TM(s)==="object"&&(t=s,e(t)),typeof s=="function"&&s()}};return{stop:function(){n=!0},start:function(s){n=!1,i(s)},subscribe:function(s){return e=s,function(){e=function(){return null}}}}}function zA(t){"@babel/helpers - typeof";return zA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zA(t)}function F9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function _9(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F9(Object(n),!0).forEach(function(i){N6(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function N6(t,e,n){return e=zMe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zMe(t){var e=jMe(t,"string");return zA(e)==="symbol"?e:String(e)}function jMe(t,e){if(zA(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(zA(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PMe=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(i,r){return i.filter(function(s){return r.includes(s)})})},OMe=function(e){return e},DMe=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Tm=function(e,n){return Object.keys(n).reduce(function(i,r){return _9(_9({},i),{},N6({},r,e(r,n[r])))},{})},T9=function(e,n,i){return e.map(function(r){return"".concat(DMe(r)," ").concat(n,"ms ").concat(i)}).join(",")};function UMe(t,e){return qMe(t)||QMe(t,e)||W6(t,e)||JMe()}function JMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QMe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function qMe(t){if(Array.isArray(t))return t}function $Me(t){return n3e(t)||t3e(t)||W6(t)||e3e()}function e3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W6(t,e){if(t){if(typeof t=="string")return XM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XM(t,e)}}function t3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function n3e(t){if(Array.isArray(t))return XM(t)}function XM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Pw=1e-4,M6=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},V6=function(e,n){return e.map(function(i,r){return i*Math.pow(n,r)}).reduce(function(i,r){return i+r})},X9=function(e,n){return function(i){var r=M6(e,n);return V6(r,i)}},i3e=function(e,n){return function(i){var r=M6(e,n),s=[].concat($Me(r.map(function(o,a){return o*a}).slice(1)),[0]);return V6(s,i)}},E9=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],s=n[1],o=n[2],a=n[3];if(n.length===1)switch(n[0]){case"linear":r=0,s=0,o=1,a=1;break;case"ease":r=.25,s=.1,o=.25,a=1;break;case"ease-in":r=.42,s=0,o=1,a=1;break;case"ease-out":r=.42,s=0,o=.58,a=1;break;case"ease-in-out":r=0,s=0,o=.58,a=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(A){return parseFloat(A)}),u=UMe(c,4);r=u[0],s=u[1],o=u[2],a=u[3]}}}var d=X9(r,o),h=X9(s,a),I=i3e(r,o),p=function(m){return m>1?1:m<0?0:m},y=function(m){for(var b=m>1?1:m,v=b,w=0;w<8;++w){var x=d(v)-b,B=I(v);if(Math.abs(x-b)<Pw||B<Pw)return h(v);v=p(v-x/B)}return h(v)};return y.isStepper=!1,y},r3e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,i=n===void 0?100:n,r=e.damping,s=r===void 0?8:r,o=e.dt,a=o===void 0?17:o,l=function(u,d,h){var I=-(u-d)*i,p=h*s,y=h+(I-p)*a/1e3,A=h*a/1e3+u;return Math.abs(A-d)<Pw&&Math.abs(y)<Pw?[d,0]:[A,y]};return l.isStepper=!0,l.dt=a,l},s3e=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return E9(r);case"spring":return r3e();default:if(r.split("(")[0]==="cubic-bezier")return E9(r)}return typeof r=="function"?r:null};function jA(t){"@babel/helpers - typeof";return jA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jA(t)}function Y9(t){return l3e(t)||a3e(t)||F6(t)||o3e()}function o3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function l3e(t){if(Array.isArray(t))return YM(t)}function k9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Mr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?k9(Object(n),!0).forEach(function(i){EM(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function EM(t,e,n){return e=c3e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c3e(t){var e=g3e(t,"string");return jA(e)==="symbol"?e:String(e)}function g3e(t,e){if(jA(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(jA(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function u3e(t,e){return I3e(t)||h3e(t,e)||F6(t,e)||d3e()}function d3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F6(t,e){if(t){if(typeof t=="string")return YM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YM(t,e)}}function YM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function h3e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function I3e(t){if(Array.isArray(t))return t}var Ow=function(e,n,i){return e+(n-e)*i},kM=function(e){var n=e.from,i=e.to;return n!==i},f3e=function t(e,n,i){var r=Tm(function(s,o){if(kM(o)){var a=e(o.from,o.to,o.velocity),l=u3e(a,2),c=l[0],u=l[1];return Mr(Mr({},o),{},{from:c,velocity:u})}return o},n);return i<1?Tm(function(s,o){return kM(o)?Mr(Mr({},o),{},{velocity:Ow(o.velocity,r[s].velocity,i),from:Ow(o.from,r[s].from,i)}):o},n):t(e,r,i-1)};const C3e=function(t,e,n,i,r){var s=PMe(t,e),o=s.reduce(function(A,m){return Mr(Mr({},A),{},EM({},m,[t[m],e[m]]))},{}),a=s.reduce(function(A,m){return Mr(Mr({},A),{},EM({},m,{from:t[m],velocity:0,to:e[m]}))},{}),l=-1,c,u,d=function(){return null},h=function(){return Tm(function(m,b){return b.from},a)},I=function(){return!Object.values(a).filter(kM).length},p=function(m){c||(c=m);var b=m-c,v=b/n.dt;a=f3e(n,a,v),r(Mr(Mr(Mr({},t),e),h())),c=m,I()||(l=requestAnimationFrame(d))},y=function(m){u||(u=m);var b=(m-u)/i,v=Tm(function(x,B){return Ow.apply(void 0,Y9(B).concat([n(b)]))},o);if(r(Mr(Mr(Mr({},t),e),v)),b<1)l=requestAnimationFrame(d);else{var w=Tm(function(x,B){return Ow.apply(void 0,Y9(B).concat([n(1)]))},o);r(Mr(Mr(Mr({},t),e),w))}};return d=n.isStepper?p:y,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(l)}}};function Yf(t){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yf(t)}var p3e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function m3e(t,e){if(t==null)return{};var n=A3e(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function A3e(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function UZ(t){return x3e(t)||v3e(t)||b3e(t)||y3e()}function y3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b3e(t,e){if(t){if(typeof t=="string")return HM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HM(t,e)}}function v3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function x3e(t){if(Array.isArray(t))return HM(t)}function HM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function H9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ya(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H9(Object(n),!0).forEach(function(i){Cm(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Cm(t,e,n){return e=_6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G3e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_6(i.key),i)}}function B3e(t,e,n){return e&&G3e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _6(t){var e=S3e(t,"string");return Yf(e)==="symbol"?e:String(e)}function S3e(t,e){if(Yf(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Yf(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&KM(t,e)}function KM(t,e){return KM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},KM(t,e)}function R3e(t){var e=N3e();return function(){var i=Dw(t),r;if(e){var s=Dw(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return LM(this,r)}}function LM(t,e){if(e&&(Yf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zM(t)}function zM(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dw(t){return Dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Dw(t)}var ca=function(t){Z3e(n,t);var e=R3e(n);function n(i,r){var s;w3e(this,n),s=e.call(this,i,r);var o=s.props,a=o.isActive,l=o.attributeName,c=o.from,u=o.to,d=o.steps,h=o.children,I=o.duration;if(s.handleStyleChange=s.handleStyleChange.bind(zM(s)),s.changeStyle=s.changeStyle.bind(zM(s)),!a||I<=0)return s.state={style:{}},typeof h=="function"&&(s.state={style:u}),LM(s);if(d&&d.length)s.state={style:d[0].style};else if(c){if(typeof h=="function")return s.state={style:c},LM(s);s.state={style:l?Cm({},l,c):c}}else s.state={style:{}};return s}return B3e(n,[{key:"componentDidMount",value:function(){var r=this.props,s=r.isActive,o=r.canBegin;this.mounted=!0,!(!s||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var s=this.props,o=s.isActive,a=s.canBegin,l=s.attributeName,c=s.shouldReAnimate,u=s.to,d=s.from,h=this.state.style;if(a){if(!o){var I={style:l?Cm({},l,u):u};this.state&&h&&(l&&h[l]!==u||!l&&h!==u)&&this.setState(I);return}if(!(TMe(r.to,u)&&r.canBegin&&r.isActive)){var p=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=p||c?d:r.to;if(this.state&&h){var A={style:l?Cm({},l,y):y};(l&&h[l]!==y||!l&&h!==y)&&this.setState(A)}this.runAnimation(ya(ya({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var s=this,o=r.from,a=r.to,l=r.duration,c=r.easing,u=r.begin,d=r.onAnimationEnd,h=r.onAnimationStart,I=C3e(o,a,s3e(c),l,this.changeStyle),p=function(){s.stopJSAnimation=I()};this.manager.start([h,u,p,l,d])}},{key:"runStepAnimation",value:function(r){var s=this,o=r.steps,a=r.begin,l=r.onAnimationStart,c=o[0],u=c.style,d=c.duration,h=d===void 0?0:d,I=function(y,A,m){if(m===0)return y;var b=A.duration,v=A.easing,w=v===void 0?"ease":v,x=A.style,B=A.properties,Z=A.onAnimationEnd,N=m>0?o[m-1]:A,W=B||Object.keys(x);if(typeof w=="function"||w==="spring")return[].concat(UZ(y),[s.runJSAnimation.bind(s,{from:N.style,to:x,duration:b,easing:w}),b]);var M=T9(W,b,w),F=ya(ya(ya({},N.style),x),{},{transition:M});return[].concat(UZ(y),[F,b,Z]).filter(OMe)};return this.manager.start([l].concat(UZ(o.reduce(I,[u,Math.max(h,a)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=LMe());var s=r.begin,o=r.duration,a=r.attributeName,l=r.to,c=r.easing,u=r.onAnimationStart,d=r.onAnimationEnd,h=r.steps,I=r.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof I=="function"||c==="spring"){this.runJSAnimation(r);return}if(h.length>1){this.runStepAnimation(r);return}var y=a?Cm({},a,l):l,A=T9(Object.keys(y),o,c);p.start([u,s,ya(ya({},y),{},{transition:A}),o,d])}},{key:"render",value:function(){var r=this.props,s=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var a=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var l=m3e(r,p3e),c=S.Children.count(s),u=this.state.style;if(typeof s=="function")return s(u);if(!a||c===0||o<=0)return s;var d=function(I){var p=I.props,y=p.style,A=y===void 0?{}:y,m=p.className,b=S.cloneElement(I,ya(ya({},l),{},{style:ya(ya({},A),u),className:m}));return b};return c===1?d(S.Children.only(s)):$.createElement("div",null,S.Children.map(s,function(h){return d(h)}))}}]),n}(S.PureComponent);ca.displayName="Animate";ca.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ca.propTypes={from:Un.oneOfType([Un.object,Un.string]),to:Un.oneOfType([Un.object,Un.string]),attributeName:Un.string,duration:Un.number,begin:Un.number,easing:Un.oneOfType([Un.string,Un.func]),steps:Un.arrayOf(Un.shape({duration:Un.number.isRequired,style:Un.object.isRequired,easing:Un.oneOfType([Un.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Un.func]),properties:Un.arrayOf("string"),onAnimationEnd:Un.func})),children:Un.oneOfType([Un.node,Un.func]),isActive:Un.bool,canBegin:Un.bool,onAnimationEnd:Un.func,shouldReAnimate:Un.bool,onAnimationStart:Un.func,onAnimationReStart:Un.func};function kf(){return kf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},kf.apply(null,arguments)}function PA(t){"@babel/helpers - typeof";return PA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PA(t)}function Uw(){return Uw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Uw.apply(this,arguments)}function W3e(t,e){return _3e(t)||F3e(t,e)||V3e(t,e)||M3e()}function M3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V3e(t,e){if(t){if(typeof t=="string")return K9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K9(t,e)}}function K9(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function F3e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function _3e(t){if(Array.isArray(t))return t}function L9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function z9(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?L9(Object(n),!0).forEach(function(i){T3e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function T3e(t,e,n){return e=X3e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X3e(t){var e=E3e(t,"string");return PA(e)=="symbol"?e:e+""}function E3e(t,e){if(PA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(PA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var j9=function(e,n,i,r,s){var o=Math.min(Math.abs(i)/2,Math.abs(r)/2),a=r>=0?1:-1,l=i>=0?1:-1,c=r>=0&&i>=0||r<0&&i<0?1:0,u;if(o>0&&s instanceof Array){for(var d=[0,0,0,0],h=0,I=4;h<I;h++)d[h]=s[h]>o?o:s[h];u="M".concat(e,",").concat(n+a*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(n)),u+="L ".concat(e+i-l*d[1],",").concat(n),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+i,",").concat(n+a*d[1])),u+="L ".concat(e+i,",").concat(n+r-a*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+i-l*d[2],",").concat(n+r)),u+="L ".concat(e+l*d[3],",").concat(n+r),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(n+r-a*d[3])),u+="Z"}else if(o>0&&s===+s&&s>0){var p=Math.min(o,s);u="M ".concat(e,",").concat(n+a*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+l*p,",").concat(n,`
            L `).concat(e+i-l*p,",").concat(n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+i,",").concat(n+a*p,`
            L `).concat(e+i,",").concat(n+r-a*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+i-l*p,",").concat(n+r,`
            L `).concat(e+l*p,",").concat(n+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(n+r-a*p," Z")}else u="M ".concat(e,",").concat(n," h ").concat(i," v ").concat(r," h ").concat(-i," Z");return u},Y3e=function(e,n){if(!e||!n)return!1;var i=e.x,r=e.y,s=n.x,o=n.y,a=n.width,l=n.height;if(Math.abs(a)>0&&Math.abs(l)>0){var c=Math.min(s,s+a),u=Math.max(s,s+a),d=Math.min(o,o+l),h=Math.max(o,o+l);return i>=c&&i<=u&&r>=d&&r<=h}return!1},k3e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},YF=function(e){var n=z9(z9({},k3e),e),i=S.useRef(),r=S.useState(-1),s=W3e(r,2),o=s[0],a=s[1];S.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var w=i.current.getTotalLength();w&&a(w)}catch{}},[]);var l=n.x,c=n.y,u=n.width,d=n.height,h=n.radius,I=n.className,p=n.animationEasing,y=n.animationDuration,A=n.animationBegin,m=n.isAnimationActive,b=n.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||d!==+d||u===0||d===0)return null;var v=ln("recharts-rectangle",I);return b?$.createElement(ca,{canBegin:o>0,from:{width:u,height:d,x:l,y:c},to:{width:u,height:d,x:l,y:c},duration:y,animationEasing:p,isActive:b},function(w){var x=w.width,B=w.height,Z=w.x,N=w.y;return $.createElement(ca,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:A,duration:y,isActive:m,easing:p},$.createElement("path",Uw({},Yt(n,!0),{className:v,d:j9(Z,N,x,B,h),ref:i})))}):$.createElement("path",Uw({},Yt(n,!0),{className:v,d:j9(l,c,u,d,h)}))},H3e=["points","className","baseLinePoints","connectNulls"];function RI(){return RI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},RI.apply(this,arguments)}function K3e(t,e){if(t==null)return{};var n=L3e(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function L3e(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function P9(t){return O3e(t)||P3e(t)||j3e(t)||z3e()}function z3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j3e(t,e){if(t){if(typeof t=="string")return jM(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jM(t,e)}}function P3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function O3e(t){if(Array.isArray(t))return jM(t)}function jM(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var O9=function(e){return e&&e.x===+e.x&&e.y===+e.y},D3e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return e.forEach(function(i){O9(i)?n[n.length-1].push(i):n[n.length-1].length>0&&n.push([])}),O9(e[0])&&n[n.length-1].push(e[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},Xm=function(e,n){var i=D3e(e);n&&(i=[i.reduce(function(s,o){return[].concat(P9(s),P9(o))},[])]);var r=i.map(function(s){return s.reduce(function(o,a,l){return"".concat(o).concat(l===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return i.length===1?"".concat(r,"Z"):r},U3e=function(e,n,i){var r=Xm(e,i);return"".concat(r.slice(-1)==="Z"?r.slice(0,-1):r,"L").concat(Xm(n.reverse(),i).slice(1))},J3e=function(e){var n=e.points,i=e.className,r=e.baseLinePoints,s=e.connectNulls,o=K3e(e,H3e);if(!n||!n.length)return null;var a=ln("recharts-polygon",i);if(r&&r.length){var l=o.stroke&&o.stroke!=="none",c=U3e(n,r,s);return $.createElement("g",{className:a},$.createElement("path",RI({},Yt(o,!0),{fill:c.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:c})),l?$.createElement("path",RI({},Yt(o,!0),{fill:"none",d:Xm(n,s)})):null,l?$.createElement("path",RI({},Yt(o,!0),{fill:"none",d:Xm(r,s)})):null)}var u=Xm(n,s);return $.createElement("path",RI({},Yt(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:a,d:u}))};function PM(){return PM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},PM.apply(this,arguments)}var J0=function(e){var n=e.cx,i=e.cy,r=e.r,s=e.className,o=ln("recharts-dot",s);return n===+n&&i===+i&&r===+r?$.createElement("circle",PM({},Yt(e,!1),Cw(e),{className:o,cx:n,cy:i,r})):null};function OA(t){"@babel/helpers - typeof";return OA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OA(t)}var Q3e=["x","y","top","left","width","height","className"];function OM(){return OM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},OM.apply(this,arguments)}function D9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function q3e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?D9(Object(n),!0).forEach(function(i){$3e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $3e(t,e,n){return e=eVe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eVe(t){var e=tVe(t,"string");return OA(e)=="symbol"?e:e+""}function tVe(t,e){if(OA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(OA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nVe(t,e){if(t==null)return{};var n=iVe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function iVe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var rVe=function(e,n,i,r,s,o){return"M".concat(e,",").concat(s,"v").concat(r,"M").concat(o,",").concat(n,"h").concat(i)},sVe=function(e){var n=e.x,i=n===void 0?0:n,r=e.y,s=r===void 0?0:r,o=e.top,a=o===void 0?0:o,l=e.left,c=l===void 0?0:l,u=e.width,d=u===void 0?0:u,h=e.height,I=h===void 0?0:h,p=e.className,y=nVe(e,Q3e),A=q3e({x:i,y:s,top:a,left:c,width:d,height:I},y);return!ut(i)||!ut(s)||!ut(d)||!ut(I)||!ut(a)||!ut(c)?null:$.createElement("path",OM({},Yt(A,!0),{className:ln("recharts-cross",p),d:rVe(i,s,d,I,a,c)}))},oVe=NB,aVe=O7,lVe=Pl;function cVe(t,e){return t&&t.length?oVe(t,lVe(e),aVe):void 0}var gVe=cVe;const uVe=Pn(gVe);var dVe=NB,hVe=Pl,IVe=D7;function fVe(t,e){return t&&t.length?dVe(t,hVe(e),IVe):void 0}var CVe=fVe;const pVe=Pn(CVe);var mVe=["cx","cy","angle","ticks","axisLine"],AVe=["ticks","tick","angle","tickFormatter","stroke"];function Hf(t){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(t)}function Em(){return Em=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Em.apply(this,arguments)}function U9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Eu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U9(Object(n),!0).forEach(function(i){FB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function J9(t,e){if(t==null)return{};var n=yVe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function yVe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function bVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q9(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,X6(i.key),i)}}function vVe(t,e,n){return e&&Q9(t.prototype,e),n&&Q9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xVe(t,e,n){return e=Jw(e),wVe(t,T6()?Reflect.construct(e,n||[],Jw(t).constructor):e.apply(t,n))}function wVe(t,e){if(e&&(Hf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GVe(t)}function GVe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(T6=function(){return!!t})()}function Jw(t){return Jw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Jw(t)}function BVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DM(t,e)}function DM(t,e){return DM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},DM(t,e)}function FB(t,e,n){return e=X6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X6(t){var e=SVe(t,"string");return Hf(e)=="symbol"?e:e+""}function SVe(t,e){if(Hf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Hf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _B=function(t){function e(){return bVe(this,e),xVe(this,e,arguments)}return BVe(e,t),vVe(e,[{key:"getTickValueCoord",value:function(i){var r=i.coordinate,s=this.props,o=s.angle,a=s.cx,l=s.cy;return Ii(a,l,r,o)}},{key:"getTickTextAnchor",value:function(){var i=this.props.orientation,r;switch(i){case"left":r="end";break;case"right":r="start";break;default:r="middle";break}return r}},{key:"getViewBox",value:function(){var i=this.props,r=i.cx,s=i.cy,o=i.angle,a=i.ticks,l=uVe(a,function(u){return u.coordinate||0}),c=pVe(a,function(u){return u.coordinate||0});return{cx:r,cy:s,startAngle:o,endAngle:o,innerRadius:c.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var i=this.props,r=i.cx,s=i.cy,o=i.angle,a=i.ticks,l=i.axisLine,c=J9(i,mVe),u=a.reduce(function(p,y){return[Math.min(p[0],y.coordinate),Math.max(p[1],y.coordinate)]},[1/0,-1/0]),d=Ii(r,s,u[0],o),h=Ii(r,s,u[1],o),I=Eu(Eu(Eu({},Yt(c,!1)),{},{fill:"none"},Yt(l,!1)),{},{x1:d.x,y1:d.y,x2:h.x,y2:h.y});return $.createElement("line",Em({className:"recharts-polar-radius-axis-line"},I))}},{key:"renderTicks",value:function(){var i=this,r=this.props,s=r.ticks,o=r.tick,a=r.angle,l=r.tickFormatter,c=r.stroke,u=J9(r,AVe),d=this.getTickTextAnchor(),h=Yt(u,!1),I=Yt(o,!1),p=s.map(function(y,A){var m=i.getTickValueCoord(y),b=Eu(Eu(Eu(Eu({textAnchor:d,transform:"rotate(".concat(90-a,", ").concat(m.x,", ").concat(m.y,")")},h),{},{stroke:"none",fill:c},I),{},{index:A},m),{},{payload:y});return $.createElement(fn,Em({className:ln("recharts-polar-radius-axis-tick",v6(o)),key:"tick-".concat(y.coordinate)},su(i.props,y,A)),e.renderTickItem(o,b,l?l(y.value,A):y.value))});return $.createElement(fn,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var i=this.props,r=i.ticks,s=i.axisLine,o=i.tick;return!r||!r.length?null:$.createElement(fn,{className:ln("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),o&&this.renderTicks(),wr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(i,r,s){var o;return $.isValidElement(i)?o=$.cloneElement(i,r):$t(i)?o=i(r):o=$.createElement($d,Em({},r,{className:"recharts-polar-radius-axis-tick-value"}),s),o}}])}(S.PureComponent);FB(_B,"displayName","PolarRadiusAxis");FB(_B,"axisType","radiusAxis");FB(_B,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Kf(t){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kf(t)}function ld(){return ld=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ld.apply(this,arguments)}function q9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Yu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?q9(Object(n),!0).forEach(function(i){TB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q9(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ZVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $9(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Y6(i.key),i)}}function RVe(t,e,n){return e&&$9(t.prototype,e),n&&$9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function NVe(t,e,n){return e=Qw(e),WVe(t,E6()?Reflect.construct(e,n||[],Qw(t).constructor):e.apply(t,n))}function WVe(t,e){if(e&&(Kf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MVe(t)}function MVe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E6=function(){return!!t})()}function Qw(t){return Qw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Qw(t)}function VVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UM(t,e)}function UM(t,e){return UM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},UM(t,e)}function TB(t,e,n){return e=Y6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=FVe(t,"string");return Kf(e)=="symbol"?e:e+""}function FVe(t,e){if(Kf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Kf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _Ve=Math.PI/180,eK=1e-5,XB=function(t){function e(){return ZVe(this,e),NVe(this,e,arguments)}return VVe(e,t),RVe(e,[{key:"getTickLineCoord",value:function(i){var r=this.props,s=r.cx,o=r.cy,a=r.radius,l=r.orientation,c=r.tickSize,u=c||8,d=Ii(s,o,a,i.coordinate),h=Ii(s,o,a+(l==="inner"?-1:1)*u,i.coordinate);return{x1:d.x,y1:d.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(i){var r=this.props.orientation,s=Math.cos(-i.coordinate*_Ve),o;return s>eK?o=r==="outer"?"start":"end":s<-eK?o=r==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var i=this.props,r=i.cx,s=i.cy,o=i.radius,a=i.axisLine,l=i.axisLineType,c=Yu(Yu({},Yt(this.props,!1)),{},{fill:"none"},Yt(a,!1));if(l==="circle")return $.createElement(J0,ld({className:"recharts-polar-angle-axis-line"},c,{cx:r,cy:s,r:o}));var u=this.props.ticks,d=u.map(function(h){return Ii(r,s,o,h.coordinate)});return $.createElement(J3e,ld({className:"recharts-polar-angle-axis-line"},c,{points:d}))}},{key:"renderTicks",value:function(){var i=this,r=this.props,s=r.ticks,o=r.tick,a=r.tickLine,l=r.tickFormatter,c=r.stroke,u=Yt(this.props,!1),d=Yt(o,!1),h=Yu(Yu({},u),{},{fill:"none"},Yt(a,!1)),I=s.map(function(p,y){var A=i.getTickLineCoord(p),m=i.getTickTextAnchor(p),b=Yu(Yu(Yu({textAnchor:m},u),{},{stroke:"none",fill:c},d),{},{index:y,payload:p,x:A.x2,y:A.y2});return $.createElement(fn,ld({className:ln("recharts-polar-angle-axis-tick",v6(o)),key:"tick-".concat(p.coordinate)},su(i.props,p,y)),a&&$.createElement("line",ld({className:"recharts-polar-angle-axis-tick-line"},h,A)),o&&e.renderTickItem(o,b,l?l(p.value,y):p.value))});return $.createElement(fn,{className:"recharts-polar-angle-axis-ticks"},I)}},{key:"render",value:function(){var i=this.props,r=i.ticks,s=i.radius,o=i.axisLine;return s<=0||!r||!r.length?null:$.createElement(fn,{className:ln("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(i,r,s){var o;return $.isValidElement(i)?o=$.cloneElement(i,r):$t(i)?o=i(r):o=$.createElement($d,ld({},r,{className:"recharts-polar-angle-axis-tick-value"}),s),o}}])}(S.PureComponent);TB(XB,"displayName","PolarAngleAxis");TB(XB,"axisType","angleAxis");TB(XB,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var TVe=L8,XVe=TVe(Object.getPrototypeOf,Object),EVe=XVe,YVe=jc,kVe=EVe,HVe=Pc,KVe="[object Object]",LVe=Function.prototype,zVe=Object.prototype,k6=LVe.toString,jVe=zVe.hasOwnProperty,PVe=k6.call(Object);function OVe(t){if(!HVe(t)||YVe(t)!=KVe)return!1;var e=kVe(t);if(e===null)return!0;var n=jVe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&k6.call(n)==PVe}var DVe=OVe;const UVe=Pn(DVe);var JVe=jc,QVe=Pc,qVe="[object Boolean]";function $Ve(t){return t===!0||t===!1||QVe(t)&&JVe(t)==qVe}var e5e=$Ve;const t5e=Pn(e5e);function DA(t){"@babel/helpers - typeof";return DA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DA(t)}function qw(){return qw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},qw.apply(this,arguments)}function n5e(t,e){return o5e(t)||s5e(t,e)||r5e(t,e)||i5e()}function i5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r5e(t,e){if(t){if(typeof t=="string")return tK(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tK(t,e)}}function tK(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s5e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function o5e(t){if(Array.isArray(t))return t}function nK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function iK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nK(Object(n),!0).forEach(function(i){a5e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function a5e(t,e,n){return e=l5e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l5e(t){var e=c5e(t,"string");return DA(e)=="symbol"?e:e+""}function c5e(t,e){if(DA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(DA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rK=function(e,n,i,r,s){var o=i-r,a;return a="M ".concat(e,",").concat(n),a+="L ".concat(e+i,",").concat(n),a+="L ".concat(e+i-o/2,",").concat(n+s),a+="L ".concat(e+i-o/2-r,",").concat(n+s),a+="L ".concat(e,",").concat(n," Z"),a},g5e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},u5e=function(e){var n=iK(iK({},g5e),e),i=S.useRef(),r=S.useState(-1),s=n5e(r,2),o=s[0],a=s[1];S.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var v=i.current.getTotalLength();v&&a(v)}catch{}},[]);var l=n.x,c=n.y,u=n.upperWidth,d=n.lowerWidth,h=n.height,I=n.className,p=n.animationEasing,y=n.animationDuration,A=n.animationBegin,m=n.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||d!==+d||h!==+h||u===0&&d===0||h===0)return null;var b=ln("recharts-trapezoid",I);return m?$.createElement(ca,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:c},to:{upperWidth:u,lowerWidth:d,height:h,x:l,y:c},duration:y,animationEasing:p,isActive:m},function(v){var w=v.upperWidth,x=v.lowerWidth,B=v.height,Z=v.x,N=v.y;return $.createElement(ca,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:A,duration:y,easing:p},$.createElement("path",qw({},Yt(n,!0),{className:b,d:rK(Z,N,w,x,B),ref:i})))}):$.createElement("g",null,$.createElement("path",qw({},Yt(n,!0),{className:b,d:rK(l,c,u,d,h)})))},d5e=["option","shapeType","propTransformer","activeClassName","isActive"];function UA(t){"@babel/helpers - typeof";return UA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UA(t)}function h5e(t,e){if(t==null)return{};var n=I5e(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function I5e(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function sK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function $w(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sK(Object(n),!0).forEach(function(i){f5e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function f5e(t,e,n){return e=C5e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C5e(t){var e=p5e(t,"string");return UA(e)=="symbol"?e:e+""}function p5e(t,e){if(UA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(UA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m5e(t,e){return $w($w({},e),t)}function A5e(t,e){return t==="symbols"}function oK(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return $.createElement(YF,n);case"trapezoid":return $.createElement(u5e,n);case"sector":return $.createElement(G6,n);case"symbols":if(A5e(e))return $.createElement(yB,n);break;default:return null}}function y5e(t){return S.isValidElement(t)?t.props:t}function eG(t){var e=t.option,n=t.shapeType,i=t.propTransformer,r=i===void 0?m5e:i,s=t.activeClassName,o=s===void 0?"recharts-active-shape":s,a=t.isActive,l=h5e(t,d5e),c;if(S.isValidElement(e))c=S.cloneElement(e,$w($w({},l),y5e(e)));else if($t(e))c=e(l);else if(UVe(e)&&!t5e(e)){var u=r(e,l);c=$.createElement(oK,{shapeType:n,elementProps:u})}else{var d=l;c=$.createElement(oK,{shapeType:n,elementProps:d})}return a?$.createElement(fn,{className:o},c):c}function EB(t,e){return e!=null&&"trapezoids"in t.props}function YB(t,e){return e!=null&&"sectors"in t.props}function JA(t,e){return e!=null&&"points"in t.props}function b5e(t,e){var n,i,r=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,s=t.y===(e==null||(i=e.labelViewBox)===null||i===void 0?void 0:i.y)||t.y===e.y;return r&&s}function v5e(t,e){var n=t.endAngle===e.endAngle,i=t.startAngle===e.startAngle;return n&&i}function x5e(t,e){var n=t.x===e.x,i=t.y===e.y,r=t.z===e.z;return n&&i&&r}function w5e(t,e){var n;return EB(t,e)?n=b5e:YB(t,e)?n=v5e:JA(t,e)&&(n=x5e),n}function G5e(t,e){var n;return EB(t,e)?n="trapezoids":YB(t,e)?n="sectors":JA(t,e)&&(n="points"),n}function B5e(t,e){if(EB(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(YB(t,e)){var i;return(i=e.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return JA(t,e)?e.payload:{}}function S5e(t){var e=t.activeTooltipItem,n=t.graphicalItem,i=t.itemData,r=G5e(n,e),s=B5e(n,e),o=i.filter(function(l,c){var u=ou(s,l),d=n.props[r].filter(function(p){var y=w5e(n,e);return y(p,e)}),h=n.props[r].indexOf(d[d.length-1]),I=c===h;return u&&I}),a=i.indexOf(o[o.length-1]);return a}var bx;function Lf(t){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lf(t)}function NI(){return NI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},NI.apply(this,arguments)}function aK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function li(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aK(Object(n),!0).forEach(function(i){Jo(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Z5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,K6(i.key),i)}}function R5e(t,e,n){return e&&lK(t.prototype,e),n&&lK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function N5e(t,e,n){return e=tG(e),W5e(t,H6()?Reflect.construct(e,n||[],tG(t).constructor):e.apply(t,n))}function W5e(t,e){if(e&&(Lf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M5e(t)}function M5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H6=function(){return!!t})()}function tG(t){return tG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tG(t)}function V5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JM(t,e)}function JM(t,e){return JM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},JM(t,e)}function Jo(t,e,n){return e=K6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K6(t){var e=F5e(t,"string");return Lf(e)=="symbol"?e:e+""}function F5e(t,e){if(Lf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Lf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dc=function(t){function e(n){var i;return Z5e(this,e),i=N5e(this,e,[n]),Jo(i,"pieRef",null),Jo(i,"sectorRefs",[]),Jo(i,"id",yu("recharts-pie-")),Jo(i,"handleAnimationEnd",function(){var r=i.props.onAnimationEnd;i.setState({isAnimationFinished:!0}),$t(r)&&r()}),Jo(i,"handleAnimationStart",function(){var r=i.props.onAnimationStart;i.setState({isAnimationFinished:!1}),$t(r)&&r()}),i.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},i}return V5e(e,t),R5e(e,[{key:"isActiveIndex",value:function(i){var r=this.props.activeIndex;return Array.isArray(r)?r.indexOf(i)!==-1:i===r}},{key:"hasActiveIndex",value:function(){var i=this.props.activeIndex;return Array.isArray(i)?i.length!==0:i||i===0}},{key:"renderLabels",value:function(i){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.label,a=s.labelLine,l=s.dataKey,c=s.valueKey,u=Yt(this.props,!1),d=Yt(o,!1),h=Yt(a,!1),I=o&&o.offsetRadius||20,p=i.map(function(y,A){var m=(y.startAngle+y.endAngle)/2,b=Ii(y.cx,y.cy,y.outerRadius+I,m),v=li(li(li(li({},u),y),{},{stroke:"none"},d),{},{index:A,textAnchor:e.getTextAnchor(b.x,y.cx)},b),w=li(li(li(li({},u),y),{},{fill:"none",stroke:y.fill},h),{},{index:A,points:[Ii(y.cx,y.cy,y.outerRadius,m),b]}),x=l;return en(l)&&en(c)?x="value":en(l)&&(x=c),$.createElement(fn,{key:"label-".concat(y.startAngle,"-").concat(y.endAngle,"-").concat(y.midAngle,"-").concat(A)},a&&e.renderLabelLineItem(a,w,"line"),e.renderLabelItem(o,v,yi(y,x)))});return $.createElement(fn,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(i){var r=this,s=this.props,o=s.activeShape,a=s.blendStroke,l=s.inactiveShape;return i.map(function(c,u){if((c==null?void 0:c.startAngle)===0&&(c==null?void 0:c.endAngle)===0&&i.length!==1)return null;var d=r.isActiveIndex(u),h=l&&r.hasActiveIndex()?l:null,I=d?o:h,p=li(li({},c),{},{stroke:a?c.fill:c.stroke,tabIndex:-1});return $.createElement(fn,NI({ref:function(A){A&&!r.sectorRefs.includes(A)&&r.sectorRefs.push(A)},tabIndex:-1,className:"recharts-pie-sector"},su(r.props,c,u),{key:"sector-".concat(c==null?void 0:c.startAngle,"-").concat(c==null?void 0:c.endAngle,"-").concat(c.midAngle,"-").concat(u)}),$.createElement(eG,NI({option:I,isActive:d,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var i=this,r=this.props,s=r.sectors,o=r.isAnimationActive,a=r.animationBegin,l=r.animationDuration,c=r.animationEasing,u=r.animationId,d=this.state,h=d.prevSectors,I=d.prevIsAnimationActive;return $.createElement(ca,{begin:a,duration:l,isActive:o,easing:c,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(I),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var y=p.t,A=[],m=s&&s[0],b=m.startAngle;return s.forEach(function(v,w){var x=h&&h[w],B=w>0?wo(v,"paddingAngle",0):0;if(x){var Z=Ni(x.endAngle-x.startAngle,v.endAngle-v.startAngle),N=li(li({},v),{},{startAngle:b+B,endAngle:b+Z(y)+B});A.push(N),b=N.endAngle}else{var W=v.endAngle,M=v.startAngle,F=Ni(0,W-M),T=F(y),H=li(li({},v),{},{startAngle:b+B,endAngle:b+T+B});A.push(H),b=H.endAngle}}),$.createElement(fn,null,i.renderSectorsStatically(A))})}},{key:"attachKeyboardHandlers",value:function(i){var r=this;i.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var o=++r.state.sectorToFocus%r.sectorRefs.length;r.sectorRefs[o].focus(),r.setState({sectorToFocus:o});break}case"ArrowRight":{var a=--r.state.sectorToFocus<0?r.sectorRefs.length-1:r.state.sectorToFocus%r.sectorRefs.length;r.sectorRefs[a].focus(),r.setState({sectorToFocus:a});break}case"Escape":{r.sectorRefs[r.state.sectorToFocus].blur(),r.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var i=this.props,r=i.sectors,s=i.isAnimationActive,o=this.state.prevSectors;return s&&r&&r.length&&(!o||!ou(o,r))?this.renderSectorsWithAnimation():this.renderSectorsStatically(r)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var i=this,r=this.props,s=r.hide,o=r.sectors,a=r.className,l=r.label,c=r.cx,u=r.cy,d=r.innerRadius,h=r.outerRadius,I=r.isAnimationActive,p=this.state.isAnimationFinished;if(s||!o||!o.length||!ut(c)||!ut(u)||!ut(d)||!ut(h))return null;var y=ln("recharts-pie",a);return $.createElement(fn,{tabIndex:this.props.rootTabIndex,className:y,ref:function(m){i.pieRef=m}},this.renderSectors(),l&&this.renderLabels(o),wr.renderCallByParent(this.props,null,!1),(!I||p)&&Oa.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(i,r){return r.prevIsAnimationActive!==i.isAnimationActive?{prevIsAnimationActive:i.isAnimationActive,prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:[],isAnimationFinished:!0}:i.isAnimationActive&&i.animationId!==r.prevAnimationId?{prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:r.curSectors,isAnimationFinished:!0}:i.sectors!==r.curSectors?{curSectors:i.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(i,r){return i>r?"start":i<r?"end":"middle"}},{key:"renderLabelLineItem",value:function(i,r,s){if($.isValidElement(i))return $.cloneElement(i,r);if($t(i))return i(r);var o=ln("recharts-pie-label-line",typeof i!="boolean"?i.className:"");return $.createElement(Qg,NI({},r,{key:s,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(i,r,s){if($.isValidElement(i))return $.cloneElement(i,r);var o=s;if($t(i)&&(o=i(r),$.isValidElement(o)))return o;var a=ln("recharts-pie-label-text",typeof i!="boolean"&&!$t(i)?i.className:"");return $.createElement($d,NI({},r,{alignmentBaseline:"middle",className:a}),o)}}])}(S.PureComponent);bx=Dc;Jo(Dc,"displayName","Pie");Jo(Dc,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!ra.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Jo(Dc,"parseDeltaAngle",function(t,e){var n=ys(e-t),i=Math.min(Math.abs(e-t),360);return n*i});Jo(Dc,"getRealPieData",function(t){var e=t.data,n=t.children,i=Yt(t,!1),r=Gs(n,j0);return e&&e.length?e.map(function(s,o){return li(li(li({payload:s},i),s),r&&r[o]&&r[o].props)}):r&&r.length?r.map(function(s){return li(li({},i),s.props)}):[]});Jo(Dc,"parseCoordinateOfPie",function(t,e){var n=e.top,i=e.left,r=e.width,s=e.height,o=b6(r,s),a=i+bs(t.cx,r,r/2),l=n+bs(t.cy,s,s/2),c=bs(t.innerRadius,o,0),u=bs(t.outerRadius,o,o*.8),d=t.maxRadius||Math.sqrt(r*r+s*s)/2;return{cx:a,cy:l,innerRadius:c,outerRadius:u,maxRadius:d}});Jo(Dc,"getComposedData",function(t){var e=t.item,n=t.offset,i=e.type.defaultProps!==void 0?li(li({},e.type.defaultProps),e.props):e.props,r=bx.getRealPieData(i);if(!r||!r.length)return null;var s=i.cornerRadius,o=i.startAngle,a=i.endAngle,l=i.paddingAngle,c=i.dataKey,u=i.nameKey,d=i.valueKey,h=i.tooltipType,I=Math.abs(i.minAngle),p=bx.parseCoordinateOfPie(i,n),y=bx.parseDeltaAngle(o,a),A=Math.abs(y),m=c;en(c)&&en(d)?(Pa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),m="value"):en(c)&&(Pa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),m=d);var b=r.filter(function(N){return yi(N,m,0)!==0}).length,v=(A>=360?b:b-1)*l,w=A-b*I-v,x=r.reduce(function(N,W){var M=yi(W,m,0);return N+(ut(M)?M:0)},0),B;if(x>0){var Z;B=r.map(function(N,W){var M=yi(N,m,0),F=yi(N,u,W),T=(ut(M)?M:0)/x,H;W?H=Z.endAngle+ys(y)*l*(M!==0?1:0):H=o;var K=H+ys(y)*((M!==0?I:0)+T*w),z=(H+K)/2,j=(p.innerRadius+p.outerRadius)/2,O=[{name:F,value:M,payload:N,dataKey:m,type:h}],_=Ii(p.cx,p.cy,j,z);return Z=li(li(li({percent:T,cornerRadius:s,name:F,tooltipPayload:O,midAngle:z,middleRadius:j,tooltipPosition:_},N),p),{},{value:yi(N,m),startAngle:H,endAngle:K,payload:N,paddingAngle:ys(y)*l}),Z})}return li(li({},p),{},{sectors:B,data:r})});var _5e=Math.ceil,T5e=Math.max;function X5e(t,e,n,i){for(var r=-1,s=T5e(_5e((e-t)/(n||1)),0),o=Array(s);s--;)o[i?s:++r]=t,t+=n;return o}var E5e=X5e,Y5e=l7,cK=1/0,k5e=17976931348623157e292;function H5e(t){if(!t)return t===0?t:0;if(t=Y5e(t),t===cK||t===-cK){var e=t<0?-1:1;return e*k5e}return t===t?t:0}var L6=H5e,K5e=E5e,L5e=xB,JZ=L6;function z5e(t){return function(e,n,i){return i&&typeof i!="number"&&L5e(e,n,i)&&(n=i=void 0),e=JZ(e),n===void 0?(n=e,e=0):n=JZ(n),i=i===void 0?e<n?1:-1:JZ(i),K5e(e,n,i,t)}}var j5e=z5e,P5e=j5e,O5e=P5e(),D5e=O5e;const nG=Pn(D5e);function QA(t){"@babel/helpers - typeof";return QA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QA(t)}function gK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function uK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gK(Object(n),!0).forEach(function(i){z6(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function z6(t,e,n){return e=U5e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U5e(t){var e=J5e(t,"string");return QA(e)=="symbol"?e:e+""}function J5e(t,e){if(QA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(QA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Q5e=["Webkit","Moz","O","ms"],q5e=function(e,n){var i=e.replace(/(\w)/,function(s){return s.toUpperCase()}),r=Q5e.reduce(function(s,o){return uK(uK({},s),{},z6({},o+i,n))},{});return r[e]=n,r};function zf(t){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zf(t)}function iG(){return iG=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},iG.apply(this,arguments)}function dK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function QZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dK(Object(n),!0).forEach(function(i){ho(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,P6(i.key),i)}}function eFe(t,e,n){return e&&hK(t.prototype,e),n&&hK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tFe(t,e,n){return e=rG(e),nFe(t,j6()?Reflect.construct(e,n||[],rG(t).constructor):e.apply(t,n))}function nFe(t,e){if(e&&(zf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iFe(t)}function iFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j6=function(){return!!t})()}function rG(t){return rG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rG(t)}function rFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QM(t,e)}function QM(t,e){return QM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},QM(t,e)}function ho(t,e,n){return e=P6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=sFe(t,"string");return zf(e)=="symbol"?e:e+""}function sFe(t,e){if(zf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(zf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oFe=function(e){var n=e.data,i=e.startIndex,r=e.endIndex,s=e.x,o=e.width,a=e.travellerWidth;if(!n||!n.length)return{};var l=n.length,c=Fm().domain(nG(0,l)).range([s,s+o-a]),u=c.domain().map(function(d){return c(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(i),endX:c(r),scale:c,scaleValues:u}},IK=function(e){return e.changedTouches&&!!e.changedTouches.length},jf=function(t){function e(n){var i;return $5e(this,e),i=tFe(this,e,[n]),ho(i,"handleDrag",function(r){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(r):i.state.isSlideMoving&&i.handleSlideDrag(r)}),ho(i,"handleTouchMove",function(r){r.changedTouches!=null&&r.changedTouches.length>0&&i.handleDrag(r.changedTouches[0])}),ho(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var r=i.props,s=r.endIndex,o=r.onDragEnd,a=r.startIndex;o==null||o({endIndex:s,startIndex:a})}),i.detachDragEndListener()}),ho(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),ho(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),ho(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),ho(i,"handleSlideDragStart",function(r){var s=IK(r)?r.changedTouches[0]:r;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return rFe(e,t),eFe(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var r=i.startX,s=i.endX,o=this.state.scaleValues,a=this.props,l=a.gap,c=a.data,u=c.length-1,d=Math.min(r,s),h=Math.max(r,s),I=e.getIndexInRange(o,d),p=e.getIndexInRange(o,h);return{startIndex:I-I%l,endIndex:p===u?u:p-p%l}}},{key:"getTextOfTick",value:function(i){var r=this.props,s=r.data,o=r.tickFormatter,a=r.dataKey,l=yi(s[i],a,i);return $t(o)?o(l,i):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var r=this.state,s=r.slideMoveStartX,o=r.startX,a=r.endX,l=this.props,c=l.x,u=l.width,d=l.travellerWidth,h=l.startIndex,I=l.endIndex,p=l.onChange,y=i.pageX-s;y>0?y=Math.min(y,c+u-d-a,c+u-d-o):y<0&&(y=Math.max(y,c-o,c-a));var A=this.getIndex({startX:o+y,endX:a+y});(A.startIndex!==h||A.endIndex!==I)&&p&&p(A),this.setState({startX:o+y,endX:a+y,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,r){var s=IK(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var r=this.state,s=r.brushMoveStartX,o=r.movingTravellerId,a=r.endX,l=r.startX,c=this.state[o],u=this.props,d=u.x,h=u.width,I=u.travellerWidth,p=u.onChange,y=u.gap,A=u.data,m={startX:this.state.startX,endX:this.state.endX},b=i.pageX-s;b>0?b=Math.min(b,d+h-I-c):b<0&&(b=Math.max(b,d-c)),m[o]=c+b;var v=this.getIndex(m),w=v.startIndex,x=v.endIndex,B=function(){var N=A.length-1;return o==="startX"&&(a>l?w%y===0:x%y===0)||a<l&&x===N||o==="endX"&&(a>l?x%y===0:w%y===0)||a>l&&x===N};this.setState(ho(ho({},o,c+b),"brushMoveStartX",i.pageX),function(){p&&B()&&p(v)})}},{key:"handleTravellerMoveKeyboard",value:function(i,r){var s=this,o=this.state,a=o.scaleValues,l=o.startX,c=o.endX,u=this.state[r],d=a.indexOf(u);if(d!==-1){var h=d+i;if(!(h===-1||h>=a.length)){var I=a[h];r==="startX"&&I>=c||r==="endX"&&I<=l||this.setState(ho({},r,I),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,r=i.x,s=i.y,o=i.width,a=i.height,l=i.fill,c=i.stroke;return $.createElement("rect",{stroke:c,fill:l,x:r,y:s,width:o,height:a})}},{key:"renderPanorama",value:function(){var i=this.props,r=i.x,s=i.y,o=i.width,a=i.height,l=i.data,c=i.children,u=i.padding,d=S.Children.only(c);return d?$.cloneElement(d,{x:r,y:s,width:o,height:a,margin:u,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(i,r){var s,o,a=this,l=this.props,c=l.y,u=l.travellerWidth,d=l.height,h=l.traveller,I=l.ariaLabel,p=l.data,y=l.startIndex,A=l.endIndex,m=Math.max(i,this.props.x),b=QZ(QZ({},Yt(this.props,!1)),{},{x:m,y:c,width:u,height:d}),v=I||"Min value: ".concat((s=p[y])===null||s===void 0?void 0:s.name,", Max value: ").concat((o=p[A])===null||o===void 0?void 0:o.name);return $.createElement(fn,{tabIndex:0,role:"slider","aria-label":v,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(x){["ArrowLeft","ArrowRight"].includes(x.key)&&(x.preventDefault(),x.stopPropagation(),a.handleTravellerMoveKeyboard(x.key==="ArrowRight"?1:-1,r))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(h,b))}},{key:"renderSlide",value:function(i,r){var s=this.props,o=s.y,a=s.height,l=s.stroke,c=s.travellerWidth,u=Math.min(i,r)+c,d=Math.max(Math.abs(r-i)-c,0);return $.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:u,y:o,width:d,height:a})}},{key:"renderText",value:function(){var i=this.props,r=i.startIndex,s=i.endIndex,o=i.y,a=i.height,l=i.travellerWidth,c=i.stroke,u=this.state,d=u.startX,h=u.endX,I=5,p={pointerEvents:"none",fill:c};return $.createElement(fn,{className:"recharts-brush-texts"},$.createElement($d,iG({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,h)-I,y:o+a/2},p),this.getTextOfTick(r)),$.createElement($d,iG({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,h)+l+I,y:o+a/2},p),this.getTextOfTick(s)))}},{key:"render",value:function(){var i=this.props,r=i.data,s=i.className,o=i.children,a=i.x,l=i.y,c=i.width,u=i.height,d=i.alwaysShowText,h=this.state,I=h.startX,p=h.endX,y=h.isTextActive,A=h.isSlideMoving,m=h.isTravellerMoving,b=h.isTravellerFocused;if(!r||!r.length||!ut(a)||!ut(l)||!ut(c)||!ut(u)||c<=0||u<=0)return null;var v=ln("recharts-brush",s),w=$.Children.count(o)===1,x=q5e("userSelect","none");return $.createElement(fn,{className:v,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(I,p),this.renderTravellerLayer(I,"startX"),this.renderTravellerLayer(p,"endX"),(y||A||m||b||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var r=i.x,s=i.y,o=i.width,a=i.height,l=i.stroke,c=Math.floor(s+a/2)-1;return $.createElement($.Fragment,null,$.createElement("rect",{x:r,y:s,width:o,height:a,fill:l,stroke:"none"}),$.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),$.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,r){var s;return $.isValidElement(i)?s=$.cloneElement(i,r):$t(i)?s=i(r):s=e.renderDefaultTraveller(r),s}},{key:"getDerivedStateFromProps",value:function(i,r){var s=i.data,o=i.width,a=i.x,l=i.travellerWidth,c=i.updateId,u=i.startIndex,d=i.endIndex;if(s!==r.prevData||c!==r.prevUpdateId)return QZ({prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:a,prevWidth:o},s&&s.length?oFe({data:s,width:o,x:a,travellerWidth:l,startIndex:u,endIndex:d}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||a!==r.prevX||l!==r.prevTravellerWidth)){r.scale.range([a,a+o-l]);var h=r.scale.domain().map(function(I){return r.scale(I)});return{prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:a,prevWidth:o,startX:r.scale(i.startIndex),endX:r.scale(i.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(i,r){for(var s=i.length,o=0,a=s-1;a-o>1;){var l=Math.floor((o+a)/2);i[l]>r?a=l:o=l}return r>=i[a]?a:o}}])}(S.PureComponent);ho(jf,"displayName","Brush");ho(jf,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var aFe=uF;function lFe(t,e){var n;return aFe(t,function(i,r,s){return n=e(i,r,s),!n}),!!n}var cFe=lFe,gFe=_8,uFe=Pl,dFe=cFe,hFe=io,IFe=xB;function fFe(t,e,n){var i=hFe(t)?gFe:dFe;return n&&IFe(t,e,n)&&(e=void 0),i(t,uFe(e))}var CFe=fFe;const pFe=Pn(CFe);var _l=function(e,n){var i=e.alwaysShow,r=e.ifOverflow;return i&&(r="extendDomain"),r===n},fK=i7;function mFe(t,e,n){e=="__proto__"&&fK?fK(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var AFe=mFe,yFe=AFe,bFe=t7,vFe=Pl;function xFe(t,e){var n={};return e=vFe(e),bFe(t,function(i,r,s){yFe(n,r,e(i,r,s))}),n}var wFe=xFe;const GFe=Pn(wFe);function BFe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}var SFe=BFe,ZFe=uF;function RFe(t,e){var n=!0;return ZFe(t,function(i,r,s){return n=!!e(i,r,s),n}),n}var NFe=RFe,WFe=SFe,MFe=NFe,VFe=Pl,FFe=io,_Fe=xB;function TFe(t,e,n){var i=FFe(t)?WFe:MFe;return n&&_Fe(t,e,n)&&(e=void 0),i(t,VFe(e))}var XFe=TFe;const O6=Pn(XFe);var EFe=["x","y"];function qA(t){"@babel/helpers - typeof";return qA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qA(t)}function qM(){return qM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},qM.apply(this,arguments)}function CK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Yp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CK(Object(n),!0).forEach(function(i){YFe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function YFe(t,e,n){return e=kFe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kFe(t){var e=HFe(t,"string");return qA(e)=="symbol"?e:e+""}function HFe(t,e){if(qA(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(qA(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KFe(t,e){if(t==null)return{};var n=LFe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function LFe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function zFe(t,e){var n=t.x,i=t.y,r=KFe(t,EFe),s="".concat(n),o=parseInt(s,10),a="".concat(i),l=parseInt(a,10),c="".concat(e.height||r.height),u=parseInt(c,10),d="".concat(e.width||r.width),h=parseInt(d,10);return Yp(Yp(Yp(Yp(Yp({},e),r),o?{x:o}:{}),l?{y:l}:{}),{},{height:u,width:h,name:e.name,radius:e.radius})}function pK(t){return $.createElement(eG,qM({shapeType:"rectangle",propTransformer:zFe,activeClassName:"recharts-active-bar"},t))}var jFe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,r){if(typeof e=="number")return e;var s=typeof i=="number";return s?e(i,r):(s||th(),n)}},PFe=["value","background"],D6;function Pf(t){"@babel/helpers - typeof";return Pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pf(t)}function OFe(t,e){if(t==null)return{};var n=DFe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function DFe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function sG(){return sG=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},sG.apply(this,arguments)}function mK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function $i(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mK(Object(n),!0).forEach(function(i){Eg(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function UFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,J6(i.key),i)}}function JFe(t,e,n){return e&&AK(t.prototype,e),n&&AK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function QFe(t,e,n){return e=oG(e),qFe(t,U6()?Reflect.construct(e,n||[],oG(t).constructor):e.apply(t,n))}function qFe(t,e){if(e&&(Pf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Fe(t)}function $Fe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U6=function(){return!!t})()}function oG(t){return oG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},oG(t)}function e_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$M(t,e)}function $M(t,e){return $M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},$M(t,e)}function Eg(t,e,n){return e=J6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J6(t){var e=t_e(t,"string");return Pf(e)=="symbol"?e:e+""}function t_e(t,e){if(Pf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Pf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gr=function(t){function e(){var n;UFe(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=QFe(this,e,[].concat(r)),Eg(n,"state",{isAnimationFinished:!1}),Eg(n,"id",yu("recharts-bar-")),Eg(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),o&&o()}),Eg(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),o&&o()}),n}return e_e(e,t),JFe(e,[{key:"renderRectanglesStatically",value:function(i){var r=this,s=this.props,o=s.shape,a=s.dataKey,l=s.activeIndex,c=s.activeBar,u=Yt(this.props,!1);return i&&i.map(function(d,h){var I=h===l,p=I?c:o,y=$i($i($i({},u),d),{},{isActive:I,option:p,index:h,dataKey:a,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return $.createElement(fn,sG({className:"recharts-bar-rectangle"},su(r.props,d,h),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(h)}),$.createElement(pK,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,r=this.props,s=r.data,o=r.layout,a=r.isAnimationActive,l=r.animationBegin,c=r.animationDuration,u=r.animationEasing,d=r.animationId,h=this.state.prevData;return $.createElement(ca,{begin:l,duration:c,isActive:a,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(I){var p=I.t,y=s.map(function(A,m){var b=h&&h[m];if(b){var v=Ni(b.x,A.x),w=Ni(b.y,A.y),x=Ni(b.width,A.width),B=Ni(b.height,A.height);return $i($i({},A),{},{x:v(p),y:w(p),width:x(p),height:B(p)})}if(o==="horizontal"){var Z=Ni(0,A.height),N=Z(p);return $i($i({},A),{},{y:A.y+A.height-N,height:N})}var W=Ni(0,A.width),M=W(p);return $i($i({},A),{},{width:M})});return $.createElement(fn,null,i.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var i=this.props,r=i.data,s=i.isAnimationActive,o=this.state.prevData;return s&&r&&r.length&&(!o||!ou(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var i=this,r=this.props,s=r.data,o=r.dataKey,a=r.activeIndex,l=Yt(this.props.background,!1);return s.map(function(c,u){c.value;var d=c.background,h=OFe(c,PFe);if(!d)return null;var I=$i($i($i($i($i({},h),{},{fill:"#eee"},d),l),su(i.props,c,u)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return $.createElement(pK,sG({key:"background-bar-".concat(u),option:i.props.background,isActive:u===a},I))})}},{key:"renderErrorBar",value:function(i,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.data,a=s.xAxis,l=s.yAxis,c=s.layout,u=s.children,d=Gs(u,PC);if(!d)return null;var h=c==="vertical"?o[0].height/2:o[0].width/2,I=function(A,m){var b=Array.isArray(A.value)?A.value[1]:A.value;return{x:A.x,y:A.y,value:b,errorVal:yi(A,m)}},p={clipPath:i?"url(#clipPath-".concat(r,")"):null};return $.createElement(fn,p,d.map(function(y){return $.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:o,xAxis:a,yAxis:l,layout:c,offset:h,dataPointFormatter:I})}))}},{key:"render",value:function(){var i=this.props,r=i.hide,s=i.data,o=i.className,a=i.xAxis,l=i.yAxis,c=i.left,u=i.top,d=i.width,h=i.height,I=i.isAnimationActive,p=i.background,y=i.id;if(r||!s||!s.length)return null;var A=this.state.isAnimationFinished,m=ln("recharts-bar",o),b=a&&a.allowDataOverflow,v=l&&l.allowDataOverflow,w=b||v,x=en(y)?this.id:y;return $.createElement(fn,{className:m},b||v?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(x)},$.createElement("rect",{x:b?c:c-d/2,y:v?u:u-h/2,width:b?d:d*2,height:v?h:h*2}))):null,$.createElement(fn,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(x,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,x),(!I||A)&&Oa.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.animationId!==r.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:r.curData}:i.data!==r.curData?{curData:i.data}:null}}])}(S.PureComponent);D6=Gr;Eg(Gr,"displayName","Bar");Eg(Gr,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!ra.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Eg(Gr,"getComposedData",function(t){var e=t.props,n=t.item,i=t.barPosition,r=t.bandSize,s=t.xAxis,o=t.yAxis,a=t.xAxisTicks,l=t.yAxisTicks,c=t.stackedData,u=t.dataStartIndex,d=t.displayedData,h=t.offset,I=_Ne(i,n);if(!I)return null;var p=e.layout,y=n.type.defaultProps,A=y!==void 0?$i($i({},y),n.props):n.props,m=A.dataKey,b=A.children,v=A.minPointSize,w=p==="horizontal"?o:s,x=c?w.scale.domain():null,B=KNe({numericAxis:w}),Z=Gs(b,j0),N=d.map(function(W,M){var F,T,H,K,z,j;c?F=TNe(c[u+M],x):(F=yi(W,m),Array.isArray(F)||(F=[B,F]));var O=jFe(v,D6.defaultProps.minPointSize)(F[1],M);if(p==="horizontal"){var _,E=[o.scale(F[0]),o.scale(F[1])],P=E[0],q=E[1];T=l9({axis:s,ticks:a,bandSize:r,offset:I.offset,entry:W,index:M}),H=(_=q??P)!==null&&_!==void 0?_:void 0,K=I.size;var re=P-q;if(z=Number.isNaN(re)?0:re,j={x:T,y:o.y,width:K,height:o.height},Math.abs(O)>0&&Math.abs(z)<Math.abs(O)){var de=ys(z||O)*(Math.abs(O)-Math.abs(z));H-=de,z+=de}}else{var Re=[s.scale(F[0]),s.scale(F[1])],Pe=Re[0],ae=Re[1];if(T=Pe,H=l9({axis:o,ticks:l,bandSize:r,offset:I.offset,entry:W,index:M}),K=ae-Pe,z=I.size,j={x:s.x,y:H,width:s.width,height:z},Math.abs(O)>0&&Math.abs(K)<Math.abs(O)){var he=ys(K||O)*(Math.abs(O)-Math.abs(K));K+=he}}return $i($i($i({},W),{},{x:T,y:H,width:K,height:z,value:c?F:F[1],payload:W,background:j},Z&&Z[M]&&Z[M].props),{},{tooltipPayload:[A6(n,W)],tooltipPosition:{x:T+K/2,y:H+z/2}})});return $i({data:N,layout:p},h)});function $A(t){"@babel/helpers - typeof";return $A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$A(t)}function n_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Q6(i.key),i)}}function i_e(t,e,n){return e&&yK(t.prototype,e),n&&yK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function bK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Va(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bK(Object(n),!0).forEach(function(i){kB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function kB(t,e,n){return e=Q6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q6(t){var e=r_e(t,"string");return $A(e)=="symbol"?e:e+""}function r_e(t,e){if($A(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if($A(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Q0=function(e,n,i,r,s){var o=e.width,a=e.height,l=e.layout,c=e.children,u=Object.keys(n),d={left:i.left,leftMirror:i.left,right:o-i.right,rightMirror:o-i.right,top:i.top,topMirror:i.top,bottom:a-i.bottom,bottomMirror:a-i.bottom},h=!!Co(c,Gr);return u.reduce(function(I,p){var y=n[p],A=y.orientation,m=y.domain,b=y.padding,v=b===void 0?{}:b,w=y.mirror,x=y.reversed,B="".concat(A).concat(w?"Mirror":""),Z,N,W,M,F;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var T=m[1]-m[0],H=1/0,K=y.categoricalDomain.sort();if(K.forEach(function(Re,Pe){Pe>0&&(H=Math.min((Re||0)-(K[Pe-1]||0),H))}),Number.isFinite(H)){var z=H/T,j=y.layout==="vertical"?i.height:i.width;if(y.padding==="gap"&&(Z=z*j/2),y.padding==="no-gap"){var O=bs(e.barCategoryGap,z*j),_=z*j/2;Z=_-O-(_-O)/j*O}}}r==="xAxis"?N=[i.left+(v.left||0)+(Z||0),i.left+i.width-(v.right||0)-(Z||0)]:r==="yAxis"?N=l==="horizontal"?[i.top+i.height-(v.bottom||0),i.top+(v.top||0)]:[i.top+(v.top||0)+(Z||0),i.top+i.height-(v.bottom||0)-(Z||0)]:N=y.range,x&&(N=[N[1],N[0]]);var E=f6(y,s,h),P=E.scale,q=E.realScaleType;P.domain(m).range(N),C6(P);var re=p6(P,Va(Va({},y),{},{realScaleType:q}));r==="xAxis"?(F=A==="top"&&!w||A==="bottom"&&w,W=i.left,M=d[B]-F*y.height):r==="yAxis"&&(F=A==="left"&&!w||A==="right"&&w,W=d[B]-F*y.width,M=i.top);var de=Va(Va(Va({},y),re),{},{realScaleType:q,x:W,y:M,scale:P,width:r==="xAxis"?i.width:y.width,height:r==="yAxis"?i.height:y.height});return de.bandSize=Lw(de,re),!y.hide&&r==="xAxis"?d[B]+=(F?-1:1)*de.height:y.hide||(d[B]+=(F?-1:1)*de.width),Va(Va({},I),{},kB({},p,de))},{})},q6=function(e,n){var i=e.x,r=e.y,s=n.x,o=n.y;return{x:Math.min(i,s),y:Math.min(r,o),width:Math.abs(s-i),height:Math.abs(o-r)}},s_e=function(e){var n=e.x1,i=e.y1,r=e.x2,s=e.y2;return q6({x:n,y:i},{x:r,y:s})},$6=function(){function t(e){n_e(this,t),this.scale=e}return i_e(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.bandAware,s=i.position;if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+o}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(n)+a}default:return this.scale(n)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),r=i[0],s=i[i.length-1];return r<=s?n>=r&&n<=s:n>=s&&n<=r}}],[{key:"create",value:function(n){return new t(n)}}])}();kB($6,"EPS",1e-4);var kF=function(e){var n=Object.keys(e).reduce(function(i,r){return Va(Va({},i),{},kB({},r,$6.create(e[r])))},{});return Va(Va({},n),{},{apply:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.bandAware,a=s.position;return GFe(r,function(l,c){return n[c].apply(l,{bandAware:o,position:a})})},isInRange:function(r){return O6(r,function(s,o){return n[o].isInRange(s)})}})};function o_e(t){return(t%180+180)%180}var a_e=function(e){var n=e.width,i=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=o_e(r),o=s*Math.PI/180,a=Math.atan(i/n),l=o>a&&o<Math.PI-a?i/Math.sin(o):n/Math.cos(o);return Math.abs(l)},l_e=Pl,c_e=z0,g_e=bB;function u_e(t){return function(e,n,i){var r=Object(e);if(!c_e(e)){var s=l_e(n);e=g_e(e),n=function(a){return s(r[a],a,r)}}var o=t(e,n,i);return o>-1?r[s?e[o]:o]:void 0}}var d_e=u_e,h_e=L6;function I_e(t){var e=h_e(t),n=e%1;return e===e?n?e-n:e:0}var f_e=I_e,C_e=U8,p_e=Pl,m_e=f_e,A_e=Math.max;function y_e(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:m_e(n);return r<0&&(r=A_e(i+r,0)),C_e(t,p_e(e),r)}var b_e=y_e,v_e=d_e,x_e=b_e,w_e=v_e(x_e),G_e=w_e;const B_e=Pn(G_e);var S_e=vpe(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),HF=S.createContext(void 0),KF=S.createContext(void 0),eq=S.createContext(void 0),tq=S.createContext({}),nq=S.createContext(void 0),iq=S.createContext(0),rq=S.createContext(0),vK=function(e){var n=e.state,i=n.xAxisMap,r=n.yAxisMap,s=n.offset,o=e.clipPathId,a=e.children,l=e.width,c=e.height,u=S_e(s);return $.createElement(HF.Provider,{value:i},$.createElement(KF.Provider,{value:r},$.createElement(tq.Provider,{value:s},$.createElement(eq.Provider,{value:u},$.createElement(nq.Provider,{value:o},$.createElement(iq.Provider,{value:c},$.createElement(rq.Provider,{value:l},a)))))))},Z_e=function(){return S.useContext(nq)},sq=function(e){var n=S.useContext(HF);n==null&&th();var i=n[e];return i==null&&th(),i},R_e=function(){var e=S.useContext(HF);return wg(e)},N_e=function(){var e=S.useContext(KF),n=B_e(e,function(i){return O6(i.domain,Number.isFinite)});return n||wg(e)},oq=function(e){var n=S.useContext(KF);n==null&&th();var i=n[e];return i==null&&th(),i},W_e=function(){var e=S.useContext(eq);return e},M_e=function(){return S.useContext(tq)},LF=function(){return S.useContext(rq)},zF=function(){return S.useContext(iq)};function Of(t){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Of(t)}function V_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F_e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,lq(i.key),i)}}function __e(t,e,n){return e&&F_e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function T_e(t,e,n){return e=aG(e),X_e(t,aq()?Reflect.construct(e,n||[],aG(t).constructor):e.apply(t,n))}function X_e(t,e){if(e&&(Of(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E_e(t)}function E_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aq=function(){return!!t})()}function aG(t){return aG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},aG(t)}function Y_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&e3(t,e)}function e3(t,e){return e3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},e3(t,e)}function xK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function wK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xK(Object(n),!0).forEach(function(i){jF(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function jF(t,e,n){return e=lq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lq(t){var e=k_e(t,"string");return Of(e)=="symbol"?e:e+""}function k_e(t,e){if(Of(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Of(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H_e(t,e){return j_e(t)||z_e(t,e)||L_e(t,e)||K_e()}function K_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L_e(t,e){if(t){if(typeof t=="string")return GK(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GK(t,e)}}function GK(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function z_e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function j_e(t){if(Array.isArray(t))return t}function t3(){return t3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},t3.apply(this,arguments)}var P_e=function(e,n){var i;return $.isValidElement(e)?i=$.cloneElement(e,n):$t(e)?i=e(n):i=$.createElement("line",t3({},n,{className:"recharts-reference-line-line"})),i},O_e=function(e,n,i,r,s,o,a,l,c){var u=s.x,d=s.y,h=s.width,I=s.height;if(i){var p=c.y,y=e.y.apply(p,{position:o});if(_l(c,"discard")&&!e.y.isInRange(y))return null;var A=[{x:u+h,y},{x:u,y}];return l==="left"?A.reverse():A}if(n){var m=c.x,b=e.x.apply(m,{position:o});if(_l(c,"discard")&&!e.x.isInRange(b))return null;var v=[{x:b,y:d+I},{x:b,y:d}];return a==="top"?v.reverse():v}if(r){var w=c.segment,x=w.map(function(B){return e.apply(B,{position:o})});return _l(c,"discard")&&pFe(x,function(B){return!e.isInRange(B)})?null:x}return null};function D_e(t){var e=t.x,n=t.y,i=t.segment,r=t.xAxisId,s=t.yAxisId,o=t.shape,a=t.className,l=t.alwaysShow,c=Z_e(),u=sq(r),d=oq(s),h=W_e();if(!c||!h)return null;Pa(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var I=kF({x:u.scale,y:d.scale}),p=dr(e),y=dr(n),A=i&&i.length===2,m=O_e(I,p,y,A,h,t.position,u.orientation,d.orientation,t);if(!m)return null;var b=H_e(m,2),v=b[0],w=v.x,x=v.y,B=b[1],Z=B.x,N=B.y,W=_l(t,"hidden")?"url(#".concat(c,")"):void 0,M=wK(wK({clipPath:W},Yt(t,!0)),{},{x1:w,y1:x,x2:Z,y2:N});return $.createElement(fn,{className:ln("recharts-reference-line",a)},P_e(o,M),wr.renderCallByParent(t,s_e({x1:w,y1:x,x2:Z,y2:N})))}var PF=function(t){function e(){return V_e(this,e),T_e(this,e,arguments)}return Y_e(e,t),__e(e,[{key:"render",value:function(){return $.createElement(D_e,this.props)}}])}($.Component);jF(PF,"displayName","ReferenceLine");jF(PF,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function n3(){return n3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},n3.apply(this,arguments)}function Df(t){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Df(t)}function BK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function SK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BK(Object(n),!0).forEach(function(i){HB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function U_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J_e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,gq(i.key),i)}}function Q_e(t,e,n){return e&&J_e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function q_e(t,e,n){return e=lG(e),$_e(t,cq()?Reflect.construct(e,n||[],lG(t).constructor):e.apply(t,n))}function $_e(t,e){if(e&&(Df(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eTe(t)}function eTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cq=function(){return!!t})()}function lG(t){return lG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lG(t)}function tTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i3(t,e)}function i3(t,e){return i3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},i3(t,e)}function HB(t,e,n){return e=gq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gq(t){var e=nTe(t,"string");return Df(e)=="symbol"?e:e+""}function nTe(t,e){if(Df(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Df(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iTe=function(e){var n=e.x,i=e.y,r=e.xAxis,s=e.yAxis,o=kF({x:r.scale,y:s.scale}),a=o.apply({x:n,y:i},{bandAware:!0});return _l(e,"discard")&&!o.isInRange(a)?null:a},KB=function(t){function e(){return U_e(this,e),q_e(this,e,arguments)}return tTe(e,t),Q_e(e,[{key:"render",value:function(){var i=this.props,r=i.x,s=i.y,o=i.r,a=i.alwaysShow,l=i.clipPathId,c=dr(r),u=dr(s);if(Pa(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!u)return null;var d=iTe(this.props);if(!d)return null;var h=d.x,I=d.y,p=this.props,y=p.shape,A=p.className,m=_l(this.props,"hidden")?"url(#".concat(l,")"):void 0,b=SK(SK({clipPath:m},Yt(this.props,!0)),{},{cx:h,cy:I});return $.createElement(fn,{className:ln("recharts-reference-dot",A)},e.renderDot(y,b),wr.renderCallByParent(this.props,{x:h-o,y:I-o,width:2*o,height:2*o}))}}])}($.Component);HB(KB,"displayName","ReferenceDot");HB(KB,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});HB(KB,"renderDot",function(t,e){var n;return $.isValidElement(t)?n=$.cloneElement(t,e):$t(t)?n=t(e):n=$.createElement(J0,n3({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function r3(){return r3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r3.apply(this,arguments)}function Uf(t){"@babel/helpers - typeof";return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uf(t)}function ZK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function RK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZK(Object(n),!0).forEach(function(i){LB(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function rTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sTe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,dq(i.key),i)}}function oTe(t,e,n){return e&&sTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function aTe(t,e,n){return e=cG(e),lTe(t,uq()?Reflect.construct(e,n||[],cG(t).constructor):e.apply(t,n))}function lTe(t,e){if(e&&(Uf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cTe(t)}function cTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uq=function(){return!!t})()}function cG(t){return cG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cG(t)}function gTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s3(t,e)}function s3(t,e){return s3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},s3(t,e)}function LB(t,e,n){return e=dq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=uTe(t,"string");return Uf(e)=="symbol"?e:e+""}function uTe(t,e){if(Uf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Uf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dTe=function(e,n,i,r,s){var o=s.x1,a=s.x2,l=s.y1,c=s.y2,u=s.xAxis,d=s.yAxis;if(!u||!d)return null;var h=kF({x:u.scale,y:d.scale}),I={x:e?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:i?h.y.apply(l,{position:"start"}):h.y.rangeMin},p={x:n?h.x.apply(a,{position:"end"}):h.x.rangeMax,y:r?h.y.apply(c,{position:"end"}):h.y.rangeMax};return _l(s,"discard")&&(!h.isInRange(I)||!h.isInRange(p))?null:q6(I,p)},zB=function(t){function e(){return rTe(this,e),aTe(this,e,arguments)}return gTe(e,t),oTe(e,[{key:"render",value:function(){var i=this.props,r=i.x1,s=i.x2,o=i.y1,a=i.y2,l=i.className,c=i.alwaysShow,u=i.clipPathId;Pa(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=dr(r),h=dr(s),I=dr(o),p=dr(a),y=this.props.shape;if(!d&&!h&&!I&&!p&&!y)return null;var A=dTe(d,h,I,p,this.props);if(!A&&!y)return null;var m=_l(this.props,"hidden")?"url(#".concat(u,")"):void 0;return $.createElement(fn,{className:ln("recharts-reference-area",l)},e.renderRect(y,RK(RK({clipPath:m},Yt(this.props,!0)),A)),wr.renderCallByParent(this.props,A))}}])}($.Component);LB(zB,"displayName","ReferenceArea");LB(zB,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});LB(zB,"renderRect",function(t,e){var n;return $.isValidElement(t)?n=$.cloneElement(t,e):$t(t)?n=t(e):n=$.createElement(YF,r3({},e,{className:"recharts-reference-area-rect"})),n});function hq(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var i=[],r=0;r<t.length;r+=e)i.push(t[r]);return i}function hTe(t,e,n){var i={width:t.width+e.width,height:t.height+e.height};return a_e(i,n)}function ITe(t,e,n){var i=n==="width",r=t.x,s=t.y,o=t.width,a=t.height;return e===1?{start:i?r:s,end:i?r+o:s+a}:{start:i?r+o:s+a,end:i?r:s}}function gG(t,e,n,i,r){if(t*e<t*i||t*e>t*r)return!1;var s=n();return t*(e-t*s/2-i)>=0&&t*(e+t*s/2-r)<=0}function fTe(t,e){return hq(t,e+1)}function CTe(t,e,n,i,r){for(var s=(i||[]).slice(),o=e.start,a=e.end,l=0,c=1,u=o,d=function(){var p=i==null?void 0:i[l];if(p===void 0)return{v:hq(i,c)};var y=l,A,m=function(){return A===void 0&&(A=n(p,y)),A},b=p.coordinate,v=l===0||gG(t,b,m,u,a);v||(l=0,u=o,c+=1),v&&(u=b+t*(m()/2+r),l+=c)},h;c<=s.length;)if(h=d(),h)return h.v;return[]}function e0(t){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e0(t)}function NK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Jr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NK(Object(n),!0).forEach(function(i){pTe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function pTe(t,e,n){return e=mTe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mTe(t){var e=ATe(t,"string");return e0(e)=="symbol"?e:e+""}function ATe(t,e){if(e0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(e0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yTe(t,e,n,i,r){for(var s=(i||[]).slice(),o=s.length,a=e.start,l=e.end,c=function(h){var I=s[h],p,y=function(){return p===void 0&&(p=n(I,h)),p};if(h===o-1){var A=t*(I.coordinate+t*y()/2-l);s[h]=I=Jr(Jr({},I),{},{tickCoord:A>0?I.coordinate-A*t:I.coordinate})}else s[h]=I=Jr(Jr({},I),{},{tickCoord:I.coordinate});var m=gG(t,I.tickCoord,y,a,l);m&&(l=I.tickCoord-t*(y()/2+r),s[h]=Jr(Jr({},I),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return s}function bTe(t,e,n,i,r,s){var o=(i||[]).slice(),a=o.length,l=e.start,c=e.end;if(s){var u=i[a-1],d=n(u,a-1),h=t*(u.coordinate+t*d/2-c);o[a-1]=u=Jr(Jr({},u),{},{tickCoord:h>0?u.coordinate-h*t:u.coordinate});var I=gG(t,u.tickCoord,function(){return d},l,c);I&&(c=u.tickCoord-t*(d/2+r),o[a-1]=Jr(Jr({},u),{},{isShow:!0}))}for(var p=s?a-1:a,y=function(b){var v=o[b],w,x=function(){return w===void 0&&(w=n(v,b)),w};if(b===0){var B=t*(v.coordinate-t*x()/2-l);o[b]=v=Jr(Jr({},v),{},{tickCoord:B<0?v.coordinate-B*t:v.coordinate})}else o[b]=v=Jr(Jr({},v),{},{tickCoord:v.coordinate});var Z=gG(t,v.tickCoord,x,l,c);Z&&(l=v.tickCoord+t*(x()/2+r),o[b]=Jr(Jr({},v),{},{isShow:!0}))},A=0;A<p;A++)y(A);return o}function OF(t,e,n){var i=t.tick,r=t.ticks,s=t.viewBox,o=t.minTickGap,a=t.orientation,l=t.interval,c=t.tickFormatter,u=t.unit,d=t.angle;if(!r||!r.length||!i)return[];if(ut(l)||ra.isSsr)return fTe(r,typeof l=="number"&&ut(l)?l:0);var h=[],I=a==="top"||a==="bottom"?"width":"height",p=u&&I==="width"?Vm(u,{fontSize:e,letterSpacing:n}):{width:0,height:0},y=function(v,w){var x=$t(c)?c(v.value,w):v.value;return I==="width"?hTe(Vm(x,{fontSize:e,letterSpacing:n}),p,d):Vm(x,{fontSize:e,letterSpacing:n})[I]},A=r.length>=2?ys(r[1].coordinate-r[0].coordinate):1,m=ITe(s,A,I);return l==="equidistantPreserveStart"?CTe(A,m,y,r,o):(l==="preserveStart"||l==="preserveStartEnd"?h=bTe(A,m,y,r,o,l==="preserveStartEnd"):h=yTe(A,m,y,r,o),h.filter(function(b){return b.isShow}))}var vTe=["viewBox"],xTe=["viewBox"],wTe=["ticks"];function Jf(t){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jf(t)}function WI(){return WI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},WI.apply(this,arguments)}function WK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function us(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WK(Object(n),!0).forEach(function(i){DF(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function qZ(t,e){if(t==null)return{};var n=GTe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function GTe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function BTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,fq(i.key),i)}}function STe(t,e,n){return e&&MK(t.prototype,e),n&&MK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZTe(t,e,n){return e=uG(e),RTe(t,Iq()?Reflect.construct(e,n||[],uG(t).constructor):e.apply(t,n))}function RTe(t,e){if(e&&(Jf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NTe(t)}function NTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Iq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Iq=function(){return!!t})()}function uG(t){return uG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uG(t)}function WTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o3(t,e)}function o3(t,e){return o3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},o3(t,e)}function DF(t,e,n){return e=fq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fq(t){var e=MTe(t,"string");return Jf(e)=="symbol"?e:e+""}function MTe(t,e){if(Jf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Jf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OC=function(t){function e(n){var i;return BTe(this,e),i=ZTe(this,e,[n]),i.state={fontSize:"",letterSpacing:""},i}return WTe(e,t),STe(e,[{key:"shouldComponentUpdate",value:function(i,r){var s=i.viewBox,o=qZ(i,vTe),a=this.props,l=a.viewBox,c=qZ(a,xTe);return!UI(s,l)||!UI(o,c)||!UI(r,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var r=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var r=this.props,s=r.x,o=r.y,a=r.width,l=r.height,c=r.orientation,u=r.tickSize,d=r.mirror,h=r.tickMargin,I,p,y,A,m,b,v=d?-1:1,w=i.tickSize||u,x=ut(i.tickCoord)?i.tickCoord:i.coordinate;switch(c){case"top":I=p=i.coordinate,A=o+ +!d*l,y=A-v*w,b=y-v*h,m=x;break;case"left":y=A=i.coordinate,p=s+ +!d*a,I=p-v*w,m=I-v*h,b=x;break;case"right":y=A=i.coordinate,p=s+ +d*a,I=p+v*w,m=I+v*h,b=x;break;default:I=p=i.coordinate,A=o+ +d*l,y=A+v*w,b=y+v*h,m=x;break}return{line:{x1:I,y1:y,x2:p,y2:A},tick:{x:m,y:b}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,r=i.orientation,s=i.mirror,o;switch(r){case"left":o=s?"start":"end";break;case"right":o=s?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,r=i.orientation,s=i.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=s?"start":"end";break;default:o=s?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var i=this.props,r=i.x,s=i.y,o=i.width,a=i.height,l=i.orientation,c=i.mirror,u=i.axisLine,d=us(us(us({},Yt(this.props,!1)),Yt(u,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!c||l==="bottom"&&c);d=us(us({},d),{},{x1:r,y1:s+h*a,x2:r+o,y2:s+h*a})}else{var I=+(l==="left"&&!c||l==="right"&&c);d=us(us({},d),{},{x1:r+I*o,y1:s,x2:r+I*o,y2:s+a})}return $.createElement("line",WI({},d,{className:ln("recharts-cartesian-axis-line",wo(u,"className"))}))}},{key:"renderTicks",value:function(i,r,s){var o=this,a=this.props,l=a.tickLine,c=a.stroke,u=a.tick,d=a.tickFormatter,h=a.unit,I=OF(us(us({},this.props),{},{ticks:i}),r,s),p=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),A=Yt(this.props,!1),m=Yt(u,!1),b=us(us({},A),{},{fill:"none"},Yt(l,!1)),v=I.map(function(w,x){var B=o.getTickLineCoord(w),Z=B.line,N=B.tick,W=us(us(us(us({textAnchor:p,verticalAnchor:y},A),{},{stroke:"none",fill:c},m),N),{},{index:x,payload:w,visibleTicksCount:I.length,tickFormatter:d});return $.createElement(fn,WI({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},su(o.props,w,x)),l&&$.createElement("line",WI({},b,Z,{className:ln("recharts-cartesian-axis-tick-line",wo(l,"className"))})),u&&e.renderTickItem(u,W,"".concat($t(d)?d(w.value,x):w.value).concat(h||"")))});return $.createElement("g",{className:"recharts-cartesian-axis-ticks"},v)}},{key:"render",value:function(){var i=this,r=this.props,s=r.axisLine,o=r.width,a=r.height,l=r.ticksGenerator,c=r.className,u=r.hide;if(u)return null;var d=this.props,h=d.ticks,I=qZ(d,wTe),p=h;return $t(l)&&(p=h&&h.length>0?l(this.props):l(I)),o<=0||a<=0||!p||!p.length?null:$.createElement(fn,{className:ln("recharts-cartesian-axis",c),ref:function(A){i.layerReference=A}},s&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),wr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,r,s){var o;return $.isValidElement(i)?o=$.cloneElement(i,r):$t(i)?o=i(r):o=$.createElement($d,WI({},r,{className:"recharts-cartesian-axis-tick-value"}),s),o}}])}(S.Component);DF(OC,"displayName","CartesianAxis");DF(OC,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var VTe=["x1","y1","x2","y2","key"],FTe=["offset"];function nh(t){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nh(t)}function VK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function is(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?VK(Object(n),!0).forEach(function(i){_Te(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function _Te(t,e,n){return e=TTe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TTe(t){var e=XTe(t,"string");return nh(e)=="symbol"?e:e+""}function XTe(t,e){if(nh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(nh(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function md(){return md=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},md.apply(this,arguments)}function FK(t,e){if(t==null)return{};var n=ETe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function ETe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var YTe=function(e){var n=e.fill;if(!n||n==="none")return null;var i=e.fillOpacity,r=e.x,s=e.y,o=e.width,a=e.height,l=e.ry;return $.createElement("rect",{x:r,y:s,ry:l,width:o,height:a,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function Cq(t,e){var n;if($.isValidElement(t))n=$.cloneElement(t,e);else if($t(t))n=t(e);else{var i=e.x1,r=e.y1,s=e.x2,o=e.y2,a=e.key,l=FK(e,VTe),c=Yt(l,!1);c.offset;var u=FK(c,FTe);n=$.createElement("line",md({},u,{x1:i,y1:r,x2:s,y2:o,fill:"none",key:a}))}return n}function kTe(t){var e=t.x,n=t.width,i=t.horizontal,r=i===void 0?!0:i,s=t.horizontalPoints;if(!r||!s||!s.length)return null;var o=s.map(function(a,l){var c=is(is({},t),{},{x1:e,y1:a,x2:e+n,y2:a,key:"line-".concat(l),index:l});return Cq(r,c)});return $.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function HTe(t){var e=t.y,n=t.height,i=t.vertical,r=i===void 0?!0:i,s=t.verticalPoints;if(!r||!s||!s.length)return null;var o=s.map(function(a,l){var c=is(is({},t),{},{x1:a,y1:e,x2:a,y2:e+n,key:"line-".concat(l),index:l});return Cq(r,c)});return $.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function KTe(t){var e=t.horizontalFill,n=t.fillOpacity,i=t.x,r=t.y,s=t.width,o=t.height,a=t.horizontalPoints,l=t.horizontal,c=l===void 0?!0:l;if(!c||!e||!e.length)return null;var u=a.map(function(h){return Math.round(h+r-r)}).sort(function(h,I){return h-I});r!==u[0]&&u.unshift(0);var d=u.map(function(h,I){var p=!u[I+1],y=p?r+o-h:u[I+1]-h;if(y<=0)return null;var A=I%e.length;return $.createElement("rect",{key:"react-".concat(I),y:h,x:i,height:y,width:s,stroke:"none",fill:e[A],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return $.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function LTe(t){var e=t.vertical,n=e===void 0?!0:e,i=t.verticalFill,r=t.fillOpacity,s=t.x,o=t.y,a=t.width,l=t.height,c=t.verticalPoints;if(!n||!i||!i.length)return null;var u=c.map(function(h){return Math.round(h+s-s)}).sort(function(h,I){return h-I});s!==u[0]&&u.unshift(0);var d=u.map(function(h,I){var p=!u[I+1],y=p?s+a-h:u[I+1]-h;if(y<=0)return null;var A=I%i.length;return $.createElement("rect",{key:"react-".concat(I),x:h,y:o,width:y,height:l,stroke:"none",fill:i[A],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return $.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var zTe=function(e,n){var i=e.xAxis,r=e.width,s=e.height,o=e.offset;return I6(OF(is(is(is({},OC.defaultProps),i),{},{ticks:xc(i,!0),viewBox:{x:0,y:0,width:r,height:s}})),o.left,o.left+o.width,n)},jTe=function(e,n){var i=e.yAxis,r=e.width,s=e.height,o=e.offset;return I6(OF(is(is(is({},OC.defaultProps),i),{},{ticks:xc(i,!0),viewBox:{x:0,y:0,width:r,height:s}})),o.top,o.top+o.height,n)},zh={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function er(t){var e,n,i,r,s,o,a=LF(),l=zF(),c=M_e(),u=is(is({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:zh.stroke,fill:(n=t.fill)!==null&&n!==void 0?n:zh.fill,horizontal:(i=t.horizontal)!==null&&i!==void 0?i:zh.horizontal,horizontalFill:(r=t.horizontalFill)!==null&&r!==void 0?r:zh.horizontalFill,vertical:(s=t.vertical)!==null&&s!==void 0?s:zh.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:zh.verticalFill,x:ut(t.x)?t.x:c.left,y:ut(t.y)?t.y:c.top,width:ut(t.width)?t.width:c.width,height:ut(t.height)?t.height:c.height}),d=u.x,h=u.y,I=u.width,p=u.height,y=u.syncWithTicks,A=u.horizontalValues,m=u.verticalValues,b=R_e(),v=N_e();if(!ut(I)||I<=0||!ut(p)||p<=0||!ut(d)||d!==+d||!ut(h)||h!==+h)return null;var w=u.verticalCoordinatesGenerator||zTe,x=u.horizontalCoordinatesGenerator||jTe,B=u.horizontalPoints,Z=u.verticalPoints;if((!B||!B.length)&&$t(x)){var N=A&&A.length,W=x({yAxis:v?is(is({},v),{},{ticks:N?A:v.ticks}):void 0,width:a,height:l,offset:c},N?!0:y);Pa(Array.isArray(W),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(nh(W),"]")),Array.isArray(W)&&(B=W)}if((!Z||!Z.length)&&$t(w)){var M=m&&m.length,F=w({xAxis:b?is(is({},b),{},{ticks:M?m:b.ticks}):void 0,width:a,height:l,offset:c},M?!0:y);Pa(Array.isArray(F),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(nh(F),"]")),Array.isArray(F)&&(Z=F)}return $.createElement("g",{className:"recharts-cartesian-grid"},$.createElement(YTe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),$.createElement(kTe,md({},u,{offset:c,horizontalPoints:B,xAxis:b,yAxis:v})),$.createElement(HTe,md({},u,{offset:c,verticalPoints:Z,xAxis:b,yAxis:v})),$.createElement(KTe,md({},u,{horizontalPoints:B})),$.createElement(LTe,md({},u,{verticalPoints:Z})))}er.displayName="CartesianGrid";var PTe=["type","layout","connectNulls","ref"],OTe=["key"];function Qf(t){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(t)}function _K(t,e){if(t==null)return{};var n=DTe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function DTe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function Ym(){return Ym=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ym.apply(this,arguments)}function TK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function uo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TK(Object(n),!0).forEach(function(i){Fa(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function jh(t){return qTe(t)||QTe(t)||JTe(t)||UTe()}function UTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JTe(t,e){if(t){if(typeof t=="string")return a3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a3(t,e)}}function QTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qTe(t){if(Array.isArray(t))return a3(t)}function a3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function $Te(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,mq(i.key),i)}}function eXe(t,e,n){return e&&XK(t.prototype,e),n&&XK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tXe(t,e,n){return e=dG(e),nXe(t,pq()?Reflect.construct(e,n||[],dG(t).constructor):e.apply(t,n))}function nXe(t,e){if(e&&(Qf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iXe(t)}function iXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pq=function(){return!!t})()}function dG(t){return dG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dG(t)}function rXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l3(t,e)}function l3(t,e){return l3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},l3(t,e)}function Fa(t,e,n){return e=mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=sXe(t,"string");return Qf(e)=="symbol"?e:e+""}function sXe(t,e){if(Qf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Qf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jn=function(t){function e(){var n;$Te(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=tXe(this,e,[].concat(r)),Fa(n,"state",{isAnimationFinished:!0,totalLength:0}),Fa(n,"generateSimpleStrokeDasharray",function(o,a){return"".concat(a,"px ").concat(o-a,"px")}),Fa(n,"getStrokeDasharray",function(o,a,l){var c=l.reduce(function(m,b){return m+b});if(!c)return n.generateSimpleStrokeDasharray(a,o);for(var u=Math.floor(o/c),d=o%c,h=a-o,I=[],p=0,y=0;p<l.length;y+=l[p],++p)if(y+l[p]>d){I=[].concat(jh(l.slice(0,p)),[d-y]);break}var A=I.length%2===0?[0,h]:[h];return[].concat(jh(e.repeat(l,u)),jh(I),A).map(function(m){return"".concat(m,"px")}).join(", ")}),Fa(n,"id",yu("recharts-line-")),Fa(n,"pathRef",function(o){n.mainCurve=o}),Fa(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Fa(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return rXe(e,t),eXe(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();this.setState({totalLength:i})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();i!==this.state.totalLength&&this.setState({totalLength:i})}}},{key:"getTotalLength",value:function(){var i=this.mainCurve;try{return i&&i.getTotalLength&&i.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(i,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.points,a=s.xAxis,l=s.yAxis,c=s.layout,u=s.children,d=Gs(u,PC);if(!d)return null;var h=function(y,A){return{x:y.x,y:y.y,value:y.value,errorVal:yi(y.payload,A)}},I={clipPath:i?"url(#clipPath-".concat(r,")"):null};return $.createElement(fn,I,d.map(function(p){return $.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:a,yAxis:l,layout:c,dataPointFormatter:h})}))}},{key:"renderDots",value:function(i,r,s){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.dot,c=a.points,u=a.dataKey,d=Yt(this.props,!1),h=Yt(l,!0),I=c.map(function(y,A){var m=uo(uo(uo({key:"dot-".concat(A),r:3},d),h),{},{index:A,cx:y.x,cy:y.y,value:y.value,dataKey:u,payload:y.payload,points:c});return e.renderDotItem(l,m)}),p={clipPath:i?"url(#clipPath-".concat(r?"":"dots-").concat(s,")"):null};return $.createElement(fn,Ym({className:"recharts-line-dots",key:"dots"},p),I)}},{key:"renderCurveStatically",value:function(i,r,s,o){var a=this.props,l=a.type,c=a.layout,u=a.connectNulls;a.ref;var d=_K(a,PTe),h=uo(uo(uo({},Yt(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:r?"url(#clipPath-".concat(s,")"):null,points:i},o),{},{type:l,layout:c,connectNulls:u});return $.createElement(Qg,Ym({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(i,r){var s=this,o=this.props,a=o.points,l=o.strokeDasharray,c=o.isAnimationActive,u=o.animationBegin,d=o.animationDuration,h=o.animationEasing,I=o.animationId,p=o.animateNewValues,y=o.width,A=o.height,m=this.state,b=m.prevPoints,v=m.totalLength;return $.createElement(ca,{begin:u,duration:d,isActive:c,easing:h,from:{t:0},to:{t:1},key:"line-".concat(I),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var x=w.t;if(b){var B=b.length/a.length,Z=a.map(function(T,H){var K=Math.floor(H*B);if(b[K]){var z=b[K],j=Ni(z.x,T.x),O=Ni(z.y,T.y);return uo(uo({},T),{},{x:j(x),y:O(x)})}if(p){var _=Ni(y*2,T.x),E=Ni(A/2,T.y);return uo(uo({},T),{},{x:_(x),y:E(x)})}return uo(uo({},T),{},{x:T.x,y:T.y})});return s.renderCurveStatically(Z,i,r)}var N=Ni(0,v),W=N(x),M;if(l){var F="".concat(l).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});M=s.getStrokeDasharray(W,v,F)}else M=s.generateSimpleStrokeDasharray(v,W);return s.renderCurveStatically(a,i,r,{strokeDasharray:M})})}},{key:"renderCurve",value:function(i,r){var s=this.props,o=s.points,a=s.isAnimationActive,l=this.state,c=l.prevPoints,u=l.totalLength;return a&&o&&o.length&&(!c&&u>0||!ou(c,o))?this.renderCurveWithAnimation(i,r):this.renderCurveStatically(o,i,r)}},{key:"render",value:function(){var i,r=this.props,s=r.hide,o=r.dot,a=r.points,l=r.className,c=r.xAxis,u=r.yAxis,d=r.top,h=r.left,I=r.width,p=r.height,y=r.isAnimationActive,A=r.id;if(s||!a||!a.length)return null;var m=this.state.isAnimationFinished,b=a.length===1,v=ln("recharts-line",l),w=c&&c.allowDataOverflow,x=u&&u.allowDataOverflow,B=w||x,Z=en(A)?this.id:A,N=(i=Yt(o,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},W=N.r,M=W===void 0?3:W,F=N.strokeWidth,T=F===void 0?2:F,H=o8(o)?o:{},K=H.clipDot,z=K===void 0?!0:K,j=M*2+T;return $.createElement(fn,{className:v},w||x?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(Z)},$.createElement("rect",{x:w?h:h-I/2,y:x?d:d-p/2,width:w?I:I*2,height:x?p:p*2})),!z&&$.createElement("clipPath",{id:"clipPath-dots-".concat(Z)},$.createElement("rect",{x:h-j/2,y:d-j/2,width:I+j,height:p+j}))):null,!b&&this.renderCurve(B,Z),this.renderErrorBar(B,Z),(b||o)&&this.renderDots(B,z,Z),(!y||m)&&Oa.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.animationId!==r.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:r.curPoints}:i.points!==r.curPoints?{curPoints:i.points}:null}},{key:"repeat",value:function(i,r){for(var s=i.length%2!==0?[].concat(jh(i),[0]):i,o=[],a=0;a<r;++a)o=[].concat(jh(o),jh(s));return o}},{key:"renderDotItem",value:function(i,r){var s;if($.isValidElement(i))s=$.cloneElement(i,r);else if($t(i))s=i(r);else{var o=r.key,a=_K(r,OTe),l=ln("recharts-line-dot",typeof i!="boolean"?i.className:"");s=$.createElement(J0,Ym({key:o},a,{className:l}))}return s}}])}(S.PureComponent);Fa(jn,"displayName","Line");Fa(jn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ra.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Fa(jn,"getComposedData",function(t){var e=t.props,n=t.xAxis,i=t.yAxis,r=t.xAxisTicks,s=t.yAxisTicks,o=t.dataKey,a=t.bandSize,l=t.displayedData,c=t.offset,u=e.layout,d=l.map(function(h,I){var p=yi(h,o);return u==="horizontal"?{x:Ef({axis:n,ticks:r,bandSize:a,entry:h,index:I}),y:en(p)?null:i.scale(p),value:p,payload:h}:{x:en(p)?null:n.scale(p),y:Ef({axis:i,ticks:s,bandSize:a,entry:h,index:I}),value:p,payload:h}});return uo({points:d,layout:u},c)});var oXe=["layout","type","stroke","connectNulls","isRange","ref"],aXe=["key"],Aq;function qf(t){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qf(t)}function yq(t,e){if(t==null)return{};var n=lXe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function lXe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function Ad(){return Ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ad.apply(this,arguments)}function EK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function pg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EK(Object(n),!0).forEach(function(i){Sl(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function cXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,vq(i.key),i)}}function gXe(t,e,n){return e&&YK(t.prototype,e),n&&YK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uXe(t,e,n){return e=hG(e),dXe(t,bq()?Reflect.construct(e,n||[],hG(t).constructor):e.apply(t,n))}function dXe(t,e){if(e&&(qf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hXe(t)}function hXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bq=function(){return!!t})()}function hG(t){return hG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hG(t)}function IXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c3(t,e)}function c3(t,e){return c3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},c3(t,e)}function Sl(t,e,n){return e=vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=fXe(t,"string");return qf(e)=="symbol"?e:e+""}function fXe(t,e){if(qf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(qf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xs=function(t){function e(){var n;cXe(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=uXe(this,e,[].concat(r)),Sl(n,"state",{isAnimationFinished:!0}),Sl(n,"id",yu("recharts-area-")),Sl(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),$t(o)&&o()}),Sl(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),$t(o)&&o()}),n}return IXe(e,t),gXe(e,[{key:"renderDots",value:function(i,r,s){var o=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(o&&!a)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,h=Yt(this.props,!1),I=Yt(c,!0),p=u.map(function(A,m){var b=pg(pg(pg({key:"dot-".concat(m),r:3},h),I),{},{index:m,cx:A.x,cy:A.y,dataKey:d,value:A.value,payload:A.payload,points:u});return e.renderDotItem(c,b)}),y={clipPath:i?"url(#clipPath-".concat(r?"":"dots-").concat(s,")"):null};return $.createElement(fn,Ad({className:"recharts-area-dots"},y),p)}},{key:"renderHorizontalRect",value:function(i){var r=this.props,s=r.baseLine,o=r.points,a=r.strokeWidth,l=o[0].x,c=o[o.length-1].x,u=i*Math.abs(l-c),d=Xg(o.map(function(h){return h.y||0}));return ut(s)&&typeof s=="number"?d=Math.max(s,d):s&&Array.isArray(s)&&s.length&&(d=Math.max(Xg(s.map(function(h){return h.y||0})),d)),ut(d)?$.createElement("rect",{x:l<c?l:l-u,y:0,width:u,height:Math.floor(d+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(i){var r=this.props,s=r.baseLine,o=r.points,a=r.strokeWidth,l=o[0].y,c=o[o.length-1].y,u=i*Math.abs(l-c),d=Xg(o.map(function(h){return h.x||0}));return ut(s)&&typeof s=="number"?d=Math.max(s,d):s&&Array.isArray(s)&&s.length&&(d=Math.max(Xg(s.map(function(h){return h.x||0})),d)),ut(d)?$.createElement("rect",{x:0,y:l<c?l:l-u,width:d+(a?parseInt("".concat(a),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(i){var r=this.props.layout;return r==="vertical"?this.renderVerticalRect(i):this.renderHorizontalRect(i)}},{key:"renderAreaStatically",value:function(i,r,s,o){var a=this.props,l=a.layout,c=a.type,u=a.stroke,d=a.connectNulls,h=a.isRange;a.ref;var I=yq(a,oXe);return $.createElement(fn,{clipPath:s?"url(#clipPath-".concat(o,")"):null},$.createElement(Qg,Ad({},Yt(I,!0),{points:i,connectNulls:d,type:c,baseLine:r,layout:l,stroke:"none",className:"recharts-area-area"})),u!=="none"&&$.createElement(Qg,Ad({},Yt(this.props,!1),{className:"recharts-area-curve",layout:l,type:c,connectNulls:d,fill:"none",points:i})),u!=="none"&&h&&$.createElement(Qg,Ad({},Yt(this.props,!1),{className:"recharts-area-curve",layout:l,type:c,connectNulls:d,fill:"none",points:r})))}},{key:"renderAreaWithAnimation",value:function(i,r){var s=this,o=this.props,a=o.points,l=o.baseLine,c=o.isAnimationActive,u=o.animationBegin,d=o.animationDuration,h=o.animationEasing,I=o.animationId,p=this.state,y=p.prevPoints,A=p.prevBaseLine;return $.createElement(ca,{begin:u,duration:d,isActive:c,easing:h,from:{t:0},to:{t:1},key:"area-".concat(I),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var b=m.t;if(y){var v=y.length/a.length,w=a.map(function(N,W){var M=Math.floor(W*v);if(y[M]){var F=y[M],T=Ni(F.x,N.x),H=Ni(F.y,N.y);return pg(pg({},N),{},{x:T(b),y:H(b)})}return N}),x;if(ut(l)&&typeof l=="number"){var B=Ni(A,l);x=B(b)}else if(en(l)||YC(l)){var Z=Ni(A,0);x=Z(b)}else x=l.map(function(N,W){var M=Math.floor(W*v);if(A[M]){var F=A[M],T=Ni(F.x,N.x),H=Ni(F.y,N.y);return pg(pg({},N),{},{x:T(b),y:H(b)})}return N});return s.renderAreaStatically(w,x,i,r)}return $.createElement(fn,null,$.createElement("defs",null,$.createElement("clipPath",{id:"animationClipPath-".concat(r)},s.renderClipRect(b))),$.createElement(fn,{clipPath:"url(#animationClipPath-".concat(r,")")},s.renderAreaStatically(a,l,i,r)))})}},{key:"renderArea",value:function(i,r){var s=this.props,o=s.points,a=s.baseLine,l=s.isAnimationActive,c=this.state,u=c.prevPoints,d=c.prevBaseLine,h=c.totalLength;return l&&o&&o.length&&(!u&&h>0||!ou(u,o)||!ou(d,a))?this.renderAreaWithAnimation(i,r):this.renderAreaStatically(o,a,i,r)}},{key:"render",value:function(){var i,r=this.props,s=r.hide,o=r.dot,a=r.points,l=r.className,c=r.top,u=r.left,d=r.xAxis,h=r.yAxis,I=r.width,p=r.height,y=r.isAnimationActive,A=r.id;if(s||!a||!a.length)return null;var m=this.state.isAnimationFinished,b=a.length===1,v=ln("recharts-area",l),w=d&&d.allowDataOverflow,x=h&&h.allowDataOverflow,B=w||x,Z=en(A)?this.id:A,N=(i=Yt(o,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},W=N.r,M=W===void 0?3:W,F=N.strokeWidth,T=F===void 0?2:F,H=o8(o)?o:{},K=H.clipDot,z=K===void 0?!0:K,j=M*2+T;return $.createElement(fn,{className:v},w||x?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(Z)},$.createElement("rect",{x:w?u:u-I/2,y:x?c:c-p/2,width:w?I:I*2,height:x?p:p*2})),!z&&$.createElement("clipPath",{id:"clipPath-dots-".concat(Z)},$.createElement("rect",{x:u-j/2,y:c-j/2,width:I+j,height:p+j}))):null,b?null:this.renderArea(B,Z),(o||b)&&this.renderDots(B,z,Z),(!y||m)&&Oa.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.animationId!==r.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,curBaseLine:i.baseLine,prevPoints:r.curPoints,prevBaseLine:r.curBaseLine}:i.points!==r.curPoints||i.baseLine!==r.curBaseLine?{curPoints:i.points,curBaseLine:i.baseLine}:null}}])}(S.PureComponent);Aq=xs;Sl(xs,"displayName","Area");Sl(xs,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ra.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Sl(xs,"getBaseValue",function(t,e,n,i){var r=t.layout,s=t.baseValue,o=e.props.baseValue,a=o??s;if(ut(a)&&typeof a=="number")return a;var l=r==="horizontal"?i:n,c=l.scale.domain();if(l.type==="number"){var u=Math.max(c[0],c[1]),d=Math.min(c[0],c[1]);return a==="dataMin"?d:a==="dataMax"||u<0?u:Math.max(Math.min(c[0],c[1]),0)}return a==="dataMin"?c[0]:a==="dataMax"?c[1]:c[0]});Sl(xs,"getComposedData",function(t){var e=t.props,n=t.item,i=t.xAxis,r=t.yAxis,s=t.xAxisTicks,o=t.yAxisTicks,a=t.bandSize,l=t.dataKey,c=t.stackedData,u=t.dataStartIndex,d=t.displayedData,h=t.offset,I=e.layout,p=c&&c.length,y=Aq.getBaseValue(e,n,i,r),A=I==="horizontal",m=!1,b=d.map(function(w,x){var B;p?B=c[u+x]:(B=yi(w,l),Array.isArray(B)?m=!0:B=[y,B]);var Z=B[1]==null||p&&yi(w,l)==null;return A?{x:Ef({axis:i,ticks:s,bandSize:a,entry:w,index:x}),y:Z?null:r.scale(B[1]),value:B,payload:w}:{x:Z?null:i.scale(B[1]),y:Ef({axis:r,ticks:o,bandSize:a,entry:w,index:x}),value:B,payload:w}}),v;return p||m?v=b.map(function(w){var x=Array.isArray(w.value)?w.value[0]:null;return A?{x:w.x,y:x!=null&&w.y!=null?r.scale(x):null}:{x:x!=null?i.scale(x):null,y:w.y}}):v=A?r.scale(y):i.scale(y),pg({points:b,baseLine:v,layout:I,isRange:m},h)});Sl(xs,"renderDotItem",function(t,e){var n;if($.isValidElement(t))n=$.cloneElement(t,e);else if($t(t))n=t(e);else{var i=ln("recharts-area-dot",typeof t!="boolean"?t.className:""),r=e.key,s=yq(e,aXe);n=$.createElement(J0,Ad({},s,{key:r,className:i}))}return n});function $f(t){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$f(t)}function CXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pXe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Gq(i.key),i)}}function mXe(t,e,n){return e&&pXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function AXe(t,e,n){return e=IG(e),yXe(t,xq()?Reflect.construct(e,n||[],IG(t).constructor):e.apply(t,n))}function yXe(t,e){if(e&&($f(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bXe(t)}function bXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xq=function(){return!!t})()}function IG(t){return IG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},IG(t)}function vXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g3(t,e)}function g3(t,e){return g3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},g3(t,e)}function wq(t,e,n){return e=Gq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gq(t){var e=xXe(t,"string");return $f(e)=="symbol"?e:e+""}function xXe(t,e){if($f(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if($f(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var q0=function(t){function e(){return CXe(this,e),AXe(this,e,arguments)}return vXe(e,t),mXe(e,[{key:"render",value:function(){return null}}])}($.Component);wq(q0,"displayName","ZAxis");wq(q0,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var wXe=["option","isActive"];function km(){return km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},km.apply(this,arguments)}function GXe(t,e){if(t==null)return{};var n=BXe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function BXe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function SXe(t){var e=t.option,n=t.isActive,i=GXe(t,wXe);return typeof e=="string"?$.createElement(eG,km({option:$.createElement(yB,km({type:e},i)),isActive:n,shapeType:"symbols"},i)):$.createElement(eG,km({option:e,isActive:n,shapeType:"symbols"},i))}function eC(t){"@babel/helpers - typeof";return eC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eC(t)}function Hm(){return Hm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Hm.apply(this,arguments)}function kK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function zo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kK(Object(n),!0).forEach(function(i){Yg(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ZXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Sq(i.key),i)}}function RXe(t,e,n){return e&&HK(t.prototype,e),n&&HK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function NXe(t,e,n){return e=fG(e),WXe(t,Bq()?Reflect.construct(e,n||[],fG(t).constructor):e.apply(t,n))}function WXe(t,e){if(e&&(eC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MXe(t)}function MXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bq=function(){return!!t})()}function fG(t){return fG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fG(t)}function VXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u3(t,e)}function u3(t,e){return u3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},u3(t,e)}function Yg(t,e,n){return e=Sq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sq(t){var e=FXe(t,"string");return eC(e)=="symbol"?e:e+""}function FXe(t,e){if(eC(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(eC(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ih=function(t){function e(){var n;ZXe(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=NXe(this,e,[].concat(r)),Yg(n,"state",{isAnimationFinished:!1}),Yg(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),Yg(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),Yg(n,"id",yu("recharts-scatter-")),n}return VXe(e,t),RXe(e,[{key:"renderSymbolsStatically",value:function(i){var r=this,s=this.props,o=s.shape,a=s.activeShape,l=s.activeIndex,c=Yt(this.props,!1);return i.map(function(u,d){var h=l===d,I=h?a:o,p=zo(zo({},c),u);return $.createElement(fn,Hm({className:"recharts-scatter-symbol",key:"symbol-".concat(u==null?void 0:u.cx,"-").concat(u==null?void 0:u.cy,"-").concat(u==null?void 0:u.size,"-").concat(d)},su(r.props,u,d),{role:"img"}),$.createElement(SXe,Hm({option:I,isActive:h,key:"symbol-".concat(d)},p)))})}},{key:"renderSymbolsWithAnimation",value:function(){var i=this,r=this.props,s=r.points,o=r.isAnimationActive,a=r.animationBegin,l=r.animationDuration,c=r.animationEasing,u=r.animationId,d=this.state.prevPoints;return $.createElement(ca,{begin:a,duration:l,isActive:o,easing:c,from:{t:0},to:{t:1},key:"pie-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var I=h.t,p=s.map(function(y,A){var m=d&&d[A];if(m){var b=Ni(m.cx,y.cx),v=Ni(m.cy,y.cy),w=Ni(m.size,y.size);return zo(zo({},y),{},{cx:b(I),cy:v(I),size:w(I)})}var x=Ni(0,y.size);return zo(zo({},y),{},{size:x(I)})});return $.createElement(fn,null,i.renderSymbolsStatically(p))})}},{key:"renderSymbols",value:function(){var i=this.props,r=i.points,s=i.isAnimationActive,o=this.state.prevPoints;return s&&r&&r.length&&(!o||!ou(o,r))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(r)}},{key:"renderErrorBar",value:function(){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var r=this.props,s=r.points,o=r.xAxis,a=r.yAxis,l=r.children,c=Gs(l,PC);return c?c.map(function(u,d){var h=u.props,I=h.direction,p=h.dataKey;return $.cloneElement(u,{key:"".concat(I,"-").concat(p,"-").concat(s[d]),data:s,xAxis:o,yAxis:a,layout:I==="x"?"vertical":"horizontal",dataPointFormatter:function(A,m){return{x:A.cx,y:A.cy,value:I==="x"?+A.node.x:+A.node.y,errorVal:yi(A,m)}}})}):null}},{key:"renderLine",value:function(){var i=this.props,r=i.points,s=i.line,o=i.lineType,a=i.lineJointType,l=Yt(this.props,!1),c=Yt(s,!1),u,d;if(o==="joint")u=r.map(function(v){return{x:v.cx,y:v.cy}});else if(o==="fitting"){var h=yme(r),I=h.xmin,p=h.xmax,y=h.a,A=h.b,m=function(w){return y*w+A};u=[{x:I,y:m(I)},{x:p,y:m(p)}]}var b=zo(zo(zo({},l),{},{fill:"none",stroke:l&&l.fill},c),{},{points:u});return $.isValidElement(s)?d=$.cloneElement(s,b):$t(s)?d=s(b):d=$.createElement(Qg,Hm({},b,{type:a})),$.createElement(fn,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}},{key:"render",value:function(){var i=this.props,r=i.hide,s=i.points,o=i.line,a=i.className,l=i.xAxis,c=i.yAxis,u=i.left,d=i.top,h=i.width,I=i.height,p=i.id,y=i.isAnimationActive;if(r||!s||!s.length)return null;var A=this.state.isAnimationFinished,m=ln("recharts-scatter",a),b=l&&l.allowDataOverflow,v=c&&c.allowDataOverflow,w=b||v,x=en(p)?this.id:p;return $.createElement(fn,{className:m,clipPath:w?"url(#clipPath-".concat(x,")"):null},b||v?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(x)},$.createElement("rect",{x:b?u:u-h/2,y:v?d:d-I/2,width:b?h:h*2,height:v?I:I*2}))):null,o&&this.renderLine(),this.renderErrorBar(),$.createElement(fn,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!y||A)&&Oa.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.animationId!==r.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:r.curPoints}:i.points!==r.curPoints?{curPoints:i.points}:null}}])}(S.PureComponent);Yg(ih,"displayName","Scatter");Yg(ih,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!ra.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Yg(ih,"getComposedData",function(t){var e=t.xAxis,n=t.yAxis,i=t.zAxis,r=t.item,s=t.displayedData,o=t.xAxisTicks,a=t.yAxisTicks,l=t.offset,c=r.props.tooltipType,u=Gs(r.props.children,j0),d=en(e.dataKey)?r.props.dataKey:e.dataKey,h=en(n.dataKey)?r.props.dataKey:n.dataKey,I=i&&i.dataKey,p=i?i.range:q0.defaultProps.range,y=p&&p[0],A=e.scale.bandwidth?e.scale.bandwidth():0,m=n.scale.bandwidth?n.scale.bandwidth():0,b=s.map(function(v,w){var x=yi(v,d),B=yi(v,h),Z=!en(I)&&yi(v,I)||"-",N=[{name:en(e.dataKey)?r.props.name:e.name||e.dataKey,unit:e.unit||"",value:x,payload:v,dataKey:d,type:c},{name:en(n.dataKey)?r.props.name:n.name||n.dataKey,unit:n.unit||"",value:B,payload:v,dataKey:h,type:c}];Z!=="-"&&N.push({name:i.name||i.dataKey,unit:i.unit||"",value:Z,payload:v,dataKey:I,type:c});var W=Ef({axis:e,ticks:o,bandSize:A,entry:v,index:w,dataKey:d}),M=Ef({axis:n,ticks:a,bandSize:m,entry:v,index:w,dataKey:h}),F=Z!=="-"?i.scale(Z):y,T=Math.sqrt(Math.max(F,0)/Math.PI);return zo(zo({},v),{},{cx:W,cy:M,x:W-T,y:M-T,xAxis:e,yAxis:n,zAxis:i,width:2*T,height:2*T,size:F,node:{x,y:B,z:Z},tooltipPayload:N,tooltipPosition:{x:W,y:M},payload:v},u&&u[w]&&u[w].props)});return zo({points:b},l)});function tC(t){"@babel/helpers - typeof";return tC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tC(t)}function _Xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TXe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Nq(i.key),i)}}function XXe(t,e,n){return e&&TXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function EXe(t,e,n){return e=CG(e),YXe(t,Zq()?Reflect.construct(e,n||[],CG(t).constructor):e.apply(t,n))}function YXe(t,e){if(e&&(tC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kXe(t)}function kXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zq=function(){return!!t})()}function CG(t){return CG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CG(t)}function HXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d3(t,e)}function d3(t,e){return d3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},d3(t,e)}function Rq(t,e,n){return e=Nq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nq(t){var e=KXe(t,"string");return tC(e)=="symbol"?e:e+""}function KXe(t,e){if(tC(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(tC(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h3(){return h3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},h3.apply(this,arguments)}function LXe(t){var e=t.xAxisId,n=LF(),i=zF(),r=sq(e);return r==null?null:$.createElement(OC,h3({},r,{className:ln("recharts-".concat(r.axisType," ").concat(r.axisType),r.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(o){return xc(o,!0)}}))}var ui=function(t){function e(){return _Xe(this,e),EXe(this,e,arguments)}return HXe(e,t),XXe(e,[{key:"render",value:function(){return $.createElement(LXe,this.props)}}])}($.Component);Rq(ui,"displayName","XAxis");Rq(ui,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function nC(t){"@babel/helpers - typeof";return nC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nC(t)}function zXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jXe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Vq(i.key),i)}}function PXe(t,e,n){return e&&jXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function OXe(t,e,n){return e=pG(e),DXe(t,Wq()?Reflect.construct(e,n||[],pG(t).constructor):e.apply(t,n))}function DXe(t,e){if(e&&(nC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UXe(t)}function UXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wq=function(){return!!t})()}function pG(t){return pG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pG(t)}function JXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I3(t,e)}function I3(t,e){return I3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},I3(t,e)}function Mq(t,e,n){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vq(t){var e=QXe(t,"string");return nC(e)=="symbol"?e:e+""}function QXe(t,e){if(nC(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(nC(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f3(){return f3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},f3.apply(this,arguments)}var qXe=function(e){var n=e.yAxisId,i=LF(),r=zF(),s=oq(n);return s==null?null:$.createElement(OC,f3({},s,{className:ln("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:i,height:r},ticksGenerator:function(a){return xc(a,!0)}}))},ii=function(t){function e(){return zXe(this,e),OXe(this,e,arguments)}return JXe(e,t),PXe(e,[{key:"render",value:function(){return $.createElement(qXe,this.props)}}])}($.Component);Mq(ii,"displayName","YAxis");Mq(ii,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function KK(t){return nEe(t)||tEe(t)||eEe(t)||$Xe()}function $Xe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eEe(t,e){if(t){if(typeof t=="string")return C3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C3(t,e)}}function tEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nEe(t){if(Array.isArray(t))return C3(t)}function C3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var p3=function(e,n,i,r,s){var o=Gs(e,PF),a=Gs(e,KB),l=[].concat(KK(o),KK(a)),c=Gs(e,zB),u="".concat(r,"Id"),d=r[0],h=n;if(l.length&&(h=l.reduce(function(y,A){if(A.props[u]===i&&_l(A.props,"extendDomain")&&ut(A.props[d])){var m=A.props[d];return[Math.min(y[0],m),Math.max(y[1],m)]}return y},h)),c.length){var I="".concat(d,"1"),p="".concat(d,"2");h=c.reduce(function(y,A){if(A.props[u]===i&&_l(A.props,"extendDomain")&&ut(A.props[I])&&ut(A.props[p])){var m=A.props[I],b=A.props[p];return[Math.min(y[0],m,b),Math.max(y[1],m,b)]}return y},h)}return s&&s.length&&(h=s.reduce(function(y,A){return ut(A)?[Math.min(y[0],A),Math.max(y[1],A)]:y},h)),h},Fq={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var I=new r(u,d||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],I]:l._events[p].push(I):(l._events[p]=I,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new i:delete l._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,I=d.length,p=new Array(I);h<I;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,I,p){var y=n?n+c:c;if(!this._events[y])return!1;var A=this._events[y],m=arguments.length,b,v;if(A.fn){switch(A.once&&this.removeListener(c,A.fn,void 0,!0),m){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,u),!0;case 3:return A.fn.call(A.context,u,d),!0;case 4:return A.fn.call(A.context,u,d,h),!0;case 5:return A.fn.call(A.context,u,d,h,I),!0;case 6:return A.fn.call(A.context,u,d,h,I,p),!0}for(v=1,b=new Array(m-1);v<m;v++)b[v-1]=arguments[v];A.fn.apply(A.context,b)}else{var w=A.length,x;for(v=0;v<w;v++)switch(A[v].once&&this.removeListener(c,A[v].fn,void 0,!0),m){case 1:A[v].fn.call(A[v].context);break;case 2:A[v].fn.call(A[v].context,u);break;case 3:A[v].fn.call(A[v].context,u,d);break;case 4:A[v].fn.call(A[v].context,u,d,h);break;default:if(!b)for(x=1,b=new Array(m-1);x<m;x++)b[x-1]=arguments[x];A[v].fn.apply(A[v].context,b)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var I=n?n+c:c;if(!this._events[I])return this;if(!u)return o(this,I),this;var p=this._events[I];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,I);else{for(var y=0,A=[],m=p.length;y<m;y++)(p[y].fn!==u||h&&!p[y].once||d&&p[y].context!==d)&&A.push(p[y]);A.length?this._events[I]=A.length===1?A[0]:A:o(this,I)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(Fq);var iEe=Fq.exports;const rEe=Pn(iEe);var $Z=new rEe,eR="recharts.syncMouseEvents";function t0(t){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t0(t)}function sEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oEe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_q(i.key),i)}}function aEe(t,e,n){return e&&oEe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function tR(t,e,n){return e=_q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=lEe(t,"string");return t0(e)=="symbol"?e:e+""}function lEe(t,e){if(t0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(t0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var cEe=function(){function t(){sEe(this,t),tR(this,"activeIndex",0),tR(this,"coordinateList",[]),tR(this,"layout","horizontal")}return aEe(t,[{key:"setDetails",value:function(n){var i,r=n.coordinateList,s=r===void 0?null:r,o=n.container,a=o===void 0?null:o,l=n.layout,c=l===void 0?null:l,u=n.offset,d=u===void 0?null:u,h=n.mouseHandlerCallback,I=h===void 0?null:h;this.coordinateList=(i=s??this.coordinateList)!==null&&i!==void 0?i:[],this.container=a??this.container,this.layout=c??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=I??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),s=r.x,o=r.y,a=r.height,l=this.coordinateList[this.activeIndex].coordinate,c=((n=window)===null||n===void 0?void 0:n.scrollX)||0,u=((i=window)===null||i===void 0?void 0:i.scrollY)||0,d=s+l+c,h=o+this.offset.top+a/2+u;this.mouseHandlerCallback({pageX:d,pageY:h})}}}])}();function gEe(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var i=t==null?void 0:t[0],r=t==null?void 0:t[1];if(i&&r&&ut(i)&&ut(r))return!0}return!1}function uEe(t,e,n,i){var r=i/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-r:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-r,width:t==="horizontal"?i:n.width-1,height:t==="horizontal"?n.height-1:i}}function Tq(t){var e=t.cx,n=t.cy,i=t.radius,r=t.startAngle,s=t.endAngle,o=Ii(e,n,i,r),a=Ii(e,n,i,s);return{points:[o,a],cx:e,cy:n,radius:i,startAngle:r,endAngle:s}}function dEe(t,e,n){var i,r,s,o;if(t==="horizontal")i=e.x,s=i,r=n.top,o=n.top+n.height;else if(t==="vertical")r=e.y,o=r,i=n.left,s=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var a=e.cx,l=e.cy,c=e.innerRadius,u=e.outerRadius,d=e.angle,h=Ii(a,l,c,d),I=Ii(a,l,u,d);i=h.x,r=h.y,s=I.x,o=I.y}else return Tq(e);return[{x:i,y:r},{x:s,y:o}]}function n0(t){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n0(t)}function LK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Ob(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LK(Object(n),!0).forEach(function(i){hEe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function hEe(t,e,n){return e=IEe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IEe(t){var e=fEe(t,"string");return n0(e)=="symbol"?e:e+""}function fEe(t,e){if(n0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(n0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CEe(t){var e,n,i=t.element,r=t.tooltipEventType,s=t.isActive,o=t.activeCoordinate,a=t.activePayload,l=t.offset,c=t.activeTooltipIndex,u=t.tooltipAxisBandSize,d=t.layout,h=t.chartName,I=(e=i.props.cursor)!==null&&e!==void 0?e:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!I||!s||!o||h!=="ScatterChart"&&r!=="axis")return null;var p,y=Qg;if(h==="ScatterChart")p=o,y=sVe;else if(h==="BarChart")p=uEe(d,o,l,u),y=YF;else if(d==="radial"){var A=Tq(o),m=A.cx,b=A.cy,v=A.radius,w=A.startAngle,x=A.endAngle;p={cx:m,cy:b,startAngle:w,endAngle:x,innerRadius:v,outerRadius:v},y=G6}else p={points:dEe(d,o,l)},y=Qg;var B=Ob(Ob(Ob(Ob({stroke:"#ccc",pointerEvents:"none"},l),p),Yt(I,!1)),{},{payload:a,payloadIndex:c,className:ln("recharts-tooltip-cursor",I.className)});return S.isValidElement(I)?S.cloneElement(I,B):S.createElement(y,B)}var pEe=["item"],mEe=["children","className","width","height","style","compact","title","desc"];function iC(t){"@babel/helpers - typeof";return iC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iC(t)}function MI(){return MI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},MI.apply(this,arguments)}function zK(t,e){return bEe(t)||yEe(t,e)||Eq(t,e)||AEe()}function AEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yEe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}function bEe(t){if(Array.isArray(t))return t}function jK(t,e){if(t==null)return{};var n=vEe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function vEe(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function xEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wEe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Yq(i.key),i)}}function GEe(t,e,n){return e&&wEe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function BEe(t,e,n){return e=mG(e),SEe(t,Xq()?Reflect.construct(e,n||[],mG(t).constructor):e.apply(t,n))}function SEe(t,e){if(e&&(iC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZEe(t)}function ZEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xq=function(){return!!t})()}function mG(t){return mG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mG(t)}function REe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m3(t,e)}function m3(t,e){return m3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},m3(t,e)}function rC(t){return MEe(t)||WEe(t)||Eq(t)||NEe()}function NEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eq(t,e){if(t){if(typeof t=="string")return A3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A3(t,e)}}function WEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function MEe(t){if(Array.isArray(t))return A3(t)}function A3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function PK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PK(Object(n),!0).forEach(function(i){tn(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PK(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function tn(t,e,n){return e=Yq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yq(t){var e=VEe(t,"string");return iC(e)=="symbol"?e:e+""}function VEe(t,e){if(iC(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(iC(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FEe={xAxis:["bottom","top"],yAxis:["left","right"]},_Ee={width:"100%",height:"100%"},kq={x:0,y:0};function Db(t){return t}var TEe=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},XEe=function(e,n,i,r){var s=n.find(function(u){return u&&u.index===i});if(s){if(e==="horizontal")return{x:s.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:s.coordinate};if(e==="centric"){var o=s.coordinate,a=r.radius;return Ee(Ee(Ee({},r),Ii(r.cx,r.cy,a,o)),{},{angle:o,radius:a})}var l=s.coordinate,c=r.angle;return Ee(Ee(Ee({},r),Ii(r.cx,r.cy,l,c)),{},{angle:c,radius:l})}return kq},jB=function(e,n){var i=n.graphicalItems,r=n.dataStartIndex,s=n.dataEndIndex,o=(i??[]).reduce(function(a,l){var c=l.props.data;return c&&c.length?[].concat(rC(a),rC(c)):a},[]);return o.length>0?o:e&&e.length&&ut(r)&&ut(s)?e.slice(r,s+1):[]};function Hq(t){return t==="number"?[0,"auto"]:void 0}var y3=function(e,n,i,r){var s=e.graphicalItems,o=e.tooltipAxis,a=jB(n,e);return i<0||!s||!s.length||i>=a.length?null:s.reduce(function(l,c){var u,d=(u=c.props.data)!==null&&u!==void 0?u:n;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=i&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var I=d===void 0?a:d;h=fw(I,o.dataKey,r)}else h=d&&d[i]||a[i];return h?[].concat(rC(l),[A6(c,h)]):l},[])},OK=function(e,n,i,r){var s=r||{x:e.chartX,y:e.chartY},o=TEe(s,i),a=e.orderedTooltipTicks,l=e.tooltipAxis,c=e.tooltipTicks,u=RNe(o,a,c,l);if(u>=0&&c){var d=c[u]&&c[u].value,h=y3(e,n,u,d),I=XEe(i,a,u,s);return{activeTooltipIndex:u,activeLabel:d,activePayload:h,activeCoordinate:I}}return null},EEe=function(e,n){var i=n.axes,r=n.graphicalItems,s=n.axisType,o=n.axisIdKey,a=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.layout,d=e.children,h=e.stackOffset,I=h6(u,s);return i.reduce(function(p,y){var A,m=y.type.defaultProps!==void 0?Ee(Ee({},y.type.defaultProps),y.props):y.props,b=m.type,v=m.dataKey,w=m.allowDataOverflow,x=m.allowDuplicatedCategory,B=m.scale,Z=m.ticks,N=m.includeHidden,W=m[o];if(p[W])return p;var M=jB(e.data,{graphicalItems:r.filter(function(re){var de,Re=o in re.props?re.props[o]:(de=re.type.defaultProps)===null||de===void 0?void 0:de[o];return Re===W}),dataStartIndex:l,dataEndIndex:c}),F=M.length,T,H,K;gEe(m.domain,w,b)&&(T=WM(m.domain,null,w),I&&(b==="number"||B!=="auto")&&(K=_m(M,v,"category")));var z=Hq(b);if(!T||T.length===0){var j,O=(j=m.domain)!==null&&j!==void 0?j:z;if(v){if(T=_m(M,v,b),b==="category"&&I){var _=Ame(T);x&&_?(H=T,T=nG(0,F)):x||(T=u9(O,T,y).reduce(function(re,de){return re.indexOf(de)>=0?re:[].concat(rC(re),[de])},[]))}else if(b==="category")x?T=T.filter(function(re){return re!==""&&!en(re)}):T=u9(O,T,y).reduce(function(re,de){return re.indexOf(de)>=0||de===""||en(de)?re:[].concat(rC(re),[de])},[]);else if(b==="number"){var E=FNe(M,r.filter(function(re){var de,Re,Pe=o in re.props?re.props[o]:(de=re.type.defaultProps)===null||de===void 0?void 0:de[o],ae="hide"in re.props?re.props.hide:(Re=re.type.defaultProps)===null||Re===void 0?void 0:Re.hide;return Pe===W&&(N||!ae)}),v,s,u);E&&(T=E)}I&&(b==="number"||B!=="auto")&&(K=_m(M,v,"category"))}else I?T=nG(0,F):a&&a[W]&&a[W].hasStack&&b==="number"?T=h==="expand"?[0,1]:m6(a[W].stackGroups,l,c):T=d6(M,r.filter(function(re){var de=o in re.props?re.props[o]:re.type.defaultProps[o],Re="hide"in re.props?re.props.hide:re.type.defaultProps.hide;return de===W&&(N||!Re)}),b,u,!0);if(b==="number")T=p3(d,T,W,s,Z),O&&(T=WM(O,T,w));else if(b==="category"&&O){var P=O,q=T.every(function(re){return P.indexOf(re)>=0});q&&(T=P)}}return Ee(Ee({},p),{},tn({},W,Ee(Ee({},m),{},{axisType:s,domain:T,categoricalDomain:K,duplicateDomain:H,originalDomain:(A=m.domain)!==null&&A!==void 0?A:z,isCategorical:I,layout:u})))},{})},YEe=function(e,n){var i=n.graphicalItems,r=n.Axis,s=n.axisType,o=n.axisIdKey,a=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.layout,d=e.children,h=jB(e.data,{graphicalItems:i,dataStartIndex:l,dataEndIndex:c}),I=h.length,p=h6(u,s),y=-1;return i.reduce(function(A,m){var b=m.type.defaultProps!==void 0?Ee(Ee({},m.type.defaultProps),m.props):m.props,v=b[o],w=Hq("number");if(!A[v]){y++;var x;return p?x=nG(0,I):a&&a[v]&&a[v].hasStack?(x=m6(a[v].stackGroups,l,c),x=p3(d,x,v,s)):(x=WM(w,d6(h,i.filter(function(B){var Z,N,W=o in B.props?B.props[o]:(Z=B.type.defaultProps)===null||Z===void 0?void 0:Z[o],M="hide"in B.props?B.props.hide:(N=B.type.defaultProps)===null||N===void 0?void 0:N.hide;return W===v&&!M}),"number",u),r.defaultProps.allowDataOverflow),x=p3(d,x,v,s)),Ee(Ee({},A),{},tn({},v,Ee(Ee({axisType:s},r.defaultProps),{},{hide:!0,orientation:wo(FEe,"".concat(s,".").concat(y%2),null),domain:x,originalDomain:w,isCategorical:p,layout:u})))}return A},{})},kEe=function(e,n){var i=n.axisType,r=i===void 0?"xAxis":i,s=n.AxisComp,o=n.graphicalItems,a=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.children,d="".concat(r,"Id"),h=Gs(u,s),I={};return h&&h.length?I=EEe(e,{axes:h,graphicalItems:o,axisType:r,axisIdKey:d,stackGroups:a,dataStartIndex:l,dataEndIndex:c}):o&&o.length&&(I=YEe(e,{Axis:s,graphicalItems:o,axisType:r,axisIdKey:d,stackGroups:a,dataStartIndex:l,dataEndIndex:c})),I},HEe=function(e){var n=wg(e),i=xc(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:dF(i,function(r){return r.coordinate}),tooltipAxis:n,tooltipAxisBandSize:Lw(n,i)}},DK=function(e){var n=e.children,i=e.defaultShowTooltip,r=Co(n,jf),s=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(s=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!i}},KEe=function(e){return!e||!e.length?!1:e.some(function(n){var i=Rc(n&&n.type);return i&&i.indexOf("Bar")>=0})},UK=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},LEe=function(e,n){var i=e.props,r=e.graphicalItems,s=e.xAxisMap,o=s===void 0?{}:s,a=e.yAxisMap,l=a===void 0?{}:a,c=i.width,u=i.height,d=i.children,h=i.margin||{},I=Co(d,jf),p=Co(d,JI),y=Object.keys(l).reduce(function(x,B){var Z=l[B],N=Z.orientation;return!Z.mirror&&!Z.hide?Ee(Ee({},x),{},tn({},N,x[N]+Z.width)):x},{left:h.left||0,right:h.right||0}),A=Object.keys(o).reduce(function(x,B){var Z=o[B],N=Z.orientation;return!Z.mirror&&!Z.hide?Ee(Ee({},x),{},tn({},N,wo(x,"".concat(N))+Z.height)):x},{top:h.top||0,bottom:h.bottom||0}),m=Ee(Ee({},A),y),b=m.bottom;I&&(m.bottom+=I.props.height||jf.defaultProps.height),p&&n&&(m=MNe(m,r,i,n));var v=c-m.left-m.right,w=u-m.top-m.bottom;return Ee(Ee({brushBottom:b},m),{},{width:Math.max(v,0),height:Math.max(w,0)})},zEe=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},DC=function(e){var n=e.chartName,i=e.GraphicalChild,r=e.defaultTooltipEventType,s=r===void 0?"axis":r,o=e.validateTooltipEventTypes,a=o===void 0?["axis"]:o,l=e.axisComponents,c=e.legendContent,u=e.formatAxisMap,d=e.defaultProps,h=function(m,b){var v=b.graphicalItems,w=b.stackGroups,x=b.offset,B=b.updateId,Z=b.dataStartIndex,N=b.dataEndIndex,W=m.barSize,M=m.layout,F=m.barGap,T=m.barCategoryGap,H=m.maxBarSize,K=UK(M),z=K.numericAxisName,j=K.cateAxisName,O=KEe(v),_=[];return v.forEach(function(E,P){var q=jB(m.data,{graphicalItems:[E],dataStartIndex:Z,dataEndIndex:N}),re=E.type.defaultProps!==void 0?Ee(Ee({},E.type.defaultProps),E.props):E.props,de=re.dataKey,Re=re.maxBarSize,Pe=re["".concat(z,"Id")],ae=re["".concat(j,"Id")],he={},Me=l.reduce(function(ot,ft){var Q=b["".concat(ft.axisType,"Map")],L=re["".concat(ft.axisType,"Id")];Q&&Q[L]||ft.axisType==="zAxis"||th();var Ce=Q[L];return Ee(Ee({},ot),{},tn(tn({},ft.axisType,Ce),"".concat(ft.axisType,"Ticks"),xc(Ce)))},he),be=Me[j],xe=Me["".concat(j,"Ticks")],Ge=w&&w[Pe]&&w[Pe].hasStack&&LNe(E,w[Pe].stackGroups),pe=Rc(E.type).indexOf("Bar")>=0,Oe=Lw(be,xe),ve=[],U=O&&NNe({barSize:W,stackGroups:w,totalSize:zEe(Me,j)});if(pe){var We,Xe,Qe=en(Re)?H:Re,Le=(We=(Xe=Lw(be,xe,!0))!==null&&Xe!==void 0?Xe:Qe)!==null&&We!==void 0?We:0;ve=WNe({barGap:F,barCategoryGap:T,bandSize:Le!==Oe?Le:Oe,sizeList:U[ae],maxBarSize:Qe}),Le!==Oe&&(ve=ve.map(function(ot){return Ee(Ee({},ot),{},{position:Ee(Ee({},ot.position),{},{offset:ot.position.offset-Le/2})})}))}var mt=E&&E.type&&E.type.getComposedData;mt&&_.push({props:Ee(Ee({},mt(Ee(Ee({},Me),{},{displayedData:q,props:m,dataKey:de,item:E,bandSize:Oe,barPosition:ve,offset:x,stackedData:Ge,layout:M,dataStartIndex:Z,dataEndIndex:N}))),{},tn(tn(tn({key:E.key||"item-".concat(P)},z,Me[z]),j,Me[j]),"animationId",B)),childIndex:Wme(E,m.children),item:E})}),_},I=function(m,b){var v=m.props,w=m.dataStartIndex,x=m.dataEndIndex,B=m.updateId;if(!sk({props:v}))return null;var Z=v.children,N=v.layout,W=v.stackOffset,M=v.data,F=v.reverseStackOrder,T=UK(N),H=T.numericAxisName,K=T.cateAxisName,z=Gs(Z,i),j=HNe(M,z,"".concat(H,"Id"),"".concat(K,"Id"),W,F),O=l.reduce(function(re,de){var Re="".concat(de.axisType,"Map");return Ee(Ee({},re),{},tn({},Re,kEe(v,Ee(Ee({},de),{},{graphicalItems:z,stackGroups:de.axisType===H&&j,dataStartIndex:w,dataEndIndex:x}))))},{}),_=LEe(Ee(Ee({},O),{},{props:v,graphicalItems:z}),b==null?void 0:b.legendBBox);Object.keys(O).forEach(function(re){O[re]=u(v,O[re],_,re.replace("Map",""),n)});var E=O["".concat(K,"Map")],P=HEe(E),q=h(v,Ee(Ee({},O),{},{dataStartIndex:w,dataEndIndex:x,updateId:B,graphicalItems:z,stackGroups:j,offset:_}));return Ee(Ee({formattedGraphicalItems:q,graphicalItems:z,offset:_,stackGroups:j},P),O)},p=function(A){function m(b){var v,w,x;return xEe(this,m),x=BEe(this,m,[b]),tn(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),tn(x,"accessibilityManager",new cEe),tn(x,"handleLegendBBoxUpdate",function(B){if(B){var Z=x.state,N=Z.dataStartIndex,W=Z.dataEndIndex,M=Z.updateId;x.setState(Ee({legendBBox:B},I({props:x.props,dataStartIndex:N,dataEndIndex:W,updateId:M},Ee(Ee({},x.state),{},{legendBBox:B}))))}}),tn(x,"handleReceiveSyncEvent",function(B,Z,N){if(x.props.syncId===B){if(N===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(Z)}}),tn(x,"handleBrushChange",function(B){var Z=B.startIndex,N=B.endIndex;if(Z!==x.state.dataStartIndex||N!==x.state.dataEndIndex){var W=x.state.updateId;x.setState(function(){return Ee({dataStartIndex:Z,dataEndIndex:N},I({props:x.props,dataStartIndex:Z,dataEndIndex:N,updateId:W},x.state))}),x.triggerSyncEvent({dataStartIndex:Z,dataEndIndex:N})}}),tn(x,"handleMouseEnter",function(B){var Z=x.getMouseInfo(B);if(Z){var N=Ee(Ee({},Z),{},{isTooltipActive:!0});x.setState(N),x.triggerSyncEvent(N);var W=x.props.onMouseEnter;$t(W)&&W(N,B)}}),tn(x,"triggeredAfterMouseMove",function(B){var Z=x.getMouseInfo(B),N=Z?Ee(Ee({},Z),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(N),x.triggerSyncEvent(N);var W=x.props.onMouseMove;$t(W)&&W(N,B)}),tn(x,"handleItemMouseEnter",function(B){x.setState(function(){return{isTooltipActive:!0,activeItem:B,activePayload:B.tooltipPayload,activeCoordinate:B.tooltipPosition||{x:B.cx,y:B.cy}}})}),tn(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),tn(x,"handleMouseMove",function(B){B.persist(),x.throttleTriggeredAfterMouseMove(B)}),tn(x,"handleMouseLeave",function(B){x.throttleTriggeredAfterMouseMove.cancel();var Z={isTooltipActive:!1};x.setState(Z),x.triggerSyncEvent(Z);var N=x.props.onMouseLeave;$t(N)&&N(Z,B)}),tn(x,"handleOuterEvent",function(B){var Z=Nme(B),N=wo(x.props,"".concat(Z));if(Z&&$t(N)){var W,M;/.*touch.*/i.test(Z)?M=x.getMouseInfo(B.changedTouches[0]):M=x.getMouseInfo(B),N((W=M)!==null&&W!==void 0?W:{},B)}}),tn(x,"handleClick",function(B){var Z=x.getMouseInfo(B);if(Z){var N=Ee(Ee({},Z),{},{isTooltipActive:!0});x.setState(N),x.triggerSyncEvent(N);var W=x.props.onClick;$t(W)&&W(N,B)}}),tn(x,"handleMouseDown",function(B){var Z=x.props.onMouseDown;if($t(Z)){var N=x.getMouseInfo(B);Z(N,B)}}),tn(x,"handleMouseUp",function(B){var Z=x.props.onMouseUp;if($t(Z)){var N=x.getMouseInfo(B);Z(N,B)}}),tn(x,"handleTouchMove",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(B.changedTouches[0])}),tn(x,"handleTouchStart",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&x.handleMouseDown(B.changedTouches[0])}),tn(x,"handleTouchEnd",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&x.handleMouseUp(B.changedTouches[0])}),tn(x,"handleDoubleClick",function(B){var Z=x.props.onDoubleClick;if($t(Z)){var N=x.getMouseInfo(B);Z(N,B)}}),tn(x,"handleContextMenu",function(B){var Z=x.props.onContextMenu;if($t(Z)){var N=x.getMouseInfo(B);Z(N,B)}}),tn(x,"triggerSyncEvent",function(B){x.props.syncId!==void 0&&$Z.emit(eR,x.props.syncId,B,x.eventEmitterSymbol)}),tn(x,"applySyncEvent",function(B){var Z=x.props,N=Z.layout,W=Z.syncMethod,M=x.state.updateId,F=B.dataStartIndex,T=B.dataEndIndex;if(B.dataStartIndex!==void 0||B.dataEndIndex!==void 0)x.setState(Ee({dataStartIndex:F,dataEndIndex:T},I({props:x.props,dataStartIndex:F,dataEndIndex:T,updateId:M},x.state)));else if(B.activeTooltipIndex!==void 0){var H=B.chartX,K=B.chartY,z=B.activeTooltipIndex,j=x.state,O=j.offset,_=j.tooltipTicks;if(!O)return;if(typeof W=="function")z=W(_,B);else if(W==="value"){z=-1;for(var E=0;E<_.length;E++)if(_[E].value===B.activeLabel){z=E;break}}var P=Ee(Ee({},O),{},{x:O.left,y:O.top}),q=Math.min(H,P.x+P.width),re=Math.min(K,P.y+P.height),de=_[z]&&_[z].value,Re=y3(x.state,x.props.data,z),Pe=_[z]?{x:N==="horizontal"?_[z].coordinate:q,y:N==="horizontal"?re:_[z].coordinate}:kq;x.setState(Ee(Ee({},B),{},{activeLabel:de,activeCoordinate:Pe,activePayload:Re,activeTooltipIndex:z}))}else x.setState(B)}),tn(x,"renderCursor",function(B){var Z,N=x.state,W=N.isTooltipActive,M=N.activeCoordinate,F=N.activePayload,T=N.offset,H=N.activeTooltipIndex,K=N.tooltipAxisBandSize,z=x.getTooltipEventType(),j=(Z=B.props.active)!==null&&Z!==void 0?Z:W,O=x.props.layout,_=B.key||"_recharts-cursor";return $.createElement(CEe,{key:_,activeCoordinate:M,activePayload:F,activeTooltipIndex:H,chartName:n,element:B,isActive:j,layout:O,offset:T,tooltipAxisBandSize:K,tooltipEventType:z})}),tn(x,"renderPolarAxis",function(B,Z,N){var W=wo(B,"type.axisType"),M=wo(x.state,"".concat(W,"Map")),F=B.type.defaultProps,T=F!==void 0?Ee(Ee({},F),B.props):B.props,H=M&&M[T["".concat(W,"Id")]];return S.cloneElement(B,Ee(Ee({},H),{},{className:ln(W,H.className),key:B.key||"".concat(Z,"-").concat(N),ticks:xc(H,!0)}))}),tn(x,"renderPolarGrid",function(B){var Z=B.props,N=Z.radialLines,W=Z.polarAngles,M=Z.polarRadius,F=x.state,T=F.radiusAxisMap,H=F.angleAxisMap,K=wg(T),z=wg(H),j=z.cx,O=z.cy,_=z.innerRadius,E=z.outerRadius;return S.cloneElement(B,{polarAngles:Array.isArray(W)?W:xc(z,!0).map(function(P){return P.coordinate}),polarRadius:Array.isArray(M)?M:xc(K,!0).map(function(P){return P.coordinate}),cx:j,cy:O,innerRadius:_,outerRadius:E,key:B.key||"polar-grid",radialLines:N})}),tn(x,"renderLegend",function(){var B=x.state.formattedGraphicalItems,Z=x.props,N=Z.children,W=Z.width,M=Z.height,F=x.props.margin||{},T=W-(F.left||0)-(F.right||0),H=g6({children:N,formattedGraphicalItems:B,legendWidth:T,legendContent:c});if(!H)return null;var K=H.item,z=jK(H,pEe);return S.cloneElement(K,Ee(Ee({},z),{},{chartWidth:W,chartHeight:M,margin:F,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),tn(x,"renderTooltip",function(){var B,Z=x.props,N=Z.children,W=Z.accessibilityLayer,M=Co(N,qn);if(!M)return null;var F=x.state,T=F.isTooltipActive,H=F.activeCoordinate,K=F.activePayload,z=F.activeLabel,j=F.offset,O=(B=M.props.active)!==null&&B!==void 0?B:T;return S.cloneElement(M,{viewBox:Ee(Ee({},j),{},{x:j.left,y:j.top}),active:O,label:z,payload:O?K:[],coordinate:H,accessibilityLayer:W})}),tn(x,"renderBrush",function(B){var Z=x.props,N=Z.margin,W=Z.data,M=x.state,F=M.offset,T=M.dataStartIndex,H=M.dataEndIndex,K=M.updateId;return S.cloneElement(B,{key:B.key||"_recharts-brush",onChange:Lb(x.handleBrushChange,B.props.onChange),data:W,x:ut(B.props.x)?B.props.x:F.left,y:ut(B.props.y)?B.props.y:F.top+F.height+F.brushBottom-(N.bottom||0),width:ut(B.props.width)?B.props.width:F.width,startIndex:T,endIndex:H,updateId:"brush-".concat(K)})}),tn(x,"renderReferenceElement",function(B,Z,N){if(!B)return null;var W=x,M=W.clipPathId,F=x.state,T=F.xAxisMap,H=F.yAxisMap,K=F.offset,z=B.type.defaultProps||{},j=B.props,O=j.xAxisId,_=O===void 0?z.xAxisId:O,E=j.yAxisId,P=E===void 0?z.yAxisId:E;return S.cloneElement(B,{key:B.key||"".concat(Z,"-").concat(N),xAxis:T[_],yAxis:H[P],viewBox:{x:K.left,y:K.top,width:K.width,height:K.height},clipPathId:M})}),tn(x,"renderActivePoints",function(B){var Z=B.item,N=B.activePoint,W=B.basePoint,M=B.childIndex,F=B.isRange,T=[],H=Z.props.key,K=Z.item.type.defaultProps!==void 0?Ee(Ee({},Z.item.type.defaultProps),Z.item.props):Z.item.props,z=K.activeDot,j=K.dataKey,O=Ee(Ee({index:M,dataKey:j,cx:N.x,cy:N.y,r:4,fill:EF(Z.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},Yt(z,!1)),Cw(z));return T.push(m.renderActiveDot(z,O,"".concat(H,"-activePoint-").concat(M))),W?T.push(m.renderActiveDot(z,Ee(Ee({},O),{},{cx:W.x,cy:W.y}),"".concat(H,"-basePoint-").concat(M))):F&&T.push(null),T}),tn(x,"renderGraphicChild",function(B,Z,N){var W=x.filterFormatItem(B,Z,N);if(!W)return null;var M=x.getTooltipEventType(),F=x.state,T=F.isTooltipActive,H=F.tooltipAxis,K=F.activeTooltipIndex,z=F.activeLabel,j=x.props.children,O=Co(j,qn),_=W.props,E=_.points,P=_.isRange,q=_.baseLine,re=W.item.type.defaultProps!==void 0?Ee(Ee({},W.item.type.defaultProps),W.item.props):W.item.props,de=re.activeDot,Re=re.hide,Pe=re.activeBar,ae=re.activeShape,he=!!(!Re&&T&&O&&(de||Pe||ae)),Me={};M!=="axis"&&O&&O.props.trigger==="click"?Me={onClick:Lb(x.handleItemMouseEnter,B.props.onClick)}:M!=="axis"&&(Me={onMouseLeave:Lb(x.handleItemMouseLeave,B.props.onMouseLeave),onMouseEnter:Lb(x.handleItemMouseEnter,B.props.onMouseEnter)});var be=S.cloneElement(B,Ee(Ee({},W.props),Me));function xe(ft){return typeof H.dataKey=="function"?H.dataKey(ft.payload):null}if(he)if(K>=0){var Ge,pe;if(H.dataKey&&!H.allowDuplicatedCategory){var Oe=typeof H.dataKey=="function"?xe:"payload.".concat(H.dataKey.toString());Ge=fw(E,Oe,z),pe=P&&q&&fw(q,Oe,z)}else Ge=E==null?void 0:E[K],pe=P&&q&&q[K];if(ae||Pe){var ve=B.props.activeIndex!==void 0?B.props.activeIndex:K;return[S.cloneElement(B,Ee(Ee(Ee({},W.props),Me),{},{activeIndex:ve})),null,null]}if(!en(Ge))return[be].concat(rC(x.renderActivePoints({item:W,activePoint:Ge,basePoint:pe,childIndex:K,isRange:P})))}else{var U,We=(U=x.getItemByXY(x.state.activeCoordinate))!==null&&U!==void 0?U:{graphicalItem:be},Xe=We.graphicalItem,Qe=Xe.item,Le=Qe===void 0?B:Qe,mt=Xe.childIndex,ot=Ee(Ee(Ee({},W.props),Me),{},{activeIndex:mt});return[S.cloneElement(Le,ot),null,null]}return P?[be,null,null]:[be,null]}),tn(x,"renderCustomized",function(B,Z,N){return S.cloneElement(B,Ee(Ee({key:"recharts-customized-".concat(N)},x.props),x.state))}),tn(x,"renderMap",{CartesianGrid:{handler:Db,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:Db},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:Db},YAxis:{handler:Db},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((v=b.id)!==null&&v!==void 0?v:yu("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=c7(x.triggeredAfterMouseMove,(w=b.throttleDelay)!==null&&w!==void 0?w:1e3/60),x.state={},x}return REe(m,A),GEe(m,[{key:"componentDidMount",value:function(){var v,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(v=this.props.margin.left)!==null&&v!==void 0?v:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var v=this.props,w=v.children,x=v.data,B=v.height,Z=v.layout,N=Co(w,qn);if(N){var W=N.props.defaultIndex;if(!(typeof W!="number"||W<0||W>this.state.tooltipTicks.length-1)){var M=this.state.tooltipTicks[W]&&this.state.tooltipTicks[W].value,F=y3(this.state,x,W,M),T=this.state.tooltipTicks[W].coordinate,H=(this.state.offset.top+B)/2,K=Z==="horizontal",z=K?{x:T,y:H}:{y:T,x:H},j=this.state.formattedGraphicalItems.find(function(_){var E=_.item;return E.type.name==="Scatter"});j&&(z=Ee(Ee({},z),j.props.points[W].tooltipPosition),F=j.props.points[W].tooltipPayload);var O={activeTooltipIndex:W,isTooltipActive:!0,activeLabel:M,activePayload:F,activeCoordinate:z};this.setState(O),this.renderCursor(N),this.accessibilityManager.setIndex(W)}}}},{key:"getSnapshotBeforeUpdate",value:function(v,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==v.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==v.margin){var x,B;this.accessibilityManager.setDetails({offset:{left:(x=this.props.margin.left)!==null&&x!==void 0?x:0,top:(B=this.props.margin.top)!==null&&B!==void 0?B:0}})}return null}},{key:"componentDidUpdate",value:function(v){PW([Co(v.children,qn)],[Co(this.props.children,qn)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var v=Co(this.props.children,qn);if(v&&typeof v.props.shared=="boolean"){var w=v.props.shared?"axis":"item";return a.indexOf(w)>=0?w:s}return s}},{key:"getMouseInfo",value:function(v){if(!this.container)return null;var w=this.container,x=w.getBoundingClientRect(),B=iSe(x),Z={chartX:Math.round(v.pageX-B.left),chartY:Math.round(v.pageY-B.top)},N=x.width/w.offsetWidth||1,W=this.inRange(Z.chartX,Z.chartY,N);if(!W)return null;var M=this.state,F=M.xAxisMap,T=M.yAxisMap,H=this.getTooltipEventType(),K=OK(this.state,this.props.data,this.props.layout,W);if(H!=="axis"&&F&&T){var z=wg(F).scale,j=wg(T).scale,O=z&&z.invert?z.invert(Z.chartX):null,_=j&&j.invert?j.invert(Z.chartY):null;return Ee(Ee({},Z),{},{xValue:O,yValue:_},K)}return K?Ee(Ee({},Z),K):null}},{key:"inRange",value:function(v,w){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=this.props.layout,Z=v/x,N=w/x;if(B==="horizontal"||B==="vertical"){var W=this.state.offset,M=Z>=W.left&&Z<=W.left+W.width&&N>=W.top&&N<=W.top+W.height;return M?{x:Z,y:N}:null}var F=this.state,T=F.angleAxisMap,H=F.radiusAxisMap;if(T&&H){var K=wg(T);return I9({x:Z,y:N},K)}return null}},{key:"parseEventsOfWrapper",value:function(){var v=this.props.children,w=this.getTooltipEventType(),x=Co(v,qn),B={};x&&w==="axis"&&(x.props.trigger==="click"?B={onClick:this.handleClick}:B={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var Z=Cw(this.props,this.handleOuterEvent);return Ee(Ee({},Z),B)}},{key:"addListener",value:function(){$Z.on(eR,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){$Z.removeListener(eR,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(v,w,x){for(var B=this.state.formattedGraphicalItems,Z=0,N=B.length;Z<N;Z++){var W=B[Z];if(W.item===v||W.props.key===v.key||w===Rc(W.item.type)&&x===W.childIndex)return W}return null}},{key:"renderClipPath",value:function(){var v=this.clipPathId,w=this.state.offset,x=w.left,B=w.top,Z=w.height,N=w.width;return $.createElement("defs",null,$.createElement("clipPath",{id:v},$.createElement("rect",{x,y:B,height:Z,width:N})))}},{key:"getXScales",value:function(){var v=this.state.xAxisMap;return v?Object.entries(v).reduce(function(w,x){var B=zK(x,2),Z=B[0],N=B[1];return Ee(Ee({},w),{},tn({},Z,N.scale))},{}):null}},{key:"getYScales",value:function(){var v=this.state.yAxisMap;return v?Object.entries(v).reduce(function(w,x){var B=zK(x,2),Z=B[0],N=B[1];return Ee(Ee({},w),{},tn({},Z,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(v){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[v])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(v){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[v])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(v){var w=this.state,x=w.formattedGraphicalItems,B=w.activeItem;if(x&&x.length)for(var Z=0,N=x.length;Z<N;Z++){var W=x[Z],M=W.props,F=W.item,T=F.type.defaultProps!==void 0?Ee(Ee({},F.type.defaultProps),F.props):F.props,H=Rc(F.type);if(H==="Bar"){var K=(M.data||[]).find(function(_){return Y3e(v,_)});if(K)return{graphicalItem:W,payload:K}}else if(H==="RadialBar"){var z=(M.data||[]).find(function(_){return I9(v,_)});if(z)return{graphicalItem:W,payload:z}}else if(EB(W,B)||YB(W,B)||JA(W,B)){var j=S5e({graphicalItem:W,activeTooltipItem:B,itemData:T.data}),O=T.activeIndex===void 0?j:T.activeIndex;return{graphicalItem:Ee(Ee({},W),{},{childIndex:O}),payload:JA(W,B)?T.data[j]:W.props.data[j]}}}return null}},{key:"render",value:function(){var v=this;if(!sk(this))return null;var w=this.props,x=w.children,B=w.className,Z=w.width,N=w.height,W=w.style,M=w.compact,F=w.title,T=w.desc,H=jK(w,mEe),K=Yt(H,!1);if(M)return $.createElement(vK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},$.createElement(DW,MI({},K,{width:Z,height:N,title:F,desc:T}),this.renderClipPath(),ak(x,this.renderMap)));if(this.props.accessibilityLayer){var z,j;K.tabIndex=(z=this.props.tabIndex)!==null&&z!==void 0?z:0,K.role=(j=this.props.role)!==null&&j!==void 0?j:"application",K.onKeyDown=function(_){v.accessibilityManager.keyboardEvent(_)},K.onFocus=function(){v.accessibilityManager.focus()}}var O=this.parseEventsOfWrapper();return $.createElement(vK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},$.createElement("div",MI({className:ln("recharts-wrapper",B),style:Ee({position:"relative",cursor:"default",width:Z,height:N},W)},O,{ref:function(E){v.container=E}}),$.createElement(DW,MI({},K,{width:Z,height:N,title:F,desc:T,style:_Ee}),this.renderClipPath(),ak(x,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(S.Component);tn(p,"displayName",n),tn(p,"defaultProps",Ee({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),tn(p,"getDerivedStateFromProps",function(A,m){var b=A.dataKey,v=A.data,w=A.children,x=A.width,B=A.height,Z=A.layout,N=A.stackOffset,W=A.margin,M=m.dataStartIndex,F=m.dataEndIndex;if(m.updateId===void 0){var T=DK(A);return Ee(Ee(Ee({},T),{},{updateId:0},I(Ee(Ee({props:A},T),{},{updateId:0}),m)),{},{prevDataKey:b,prevData:v,prevWidth:x,prevHeight:B,prevLayout:Z,prevStackOffset:N,prevMargin:W,prevChildren:w})}if(b!==m.prevDataKey||v!==m.prevData||x!==m.prevWidth||B!==m.prevHeight||Z!==m.prevLayout||N!==m.prevStackOffset||!UI(W,m.prevMargin)){var H=DK(A),K={chartX:m.chartX,chartY:m.chartY,isTooltipActive:m.isTooltipActive},z=Ee(Ee({},OK(m,v,Z)),{},{updateId:m.updateId+1}),j=Ee(Ee(Ee({},H),K),z);return Ee(Ee(Ee({},j),I(Ee({props:A},j),m)),{},{prevDataKey:b,prevData:v,prevWidth:x,prevHeight:B,prevLayout:Z,prevStackOffset:N,prevMargin:W,prevChildren:w})}if(!PW(w,m.prevChildren)){var O,_,E,P,q=Co(w,jf),re=q&&(O=(_=q.props)===null||_===void 0?void 0:_.startIndex)!==null&&O!==void 0?O:M,de=q&&(E=(P=q.props)===null||P===void 0?void 0:P.endIndex)!==null&&E!==void 0?E:F,Re=re!==M||de!==F,Pe=!en(v),ae=Pe&&!Re?m.updateId:m.updateId+1;return Ee(Ee({updateId:ae},I(Ee(Ee({props:A},m),{},{updateId:ae,dataStartIndex:re,dataEndIndex:de}),m)),{},{prevChildren:w,dataStartIndex:re,dataEndIndex:de})}return null}),tn(p,"renderActiveDot",function(A,m,b){var v;return S.isValidElement(A)?v=S.cloneElement(A,m):$t(A)?v=A(m):v=$.createElement(J0,m),$.createElement(fn,{className:"recharts-active-dot",key:b},v)});var y=S.forwardRef(function(m,b){return $.createElement(p,MI({},m,{ref:b}))});return y.displayName=p.displayName,y},Ds=DC({chartName:"LineChart",GraphicalChild:jn,axisComponents:[{axisType:"xAxis",AxisComp:ui},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:Q0}),VI=DC({chartName:"BarChart",GraphicalChild:Gr,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ui},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:Q0}),jEe=DC({chartName:"PieChart",GraphicalChild:Dc,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:XB},{axisType:"radiusAxis",AxisComp:_B}],formatAxisMap:$Ne,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),PEe=DC({chartName:"ScatterChart",GraphicalChild:ih,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:ui},{axisType:"yAxis",AxisComp:ii},{axisType:"zAxis",AxisComp:q0}],formatAxisMap:Q0}),Kq=DC({chartName:"AreaChart",GraphicalChild:xs,axisComponents:[{axisType:"xAxis",AxisComp:ui},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:Q0}),OEe=DC({chartName:"ComposedChart",GraphicalChild:[jn,xs,Gr,ih],axisComponents:[{axisType:"xAxis",AxisComp:ui},{axisType:"yAxis",AxisComp:ii},{axisType:"zAxis",AxisComp:q0}],formatAxisMap:Q0});function UC({title:t,value:e,min:n=0,max:i,unit:r,status:s="normal",type:o="speedometer",size:a=200}){return o==="radial"?g.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 bg-gray-800 rounded-lg",children:[g.jsx("div",{className:"text-sm font-medium text-white",children:t}),g.jsxs("div",{className:`text-3xl font-bold ${s==="critical"?"text-red-400":s==="warning"?"text-yellow-400":"text-green-400"}`,children:[e.toFixed(1)," ",r]}),g.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-gray-600 flex items-center justify-center bg-gray-700",children:g.jsx("div",{className:"text-center",children:g.jsx("div",{className:"text-xs text-gray-300",children:"Radial"})})})]}):g.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 bg-gray-800 rounded-lg",children:[g.jsx("div",{className:"text-sm font-medium text-white",children:t}),g.jsxs("div",{className:`text-3xl font-bold ${s==="critical"?"text-red-400":s==="warning"?"text-yellow-400":"text-green-400"}`,children:[e.toFixed(1)," ",r]}),g.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-gray-600 flex items-center justify-center bg-gray-700",children:g.jsx("div",{className:"text-center",children:g.jsx("div",{className:"text-xs text-gray-300",children:"Speedometer"})})})]})}function DEe({value:t,status:e}){return g.jsx(UC,{title:"Temperature",value:t,max:2e3,unit:"C",status:e,type:"speedometer"})}function UEe({value:t,status:e}){return g.jsx(UC,{title:"Vibration",value:t,max:10,unit:"Hz",status:e,type:"radial"})}function JEe({value:t,status:e}){return g.jsx(UC,{title:"Emissions",value:t,max:150,unit:"ppm",status:e,type:"speedometer"})}function QEe({value:t,status:e}){return g.jsx(UC,{title:"Scrap Purity",value:t,max:100,unit:"%",status:e,type:"radial"})}function qEe({value:t,status:e}){return g.jsx(UC,{title:"Battery Level",value:t,max:100,unit:"%",status:e,type:"speedometer"})}function $Ee({value:t,status:e}){return g.jsx(UC,{title:"Air Quality",value:t,max:500,unit:"AQI",status:e,type:"radial"})}function Lq(){const[t,e]=S.useState(null),[n,i]=S.useState(!1),[r,s]=S.useState(null);return S.useEffect(()=>{const a=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;let l=null,c;const u=()=>{try{l=new WebSocket(a),l.onopen=()=>{console.log("WebSocket connected"),i(!0),s(null)},l.onmessage=d=>{try{const h=JSON.parse(d.data);h.type==="update"&&e(h.data)}catch(h){console.error("Error parsing WebSocket message:",h)}},l.onerror=d=>{console.error("WebSocket error:",d),s("Connection error"),i(!1)},l.onclose=()=>{console.log("WebSocket disconnected"),i(!1),c=setTimeout(()=>{console.log("Attempting to reconnect..."),u()},3e3)}}catch(d){console.error("Error creating WebSocket:",d),s("Failed to connect")}};return u(),()=>{l&&l.close(),c&&clearTimeout(c)}},[]),{data:t,isConnected:n,error:r}}const nR=[{id:"F1",name:"Blast Furnace 1",status:"live",temperature:1420,emissions:85,purity:94,current:1250,vibration:2.1,doorStatus:"closed"},{id:"F2",name:"Blast Furnace 2",status:"idle",temperature:1200,emissions:45,purity:89,current:980,vibration:1.8,doorStatus:"closed"},{id:"F3",name:"Blast Furnace 3",status:"alert",temperature:1580,emissions:120,purity:76,current:1450,vibration:4.2,doorStatus:"open"},{id:"F4",name:"Blast Furnace 4",status:"live",temperature:1380,emissions:78,purity:91,current:1180,vibration:2.3,doorStatus:"closed"}];function eYe(){var a;const{data:t,isConnected:e}=Lq(),[n,i]=S.useState({temperature:1420,emissions:45,vibration:3.2,purity:94,energy:1250,battery:85,airQuality:25,scrapLevel:75});S.useEffect(()=>{var l,c,u,d,h,I,p,y;if(t!=null&&t.sensors){const A=t.sensors,m={temperature:((l=A.find(b=>b.type==="temperature"))==null?void 0:l.value)||1420,emissions:((c=A.find(b=>b.type==="emissions"))==null?void 0:c.value)||45,vibration:((u=A.find(b=>b.type==="vibration"))==null?void 0:u.value)||3.2,purity:((d=A.find(b=>b.type==="purity"))==null?void 0:d.value)||94,energy:((h=A.find(b=>b.type==="energy"))==null?void 0:h.value)||1250,battery:((I=A.find(b=>b.type==="battery"))==null?void 0:I.value)||85,airQuality:((p=A.find(b=>b.type==="airQuality"))==null?void 0:p.value)||25,scrapLevel:((y=A.find(b=>b.type==="scrapLevel"))==null?void 0:y.value)||75};console.log("Dashboard received WebSocket data:",{sensorCount:A.length,gaugeData:{temperature:m.temperature,battery:m.battery,airQuality:m.airQuality,scrapLevel:m.scrapLevel},timestamp:t.timestamp}),i(m)}},[t]);const r=l=>{switch(l){case"live":return g.jsx(nn,{className:"bg-green-100 text-green-800 border-green-200",children:"LIVE"});case"idle":return g.jsx(nn,{variant:"secondary",children:"IDLE"});case"alert":return g.jsx(nn,{className:"bg-red-100 text-red-800 border-red-200",children:"ALERT"});default:return g.jsx(nn,{variant:"outline",children:"UNKNOWN"})}},s=(l,c)=>l<=c.good?"text-green-600":l<=c.warning?"text-yellow-600":"text-red-600",o=(l,c)=>{switch(c){case"temperature":return l>1600?"critical":l>1500?"warning":"normal";case"vibration":return l>4?"critical":l>3?"warning":"normal";case"emissions":return l>60?"critical":l>40?"warning":"normal";case"battery":return l<20?"critical":l<40?"warning":"normal";default:return"normal"}};return g.jsx("div",{className:"flex-1 overflow-auto",children:g.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[g.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-border bg-background",children:[g.jsx("div",{className:"flex items-center gap-4",children:g.jsxs("div",{children:[g.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Steel Plant Alpha"}),g.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:"Real-time Monitoring"})]})}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:"relative",children:[g.jsx(fA,{className:"w-5 h-5 text-muted-foreground"}),g.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]}),g.jsx("span",{className:"text-sm text-muted-foreground",children:"3 Active Alerts"})]}),g.jsxs(Ml,{defaultValue:"24h",children:[g.jsxs(za,{className:"w-32",children:[g.jsx(qD,{className:"w-4 h-4 mr-2"}),g.jsx(Vl,{})]}),g.jsxs(ja,{children:[g.jsx(An,{value:"1h",children:"Last Hour"}),g.jsx(An,{value:"6h",children:"Last 6 Hours"}),g.jsx(An,{value:"24h",children:"Last 24 Hours"}),g.jsx(An,{value:"7d",children:"Last 7 Days"})]})]}),g.jsxs(CIe,{children:[g.jsx(pIe,{asChild:!0,children:g.jsx(Mt,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:g.jsx(AJ,{className:"h-8 w-8",children:g.jsx(yJ,{children:"OP"})})})}),g.jsxs(bQ,{className:"w-56",align:"end",forceMount:!0,children:[g.jsx(vQ,{className:"font-normal",children:g.jsxs("div",{className:"flex flex-col space-y-1",children:[g.jsx("p",{className:"text-sm font-medium leading-none",children:"Operator"}),g.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:"operator@steelplant.com"})]})}),g.jsx(LW,{}),g.jsxs(yx,{children:[g.jsx(sw,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Profile"})]}),g.jsxs(yx,{children:[g.jsx(W0,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Settings"})]}),g.jsx(LW,{}),g.jsxs(yx,{children:[g.jsx(Ale,{className:"mr-2 h-4 w-4"}),g.jsx("span",{children:"Log out"})]})]})]})]})]}),g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"mb-6",children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Multi-Furnace Dashboard"}),g.jsx("p",{className:"text-muted-foreground",children:"Monitor all furnaces in real-time"}),g.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[g.jsx("div",{className:`w-2 h-2 rounded-full ${e?"bg-green-500 animate-pulse":"bg-red-500"}`}),g.jsx("span",{className:"text-sm text-muted-foreground",children:e?"Live Data Connected":"Connecting..."})]})]}),g.jsxs(Ye,{className:"mb-6 bg-gradient-to-br from-slate-900 to-slate-800 border-slate-700",children:[g.jsx(tt,{children:g.jsxs(nt,{className:"text-white flex items-center gap-2",children:[g.jsx(Xl,{className:"w-5 h-5 text-blue-400"}),"Real-Time Sensor Gauges"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6",children:[g.jsx("div",{className:"flex justify-center",children:g.jsx(DEe,{value:n.temperature,status:o(n.temperature,"temperature")})}),g.jsx("div",{className:"flex justify-center",children:g.jsx(UEe,{value:n.vibration,status:o(n.vibration,"vibration")})}),g.jsx("div",{className:"flex justify-center",children:g.jsx(JEe,{value:n.emissions,status:o(n.emissions,"emissions")})}),g.jsx("div",{className:"flex justify-center",children:g.jsx(QEe,{value:n.purity,status:"normal"})}),g.jsx("div",{className:"flex justify-center",children:g.jsx(qEe,{value:n.battery,status:o(n.battery,"battery")})}),g.jsx("div",{className:"flex justify-center",children:g.jsx($Ee,{value:n.airQuality,status:"normal"})})]})})]}),g.jsxs(VC,{defaultValue:"overview",className:"space-y-6",children:[g.jsxs(hh,{className:"grid w-full grid-cols-4",children:[g.jsx(di,{value:"overview",children:"Overview"}),g.jsx(di,{value:"performance",children:"Performance"}),g.jsx(di,{value:"safety",children:"Safety"}),g.jsx(di,{value:"emissions",children:"Emissions"})]}),g.jsx(ri,{value:"overview",className:"space-y-6",children:g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:(a=t==null?void 0:t.furnaces)==null?void 0:a.map(l=>g.jsxs(EIe,{children:[g.jsx(YIe,{asChild:!0,children:g.jsxs(Ye,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer hover:scale-105",children:[g.jsxs(tt,{className:"pb-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(nt,{className:"text-lg",children:l.name}),r(l.status)]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:`w-2 h-2 rounded-full ${l.status==="active"?"bg-green-500 animate-pulse":l.status==="idle"?"bg-gray-400":"bg-red-500 animate-pulse"}`}),g.jsx("span",{className:"text-sm text-muted-foreground capitalize",children:l.status})]})]}),g.jsxs(ke,{className:"space-y-4",children:[g.jsx("div",{className:"h-16",children:g.jsx(Ai,{width:"100%",height:"100%",children:g.jsx(Kq,{data:[{time:"00:00",value:l.temperature-50},{time:"06:00",value:l.temperature-20},{time:"12:00",value:l.temperature},{time:"18:00",value:l.temperature-30}],children:g.jsx(xs,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.2,strokeWidth:2})})})}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx(Ud,{className:`w-5 h-5 mx-auto mb-1 ${s(l.temperature,{good:1400,warning:1500})}`}),g.jsxs("div",{className:`text-lg font-bold ${s(l.temperature,{good:1400,warning:1500})}`,children:[l.temperature.toFixed(1),"C"]}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Temperature"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx(to,{className:`w-5 h-5 mx-auto mb-1 ${s(l.energyConsumption,{good:1200,warning:1400})}`}),g.jsx("div",{className:`text-lg font-bold ${s(l.energyConsumption,{good:1200,warning:1400})}`,children:l.energyConsumption.toFixed(0)}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Energy (kW)"})]})]}),g.jsxs("div",{className:"flex justify-between items-center text-xs",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(ZW,{className:"w-3 h-3 text-blue-500"}),g.jsxs("span",{children:["Pressure: ",l.pressure.toFixed(1)," bar"]})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(pY,{className:"w-3 h-3 text-blue-500"}),g.jsxs("span",{children:["Rate: ",l.productionRate.toFixed(0)," t/h"]})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(ole,{className:"w-3 h-3 text-green-500"}),g.jsxs("span",{children:[n.battery,"%"]})]})]}),g.jsxs("div",{className:"flex gap-1 pt-2 border-t",children:[g.jsxs(Mt,{variant:"outline",size:"sm",className:"flex-1 text-xs",children:[g.jsx(Xc,{className:"w-3 h-3 mr-1"}),"View"]}),g.jsx(Mt,{variant:"outline",size:"sm",className:"text-xs",children:g.jsx(Ble,{className:"w-3 h-3"})}),g.jsx(Mt,{variant:"outline",size:"sm",className:"text-xs",children:g.jsx(R2,{className:"w-3 h-3"})}),g.jsx(Mt,{variant:"outline",size:"sm",className:"text-xs",children:g.jsx(N2,{className:"w-3 h-3"})})]})]})]})}),g.jsx(OQ,{className:"w-80",children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("h4",{className:"font-medium",children:[l.name," - Quick Stats"]}),g.jsxs("div",{children:[g.jsx("h5",{className:"text-sm font-medium mb-2",children:"Temperature History (24h)"}),g.jsx(Ai,{width:"100%",height:60,children:g.jsx(Ds,{data:[{time:"00:00",temp:1410},{time:"06:00",temp:1435},{time:"12:00",temp:1420},{time:"18:00",temp:1445}],children:g.jsx(jn,{type:"monotone",dataKey:"temp",stroke:"#ef4444",strokeWidth:2,dot:!1})})})]}),g.jsxs("div",{children:[g.jsx("h5",{className:"text-sm font-medium mb-2",children:"Vibration History (24h)"}),g.jsx(Ai,{width:"100%",height:60,children:g.jsx(Ds,{data:[{time:"00:00",vib:2.1},{time:"06:00",vib:2.3},{time:"12:00",vib:2.8},{time:"18:00",vib:l.vibration}],children:g.jsx(jn,{type:"monotone",dataKey:"vib",stroke:"#f59e0b",strokeWidth:2,dot:!1})})})]}),g.jsxs("div",{children:[g.jsx("h5",{className:"text-sm font-medium mb-2",children:"Recent Scrap Batches"}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("div",{className:"flex justify-between text-xs",children:[g.jsx("span",{children:"Batch S-2024-001"}),g.jsx("span",{className:"text-green-600",children:"94% purity"})]}),g.jsxs("div",{className:"flex justify-between text-xs",children:[g.jsx("span",{children:"Batch S-2024-002"}),g.jsx("span",{className:"text-yellow-600",children:"87% purity"})]})]})]})]})})]},l.id))})}),g.jsx(ri,{value:"performance",className:"space-y-6",children:g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Efficiency Trends"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:[{time:"00:00",f1:92,f2:89,f3:94,f4:91},{time:"06:00",f1:94,f2:91,f3:96,f4:93},{time:"12:00",f1:91,f2:88,f3:93,f4:90},{time:"16:00",f1:95,f2:92,f3:97,f4:94}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"f1",stroke:"#3b82f6",name:"Furnace 1"}),g.jsx(jn,{type:"monotone",dataKey:"f2",stroke:"#ef4444",name:"Furnace 2"}),g.jsx(jn,{type:"monotone",dataKey:"f3",stroke:"#22c55e",name:"Furnace 3"}),g.jsx(jn,{type:"monotone",dataKey:"f4",stroke:"#f59e0b",name:"Furnace 4"})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Production Rates"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:nR.map((l,c)=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:`w-3 h-3 rounded-full ${c===0?"bg-blue-500":c===1?"bg-red-500":c===2?"bg-green-500":"bg-yellow-500"}`}),g.jsx("span",{className:"text-sm font-medium",children:l.name})]}),g.jsxs("div",{className:"text-right",children:[g.jsxs("div",{className:"text-lg font-bold",children:[Math.floor(Math.random()*50)+40," tons/h"]}),g.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.purity,"% purity"]})]})]},l.id))})})]})]})}),g.jsx(ri,{value:"safety",className:"space-y-6",children:g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(gr,{className:"w-5 h-5 text-red-600"}),"Critical Alerts"]})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-3",children:g.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(gr,{className:"w-4 h-4 text-red-600"}),g.jsx("span",{className:"text-sm font-medium",children:"F3 Overheating"})]}),g.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"1580C - Exceeds threshold"})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(ZW,{className:"w-5 h-5 text-blue-600"}),"Gas Monitoring"]})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-3",children:nR.map(l=>g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:l.name}),g.jsx(nn,{variant:"outline",className:"text-green-600",children:"OK"})]},l.id))})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(pY,{className:"w-5 h-5 text-blue-600"}),"Environmental"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Humidity"}),g.jsx("span",{className:"font-medium",children:"65%"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Air Quality"}),g.jsx("span",{className:"font-medium text-green-600",children:"Good"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Temperature"}),g.jsx("span",{className:"font-medium",children:"24.5C"})]})]})})]})]})}),g.jsx(ri,{value:"emissions",className:"space-y-6",children:g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Real-time Emissions"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:[{time:"00:00",f1:85,f2:45,f3:120,f4:78},{time:"06:00",f1:82,f2:48,f3:115,f4:81},{time:"12:00",f1:88,f2:42,f3:125,f4:75},{time:"16:00",f1:91,f2:46,f3:118,f4:79}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"f1",stroke:"#3b82f6",name:"Furnace 1"}),g.jsx(jn,{type:"monotone",dataKey:"f2",stroke:"#ef4444",name:"Furnace 2"}),g.jsx(jn,{type:"monotone",dataKey:"f3",stroke:"#22c55e",name:"Furnace 3"}),g.jsx(jn,{type:"monotone",dataKey:"f4",stroke:"#f59e0b",name:"Furnace 4"})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Compliance Status"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:nR.map((l,c)=>g.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:`w-3 h-3 rounded-full ${l.emissions<100?"bg-green-500":"bg-red-500"}`}),g.jsx("span",{className:"font-medium",children:l.name})]}),g.jsxs("div",{className:"text-right",children:[g.jsxs("div",{className:"font-bold",children:[l.emissions," ppm"]}),g.jsx("div",{className:`text-xs ${l.emissions<100?"text-green-600":"text-red-600"}`,children:l.emissions<100?"Within Limits":"Exceeds Limit"})]})]},l.id))})})]})]})})]}),g.jsxs(Ye,{className:"mt-8",children:[g.jsx(tt,{children:g.jsx(nt,{children:"Production Trends (Last 24 Hours)"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:[{time:"00:00",production:1850,efficiency:91},{time:"04:00",production:1920,efficiency:93},{time:"08:00",production:2100,efficiency:95},{time:"12:00",production:2250,efficiency:94},{time:"16:00",production:2180,efficiency:92},{time:"20:00",production:2050,efficiency:90}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{yAxisId:"left"}),g.jsx(ii,{yAxisId:"right",orientation:"right"}),g.jsx(qn,{}),g.jsx(jn,{yAxisId:"left",type:"monotone",dataKey:"production",stroke:"#3b82f6",strokeWidth:3,name:"Production (tons)"}),g.jsx(jn,{yAxisId:"right",type:"monotone",dataKey:"efficiency",stroke:"#22c55e",strokeWidth:2,name:"Efficiency (%)"})]})})})]}),g.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(Xl,{className:"w-5 h-5 text-green-600"}),"System Status"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Active Furnaces"}),g.jsx("span",{className:"font-medium",children:"3/4"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Total Production"}),g.jsx("span",{className:"font-medium",children:"2,450 tons"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Avg Efficiency"}),g.jsx("span",{className:"font-medium text-green-600",children:"92.4%"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Uptime"}),g.jsx("span",{className:"font-medium text-green-600",children:"99.7%"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(gr,{className:"w-5 h-5 text-orange-600"}),"Active Alerts"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-center gap-3 p-2 bg-red-50 rounded",children:[g.jsx(gr,{className:"w-4 h-4 text-red-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"F3 Overheating"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"2 min ago"})]})]}),g.jsxs("div",{className:"flex items-center gap-3 p-2 bg-yellow-50 rounded",children:[g.jsx(gr,{className:"w-4 h-4 text-yellow-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"F2 Low Purity"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"15 min ago"})]})]}),g.jsxs("div",{className:"flex items-center gap-3 p-2 bg-blue-50 rounded",children:[g.jsx(gr,{className:"w-4 h-4 text-blue-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"Maintenance Due"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"F1 - 2 days"})]})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(to,{className:"w-5 h-5 text-blue-600"}),"Energy Overview"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Total Power"}),g.jsx("span",{className:"font-medium",children:"4,680 kW"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Energy Saved"}),g.jsx("span",{className:"font-medium text-green-600",children:"$1,240"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"CO2 Reduced"}),g.jsx("span",{className:"font-medium text-green-600",children:"45 tons"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Cost per Ton"}),g.jsx("span",{className:"font-medium",children:"$18.45"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(Ud,{className:"w-5 h-5 text-red-600"}),"Environmental"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Air Quality"}),g.jsx("span",{className:"font-medium text-green-600",children:"Good"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Emissions"}),g.jsx("span",{className:"font-medium text-green-600",children:"In Limits"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Temperature"}),g.jsx("span",{className:"font-medium",children:"24.5C"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Humidity"}),g.jsx("span",{className:"font-medium",children:"65%"})]})]})})]})]}),g.jsxs(Ye,{className:"mt-8",children:[g.jsx(tt,{children:g.jsx(nt,{children:"Recent Activity"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:[{time:"14:32",event:"Furnace F1 production started",type:"production",status:"success"},{time:"14:28",event:"Scrap batch S-2024-001 processed",type:"quality",status:"success"},{time:"14:25",event:"Maintenance alert: Bearing vibration high",type:"alert",status:"warning"},{time:"14:20",event:"Energy optimization activated",type:"system",status:"info"},{time:"14:15",event:"Operator login: John Smith",type:"security",status:"info"}].map((l,c)=>g.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[g.jsx("div",{className:`w-2 h-2 rounded-full ${l.status==="success"?"bg-green-500":l.status==="warning"?"bg-yellow-500":"bg-blue-500"}`}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"text-sm font-medium",children:l.event}),g.jsx("div",{className:"text-xs text-muted-foreground",children:l.time})]}),g.jsx(nn,{variant:"outline",className:"text-xs",children:l.type})]},c))})})]})]})]})})}var UF="Progress",JF=100,[tYe,MQe]=Ns(UF),[nYe,iYe]=tYe(UF),zq=S.forwardRef((t,e)=>{const{__scopeProgress:n,value:i=null,max:r,getValueLabel:s=rYe,...o}=t;(r||r===0)&&!JK(r)&&console.error(sYe(`${r}`,"Progress"));const a=JK(r)?r:JF;i!==null&&!QK(i,a)&&console.error(oYe(`${i}`,"Progress"));const l=QK(i,a)?i:null,c=AG(l)?s(l,a):void 0;return g.jsx(nYe,{scope:n,value:l,max:a,children:g.jsx(Ht.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":AG(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Oq(l,a),"data-value":l??void 0,"data-max":a,...o,ref:e})})});zq.displayName=UF;var jq="ProgressIndicator",Pq=S.forwardRef((t,e)=>{const{__scopeProgress:n,...i}=t,r=iYe(jq,n);return g.jsx(Ht.div,{"data-state":Oq(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...i,ref:e})});Pq.displayName=jq;function rYe(t,e){return`${Math.round(t/e*100)}%`}function Oq(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function AG(t){return typeof t=="number"}function JK(t){return AG(t)&&!isNaN(t)&&t>0}function QK(t,e){return AG(t)&&!isNaN(t)&&t<=e&&t>=0}function sYe(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${JF}\`.`}function oYe(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${JF} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Dq=zq,aYe=Pq;const sC=S.forwardRef(({className:t,value:e,...n},i)=>g.jsx(Dq,{ref:i,className:At("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:g.jsx(aYe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));sC.displayName=Dq.displayName;const lYe=C4,cYe=zue,gYe=p4,Uq=S.forwardRef(({className:t,...e},n)=>g.jsx(z2,{ref:n,className:At("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));Uq.displayName=z2.displayName;const Jq=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(gYe,{children:[g.jsx(Uq,{}),g.jsxs(j2,{ref:i,className:At("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,g.jsxs(m4,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[g.jsx(g5,{className:"h-4 w-4"}),g.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jq.displayName=j2.displayName;const Qq=({className:t,...e})=>g.jsx("div",{className:At("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Qq.displayName="DialogHeader";const qq=S.forwardRef(({className:t,...e},n)=>g.jsx(P2,{ref:n,className:At("text-lg font-semibold leading-none tracking-tight",t),...e}));qq.displayName=P2.displayName;const uYe=S.forwardRef(({className:t,...e},n)=>g.jsx(O2,{ref:n,className:At("text-sm text-muted-foreground",t),...e}));uYe.displayName=O2.displayName;var $q=["PageUp","PageDown"],e$=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],t$={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},JC="Slider",[b3,dYe,hYe]=R0(JC),[n$,VQe]=Ns(JC,[hYe]),[IYe,PB]=n$(JC),i$=S.forwardRef((t,e)=>{const{name:n,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[i],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:I=!1,form:p,...y}=t,A=S.useRef(new Set),m=S.useRef(0),v=o==="horizontal"?fYe:CYe,[w=[],x]=Qa({prop:u,defaultProp:c,onChange:F=>{var H;(H=[...A.current][m.current])==null||H.focus(),d(F)}}),B=S.useRef(w);function Z(F){const T=bYe(w,F);M(F,T)}function N(F){M(F,m.current)}function W(){const F=B.current[m.current];w[m.current]!==F&&h(w)}function M(F,T,{commit:H}={commit:!1}){const K=GYe(s),z=BYe(Math.round((F-i)/s)*s+i,K),j=uw(z,[i,r]);x((O=[])=>{const _=AYe(O,j,T);if(wYe(_,l*s)){m.current=_.indexOf(j);const E=String(_)!==String(O);return E&&H&&h(_),E?_:O}else return O})}return g.jsx(IYe,{scope:t.__scopeSlider,name:n,disabled:a,min:i,max:r,valueIndexToChangeRef:m,thumbs:A.current,values:w,orientation:o,form:p,children:g.jsx(b3.Provider,{scope:t.__scopeSlider,children:g.jsx(b3.Slot,{scope:t.__scopeSlider,children:g.jsx(v,{"aria-disabled":a,"data-disabled":a?"":void 0,...y,ref:e,onPointerDown:ht(y.onPointerDown,()=>{a||(B.current=w)}),min:i,max:r,inverted:I,onSlideStart:a?void 0:Z,onSlideMove:a?void 0:N,onSlideEnd:a?void 0:W,onHomeKeyDown:()=>!a&&M(i,0,{commit:!0}),onEndKeyDown:()=>!a&&M(r,w.length-1,{commit:!0}),onStepKeyDown:({event:F,direction:T})=>{if(!a){const z=$q.includes(F.key)||F.shiftKey&&e$.includes(F.key)?10:1,j=m.current,O=w[j],_=s*z*T;M(O+_,j,{commit:!0})}}})})})})});i$.displayName=JC;var[r$,s$]=n$(JC,{startEdge:"left",endEdge:"right",size:"width",direction:1}),fYe=S.forwardRef((t,e)=>{const{min:n,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,[d,h]=S.useState(null),I=Gn(e,v=>h(v)),p=S.useRef(void 0),y=X0(r),A=y==="ltr",m=A&&!s||!A&&s;function b(v){const w=p.current||d.getBoundingClientRect(),x=[0,w.width],Z=QF(x,m?[n,i]:[i,n]);return p.current=w,Z(v-w.left)}return g.jsx(r$,{scope:t.__scopeSlider,startEdge:m?"left":"right",endEdge:m?"right":"left",direction:m?1:-1,size:"width",children:g.jsx(o$,{dir:y,"data-orientation":"horizontal",...u,ref:I,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:v=>{const w=b(v.clientX);o==null||o(w)},onSlideMove:v=>{const w=b(v.clientX);a==null||a(w)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:v=>{const x=t$[m?"from-left":"from-right"].includes(v.key);c==null||c({event:v,direction:x?-1:1})}})})}),CYe=S.forwardRef((t,e)=>{const{min:n,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=t,u=S.useRef(null),d=Gn(e,u),h=S.useRef(void 0),I=!r;function p(y){const A=h.current||u.current.getBoundingClientRect(),m=[0,A.height],v=QF(m,I?[i,n]:[n,i]);return h.current=A,v(y-A.top)}return g.jsx(r$,{scope:t.__scopeSlider,startEdge:I?"bottom":"top",endEdge:I?"top":"bottom",size:"height",direction:I?1:-1,children:g.jsx(o$,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:y=>{const A=p(y.clientY);s==null||s(A)},onSlideMove:y=>{const A=p(y.clientY);o==null||o(A)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:y=>{const m=t$[I?"from-bottom":"from-top"].includes(y.key);l==null||l({event:y,direction:m?-1:1})}})})}),o$=S.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=t,u=PB(JC,n);return g.jsx(Ht.span,{...c,ref:e,onKeyDown:ht(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):$q.concat(e$).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:ht(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():i(d)}),onPointerMove:ht(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:ht(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),a$="SliderTrack",l$=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=PB(a$,n);return g.jsx(Ht.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});l$.displayName=a$;var v3="SliderRange",c$=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=PB(v3,n),s=s$(v3,n),o=S.useRef(null),a=Gn(e,o),l=r.values.length,c=r.values.map(h=>u$(h,r.min,r.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return g.jsx(Ht.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...t.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});c$.displayName=v3;var x3="SliderThumb",g$=S.forwardRef((t,e)=>{const n=dYe(t.__scopeSlider),[i,r]=S.useState(null),s=Gn(e,a=>r(a)),o=S.useMemo(()=>i?n().findIndex(a=>a.ref.current===i):-1,[n,i]);return g.jsx(pYe,{...t,ref:s,index:o})}),pYe=S.forwardRef((t,e)=>{const{__scopeSlider:n,index:i,name:r,...s}=t,o=PB(x3,n),a=s$(x3,n),[l,c]=S.useState(null),u=Gn(e,b=>c(b)),d=l?o.form||!!l.closest("form"):!0,h=A5(l),I=o.values[i],p=I===void 0?0:u$(I,o.min,o.max),y=yYe(i,o.values.length),A=h==null?void 0:h[a.size],m=A?vYe(A,p,a.direction):0;return S.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),g.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${m}px)`},children:[g.jsx(b3.ItemSlot,{scope:t.__scopeSlider,children:g.jsx(Ht.span,{role:"slider","aria-label":t["aria-label"]||y,"aria-valuemin":o.min,"aria-valuenow":I,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:u,style:I===void 0?{display:"none"}:t.style,onFocus:ht(t.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&g.jsx(mYe,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:I},i)]})});g$.displayName=x3;var mYe=t=>{const{value:e,...n}=t,i=S.useRef(null),r=R5(e);return S.useEffect(()=>{const s=i.current,o=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(o,"value").set;if(r!==e&&l){const c=new Event("input",{bubbles:!0});l.call(s,e),s.dispatchEvent(c)}},[r,e]),g.jsx("input",{style:{display:"none"},...n,ref:i,defaultValue:e})};function AYe(t=[],e,n){const i=[...t];return i[n]=e,i.sort((r,s)=>r-s)}function u$(t,e,n){const s=100/(n-e)*(t-e);return uw(s,[0,100])}function yYe(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function bYe(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),i=Math.min(...n);return n.indexOf(i)}function vYe(t,e,n){const i=t/2,s=QF([0,50],[0,i]);return(i-s(e)*n)*n}function xYe(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function wYe(t,e){if(e>0){const n=xYe(t);return Math.min(...n)>=e}return!0}function QF(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(t[1]-t[0]);return e[0]+i*(n-t[0])}}function GYe(t){return(String(t).split(".")[1]||"").length}function BYe(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var d$=i$,SYe=l$,ZYe=c$,RYe=g$;const wc=S.forwardRef(({className:t,...e},n)=>g.jsxs(d$,{ref:n,className:At("relative flex w-full touch-none select-none items-center",t),...e,children:[g.jsx(SYe,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:g.jsx(ZYe,{className:"absolute h-full bg-primary"})}),g.jsx(RYe,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));wc.displayName=d$.displayName;const NYe=[{time:"00:00",temp:1420,current:1250},{time:"04:00",temp:1415,current:1240},{time:"08:00",temp:1435,current:1280},{time:"12:00",temp:1428,current:1260},{time:"16:00",temp:1442,current:1290},{time:"20:00",temp:1430,current:1270}],WYe=[{time:"00:00",nox:45,co:120},{time:"04:00",nox:42,co:115},{time:"08:00",nox:48,co:125},{time:"12:00",nox:38,co:110},{time:"16:00",nox:41,co:118},{time:"20:00",nox:35,co:105}],MYe=[{name:"Temperature Sensor",status:"healthy",value:"1420C",location:"Main Chamber"},{name:"Vibration Sensor",status:"warning",value:"4.2 mm/s",location:"Motor Assembly"},{name:"Gas Sensor",status:"healthy",value:"98% O2",location:"Gas Manifold"},{name:"Humidity Sensor",status:"healthy",value:"45%",location:"Control Room"},{name:"Door Sensor",status:"healthy",value:"Closed",location:"Access Door"},{name:"Relay State",status:"healthy",value:"Active",location:"Power Panel"}],qK=[{date:"2024-01-15",type:"Preventive",component:"Gas Valve",technician:"John Smith",status:"Completed",duration:"2.5 hours"},{date:"2024-01-12",type:"Corrective",component:"Temperature Sensor",technician:"Sarah Johnson",status:"Completed",duration:"1.2 hours"},{date:"2024-01-08",type:"Inspection",component:"Motor Bearing",technician:"Mike Davis",status:"Completed",duration:"3.1 hours"},{date:"2024-01-05",type:"Calibration",component:"Control Panel",technician:"Admin",status:"Completed",duration:"0.8 hours"}],VYe=[{id:"ALT001",severity:"critical",message:"Temperature spike to 1580C",time:"2024-01-15 14:32",cause:"Gas flow interruption",resolution:"Restored gas supply"},{id:"ALT002",severity:"warning",message:"Vibration level 4.2 mm/s",time:"2024-01-15 13:45",cause:"Bearing wear",resolution:"Scheduled maintenance"},{id:"ALT003",severity:"info",message:"Power fluctuation detected",time:"2024-01-15 12:20",cause:"Grid instability",resolution:"Monitored and resolved"},{id:"ALT004",severity:"warning",message:"Door sensor malfunction",time:"2024-01-15 11:15",cause:"Sensor failure",resolution:"Replaced sensor"}];function FYe(){S.useState("F1");const[t,e]=S.useState("overview"),[n,i]=S.useState(!1),[r,s]=S.useState(50),o=a=>{switch(a){case"critical":return"text-red-600";case"warning":return"text-yellow-600";case"info":return"text-blue-600";default:return"text-gray-600"}};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-lg p-6 text-white",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center",children:g.jsx(Gf,{className:"w-8 h-8"})}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold",children:"Blast Furnace 1"}),g.jsxs("div",{className:"flex items-center gap-2 text-blue-100",children:[g.jsx(yle,{className:"w-4 h-4"}),g.jsx("span",{children:"Zone A - Production Line 1"})]})]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx(nn,{className:"bg-green-100 text-green-800 text-sm px-3 py-1 mb-2",children:"LIVE"}),g.jsx("div",{className:"text-blue-100 text-sm",children:"Last updated: 2 seconds ago"})]})]})}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{className:"pb-3",children:g.jsxs(nt,{className:"flex items-center gap-2 text-lg",children:[g.jsx(Ud,{className:"w-5 h-5 text-red-600"}),"Temperature"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-4",children:[g.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[g.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),g.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#ef4444",strokeWidth:"8",strokeDasharray:`${1420/1600*251.2} 251.2`,strokeLinecap:"round"})]}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-xl font-bold",children:"1420"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"C"})]})})]}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Target: 1450C"})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{className:"pb-3",children:g.jsxs(nt,{className:"flex items-center gap-2 text-lg",children:[g.jsx(to,{className:"w-5 h-5 text-yellow-600"}),"Power Usage"]})}),g.jsxs(ke,{children:[g.jsx(Ai,{width:"100%",height:120,children:g.jsx(Ds,{data:NYe,children:g.jsx(jn,{type:"monotone",dataKey:"current",stroke:"#eab308",strokeWidth:2,dot:!1})})}),g.jsxs("div",{className:"text-center mt-2",children:[g.jsx("div",{className:"text-lg font-bold",children:"1,250 A"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Current"})]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{className:"pb-3",children:g.jsxs(nt,{className:"flex items-center gap-2 text-lg",children:[g.jsx(Xl,{className:"w-5 h-5 text-orange-600"}),"Emissions"]})}),g.jsxs(ke,{children:[g.jsx(Ai,{width:"100%",height:120,children:g.jsxs(VI,{data:WYe.slice(-3),children:[g.jsx(Gr,{dataKey:"nox",fill:"#ef4444"}),g.jsx(Gr,{dataKey:"co",fill:"#f97316"})]})}),g.jsxs("div",{className:"text-center mt-2",children:[g.jsx("div",{className:"text-lg font-bold",children:"45 ppm"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"NOx Level"})]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{className:"pb-3",children:g.jsxs(nt,{className:"flex items-center gap-2 text-lg",children:[g.jsx(CA,{className:"w-5 h-5 text-green-600"}),"Scrap Purity"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"94%"}),g.jsx(sC,{value:94,className:"mb-2"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Quality Score"})]})})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"System Health Overview"})}),g.jsx(ke,{children:g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:MYe.map((a,l)=>g.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[g.jsx("div",{className:`w-3 h-3 rounded-full mx-auto mb-2 ${a.status==="healthy"?"bg-green-500":a.status==="warning"?"bg-yellow-500":"bg-red-500"}`}),g.jsx("div",{className:"text-sm font-medium",children:a.name}),g.jsx("div",{className:"text-lg font-bold",children:a.value}),g.jsx("div",{className:"text-xs text-muted-foreground",children:a.location})]},l))})})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsxs(Ye,{className:"h-[600px]",children:[g.jsx(tt,{children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(Xc,{className:"w-5 h-5"}),"Digital Twin View"]}),g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs(Ml,{value:t,onValueChange:e,children:[g.jsx(za,{className:"w-32",children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"overview",children:"Overview"}),g.jsx(An,{value:"internal",children:"Internal"}),g.jsx(An,{value:"scrap",children:"Scrap Loading"}),g.jsx(An,{value:"cooling",children:"Cooling Path"})]})]})})]})}),g.jsx(ke,{className:"h-full",children:g.jsxs("div",{className:"relative h-full bg-gradient-to-br from-gray-900 to-gray-800 rounded-lg overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsxs("div",{className:"text-center text-white",children:[g.jsx(Gf,{className:`w-24 h-24 mx-auto mb-4 text-orange-400 ${t==="internal"?"animate-pulse":""}`}),g.jsx("div",{className:"text-2xl font-bold mb-2",children:"Blast Furnace 1"}),g.jsxs("div",{className:"text-sm opacity-75",children:[t==="overview"&&"Overview Camera",t==="internal"&&"Internal Furnace View",t==="scrap"&&"Scrap Loading Simulation",t==="cooling"&&"Cooling System View"]})]})}),t==="internal"&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-radial from-orange-500/20 via-transparent to-transparent animate-pulse"}),g.jsx("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 w-32 h-32 bg-gray-400/30 rounded-full blur-xl animate-bounce"})]}),t==="scrap"&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"absolute bottom-20 left-0 right-0 h-2 bg-gray-600",children:g.jsx("div",{className:"absolute inset-y-0 left-0 w-8 bg-orange-500 animate-pulse",style:{animation:"moveRight 3s linear infinite"}})}),g.jsx("div",{className:"absolute bottom-24 left-10 w-3 h-3 bg-gray-400 rounded animate-bounce"}),g.jsx("div",{className:"absolute bottom-24 left-20 w-2 h-2 bg-gray-500 rounded animate-bounce",style:{animationDelay:"0.5s"}}),g.jsx("div",{className:"absolute bottom-24 left-30 w-4 h-4 bg-gray-300 rounded animate-bounce",style:{animationDelay:"1s"}})]}),t==="cooling"&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-2 bg-blue-400 rounded animate-pulse"}),g.jsx("div",{className:"absolute top-1/3 right-1/4 w-24 h-2 bg-blue-400 rounded animate-pulse",style:{animationDelay:"0.5s"}}),g.jsx("div",{className:"absolute bottom-1/3 left-1/3 w-28 h-2 bg-blue-400 rounded animate-pulse",style:{animationDelay:"1s"}})]}),g.jsx("div",{className:"absolute top-1/4 left-1/4 w-4 h-4 bg-red-500 rounded-full animate-pulse",children:g.jsxs("div",{className:"absolute -top-20 left-1/2 transform -translate-x-1/2 bg-black/90 text-white text-xs p-3 rounded-lg shadow-lg min-w-32",children:[g.jsx("div",{className:"font-medium mb-1",children:"Temperature Sensor"}),g.jsx("div",{className:"text-orange-400 font-bold",children:"1420C"}),g.jsx("div",{className:"text-xs opacity-75",children:"Target: 1450C"})]})}),g.jsx("div",{className:"absolute top-1/3 right-1/3 w-4 h-4 bg-yellow-500 rounded-full animate-pulse",children:g.jsxs("div",{className:"absolute -top-20 left-1/2 transform -translate-x-1/2 bg-black/90 text-white text-xs p-3 rounded-lg shadow-lg min-w-32",children:[g.jsx("div",{className:"font-medium mb-1",children:"Vibration Monitor"}),g.jsx("div",{className:"text-yellow-400 font-bold",children:"3.2 mm/s"}),g.jsx("div",{className:"text-xs opacity-75",children:"Threshold: 5.0 mm/s"})]})}),g.jsx("div",{className:"absolute bottom-1/3 left-1/3 w-4 h-4 bg-blue-500 rounded-full animate-pulse",children:g.jsxs("div",{className:"absolute -top-20 left-1/2 transform -translate-x-1/2 bg-black/90 text-white text-xs p-3 rounded-lg shadow-lg min-w-32",children:[g.jsx("div",{className:"font-medium mb-1",children:"Gas Flow Sensor"}),g.jsx("div",{className:"text-blue-400 font-bold",children:"98%"}),g.jsx("div",{className:"text-xs opacity-75",children:"O2 Concentration"})]})}),g.jsx("div",{className:"absolute top-1/2 right-1/4 w-4 h-4 bg-green-500 rounded-full animate-pulse",children:g.jsxs("div",{className:"absolute -top-20 left-1/2 transform -translate-x-1/2 bg-black/90 text-white text-xs p-3 rounded-lg shadow-lg min-w-32",children:[g.jsx("div",{className:"font-medium mb-1",children:"Pressure Monitor"}),g.jsx("div",{className:"text-green-400 font-bold",children:"2.4 bar"}),g.jsx("div",{className:"text-xs opacity-75",children:"System Pressure"})]})}),g.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center justify-between",children:[g.jsxs("div",{className:"flex gap-2",children:[g.jsxs(Mt,{variant:"secondary",size:"sm",children:[g.jsx($D,{className:"w-4 h-4 mr-1"}),"Rotate"]}),g.jsxs(Mt,{variant:"secondary",size:"sm",children:[g.jsx(to,{className:"w-4 h-4 mr-1"}),"Zoom"]}),g.jsxs(Mt,{variant:"secondary",size:"sm",children:[g.jsx(Xc,{className:"w-4 h-4 mr-1"}),"Reset"]})]}),g.jsxs("div",{className:"flex items-center gap-2 bg-black/50 rounded-lg p-2",children:[g.jsx(Mt,{variant:"ghost",size:"sm",onClick:()=>s(Math.max(0,r-10)),children:g.jsx(eU,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"ghost",size:"sm",onClick:()=>i(!n),children:n?g.jsx(R2,{className:"w-4 h-4"}):g.jsx(N2,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"ghost",size:"sm",onClick:()=>s(Math.min(100,r+10)),children:g.jsx(tU,{className:"w-4 h-4"})}),g.jsx("div",{className:"w-24 mx-2",children:g.jsx(wc,{value:[r],onValueChange:a=>s(a[0]),max:100,step:1,className:"w-full"})}),g.jsxs("span",{className:"text-xs text-white font-mono w-12",children:[Math.floor(r*24/100),":00"]})]})]}),g.jsxs("div",{className:"absolute top-4 left-4 bg-black/70 text-white text-xs p-2 rounded",children:[g.jsxs("div",{children:["Camera: ",t.charAt(0).toUpperCase()+t.slice(1)]}),g.jsxs("div",{children:["Time: ",new Date().toLocaleTimeString()]}),g.jsx("div",{children:"Status: Live Feed"})]}),g.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white text-xs p-2 rounded",children:[g.jsx("div",{children:"FPS: 60"}),g.jsx("div",{children:"Latency: 45ms"}),g.jsx("div",{children:"Quality: High"})]})]})})]})}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Real-time Metrics"})}),g.jsx(ke,{className:"space-y-4",children:g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx(Ud,{className:"w-6 h-6 mx-auto mb-2 text-red-600"}),g.jsx("div",{className:"text-lg font-bold",children:"1420C"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Temperature"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx(to,{className:"w-6 h-6 mx-auto mb-2 text-yellow-600"}),g.jsx("div",{className:"text-lg font-bold",children:"1250 A"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Current"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx(Xl,{className:"w-6 h-6 mx-auto mb-2 text-green-600"}),g.jsx("div",{className:"text-lg font-bold",children:"94%"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Purity"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx(CA,{className:"w-6 h-6 mx-auto mb-2 text-blue-600"}),g.jsx("div",{className:"text-lg font-bold",children:"45 ppm"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Emissions"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Furnace Controls"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium",children:"Power Level (%)"}),g.jsx(wc,{defaultValue:[85],max:100,step:1,className:"mt-2"}),g.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Current: 85%"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium",children:"Oxygen Flow (%)"}),g.jsx(wc,{defaultValue:[92],max:100,step:1,className:"mt-2"}),g.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Current: 92%"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium",children:"Input Rate (tons/h)"}),g.jsx(wc,{defaultValue:[45],max:60,step:1,className:"mt-2"}),g.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Current: 45 tons/h"})]}),g.jsxs("div",{className:"flex gap-2 pt-2",children:[g.jsx(Mt,{className:"flex-1",children:"Apply Changes"}),g.jsxs(lYe,{children:[g.jsx(cYe,{asChild:!0,children:g.jsxs(Mt,{variant:"destructive",className:"flex-1",children:[g.jsx(vle,{className:"w-4 h-4 mr-2"}),"Emergency Stop"]})}),g.jsxs(Jq,{children:[g.jsx(Qq,{children:g.jsxs(qq,{className:"flex items-center gap-2 text-red-600",children:[g.jsx(gr,{className:"w-5 h-5"}),"Emergency Shutdown"]})}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[g.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Safety Checklist"}),g.jsx("div",{className:"space-y-2",children:["Confirm all personnel are clear of danger zone","Verify emergency evacuation routes are clear","Check that all access doors are secured","Ensure backup power systems are active","Confirm emergency communication systems working"].map((a,l)=>g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Gle,{className:"w-4 h-4 text-red-600"}),g.jsx("span",{className:"text-sm",children:a})]},l))})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx(Mt,{variant:"outline",className:"flex-1",children:"Cancel"}),g.jsx(Mt,{variant:"destructive",className:"flex-1",children:"Confirm Emergency Shutdown"})]})]})]})]})]})]})]})]})]}),g.jsxs(VC,{defaultValue:"maintenance",className:"space-y-6",children:[g.jsxs(hh,{className:"grid w-full grid-cols-3",children:[g.jsx(di,{value:"maintenance",children:"Maintenance Timeline"}),g.jsx(di,{value:"alerts",children:"Alerts History"}),g.jsx(di,{value:"performance",children:"Performance Logs"})]}),g.jsx(ri,{value:"maintenance",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(ZC,{className:"w-5 h-5"}),"Maintenance Timeline & Repair Logs"]})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-6",children:qK.map((a,l)=>g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),l<qK.length-1&&g.jsx("div",{className:"w-0.5 h-16 bg-gray-200 mt-2"})]}),g.jsxs("div",{className:"flex-1 pb-6",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(l5,{className:"w-4 h-4 text-muted-foreground"}),g.jsx("span",{className:"font-medium",children:a.date}),g.jsx(nn,{variant:"outline",children:a.type})]}),g.jsx(nn,{variant:"outline",className:"text-green-600",children:a.status})]}),g.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-100",children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Component:"}),g.jsx("div",{className:"font-medium",children:a.component})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Technician:"}),g.jsx("div",{className:"font-medium",children:a.technician})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),g.jsx("div",{className:"font-medium",children:a.duration})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Status:"}),g.jsx("div",{className:"font-medium text-green-600",children:a.status})]})]})})]})]},l))})})]})}),g.jsx(ri,{value:"alerts",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(gr,{className:"w-5 h-5"}),"Alerts History & Cause Analysis"]})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:VYe.map(a=>g.jsxs("div",{className:"border rounded-lg p-4",children:[g.jsxs("div",{className:"flex items-start justify-between mb-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(gr,{className:`w-5 h-5 ${o(a.severity)}`}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:a.message}),g.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[g.jsx(qD,{className:"w-3 h-3"}),a.time]})]})]}),g.jsx(nn,{className:o(a.severity)+" border-current",children:a.severity})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Cause:"}),g.jsx("div",{className:"font-medium mt-1",children:a.cause})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-muted-foreground",children:"Resolution:"}),g.jsx("div",{className:"font-medium mt-1 text-green-600",children:a.resolution})]})]})]},a.id))})})]})}),g.jsx(ri,{value:"performance",children:g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Performance Trends"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Kq,{data:[{time:"00:00",efficiency:91,production:1850},{time:"06:00",efficiency:93,production:1920},{time:"12:00",efficiency:89,production:1780},{time:"16:00",efficiency:95,production:2010}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{yAxisId:"left"}),g.jsx(ii,{yAxisId:"right",orientation:"right"}),g.jsx(qn,{}),g.jsx(xs,{yAxisId:"left",type:"monotone",dataKey:"efficiency",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Efficiency (%)"}),g.jsx(xs,{yAxisId:"right",type:"monotone",dataKey:"production",stackId:"2",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.6,name:"Production (tons)"})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"System Logs"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[{time:"14:32:15",level:"INFO",message:"Furnace temperature stabilized at 1420C"},{time:"14:28:42",level:"WARN",message:"Vibration level increased to 3.2 mm/s"},{time:"14:25:18",level:"INFO",message:"Scrap batch S-2024-001 processing started"},{time:"14:20:33",level:"INFO",message:"Energy optimization mode activated"},{time:"14:15:27",level:"INFO",message:"Operator login: John Smith"},{time:"14:10:12",level:"INFO",message:"Maintenance check completed successfully"},{time:"14:05:48",level:"WARN",message:"Gas pressure fluctuation detected"},{time:"14:00:15",level:"INFO",message:"Daily production target achieved"}].map((a,l)=>g.jsxs("div",{className:"flex gap-3 text-sm",children:[g.jsx("span",{className:"text-muted-foreground font-mono w-12",children:a.time}),g.jsx(nn,{variant:a.level==="ERROR"?"destructive":a.level==="WARN"?"secondary":"outline",className:"w-12 justify-center",children:a.level}),g.jsx("span",{className:"flex-1",children:a.message})]},l))})})]})]})})]})]})}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const mh="181",sd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},od={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},h$=0,w3=1,I$=2,_Ye=3,f$=0,OB=1,Km=2,Na=3,Lc=0,Bs=1,rs=2,Da=0,Xd=1,G3=2,B3=3,S3=4,C$=5,Gg=100,p$=101,m$=102,A$=103,y$=104,b$=200,v$=201,x$=202,w$=203,yG=204,bG=205,G$=206,B$=207,S$=208,Z$=209,R$=210,N$=211,W$=212,M$=213,V$=214,vG=0,xG=1,wG=2,rh=3,GG=4,BG=5,SG=6,ZG=7,$0=0,F$=1,_$=2,Tl=0,T$=1,X$=2,E$=3,qF=4,Y$=5,k$=6,H$=7,Z3="attached",K$="detached",au=300,kl=301,lu=302,oC=303,i0=304,QC=306,aC=1e3,Vi=1001,lC=1002,Sr=1003,DB=1004,TYe=1004,yd=1005,XYe=1005,Ln=1006,$I=1007,EYe=1007,ka=1008,R3=1008,Ss=1009,UB=1010,JB=1011,cC=1012,ey=1013,Hl=1014,Fi=1015,hr=1016,QB=1017,qB=1018,gC=1020,$F=35902,e_=35899,t_=1021,n_=1022,Ki=1023,uC=1026,dC=1027,ty=1028,ny=1029,$B=1030,eS=1031,YYe=1032,tS=1033,Lm=33776,zm=33777,jm=33778,Pm=33779,RG=35840,NG=35841,WG=35842,MG=35843,VG=36196,FG=37492,_G=37496,TG=37808,XG=37809,EG=37810,YG=37811,kG=37812,HG=37813,KG=37814,LG=37815,zG=37816,jG=37817,PG=37818,OG=37819,DG=37820,UG=37821,JG=36492,QG=36494,qG=36495,$G=36283,e2=36284,t2=36285,n2=36286,L$=2200,z$=2201,j$=2202,hC=2300,r0=2301,vx=2302,bd=2400,vd=2401,s0=2402,nS=2500,i_=2501,kYe=0,HYe=1,KYe=2,P$=3200,O$=3201,LYe=3202,zYe=3203,wu=0,D$=1,Gl="",ts="srgb",Kl="srgb-linear",o0="linear",Qn="srgb",jYe=0,ad=7680,PYe=7681,OYe=7682,DYe=7683,UYe=34055,JYe=34056,QYe=5386,qYe=512,$Ye=513,eke=514,tke=515,nke=516,ike=517,rke=518,N3=519,U$=512,J$=513,Q$=514,r_=515,q$=516,$$=517,eee=518,tee=519,a0=35044,ske=35048,oke=35040,ake=35045,lke=35049,cke=35041,gke=35046,uke=35050,dke=35042,hke="100",W3="300 es",yo=2e3,IC=2001,Ike={COMPUTE:"compute",RENDER:"render"},fke={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Cke={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function nee(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const pke={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function FI(t,e){return new pke[t](e)}function l0(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function iee(){const t=l0("canvas");return t.style.display="block",t}const $K={};let cu=null;function mke(t){cu=t}function Ake(){return cu}function c0(...t){const e="THREE."+t.shift();cu?cu("log",e,...t):console.log(e,...t)}function vt(...t){const e="THREE."+t.shift();cu?cu("warn",e,...t):console.warn(e,...t)}function on(...t){const e="THREE."+t.shift();cu?cu("error",e,...t):console.error(e,...t)}function fC(...t){const e=t.join(" ");e in $K||($K[e]=!0,vt(...t))}function yke(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}let Ol=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const Pr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let eL=1234567;const Ed=Math.PI/180,CC=180/Math.PI;function Go(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Pr[t&255]+Pr[t>>8&255]+Pr[t>>16&255]+Pr[t>>24&255]+"-"+Pr[e&255]+Pr[e>>8&255]+"-"+Pr[e>>16&15|64]+Pr[e>>24&255]+"-"+Pr[n&63|128]+Pr[n>>8&255]+"-"+Pr[n>>16&255]+Pr[n>>24&255]+Pr[i&255]+Pr[i>>8&255]+Pr[i>>16&255]+Pr[i>>24&255]).toLowerCase()}function sn(t,e,n){return Math.max(e,Math.min(n,t))}function s_(t,e){return(t%e+e)%e}function bke(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function vke(t,e,n){return t!==e?(n-t)/(e-t):0}function Om(t,e,n){return(1-n)*t+n*e}function xke(t,e,n,i){return Om(t,e,1-Math.exp(-n*i))}function wke(t,e=1){return e-Math.abs(s_(t,e*2)-e)}function Gke(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Bke(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Ske(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Zke(t,e){return t+Math.random()*(e-t)}function Rke(t){return t*(.5-Math.random())}function Nke(t){t!==void 0&&(eL=t);let e=eL+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Wke(t){return t*Ed}function Mke(t){return t*CC}function Vke(t){return(t&t-1)===0&&t!==0}function Fke(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function _ke(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Tke(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),h=o((e-i)/2),I=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(a*u,l*d,l*h,a*c);break;case"YZY":t.set(l*h,a*u,l*d,a*c);break;case"ZXZ":t.set(l*d,l*h,a*u,a*c);break;case"XZX":t.set(a*u,l*p,l*I,a*c);break;case"YXY":t.set(l*I,a*u,l*p,a*c);break;case"ZYZ":t.set(l*p,l*I,a*u,a*c);break;default:vt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function As(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function In(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const pC={DEG2RAD:Ed,RAD2DEG:CC,generateUUID:Go,clamp:sn,euclideanModulo:s_,mapLinear:bke,inverseLerp:vke,lerp:Om,damp:xke,pingpong:wke,smoothstep:Gke,smootherstep:Bke,randInt:Ske,randFloat:Zke,randFloatSpread:Rke,seededRandom:Nke,degToRad:Wke,radToDeg:Mke,isPowerOfTwo:Vke,ceilPowerOfTwo:Fke,floorPowerOfTwo:_ke,setQuaternionFromProperEuler:Tke,normalize:In,denormalize:As};class He{constructor(e=0,n=0){He.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=sn(this.x,e.x,n.x),this.y=sn(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=sn(this.x,e,n),this.y=sn(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(sn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(sn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}let Zr=class{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3],h=s[o+0],I=s[o+1],p=s[o+2],y=s[o+3];if(a<=0){e[n+0]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d;return}if(a>=1){e[n+0]=h,e[n+1]=I,e[n+2]=p,e[n+3]=y;return}if(d!==y||l!==h||c!==I||u!==p){let A=l*h+c*I+u*p+d*y;A<0&&(h=-h,I=-I,p=-p,y=-y,A=-A);let m=1-a;if(A<.9995){const b=Math.acos(A),v=Math.sin(b);m=Math.sin(m*b)/v,a=Math.sin(a*b)/v,l=l*m+h*a,c=c*m+I*a,u=u*m+p*a,d=d*m+y*a}else{l=l*m+h*a,c=c*m+I*a,u=u*m+p*a,d=d*m+y*a;const b=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=b,c*=b,u*=b,d*=b}}e[n]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],I=s[o+2],p=s[o+3];return e[n]=a*p+u*d+l*I-c*h,e[n+1]=l*p+u*h+c*d-a*I,e[n+2]=c*p+u*I+a*h-l*d,e[n+3]=u*p-a*d-l*h-c*I,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),I=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*I*p,this._y=c*I*d-h*u*p,this._z=c*u*p+h*I*d,this._w=c*u*d-h*I*p;break;case"YXZ":this._x=h*u*d+c*I*p,this._y=c*I*d-h*u*p,this._z=c*u*p-h*I*d,this._w=c*u*d+h*I*p;break;case"ZXY":this._x=h*u*d-c*I*p,this._y=c*I*d+h*u*p,this._z=c*u*p+h*I*d,this._w=c*u*d-h*I*p;break;case"ZYX":this._x=h*u*d-c*I*p,this._y=c*I*d+h*u*p,this._z=c*u*p-h*I*d,this._w=c*u*d+h*I*p;break;case"YZX":this._x=h*u*d+c*I*p,this._y=c*I*d+h*u*p,this._z=c*u*p-h*I*d,this._w=c*u*d-h*I*p;break;case"XZY":this._x=h*u*d-c*I*p,this._y=c*I*d-h*u*p,this._z=c*u*p+h*I*d,this._w=c*u*d+h*I*p;break;default:vt("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],u=n[6],d=n[10],h=i+a+d;if(h>0){const I=.5/Math.sqrt(h+1);this._w=.25/I,this._x=(u-l)*I,this._y=(s-c)*I,this._z=(o-r)*I}else if(i>a&&i>d){const I=2*Math.sqrt(1+i-a-d);this._w=(u-l)/I,this._x=.25*I,this._y=(r+o)/I,this._z=(s+c)/I}else if(a>d){const I=2*Math.sqrt(1+a-i-d);this._w=(s-c)/I,this._x=(r+o)/I,this._y=.25*I,this._z=(l+u)/I}else{const I=2*Math.sqrt(1+d-i-a);this._w=(o-r)/I,this._x=(s+c)/I,this._y=(l+u)/I,this._z=.25*I}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(sn(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,u=n._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n<=0)return this;if(n>=1)return this.copy(e);let i=e._x,r=e._y,s=e._z,o=e._w,a=this.dot(e);a<0&&(i=-i,r=-r,s=-s,o=-o,a=-a);let l=1-n;if(a<.9995){const c=Math.acos(a),u=Math.sin(c);l=Math.sin(l*c)/u,n=Math.sin(n*c)/u,this._x=this._x*l+i*n,this._y=this._y*l+r*n,this._z=this._z*l+s*n,this._w=this._w*l+o*n,this._onChangeCallback()}else this._x=this._x*l+i*n,this._y=this._y*l+r*n,this._z=this._z*l+s*n,this._w=this._w*l+o*n,this.normalize();return this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class J{constructor(e=0,n=0,i=0){J.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(tL.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(tL.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*n-s*r),d=2*(s*i-o*n);return this.x=n+l*c+o*d-a*u,this.y=i+l*u+a*c-s*d,this.z=r+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=sn(this.x,e.x,n.x),this.y=sn(this.y,e.y,n.y),this.z=sn(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=sn(this.x,e,n),this.y=sn(this.y,e,n),this.z=sn(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(sn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return iR.copy(this).projectOnVector(e),this.sub(iR)}reflect(e){return this.sub(iR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(sn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const iR=new J,tL=new Zr;class hn{constructor(e,n,i,r,s,o,a,l,c){hn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,c)}set(e,n,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=n,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],I=i[5],p=i[8],y=r[0],A=r[3],m=r[6],b=r[1],v=r[4],w=r[7],x=r[2],B=r[5],Z=r[8];return s[0]=o*y+a*b+l*x,s[3]=o*A+a*v+l*B,s[6]=o*m+a*w+l*Z,s[1]=c*y+u*b+d*x,s[4]=c*A+u*v+d*B,s[7]=c*m+u*w+d*Z,s[2]=h*y+I*b+p*x,s[5]=h*A+I*v+p*B,s[8]=h*m+I*w+p*Z,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return n*o*u-n*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,I=c*s-o*l,p=n*d+i*h+r*I;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/p;return e[0]=d*y,e[1]=(r*c-u*i)*y,e[2]=(a*i-r*o)*y,e[3]=h*y,e[4]=(u*n-r*l)*y,e[5]=(r*s-a*n)*y,e[6]=I*y,e[7]=(i*l-c*n)*y,e[8]=(o*n-i*s)*y,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(rR.makeScale(e,n)),this}rotate(e){return this.premultiply(rR.makeRotation(-e)),this}translate(e,n){return this.premultiply(rR.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const rR=new hn,nL=new hn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),iL=new hn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Xke(){const t={enabled:!0,workingColorSpace:Kl,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===Qn&&(r.r=Wc(r.r),r.g=Wc(r.g),r.b=Wc(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Qn&&(r.r=ef(r.r),r.g=ef(r.g),r.b=ef(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Gl?o0:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return fC("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return fC("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Kl]:{primaries:e,whitePoint:i,transfer:o0,toXYZ:nL,fromXYZ:iL,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:ts},outputColorSpaceConfig:{drawingBufferColorSpace:ts}},[ts]:{primaries:e,whitePoint:i,transfer:Qn,toXYZ:nL,fromXYZ:iL,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:ts}}}),t}const Fn=Xke();function Wc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function ef(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Ph;class o_{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Ph===void 0&&(Ph=l0("canvas")),Ph.width=e.width,Ph.height=e.height;const r=Ph.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=Ph}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=l0("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Wc(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(Wc(n[i]/255)*255):n[i]=Wc(n[i]);return{data:n,width:e.width,height:e.height}}else return vt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Eke=0;class Gc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Eke++}),this.uuid=Go(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const n=this.data;return typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight,0):n instanceof VideoFrame?e.set(n.displayHeight,n.displayWidth,0):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(sR(r[o].image)):s.push(sR(r[o]))}else s=sR(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function sR(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?o_.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(vt("Texture: Unable to serialize Texture."),{})}let Yke=0;const oR=new J;class $n extends Ol{constructor(e=$n.DEFAULT_IMAGE,n=$n.DEFAULT_MAPPING,i=Vi,r=Vi,s=Ln,o=ka,a=Ki,l=Ss,c=$n.DEFAULT_ANISOTROPY,u=Gl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yke++}),this.uuid=Go(),this.name="",this.source=new Gc(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new He(0,0),this.repeat=new He(1,1),this.center=new He(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new hn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(oR).x}get height(){return this.source.getSize(oR).y}get depth(){return this.source.getSize(oR).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const n in e){const i=e[n];if(i===void 0){vt(`Texture.setValues(): parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){vt(`Texture.setValues(): property '${n}' does not exist.`);continue}r&&i&&r.isVector2&&i.isVector2||r&&i&&r.isVector3&&i.isVector3||r&&i&&r.isMatrix3&&i.isMatrix3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==au)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case aC:e.x=e.x-Math.floor(e.x);break;case Vi:e.x=e.x<0?0:1;break;case lC:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case aC:e.y=e.y-Math.floor(e.y);break;case Vi:e.y=e.y<0?0:1;break;case lC:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}$n.DEFAULT_IMAGE=null;$n.DEFAULT_MAPPING=au;$n.DEFAULT_ANISOTROPY=1;class _n{constructor(e=0,n=0,i=0,r=1){_n.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],I=l[5],p=l[9],y=l[2],A=l[6],m=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-y)<.01&&Math.abs(p-A)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+y)<.1&&Math.abs(p+A)<.1&&Math.abs(c+I+m-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const v=(c+1)/2,w=(I+1)/2,x=(m+1)/2,B=(u+h)/4,Z=(d+y)/4,N=(p+A)/4;return v>w&&v>x?v<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(v),r=B/i,s=Z/i):w>x?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=B/r,s=N/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=Z/s,r=N/s),this.set(i,r,s,n),this}let b=Math.sqrt((A-p)*(A-p)+(d-y)*(d-y)+(h-u)*(h-u));return Math.abs(b)<.001&&(b=1),this.x=(A-p)/b,this.y=(d-y)/b,this.z=(h-u)/b,this.w=Math.acos((c+I+m-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=sn(this.x,e.x,n.x),this.y=sn(this.y,e.y,n.y),this.z=sn(this.z,e.z,n.z),this.w=sn(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=sn(this.x,e,n),this.y=sn(this.y,e,n),this.z=sn(this.z,e,n),this.w=sn(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(sn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class a_ extends Ol{constructor(e=1,n=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ln,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth,this.scissor=new _n(0,0,e,n),this.scissorTest=!1,this.viewport=new _n(0,0,e,n);const r={width:e,height:n,depth:i.depth},s=new $n(r);this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const n={minFilter:Ln,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},e.textures[n].image);this.textures[n].source=new Gc(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ga extends a_{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class iS extends $n{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Sr,this.minFilter=Sr,this.wrapR=Vi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class kke extends ga{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new iS(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class rS extends $n{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Sr,this.minFilter=Sr,this.wrapR=Vi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Hke extends ga{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new rS(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class ss{constructor(e=new J(1/0,1/0,1/0),n=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(ba.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(ba.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=ba.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ba):ba.fromBufferAttribute(s,o),ba.applyMatrix4(e.matrixWorld),this.expandByPoint(ba);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ub.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Ub.copy(i.boundingBox)),Ub.applyMatrix4(e.matrixWorld),this.union(Ub)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ba),ba.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(kp),Jb.subVectors(this.max,kp),Oh.subVectors(e.a,kp),Dh.subVectors(e.b,kp),Uh.subVectors(e.c,kp),ag.subVectors(Dh,Oh),lg.subVectors(Uh,Dh),ku.subVectors(Oh,Uh);let n=[0,-ag.z,ag.y,0,-lg.z,lg.y,0,-ku.z,ku.y,ag.z,0,-ag.x,lg.z,0,-lg.x,ku.z,0,-ku.x,-ag.y,ag.x,0,-lg.y,lg.x,0,-ku.y,ku.x,0];return!aR(n,Oh,Dh,Uh,Jb)||(n=[1,0,0,0,1,0,0,0,1],!aR(n,Oh,Dh,Uh,Jb))?!1:(Qb.crossVectors(ag,lg),n=[Qb.x,Qb.y,Qb.z],aR(n,Oh,Dh,Uh,Jb))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ba).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ba).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(sc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),sc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),sc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),sc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),sc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),sc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),sc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),sc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(sc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const sc=[new J,new J,new J,new J,new J,new J,new J,new J],ba=new J,Ub=new ss,Oh=new J,Dh=new J,Uh=new J,ag=new J,lg=new J,ku=new J,kp=new J,Jb=new J,Qb=new J,Hu=new J;function aR(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Hu.fromArray(t,s);const a=r.x*Math.abs(Hu.x)+r.y*Math.abs(Hu.y)+r.z*Math.abs(Hu.z),l=e.dot(Hu),c=n.dot(Hu),u=i.dot(Hu);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const Kke=new ss,Hp=new J,lR=new J;class Tr{constructor(e=new J,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Kke.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Hp.subVectors(e,this.center);const n=Hp.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(Hp,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(lR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Hp.copy(e.center).add(lR)),this.expandByPoint(Hp.copy(e.center).sub(lR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const oc=new J,cR=new J,qb=new J,cg=new J,gR=new J,$b=new J,uR=new J;let Ah=class{constructor(e=new J,n=new J(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,oc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=oc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(oc.copy(this.origin).addScaledVector(this.direction,n),oc.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){cR.copy(e).add(n).multiplyScalar(.5),qb.copy(n).sub(e).normalize(),cg.copy(this.origin).sub(cR);const s=e.distanceTo(n)*.5,o=-this.direction.dot(qb),a=cg.dot(this.direction),l=-cg.dot(qb),c=cg.lengthSq(),u=Math.abs(1-o*o);let d,h,I,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const y=1/u;d*=y,h*=y,I=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),I=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),I=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),I=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),I=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),I=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),I=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(cR).addScaledVector(qb,h),I}intersectSphere(e,n){oc.subVectors(e.center,this.origin);const i=oc.dot(this.direction),r=oc.dot(oc)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,oc)!==null}intersectTriangle(e,n,i,r,s){gR.subVectors(n,e),$b.subVectors(i,e),uR.crossVectors(gR,$b);let o=this.direction.dot(uR),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;cg.subVectors(this.origin,e);const l=a*this.direction.dot($b.crossVectors(cg,$b));if(l<0)return null;const c=a*this.direction.dot(gR.cross(cg));if(c<0||l+c>o)return null;const u=-a*cg.dot(uR);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class Qt{constructor(e,n,i,r,s,o,a,l,c,u,d,h,I,p,y,A){Qt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,l,c,u,d,h,I,p,y,A)}set(e,n,i,r,s,o,a,l,c,u,d,h,I,p,y,A){const m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=u,m[10]=d,m[14]=h,m[3]=I,m[7]=p,m[11]=y,m[15]=A,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qt().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Jh.setFromMatrixColumn(e,0).length(),s=1/Jh.setFromMatrixColumn(e,1).length(),o=1/Jh.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const h=o*u,I=o*d,p=a*u,y=a*d;n[0]=l*u,n[4]=-l*d,n[8]=c,n[1]=I+p*c,n[5]=h-y*c,n[9]=-a*l,n[2]=y-h*c,n[6]=p+I*c,n[10]=o*l}else if(e.order==="YXZ"){const h=l*u,I=l*d,p=c*u,y=c*d;n[0]=h+y*a,n[4]=p*a-I,n[8]=o*c,n[1]=o*d,n[5]=o*u,n[9]=-a,n[2]=I*a-p,n[6]=y+h*a,n[10]=o*l}else if(e.order==="ZXY"){const h=l*u,I=l*d,p=c*u,y=c*d;n[0]=h-y*a,n[4]=-o*d,n[8]=p+I*a,n[1]=I+p*a,n[5]=o*u,n[9]=y-h*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const h=o*u,I=o*d,p=a*u,y=a*d;n[0]=l*u,n[4]=p*c-I,n[8]=h*c+y,n[1]=l*d,n[5]=y*c+h,n[9]=I*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const h=o*l,I=o*c,p=a*l,y=a*c;n[0]=l*u,n[4]=y-h*d,n[8]=p*d+I,n[1]=d,n[5]=o*u,n[9]=-a*u,n[2]=-c*u,n[6]=I*d+p,n[10]=h-y*d}else if(e.order==="XZY"){const h=o*l,I=o*c,p=a*l,y=a*c;n[0]=l*u,n[4]=-d,n[8]=c*u,n[1]=h*d+y,n[5]=o*u,n[9]=I*d-p,n[2]=p*d-I,n[6]=a*u,n[10]=y*d+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Lke,e,zke)}lookAt(e,n,i){const r=this.elements;return co.subVectors(e,n),co.lengthSq()===0&&(co.z=1),co.normalize(),gg.crossVectors(i,co),gg.lengthSq()===0&&(Math.abs(i.z)===1?co.x+=1e-4:co.z+=1e-4,co.normalize(),gg.crossVectors(i,co)),gg.normalize(),ev.crossVectors(co,gg),r[0]=gg.x,r[4]=ev.x,r[8]=co.x,r[1]=gg.y,r[5]=ev.y,r[9]=co.y,r[2]=gg.z,r[6]=ev.z,r[10]=co.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],I=i[13],p=i[2],y=i[6],A=i[10],m=i[14],b=i[3],v=i[7],w=i[11],x=i[15],B=r[0],Z=r[4],N=r[8],W=r[12],M=r[1],F=r[5],T=r[9],H=r[13],K=r[2],z=r[6],j=r[10],O=r[14],_=r[3],E=r[7],P=r[11],q=r[15];return s[0]=o*B+a*M+l*K+c*_,s[4]=o*Z+a*F+l*z+c*E,s[8]=o*N+a*T+l*j+c*P,s[12]=o*W+a*H+l*O+c*q,s[1]=u*B+d*M+h*K+I*_,s[5]=u*Z+d*F+h*z+I*E,s[9]=u*N+d*T+h*j+I*P,s[13]=u*W+d*H+h*O+I*q,s[2]=p*B+y*M+A*K+m*_,s[6]=p*Z+y*F+A*z+m*E,s[10]=p*N+y*T+A*j+m*P,s[14]=p*W+y*H+A*O+m*q,s[3]=b*B+v*M+w*K+x*_,s[7]=b*Z+v*F+w*z+x*E,s[11]=b*N+v*T+w*j+x*P,s[15]=b*W+v*H+w*O+x*q,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],I=e[14],p=e[3],y=e[7],A=e[11],m=e[15];return p*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*I-i*l*I)+y*(+n*l*I-n*c*h+s*o*h-r*o*I+r*c*u-s*l*u)+A*(+n*c*d-n*a*I-s*o*d+i*o*I+s*a*u-i*c*u)+m*(-r*a*u-n*l*d+n*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],I=e[11],p=e[12],y=e[13],A=e[14],m=e[15],b=d*A*c-y*h*c+y*l*I-a*A*I-d*l*m+a*h*m,v=p*h*c-u*A*c-p*l*I+o*A*I+u*l*m-o*h*m,w=u*y*c-p*d*c+p*a*I-o*y*I-u*a*m+o*d*m,x=p*d*l-u*y*l-p*a*h+o*y*h+u*a*A-o*d*A,B=n*b+i*v+r*w+s*x;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Z=1/B;return e[0]=b*Z,e[1]=(y*h*s-d*A*s-y*r*I+i*A*I+d*r*m-i*h*m)*Z,e[2]=(a*A*s-y*l*s+y*r*c-i*A*c-a*r*m+i*l*m)*Z,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*I-i*l*I)*Z,e[4]=v*Z,e[5]=(u*A*s-p*h*s+p*r*I-n*A*I-u*r*m+n*h*m)*Z,e[6]=(p*l*s-o*A*s-p*r*c+n*A*c+o*r*m-n*l*m)*Z,e[7]=(o*h*s-u*l*s+u*r*c-n*h*c-o*r*I+n*l*I)*Z,e[8]=w*Z,e[9]=(p*d*s-u*y*s-p*i*I+n*y*I+u*i*m-n*d*m)*Z,e[10]=(o*y*s-p*a*s+p*i*c-n*y*c-o*i*m+n*a*m)*Z,e[11]=(u*a*s-o*d*s-u*i*c+n*d*c+o*i*I-n*a*I)*Z,e[12]=x*Z,e[13]=(u*y*r-p*d*r+p*i*h-n*y*h-u*i*A+n*d*A)*Z,e[14]=(p*a*r-o*y*r-p*i*l+n*y*l+o*i*A-n*a*A)*Z,e[15]=(o*d*r-u*a*r+u*i*l-n*d*l-o*i*h+n*a*h)*Z,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,u=o+o,d=a+a,h=s*c,I=s*u,p=s*d,y=o*u,A=o*d,m=a*d,b=l*c,v=l*u,w=l*d,x=i.x,B=i.y,Z=i.z;return r[0]=(1-(y+m))*x,r[1]=(I+w)*x,r[2]=(p-v)*x,r[3]=0,r[4]=(I-w)*B,r[5]=(1-(h+m))*B,r[6]=(A+b)*B,r[7]=0,r[8]=(p+v)*Z,r[9]=(A-b)*Z,r[10]=(1-(h+y))*Z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=Jh.set(r[0],r[1],r[2]).length();const o=Jh.set(r[4],r[5],r[6]).length(),a=Jh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],va.copy(this);const c=1/s,u=1/o,d=1/a;return va.elements[0]*=c,va.elements[1]*=c,va.elements[2]*=c,va.elements[4]*=u,va.elements[5]*=u,va.elements[6]*=u,va.elements[8]*=d,va.elements[9]*=d,va.elements[10]*=d,n.setFromRotationMatrix(va),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o,a=yo,l=!1){const c=this.elements,u=2*s/(n-e),d=2*s/(i-r),h=(n+e)/(n-e),I=(i+r)/(i-r);let p,y;if(l)p=s/(o-s),y=o*s/(o-s);else if(a===yo)p=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===IC)p=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=I,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,o,a=yo,l=!1){const c=this.elements,u=2/(n-e),d=2/(i-r),h=-(n+e)/(n-e),I=-(i+r)/(i-r);let p,y;if(l)p=1/(o-s),y=o/(o-s);else if(a===yo)p=-2/(o-s),y=-(o+s)/(o-s);else if(a===IC)p=-1/(o-s),y=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=0,c[12]=h,c[1]=0,c[5]=d,c[9]=0,c[13]=I,c[2]=0,c[6]=0,c[10]=p,c[14]=y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Jh=new J,va=new Qt,Lke=new J(0,0,0),zke=new J(1,1,1),gg=new J,ev=new J,co=new J,rL=new Qt,sL=new Zr;class no{constructor(e=0,n=0,i=0,r=no.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],h=r[6],I=r[10];switch(n){case"XYZ":this._y=Math.asin(sn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,I),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-sn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,I),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(sn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,I),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-sn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,I),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(sn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,I));break;case"XZY":this._z=Math.asin(-sn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,I),this._y=0);break;default:vt("Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return rL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rL,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return sL.setFromEuler(this),this.setFromQuaternion(sL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}no.DEFAULT_ORDER="XYZ";class Yd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let jke=0;const oL=new J,Qh=new Zr,ac=new Qt,tv=new J,Kp=new J,Pke=new J,Oke=new Zr,aL=new J(1,0,0),lL=new J(0,1,0),cL=new J(0,0,1),gL={type:"added"},Dke={type:"removed"},qh={type:"childadded",child:null},dR={type:"childremoved",child:null};class Tn extends Ol{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jke++}),this.uuid=Go(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Tn.DEFAULT_UP.clone();const e=new J,n=new no,i=new Zr,r=new J(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Qt},normalMatrix:{value:new hn}}),this.matrix=new Qt,this.matrixWorld=new Qt,this.matrixAutoUpdate=Tn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Tn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Yd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Qh.setFromAxisAngle(e,n),this.quaternion.multiply(Qh),this}rotateOnWorldAxis(e,n){return Qh.setFromAxisAngle(e,n),this.quaternion.premultiply(Qh),this}rotateX(e){return this.rotateOnAxis(aL,e)}rotateY(e){return this.rotateOnAxis(lL,e)}rotateZ(e){return this.rotateOnAxis(cL,e)}translateOnAxis(e,n){return oL.copy(e).applyQuaternion(this.quaternion),this.position.add(oL.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(aL,e)}translateY(e){return this.translateOnAxis(lL,e)}translateZ(e){return this.translateOnAxis(cL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ac.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?tv.copy(e):tv.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Kp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ac.lookAt(Kp,tv,this.up):ac.lookAt(tv,Kp,this.up),this.quaternion.setFromRotationMatrix(ac),r&&(ac.extractRotation(r.matrixWorld),Qh.setFromRotationMatrix(ac),this.quaternion.premultiply(Qh.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(on("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(gL),qh.child=e,this.dispatchEvent(qh),qh.child=null):on("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Dke),dR.child=e,this.dispatchEvent(dR),dR.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ac.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ac.multiply(e.parent.matrixWorld)),e.applyMatrix4(ac),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(gL),qh.child=e,this.dispatchEvent(qh),qh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kp,e,Pke),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kp,Oke,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(a=>({...a})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),h=o(e.skeletons),I=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),h.length>0&&(i.skeletons=h),I.length>0&&(i.animations=I),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Tn.DEFAULT_UP=new J(0,1,0);Tn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Tn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xa=new J,lc=new J,hR=new J,cc=new J,$h=new J,eI=new J,uL=new J,IR=new J,fR=new J,CR=new J,pR=new _n,mR=new _n,AR=new _n;class Us{constructor(e=new J,n=new J,i=new J){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),xa.subVectors(e,n),r.cross(xa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){xa.subVectors(r,n),lc.subVectors(i,n),hR.subVectors(e,n);const o=xa.dot(xa),a=xa.dot(lc),l=xa.dot(hR),c=lc.dot(lc),u=lc.dot(hR),d=o*c-a*a;if(d===0)return s.set(0,0,0),null;const h=1/d,I=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-I-p,p,I)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,cc)===null?!1:cc.x>=0&&cc.y>=0&&cc.x+cc.y<=1}static getInterpolation(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,cc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,cc.x),l.addScaledVector(o,cc.y),l.addScaledVector(a,cc.z),l)}static getInterpolatedAttribute(e,n,i,r,s,o){return pR.setScalar(0),mR.setScalar(0),AR.setScalar(0),pR.fromBufferAttribute(e,n),mR.fromBufferAttribute(e,i),AR.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(pR,s.x),o.addScaledVector(mR,s.y),o.addScaledVector(AR,s.z),o}static isFrontFacing(e,n,i,r){return xa.subVectors(i,n),lc.subVectors(e,n),xa.cross(lc).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return xa.subVectors(this.c,this.b),lc.subVectors(this.a,this.b),xa.cross(lc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Us.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Us.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return Us.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Us.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Us.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let o,a;$h.subVectors(r,i),eI.subVectors(s,i),IR.subVectors(e,i);const l=$h.dot(IR),c=eI.dot(IR);if(l<=0&&c<=0)return n.copy(i);fR.subVectors(e,r);const u=$h.dot(fR),d=eI.dot(fR);if(u>=0&&d<=u)return n.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),n.copy(i).addScaledVector($h,o);CR.subVectors(e,s);const I=$h.dot(CR),p=eI.dot(CR);if(p>=0&&I<=p)return n.copy(s);const y=I*c-l*p;if(y<=0&&c>=0&&p<=0)return a=c/(c-p),n.copy(i).addScaledVector(eI,a);const A=u*p-I*d;if(A<=0&&d-u>=0&&I-p>=0)return uL.subVectors(s,r),a=(d-u)/(d-u+(I-p)),n.copy(r).addScaledVector(uL,a);const m=1/(A+y+h);return o=y*m,a=h*m,n.copy(i).addScaledVector($h,o).addScaledVector(eI,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const ree={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ug={h:0,s:0,l:0},nv={h:0,s:0,l:0};function yR(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class wt{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ts){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Fn.colorSpaceToWorking(this,n),this}setRGB(e,n,i,r=Fn.workingColorSpace){return this.r=e,this.g=n,this.b=i,Fn.colorSpaceToWorking(this,r),this}setHSL(e,n,i,r=Fn.workingColorSpace){if(e=s_(e,1),n=sn(n,0,1),i=sn(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=yR(o,s,e+1/3),this.g=yR(o,s,e),this.b=yR(o,s,e-1/3)}return Fn.colorSpaceToWorking(this,r),this}setStyle(e,n=ts){function i(s){s!==void 0&&parseFloat(s)<1&&vt("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:vt("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);vt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ts){const i=ree[e.toLowerCase()];return i!==void 0?this.setHex(i,n):vt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wc(e.r),this.g=Wc(e.g),this.b=Wc(e.b),this}copyLinearToSRGB(e){return this.r=ef(e.r),this.g=ef(e.g),this.b=ef(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ts){return Fn.workingToColorSpace(Or.copy(this),e),Math.round(sn(Or.r*255,0,255))*65536+Math.round(sn(Or.g*255,0,255))*256+Math.round(sn(Or.b*255,0,255))}getHexString(e=ts){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Fn.workingColorSpace){Fn.workingToColorSpace(Or.copy(this),n);const i=Or.r,r=Or.g,s=Or.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,n=Fn.workingColorSpace){return Fn.workingToColorSpace(Or.copy(this),n),e.r=Or.r,e.g=Or.g,e.b=Or.b,e}getStyle(e=ts){Fn.workingToColorSpace(Or.copy(this),e);const n=Or.r,i=Or.g,r=Or.b;return e!==ts?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(ug),this.setHSL(ug.h+e,ug.s+n,ug.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(ug),e.getHSL(nv);const i=Om(ug.h,nv.h,n),r=Om(ug.s,nv.s,n),s=Om(ug.l,nv.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Or=new wt;wt.NAMES=ree;let Uke=0;class Yr extends Ol{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Uke++}),this.uuid=Go(),this.name="",this.type="Material",this.blending=Xd,this.side=Lc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=yG,this.blendDst=bG,this.blendEquation=Gg,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wt(0,0,0),this.blendAlpha=0,this.depthFunc=rh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=N3,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ad,this.stencilZFail=ad,this.stencilZPass=ad,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){vt(`Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){vt(`Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Xd&&(i.blending=this.blending),this.side!==Lc&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==yG&&(i.blendSrc=this.blendSrc),this.blendDst!==bG&&(i.blendDst=this.blendDst),this.blendEquation!==Gg&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==rh&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==N3&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ad&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ad&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ad&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Uc extends Yr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new no,this.combine=$0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const mc=Jke();function Jke(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Ks(t){Math.abs(t)>65504&&vt("DataUtils.toHalfFloat(): Value out of range."),t=sn(t,-65504,65504),mc.floatView[0]=t;const e=mc.uint32View[0],n=e>>23&511;return mc.baseTable[n]+((e&8388607)>>mc.shiftTable[n])}function pm(t){const e=t>>10;return mc.uint32View[0]=mc.mantissaTable[mc.offsetTable[e]+(t&1023)]+mc.exponentTable[e],mc.floatView[0]}class xd{static toHalfFloat(e){return Ks(e)}static fromHalfFloat(e){return pm(e)}}const qi=new J,iv=new He;let Qke=0;class Wn{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Qke++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=a0,this.updateRanges=[],this.gpuType=Fi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)iv.fromBufferAttribute(this,n),iv.applyMatrix3(e),this.setXY(n,iv.x,iv.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix3(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix4(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.applyNormalMatrix(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)qi.fromBufferAttribute(this,n),qi.transformDirection(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=As(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=In(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=As(n,this.array)),n}setX(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=As(n,this.array)),n}setY(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=As(n,this.array)),n}setZ(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=As(n,this.array)),n}setW(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array),s=In(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==a0&&(e.usage=this.usage),e}}class qke extends Wn{constructor(e,n,i){super(new Int8Array(e),n,i)}}class $ke extends Wn{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class eHe extends Wn{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class tHe extends Wn{constructor(e,n,i){super(new Int16Array(e),n,i)}}class l_ extends Wn{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class nHe extends Wn{constructor(e,n,i){super(new Int32Array(e),n,i)}}class c_ extends Wn{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class iHe extends Wn{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=pm(this.array[e*this.itemSize]);return this.normalized&&(n=As(n,this.array)),n}setX(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize]=Ks(n),this}getY(e){let n=pm(this.array[e*this.itemSize+1]);return this.normalized&&(n=As(n,this.array)),n}setY(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+1]=Ks(n),this}getZ(e){let n=pm(this.array[e*this.itemSize+2]);return this.normalized&&(n=As(n,this.array)),n}setZ(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+2]=Ks(n),this}getW(e){let n=pm(this.array[e*this.itemSize+3]);return this.normalized&&(n=As(n,this.array)),n}setW(e,n){return this.normalized&&(n=In(n,this.array)),this.array[e*this.itemSize+3]=Ks(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array)),this.array[e+0]=Ks(n),this.array[e+1]=Ks(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array)),this.array[e+0]=Ks(n),this.array[e+1]=Ks(i),this.array[e+2]=Ks(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array),s=In(s,this.array)),this.array[e+0]=Ks(n),this.array[e+1]=Ks(i),this.array[e+2]=Ks(r),this.array[e+3]=Ks(s),this}}class _t extends Wn{constructor(e,n,i){super(new Float32Array(e),n,i)}}let rHe=0;const Lo=new Qt,bR=new Tn,tI=new J,go=new ss,Lp=new ss,br=new J;class gn extends Ol{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rHe++}),this.uuid=Go(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nee(e)?c_:l_)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new hn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Lo.makeRotationFromQuaternion(e),this.applyMatrix4(Lo),this}rotateX(e){return Lo.makeRotationX(e),this.applyMatrix4(Lo),this}rotateY(e){return Lo.makeRotationY(e),this.applyMatrix4(Lo),this}rotateZ(e){return Lo.makeRotationZ(e),this.applyMatrix4(Lo),this}translate(e,n,i){return Lo.makeTranslation(e,n,i),this.applyMatrix4(Lo),this}scale(e,n,i){return Lo.makeScale(e,n,i),this.applyMatrix4(Lo),this}lookAt(e){return bR.lookAt(e),bR.updateMatrix(),this.applyMatrix4(bR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tI).negate(),this.translate(tI.x,tI.y,tI.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new _t(i,3))}else{const i=Math.min(e.length,n.count);for(let r=0;r<i;r++){const s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&vt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ss);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){on("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];go.setFromBufferAttribute(s),this.morphTargetsRelative?(br.addVectors(this.boundingBox.min,go.min),this.boundingBox.expandByPoint(br),br.addVectors(this.boundingBox.max,go.max),this.boundingBox.expandByPoint(br)):(this.boundingBox.expandByPoint(go.min),this.boundingBox.expandByPoint(go.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&on('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){on("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new J,1/0);return}if(e){const i=this.boundingSphere.center;if(go.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];Lp.setFromBufferAttribute(a),this.morphTargetsRelative?(br.addVectors(go.min,Lp.min),go.expandByPoint(br),br.addVectors(go.max,Lp.max),go.expandByPoint(br)):(go.expandByPoint(Lp.min),go.expandByPoint(Lp.max))}go.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)br.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(br));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)br.fromBufferAttribute(a,c),l&&(tI.fromBufferAttribute(e,c),br.add(tI)),r=Math.max(r,i.distanceToSquared(br))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&on('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){on("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Wn(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let N=0;N<i.count;N++)a[N]=new J,l[N]=new J;const c=new J,u=new J,d=new J,h=new He,I=new He,p=new He,y=new J,A=new J;function m(N,W,M){c.fromBufferAttribute(i,N),u.fromBufferAttribute(i,W),d.fromBufferAttribute(i,M),h.fromBufferAttribute(s,N),I.fromBufferAttribute(s,W),p.fromBufferAttribute(s,M),u.sub(c),d.sub(c),I.sub(h),p.sub(h);const F=1/(I.x*p.y-p.x*I.y);isFinite(F)&&(y.copy(u).multiplyScalar(p.y).addScaledVector(d,-I.y).multiplyScalar(F),A.copy(d).multiplyScalar(I.x).addScaledVector(u,-p.x).multiplyScalar(F),a[N].add(y),a[W].add(y),a[M].add(y),l[N].add(A),l[W].add(A),l[M].add(A))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let N=0,W=b.length;N<W;++N){const M=b[N],F=M.start,T=M.count;for(let H=F,K=F+T;H<K;H+=3)m(e.getX(H+0),e.getX(H+1),e.getX(H+2))}const v=new J,w=new J,x=new J,B=new J;function Z(N){x.fromBufferAttribute(r,N),B.copy(x);const W=a[N];v.copy(W),v.sub(x.multiplyScalar(x.dot(W))).normalize(),w.crossVectors(B,W);const F=w.dot(l[N])<0?-1:1;o.setXYZW(N,v.x,v.y,v.z,F)}for(let N=0,W=b.length;N<W;++N){const M=b[N],F=M.start,T=M.count;for(let H=F,K=F+T;H<K;H+=3)Z(e.getX(H+0)),Z(e.getX(H+1)),Z(e.getX(H+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Wn(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let h=0,I=i.count;h<I;h++)i.setXYZ(h,0,0,0);const r=new J,s=new J,o=new J,a=new J,l=new J,c=new J,u=new J,d=new J;if(e)for(let h=0,I=e.count;h<I;h+=3){const p=e.getX(h+0),y=e.getX(h+1),A=e.getX(h+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,y),o.fromBufferAttribute(n,A),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,y),c.fromBufferAttribute(i,A),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(A,c.x,c.y,c.z)}else for(let h=0,I=n.count;h<I;h+=3)r.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),o.fromBufferAttribute(n,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)br.fromBufferAttribute(e,n),br.normalize(),e.setXYZ(n,br.x,br.y,br.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let I=0,p=0;for(let y=0,A=l.length;y<A;y++){a.isInterleavedBufferAttribute?I=l[y]*a.data.stride+a.offset:I=l[y]*u;for(let m=0;m<u;m++)h[p++]=c[I++]}return new Wn(h,u,d)}if(this.index===null)return vt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new gn,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);n.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const h=c[u],I=e(h,i);l.push(I)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++){const I=c[d];u.push(I.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(n))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,I=d.length;h<I;h++)u.push(d[h].clone(n));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const dL=new Qt,Ku=new Ah,rv=new Tr,hL=new J,sv=new J,ov=new J,av=new J,vR=new J,lv=new J,IL=new J,cv=new J;class Li extends Tn{constructor(e=new gn,n=new Uc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){lv.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],d=s[l];u!==0&&(vR.fromBufferAttribute(d,e),o?lv.addScaledVector(vR,u):lv.addScaledVector(vR.sub(n),u))}n.add(lv)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),rv.copy(i.boundingSphere),rv.applyMatrix4(s),Ku.copy(e.ray).recast(e.near),!(rv.containsPoint(Ku.origin)===!1&&(Ku.intersectSphere(rv,hL)===null||Ku.origin.distanceToSquared(hL)>(e.far-e.near)**2))&&(dL.copy(s).invert(),Ku.copy(e.ray).applyMatrix4(dL),!(i.boundingBox!==null&&Ku.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Ku)))}_computeIntersections(e,n,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,I=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const A=h[p],m=o[A.materialIndex],b=Math.max(A.start,I.start),v=Math.min(a.count,Math.min(A.start+A.count,I.start+I.count));for(let w=b,x=v;w<x;w+=3){const B=a.getX(w),Z=a.getX(w+1),N=a.getX(w+2);r=gv(this,m,e,i,c,u,d,B,Z,N),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=A.materialIndex,n.push(r))}}else{const p=Math.max(0,I.start),y=Math.min(a.count,I.start+I.count);for(let A=p,m=y;A<m;A+=3){const b=a.getX(A),v=a.getX(A+1),w=a.getX(A+2);r=gv(this,o,e,i,c,u,d,b,v,w),r&&(r.faceIndex=Math.floor(A/3),n.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const A=h[p],m=o[A.materialIndex],b=Math.max(A.start,I.start),v=Math.min(l.count,Math.min(A.start+A.count,I.start+I.count));for(let w=b,x=v;w<x;w+=3){const B=w,Z=w+1,N=w+2;r=gv(this,m,e,i,c,u,d,B,Z,N),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=A.materialIndex,n.push(r))}}else{const p=Math.max(0,I.start),y=Math.min(l.count,I.start+I.count);for(let A=p,m=y;A<m;A+=3){const b=A,v=A+1,w=A+2;r=gv(this,o,e,i,c,u,d,b,v,w),r&&(r.faceIndex=Math.floor(A/3),n.push(r))}}}}function sHe(t,e,n,i,r,s,o,a){let l;if(e.side===Bs?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Lc,a),l===null)return null;cv.copy(a),cv.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(cv);return c<n.near||c>n.far?null:{distance:c,point:cv.clone(),object:t}}function gv(t,e,n,i,r,s,o,a,l,c){t.getVertexPosition(a,sv),t.getVertexPosition(l,ov),t.getVertexPosition(c,av);const u=sHe(t,e,n,i,sv,ov,av,IL);if(u){const d=new J;Us.getBarycoord(IL,sv,ov,av,d),r&&(u.uv=Us.getInterpolatedAttribute(r,a,l,c,d,new He)),s&&(u.uv1=Us.getInterpolatedAttribute(s,a,l,c,d,new He)),o&&(u.normal=Us.getInterpolatedAttribute(o,a,l,c,d,new J),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new J,materialIndex:0};Us.getNormal(sv,ov,av,h.normal),u.face=h,u.barycoord=d}return u}class yh extends gn{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,I=0;p("z","y","x",-1,-1,i,n,e,o,s,0),p("z","y","x",1,-1,i,n,-e,o,s,1),p("x","z","y",1,1,e,i,n,r,o,2),p("x","z","y",1,-1,e,i,-n,r,o,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new _t(c,3)),this.setAttribute("normal",new _t(u,3)),this.setAttribute("uv",new _t(d,2));function p(y,A,m,b,v,w,x,B,Z,N,W){const M=w/Z,F=x/N,T=w/2,H=x/2,K=B/2,z=Z+1,j=N+1;let O=0,_=0;const E=new J;for(let P=0;P<j;P++){const q=P*F-H;for(let re=0;re<z;re++){const de=re*M-T;E[y]=de*b,E[A]=q*v,E[m]=K,c.push(E.x,E.y,E.z),E[y]=0,E[A]=0,E[m]=B>0?1:-1,u.push(E.x,E.y,E.z),d.push(re/Z),d.push(1-P/N),O+=1}}for(let P=0;P<N;P++)for(let q=0;q<Z;q++){const re=h+q+z*P,de=h+q+z*(P+1),Re=h+(q+1)+z*(P+1),Pe=h+(q+1)+z*P;l.push(re,de,Pe),l.push(de,Re,Pe),_+=6}a.addGroup(I,_,W),I+=_,h+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function mC(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(vt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function hs(t){const e={};for(let n=0;n<t.length;n++){const i=mC(t[n]);for(const r in i)e[r]=i[r]}return e}function oHe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function see(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Fn.workingColorSpace}const g_={clone:mC,merge:hs};var aHe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,lHe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class as extends Yr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aHe,this.fragmentShader=lHe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=mC(e.uniforms),this.uniformsGroups=oHe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class iy extends Tn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qt,this.projectionMatrix=new Qt,this.projectionMatrixInverse=new Qt,this.coordinateSystem=yo,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const dg=new J,fL=new He,CL=new He;class Wi extends iy{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=CC*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ed*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return CC*2*Math.atan(Math.tan(Ed*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){dg.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(dg.x,dg.y).multiplyScalar(-e/dg.z),dg.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(dg.x,dg.y).multiplyScalar(-e/dg.z)}getViewSize(e,n){return this.getViewBounds(e,fL,CL),n.subVectors(CL,fL)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Ed*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const nI=-90,iI=1;class oee extends Tn{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Wi(nI,iI,e,n);r.layers=this.layers,this.add(r);const s=new Wi(nI,iI,e,n);s.layers=this.layers,this.add(s);const o=new Wi(nI,iI,e,n);o.layers=this.layers,this.add(o);const a=new Wi(nI,iI,e,n);a.layers=this.layers,this.add(a);const l=new Wi(nI,iI,e,n);l.layers=this.layers,this.add(l);const c=new Wi(nI,iI,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,o,a,l]=n;for(const c of n)this.remove(c);if(e===yo)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===IC)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),I=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const y=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,o),e.setRenderTarget(i,2,r),e.render(n,a),e.setRenderTarget(i,3,r),e.render(n,l),e.setRenderTarget(i,4,r),e.render(n,c),i.texture.generateMipmaps=y,e.setRenderTarget(i,5,r),e.render(n,u),e.setRenderTarget(d,h,I),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class ry extends $n{constructor(e=[],n=kl,i,r,s,o,a,l,c,u){super(e,n,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class u_ extends ga{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new ry(r),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new yh(5,5,5),s=new as({name:"CubemapFromEquirect",uniforms:mC(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Bs,blending:Da});s.uniforms.tEquirect.value=n;const o=new Li(r,s),a=n.minFilter;return n.minFilter===ka&&(n.minFilter=Ln),new oee(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}}class _I extends Tn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const cHe={type:"move"};class xx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _I,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _I,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _I,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const y of e.hand.values()){const A=n.getJointPose(y,i),m=this._getHandJoint(c,y);A!==null&&(m.matrix.fromArray(A.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=A.radius),m.visible=A!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],h=u.position.distanceTo(d.position),I=.02,p=.005;c.inputState.pinching&&h>I+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=I-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(cHe)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new _I;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class sS{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new wt(e),this.density=n}clone(){return new sS(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class oS{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new wt(e),this.near=n,this.far=i}clone(){return new oS(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let gu=class extends Tn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new no,this.environmentIntensity=1,this.environmentRotation=new no,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}};class aS{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=a0,this.updateRanges=[],this.version=0,this.uuid=Go()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ds=new J;class sh{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyMatrix4(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyNormalMatrix(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.transformDirection(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=As(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=In(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=In(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=In(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=In(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=In(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=As(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=As(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=As(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=As(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=In(n,this.array),i=In(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=In(n,this.array),i=In(i,this.array),r=In(r,this.array),s=In(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){c0("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new Wn(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new sh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){c0("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class d_ extends Yr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let rI;const zp=new J,sI=new J,oI=new J,aI=new He,jp=new He,aee=new Qt,uv=new J,Pp=new J,dv=new J,pL=new He,xR=new He,mL=new He;class lee extends Tn{constructor(e=new d_){if(super(),this.isSprite=!0,this.type="Sprite",rI===void 0){rI=new gn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new aS(n,5);rI.setIndex([0,1,2,0,2,3]),rI.setAttribute("position",new sh(i,3,0,!1)),rI.setAttribute("uv",new sh(i,2,3,!1))}this.geometry=rI,this.material=e,this.center=new He(.5,.5),this.count=1}raycast(e,n){e.camera===null&&on('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sI.setFromMatrixScale(this.matrixWorld),aee.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),oI.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sI.multiplyScalar(-oI.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;hv(uv.set(-.5,-.5,0),oI,o,sI,r,s),hv(Pp.set(.5,-.5,0),oI,o,sI,r,s),hv(dv.set(.5,.5,0),oI,o,sI,r,s),pL.set(0,0),xR.set(1,0),mL.set(1,1);let a=e.ray.intersectTriangle(uv,Pp,dv,!1,zp);if(a===null&&(hv(Pp.set(-.5,.5,0),oI,o,sI,r,s),xR.set(0,1),a=e.ray.intersectTriangle(uv,dv,Pp,!1,zp),a===null))return;const l=e.ray.origin.distanceTo(zp);l<e.near||l>e.far||n.push({distance:l,point:zp.clone(),uv:Us.getInterpolation(zp,uv,Pp,dv,pL,xR,mL,new He),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function hv(t,e,n,i,r,s){aI.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(jp.x=s*aI.x-r*aI.y,jp.y=r*aI.x+s*aI.y):jp.copy(aI),t.copy(e),t.x+=jp.x,t.y+=jp.y,t.applyMatrix4(aee)}const Iv=new J,AL=new J;class cee extends Tn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){Iv.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Iv);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){Iv.setFromMatrixPosition(e.matrixWorld),AL.setFromMatrixPosition(this.matrixWorld);const i=Iv.distanceTo(AL)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const yL=new J,bL=new _n,vL=new _n,gHe=new J,xL=new Qt,fv=new J,wR=new Tr,wL=new Qt,GR=new Ah;class gee extends Li{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Z3,this.bindMatrix=new Qt,this.bindMatrixInverse=new Qt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ss),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,fv),this.boundingBox.expandByPoint(fv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Tr),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,fv),this.boundingSphere.expandByPoint(fv)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),wR.copy(this.boundingSphere),wR.applyMatrix4(r),e.ray.intersectsSphere(wR)!==!1&&(wL.copy(r).invert(),GR.copy(e.ray).applyMatrix4(wL),!(this.boundingBox!==null&&GR.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,GR)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new _n,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Z3?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===K$?this.bindMatrixInverse.copy(this.bindMatrix).invert():vt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;bL.fromBufferAttribute(r.attributes.skinIndex,e),vL.fromBufferAttribute(r.attributes.skinWeight,e),yL.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=vL.getComponent(s);if(o!==0){const a=bL.getComponent(s);xL.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(gHe.copy(yL).applyMatrix4(xL),o)}}return n.applyMatrix4(this.bindMatrixInverse)}}class h_ extends Tn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class sa extends $n{constructor(e=null,n=1,i=1,r,s,o,a,l,c=Sr,u=Sr,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const GL=new Qt,uHe=new Qt;class lS{constructor(e=[],n=[]){this.uuid=Go(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){vt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Qt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Qt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:uHe;GL.multiplyMatrices(a,n[s]),GL.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new lS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new sa(n,e,e,Ki,Fi);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=n[s];o===void 0&&(vt("Skeleton: No bone found with UUID:",s),o=new h_),this.bones.push(o),this.boneInverses.push(new Qt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class AC extends Wn{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lI=new Qt,BL=new Qt,Cv=[],SL=new ss,dHe=new Qt,Op=new Li,Dp=new Tr;class I_ extends Li{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new AC(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,dHe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new ss),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,lI),SL.copy(e.boundingBox).applyMatrix4(lI),this.boundingBox.union(SL)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Tr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,lI),Dp.copy(e.boundingSphere).applyMatrix4(lI),this.boundingSphere.union(Dp)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,o=e*s+1;for(let a=0;a<i.length;a++)i[a]=r[o+a]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(Op.geometry=this.geometry,Op.material=this.material,Op.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Dp.copy(this.boundingSphere),Dp.applyMatrix4(i),e.ray.intersectsSphere(Dp)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,lI),BL.multiplyMatrices(i,lI),Op.matrixWorld=BL,Op.raycast(e,Cv);for(let o=0,a=Cv.length;o<a;o++){const l=Cv[o];l.instanceId=s,l.object=this,n.push(l)}Cv.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new AC(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new sa(new Float32Array(r*this.count),r,this.count,ty,Fi));const s=this.morphTexture.source.data.data;let o=0;for(let c=0;c<i.length;c++)o+=i[c];const a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(i,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const BR=new J,hHe=new J,IHe=new hn;class Cc{constructor(e=new J(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=BR.subVectors(i,n).cross(hHe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(BR),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||IHe.getNormalMatrix(e),r=this.coplanarPoint(BR).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Lu=new Tr,fHe=new He(.5,.5),pv=new J;class qC{constructor(e=new Cc,n=new Cc,i=new Cc,r=new Cc,s=new Cc,o=new Cc){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=yo,i=!1){const r=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],I=s[7],p=s[8],y=s[9],A=s[10],m=s[11],b=s[12],v=s[13],w=s[14],x=s[15];if(r[0].setComponents(c-o,I-u,m-p,x-b).normalize(),r[1].setComponents(c+o,I+u,m+p,x+b).normalize(),r[2].setComponents(c+a,I+d,m+y,x+v).normalize(),r[3].setComponents(c-a,I-d,m-y,x-v).normalize(),i)r[4].setComponents(l,h,A,w).normalize(),r[5].setComponents(c-l,I-h,m-A,x-w).normalize();else if(r[4].setComponents(c-l,I-h,m-A,x-w).normalize(),n===yo)r[5].setComponents(c+l,I+h,m+A,x+w).normalize();else if(n===IC)r[5].setComponents(l,h,A,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Lu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Lu.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Lu)}intersectsSprite(e){Lu.center.set(0,0,0);const n=fHe.distanceTo(e.center);return Lu.radius=.7071067811865476+n,Lu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Lu)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(pv.x=r.normal.x>0?e.max.x:e.min.x,pv.y=r.normal.y>0?e.max.y:e.min.y,pv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(pv)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const dl=new Qt,hl=new qC;class cS{constructor(){this.coordinateSystem=yo}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.containsPoint(e))return!0}return!1}clone(){return new cS}}function SR(t,e){return t-e}function CHe(t,e){return t.z-e.z}function pHe(t,e){return e.z-t.z}class mHe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){const s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const a=s[this.index];o.push(a),this.index++,a.start=e,a.count=n,a.z=i,a.index=r}reset(){this.list.length=0,this.index=0}}const Ys=new Qt,AHe=new wt(1,1,1),ZL=new qC,yHe=new cS,mv=new ss,zu=new Tr,Up=new J,RL=new J,bHe=new J,ZR=new mHe,Dr=new Li,Av=[];function vHe(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+n,o,t.getComponent(s,o))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function ju(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class uee extends Li{constructor(e,n,i=n*2,r){super(new gn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new sa(n,e,e,Ki,Fi);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new sa(n,e,e,ny,Hl);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new sa(n,e,e,Ki,Fi);i.colorSpace=Fn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:a,itemSize:l,normalized:c}=o,u=new a.constructor(i*l),d=new Wn(u,l,c);n.setAttribute(s,d)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new Wn(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ss);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Ys),this.getBoundingBoxAt(s,mv).applyMatrix4(Ys),e.union(mv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tr);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Ys),this.getBoundingSphereAt(s,zu).applyMatrix4(Ys),e.union(zu)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(SR),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;Ys.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const o=this._colorsTexture;return o&&(AHe.toArray(o.image.data,r*4),o.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?o.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(SR),l=this._availableGeometryIds.shift(),s[l]=r):(l=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(l,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,l}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),o=n.getIndex(),a=this._geometryInfo[e];if(r&&o.count>a.reservedIndexCount||n.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.reservedVertexCount;a.vertexCount=n.getAttribute("position").count;for(const u in i.attributes){const d=n.getAttribute(u),h=i.getAttribute(u);vHe(d,h,l);const I=d.itemSize;for(let p=d.count,y=c;p<y;p++){const A=l+p;for(let m=0;m<I;m++)h.setComponent(A,m,0)}h.needsUpdate=!0,h.addUpdateRange(l*I,c*I)}if(r){const u=a.indexStart,d=a.reservedIndexCount;a.indexCount=n.getIndex().count;for(let h=0;h<o.count;h++)s.setX(u+h,l+o.getX(h));for(let h=o.count,I=d;h<I;h++)s.setX(u+h,l);s.needsUpdate=!0,s.addUpdateRange(u,a.reservedIndexCount)}return a.start=r?a.indexStart:a.vertexStart,a.count=r?a.indexCount:a.vertexCount,a.boundingBox=null,n.boundingBox!==null&&(a.boundingBox=n.boundingBox.clone()),a.boundingSphere=null,n.boundingSphere!==null&&(a.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,r=i.map((o,a)=>a).sort((o,a)=>i[o].vertexStart-i[a].vertexStart),s=this.geometry;for(let o=0,a=i.length;o<a;o++){const l=r[o],c=i[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==n){const{indexStart:u,vertexStart:d,reservedIndexCount:h}=c,I=s.index,p=I.array,y=e-d;for(let A=u;A<u+h;A++)p[A]=p[A]+y;I.array.copyWithin(n,u,u+h),I.addUpdateRange(n,h),c.indexStart=n}n+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:d}=c,h=s.attributes;for(const I in h){const p=h[I],{array:y,itemSize:A}=p;y.copyWithin(e*A,u*A,(u+d)*A),p.addUpdateRange(e*A,d*A)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new ss,o=i.index,a=i.attributes.position;for(let l=r.start,c=r.start+r.count;l<c;l++){let u=l;o&&(u=o.getX(u)),s.expandByPoint(Up.fromBufferAttribute(a,u))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Tr;this.getBoundingBoxAt(e,mv),mv.getCenter(s.center);const o=i.index,a=i.attributes.position;let l=0;for(let c=r.start,u=r.start+r.count;c<u;c++){let d=c;o&&(d=o.getX(d)),Up.fromBufferAttribute(a,d),l=Math.max(l,s.center.distanceToSquared(Up))}s.radius=Math.sqrt(l),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(SR);n[n.length-1]===i.length-1;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);ju(this._multiDrawCounts,r),ju(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const o=this._indirectTexture,a=this._matricesTexture,l=this._colorsTexture;o.dispose(),this._initIndirectTexture(),ju(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),ju(a.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),ju(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...i.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(l=>l.indexStart+l.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new gn,this._initializeGeometry(s));const o=this.geometry;s.index&&ju(s.index.array,o.index.array);for(const a in s.attributes)ju(s.attributes[a].array,o.attributes[a].array)}raycast(e,n){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,o=this.geometry;Dr.material=this.material,Dr.geometry.index=o.index,Dr.geometry.attributes=o.attributes,Dr.geometry.boundingBox===null&&(Dr.geometry.boundingBox=new ss),Dr.geometry.boundingSphere===null&&(Dr.geometry.boundingSphere=new Tr);for(let a=0,l=i.length;a<l;a++){if(!i[a].visible||!i[a].active)continue;const c=i[a].geometryIndex,u=r[c];Dr.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Dr.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Dr.geometry.boundingBox),this.getBoundingSphereAt(c,Dr.geometry.boundingSphere),Dr.raycast(e,Av);for(let d=0,h=Av.length;d<h;d++){const I=Av[d];I.object=this,I.batchId=a,n.push(I)}Av.length=0}Dr.material=null,Dr.geometry.index=null,Dr.geometry.attributes={},Dr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,d=this._geometryInfo,h=this.perObjectFrustumCulled,I=this._indirectTexture,p=I.image.data,y=i.isArrayCamera?yHe:ZL;h&&!i.isArrayCamera&&(Ys.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),ZL.setFromProjectionMatrix(Ys,i.coordinateSystem,i.reversedDepth));let A=0;if(this.sortObjects){Ys.copy(this.matrixWorld).invert(),Up.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Ys),RL.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Ys);for(let v=0,w=l.length;v<w;v++)if(l[v].visible&&l[v].active){const x=l[v].geometryIndex;this.getMatrixAt(v,Ys),this.getBoundingSphereAt(x,zu).applyMatrix4(Ys);let B=!1;if(h&&(B=!y.intersectsSphere(zu,i)),!B){const Z=d[x],N=bHe.subVectors(zu.center,Up).dot(RL);ZR.push(Z.start,Z.count,N,v)}}const m=ZR.list,b=this.customSort;b===null?m.sort(s.transparent?pHe:CHe):b.call(this,m,i);for(let v=0,w=m.length;v<w;v++){const x=m[v];c[A]=x.start*a,u[A]=x.count,p[A]=x.index,A++}ZR.reset()}else for(let m=0,b=l.length;m<b;m++)if(l[m].visible&&l[m].active){const v=l[m].geometryIndex;let w=!1;if(h&&(this.getMatrixAt(m,Ys),this.getBoundingSphereAt(v,zu).applyMatrix4(Ys),w=!y.intersectsSphere(zu,i)),!w){const x=d[v];c[A]=x.start*a,u[A]=x.count,p[A]=m,A++}}I.needsUpdate=!0,this._multiDrawCount=A,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class Ms extends Yr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new wt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const i2=new J,r2=new J,NL=new Qt,Jp=new Ah,yv=new Tr,RR=new J,WL=new J;class uu extends Tn{constructor(e=new gn,n=new Ms){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)i2.fromBufferAttribute(n,r-1),r2.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=i2.distanceTo(r2);e.setAttribute("lineDistance",new _t(i,1))}else vt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),yv.copy(i.boundingSphere),yv.applyMatrix4(r),yv.radius+=s,e.ray.intersectsSphere(yv)===!1)return;NL.copy(r).invert(),Jp.copy(e.ray).applyMatrix4(NL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,u=i.index,h=i.attributes.position;if(u!==null){const I=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);for(let y=I,A=p-1;y<A;y+=c){const m=u.getX(y),b=u.getX(y+1),v=bv(this,e,Jp,l,m,b,y);v&&n.push(v)}if(this.isLineLoop){const y=u.getX(p-1),A=u.getX(I),m=bv(this,e,Jp,l,y,A,p-1);m&&n.push(m)}}else{const I=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let y=I,A=p-1;y<A;y+=c){const m=bv(this,e,Jp,l,y,y+1,y);m&&n.push(m)}if(this.isLineLoop){const y=bv(this,e,Jp,l,p-1,I,p-1);y&&n.push(y)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function bv(t,e,n,i,r,s,o){const a=t.geometry.attributes.position;if(i2.fromBufferAttribute(a,r),r2.fromBufferAttribute(a,s),n.distanceSqToSegment(i2,r2,RR,WL)>i)return;RR.applyMatrix4(t.matrixWorld);const c=e.ray.origin.distanceTo(RR);if(!(c<e.near||c>e.far))return{distance:c,point:WL.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}const ML=new J,VL=new J;class Dl extends uu{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)ML.fromBufferAttribute(n,r),VL.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+ML.distanceTo(VL);e.setAttribute("lineDistance",new _t(i,1))}else vt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class dee extends uu{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class f_ extends Yr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const FL=new Qt,M3=new Ah,vv=new Tr,xv=new J;class hee extends Tn{constructor(e=new gn,n=new f_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),vv.copy(i.boundingSphere),vv.applyMatrix4(r),vv.radius+=s,e.ray.intersectsSphere(vv)===!1)return;FL.copy(r).invert(),M3.copy(e.ray).applyMatrix4(FL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(c!==null){const h=Math.max(0,o.start),I=Math.min(c.count,o.start+o.count);for(let p=h,y=I;p<y;p++){const A=c.getX(p);xv.fromBufferAttribute(d,A),_L(xv,A,l,r,e,n,this)}}else{const h=Math.max(0,o.start),I=Math.min(d.count,o.start+o.count);for(let p=h,y=I;p<y;p++)xv.fromBufferAttribute(d,p),_L(xv,p,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function _L(t,e,n,i,r,s,o){const a=M3.distanceSqToPoint(t);if(a<n){const l=new J;M3.closestPointToPoint(t,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Iee extends $n{constructor(e,n,i,r,s=Ln,o=Ln,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const u=this;function d(){u.needsUpdate=!0,u._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class xHe extends Iee{constructor(e,n,i,r,s,o,a,l){super({},e,n,i,r,s,o,a,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class wHe extends $n{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Sr,this.minFilter=Sr,this.generateMipmaps=!1,this.needsUpdate=!0}}class kd extends $n{constructor(e,n,i,r,s,o,a,l,c,u,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class GHe extends kd{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Vi,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class BHe extends kd{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,kl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class SHe extends $n{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class C_ extends $n{constructor(e,n,i=Hl,r,s,o,a=Sr,l=Sr,c,u=uC,d=1){if(u!==uC&&u!==dC)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const h={width:e,height:n,depth:d};super(h,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Gc(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class p_ extends $n{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class gS extends gn{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const o=[],a=[],l=[],c=[],u=n/2,d=Math.PI/2*e,h=n,I=2*d+h,p=i*2+s,y=r+1,A=new J,m=new J;for(let b=0;b<=p;b++){let v=0,w=0,x=0,B=0;if(b<=i){const W=b/i,M=W*Math.PI/2;w=-u-e*Math.cos(M),x=e*Math.sin(M),B=-e*Math.cos(M),v=W*d}else if(b<=i+s){const W=(b-i)/s;w=-u+W*n,x=e,B=0,v=d+W*h}else{const W=(b-i-s)/i,M=W*Math.PI/2;w=u+e*Math.sin(M),x=e*Math.cos(M),B=e*Math.sin(M),v=d+h+W*d}const Z=Math.max(0,Math.min(1,v/I));let N=0;b===0?N=.5/r:b===p&&(N=-.5/r);for(let W=0;W<=r;W++){const M=W/r,F=M*Math.PI*2,T=Math.sin(F),H=Math.cos(F);m.x=-x*H,m.y=w,m.z=x*T,a.push(m.x,m.y,m.z),A.set(-x*H,B,x*T),A.normalize(),l.push(A.x,A.y,A.z),c.push(M+N,Z)}if(b>0){const W=(b-1)*y;for(let M=0;M<r;M++){const F=W+M,T=W+M+1,H=b*y+M,K=b*y+M+1;o.push(F,T,H),o.push(T,K,H)}}}this.setIndex(o),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gS(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class uS extends gn{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],o=[],a=[],l=[],c=new J,u=new He;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,h=3;d<=n;d++,h+=3){const I=i+d/n*r;c.x=e*Math.cos(I),c.y=e*Math.sin(I),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[h]/e+1)/2,u.y=(o[h+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=n;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(a,3)),this.setAttribute("uv",new _t(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uS(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class sy extends gn{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],h=[],I=[];let p=0;const y=[],A=i/2;let m=0;b(),o===!1&&(e>0&&v(!0),n>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(h,3)),this.setAttribute("uv",new _t(I,2));function b(){const w=new J,x=new J;let B=0;const Z=(n-e)/i;for(let N=0;N<=s;N++){const W=[],M=N/s,F=M*(n-e)+e;for(let T=0;T<=r;T++){const H=T/r,K=H*l+a,z=Math.sin(K),j=Math.cos(K);x.x=F*z,x.y=-M*i+A,x.z=F*j,d.push(x.x,x.y,x.z),w.set(z,Z,j).normalize(),h.push(w.x,w.y,w.z),I.push(H,1-M),W.push(p++)}y.push(W)}for(let N=0;N<r;N++)for(let W=0;W<s;W++){const M=y[W][N],F=y[W+1][N],T=y[W+1][N+1],H=y[W][N+1];(e>0||W!==0)&&(u.push(M,F,H),B+=3),(n>0||W!==s-1)&&(u.push(F,T,H),B+=3)}c.addGroup(m,B,0),m+=B}function v(w){const x=p,B=new He,Z=new J;let N=0;const W=w===!0?e:n,M=w===!0?1:-1;for(let T=1;T<=r;T++)d.push(0,A*M,0),h.push(0,M,0),I.push(.5,.5),p++;const F=p;for(let T=0;T<=r;T++){const K=T/r*l+a,z=Math.cos(K),j=Math.sin(K);Z.x=W*j,Z.y=A*M,Z.z=W*z,d.push(Z.x,Z.y,Z.z),h.push(0,M,0),B.x=z*.5+.5,B.y=j*.5*M+.5,I.push(B.x,B.y),p++}for(let T=0;T<r;T++){const H=x+T,K=F+T;w===!0?u.push(K,K+1,H):u.push(K+1,K,H),N+=3}c.addGroup(m,N,w===!0?1:2),m+=N}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sy(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class oy extends sy{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new oy(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Gu extends gn{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],o=[];a(r),c(i),u(),this.setAttribute("position",new _t(s,3)),this.setAttribute("normal",new _t(s.slice(),3)),this.setAttribute("uv",new _t(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(b){const v=new J,w=new J,x=new J;for(let B=0;B<n.length;B+=3)I(n[B+0],v),I(n[B+1],w),I(n[B+2],x),l(v,w,x,b)}function l(b,v,w,x){const B=x+1,Z=[];for(let N=0;N<=B;N++){Z[N]=[];const W=b.clone().lerp(w,N/B),M=v.clone().lerp(w,N/B),F=B-N;for(let T=0;T<=F;T++)T===0&&N===B?Z[N][T]=W:Z[N][T]=W.clone().lerp(M,T/F)}for(let N=0;N<B;N++)for(let W=0;W<2*(B-N)-1;W++){const M=Math.floor(W/2);W%2===0?(h(Z[N][M+1]),h(Z[N+1][M]),h(Z[N][M])):(h(Z[N][M+1]),h(Z[N+1][M+1]),h(Z[N+1][M]))}}function c(b){const v=new J;for(let w=0;w<s.length;w+=3)v.x=s[w+0],v.y=s[w+1],v.z=s[w+2],v.normalize().multiplyScalar(b),s[w+0]=v.x,s[w+1]=v.y,s[w+2]=v.z}function u(){const b=new J;for(let v=0;v<s.length;v+=3){b.x=s[v+0],b.y=s[v+1],b.z=s[v+2];const w=A(b)/2/Math.PI+.5,x=m(b)/Math.PI+.5;o.push(w,1-x)}p(),d()}function d(){for(let b=0;b<o.length;b+=6){const v=o[b+0],w=o[b+2],x=o[b+4],B=Math.max(v,w,x),Z=Math.min(v,w,x);B>.9&&Z<.1&&(v<.2&&(o[b+0]+=1),w<.2&&(o[b+2]+=1),x<.2&&(o[b+4]+=1))}}function h(b){s.push(b.x,b.y,b.z)}function I(b,v){const w=b*3;v.x=e[w+0],v.y=e[w+1],v.z=e[w+2]}function p(){const b=new J,v=new J,w=new J,x=new J,B=new He,Z=new He,N=new He;for(let W=0,M=0;W<s.length;W+=9,M+=6){b.set(s[W+0],s[W+1],s[W+2]),v.set(s[W+3],s[W+4],s[W+5]),w.set(s[W+6],s[W+7],s[W+8]),B.set(o[M+0],o[M+1]),Z.set(o[M+2],o[M+3]),N.set(o[M+4],o[M+5]),x.copy(b).add(v).add(w).divideScalar(3);const F=A(x);y(B,M+0,b,F),y(Z,M+2,v,F),y(N,M+4,w,F)}}function y(b,v,w,x){x<0&&b.x===1&&(o[v]=b.x-1),w.x===0&&w.z===0&&(o[v]=x/2/Math.PI+.5)}function A(b){return Math.atan2(b.z,-b.x)}function m(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gu(e.vertices,e.indices,e.radius,e.details)}}class dS extends Gu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new dS(e.radius,e.detail)}}const wv=new J,Gv=new J,NR=new J,Bv=new Us;class fee extends gn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(Ed*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),h={},I=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:y,b:A,c:m}=Bv;if(y.fromBufferAttribute(a,c[0]),A.fromBufferAttribute(a,c[1]),m.fromBufferAttribute(a,c[2]),Bv.getNormal(NR),d[0]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[1]=`${Math.round(A.x*r)},${Math.round(A.y*r)},${Math.round(A.z*r)}`,d[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let b=0;b<3;b++){const v=(b+1)%3,w=d[b],x=d[v],B=Bv[u[b]],Z=Bv[u[v]],N=`${w}_${x}`,W=`${x}_${w}`;W in h&&h[W]?(NR.dot(h[W].normal)<=s&&(I.push(B.x,B.y,B.z),I.push(Z.x,Z.y,Z.z)),h[W]=null):N in h||(h[N]={index0:c[b],index1:c[v],normal:NR.clone()})}}for(const p in h)if(h[p]){const{index0:y,index1:A}=h[p];wv.fromBufferAttribute(a,y),Gv.fromBufferAttribute(a,A),I.push(wv.x,wv.y,wv.z),I.push(Gv.x,Gv.y,Gv.z)}this.setAttribute("position",new _t(I,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class nl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){vt("Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let r=0;const s=i.length;let o;n?o=n:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const u=i[r],h=i[r+1]-u,I=(o-u)/h;return(r+I)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new He:new J);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new J,r=[],s=[],o=[],a=new J,l=new Qt;for(let I=0;I<=e;I++){const p=I/e;r[I]=this.getTangentAt(p,new J)}s[0]=new J,o[0]=new J;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),h<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let I=1;I<=e;I++){if(s[I]=s[I-1].clone(),o[I]=o[I-1].clone(),a.crossVectors(r[I-1],r[I]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(sn(r[I-1].dot(r[I]),-1,1));s[I].applyMatrix4(l.makeRotationAxis(a,p))}o[I].crossVectors(r[I],s[I])}if(n===!0){let I=Math.acos(sn(s[0].dot(s[e]),-1,1));I/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(I=-I);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],I*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class hS extends nl{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n=new He){const i=n,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,I=c-this.aY;l=h*u-I*d+this.aX,c=h*d+I*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Cee extends hS{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function m_(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let h=(o-s)/c-(a-s)/(c+u)+(a-o)/u,I=(a-o)/u-(l-o)/(u+d)+(l-a)/d;h*=u,I*=u,r(o,a,h,I)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const Sv=new J,WR=new m_,MR=new m_,VR=new m_;class pee extends nl{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new J){const i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(Sv.subVectors(r[0],r[1]).add(r[0]),c=Sv);const d=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Sv.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Sv),this.curveType==="centripetal"||this.curveType==="chordal"){const I=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(d),I),y=Math.pow(d.distanceToSquared(h),I),A=Math.pow(h.distanceToSquared(u),I);y<1e-4&&(y=1),p<1e-4&&(p=y),A<1e-4&&(A=y),WR.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,p,y,A),MR.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,p,y,A),VR.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,p,y,A)}else this.curveType==="catmullrom"&&(WR.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),MR.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),VR.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return i.set(WR.calc(l),MR.calc(l),VR.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new J().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function TL(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function ZHe(t,e){const n=1-t;return n*n*e}function RHe(t,e){return 2*(1-t)*t*e}function NHe(t,e){return t*t*e}function Dm(t,e,n,i){return ZHe(t,e)+RHe(t,n)+NHe(t,i)}function WHe(t,e){const n=1-t;return n*n*n*e}function MHe(t,e){const n=1-t;return 3*n*n*t*e}function VHe(t,e){return 3*(1-t)*t*t*e}function FHe(t,e){return t*t*t*e}function Um(t,e,n,i,r){return WHe(t,e)+MHe(t,n)+VHe(t,i)+FHe(t,r)}class A_ extends nl{constructor(e=new He,n=new He,i=new He,r=new He){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new He){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Um(e,r.x,s.x,o.x,a.x),Um(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mee extends nl{constructor(e=new J,n=new J,i=new J,r=new J){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new J){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Um(e,r.x,s.x,o.x,a.x),Um(e,r.y,s.y,o.y,a.y),Um(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class y_ extends nl{constructor(e=new He,n=new He){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new He){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new He){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Aee extends nl{constructor(e=new J,n=new J){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new J){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new J){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class b_ extends nl{constructor(e=new He,n=new He,i=new He){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new He){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Dm(e,r.x,s.x,o.x),Dm(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class v_ extends nl{constructor(e=new J,n=new J,i=new J){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new J){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Dm(e,r.x,s.x,o.x),Dm(e,r.y,s.y,o.y),Dm(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class x_ extends nl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new He){const i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(TL(a,l.x,c.x,u.x,d.x),TL(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new He().fromArray(r))}return this}}var s2=Object.freeze({__proto__:null,ArcCurve:Cee,CatmullRomCurve3:pee,CubicBezierCurve:A_,CubicBezierCurve3:mee,EllipseCurve:hS,LineCurve:y_,LineCurve3:Aee,QuadraticBezierCurve:b_,QuadraticBezierCurve3:v_,SplineCurve:x_});class yee extends nl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new s2[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new s2[r.type]().fromJSON(r))}return this}}class o2 extends yee{constructor(e){super(),this.type="Path",this.currentPoint=new He,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new y_(this.currentPoint.clone(),new He(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new b_(this.currentPoint.clone(),new He(e,n),new He(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){const a=new A_(this.currentPoint.clone(),new He(e,n),new He(i,r),new He(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new x_(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,n+u,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){const c=new hS(e,n,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}let Hd=class extends o2{constructor(e){super(e),this.uuid=Go(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new o2().fromJSON(r))}return this}};function _He(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=bee(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c;if(i&&(s=kHe(t,e,s,n)),t.length>80*n){a=t[0],l=t[1];let u=a,d=l;for(let h=n;h<r;h+=n){const I=t[h],p=t[h+1];I<a&&(a=I),p<l&&(l=p),I>u&&(u=I),p>d&&(d=p)}c=Math.max(u-a,d-l),c=c!==0?32767/c:0}return g0(s,o,n,a,l,c,0),o}function bee(t,e,n,i,r){let s;if(r===QHe(t,e,n,i)>0)for(let o=e;o<n;o+=i)s=XL(o/i|0,t[o],t[o+1],s);else for(let o=n-i;o>=e;o-=i)s=XL(o/i|0,t[o],t[o+1],s);return s&&yC(s,s.next)&&(d0(s),s=s.next),s}function oh(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(yC(n,n.next)||Mi(n.prev,n,n.next)===0)){if(d0(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function g0(t,e,n,i,r,s,o){if(!t)return;!o&&s&&jHe(t,i,r,s);let a=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(s?XHe(t,i,r,s):THe(t)){e.push(l.i,t.i,c.i),d0(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=EHe(oh(t),e),g0(t,e,n,i,r,s,2)):o===2&&YHe(t,e,n,i,r,s):g0(oh(t),e,n,i,r,s,1);break}}}function THe(t){const e=t.prev,n=t,i=t.next;if(Mi(e,n,i)>=0)return!1;const r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,u=Math.min(r,s,o),d=Math.min(a,l,c),h=Math.max(r,s,o),I=Math.max(a,l,c);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=I&&mm(r,a,s,l,o,c,p.x,p.y)&&Mi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function XHe(t,e,n,i){const r=t.prev,s=t,o=t.next;if(Mi(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,d=s.y,h=o.y,I=Math.min(a,l,c),p=Math.min(u,d,h),y=Math.max(a,l,c),A=Math.max(u,d,h),m=V3(I,p,e,n,i),b=V3(y,A,e,n,i);let v=t.prevZ,w=t.nextZ;for(;v&&v.z>=m&&w&&w.z<=b;){if(v.x>=I&&v.x<=y&&v.y>=p&&v.y<=A&&v!==r&&v!==o&&mm(a,u,l,d,c,h,v.x,v.y)&&Mi(v.prev,v,v.next)>=0||(v=v.prevZ,w.x>=I&&w.x<=y&&w.y>=p&&w.y<=A&&w!==r&&w!==o&&mm(a,u,l,d,c,h,w.x,w.y)&&Mi(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;v&&v.z>=m;){if(v.x>=I&&v.x<=y&&v.y>=p&&v.y<=A&&v!==r&&v!==o&&mm(a,u,l,d,c,h,v.x,v.y)&&Mi(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;w&&w.z<=b;){if(w.x>=I&&w.x<=y&&w.y>=p&&w.y<=A&&w!==r&&w!==o&&mm(a,u,l,d,c,h,w.x,w.y)&&Mi(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function EHe(t,e){let n=t;do{const i=n.prev,r=n.next.next;!yC(i,r)&&xee(i,n,n.next,r)&&u0(i,r)&&u0(r,i)&&(e.push(i.i,n.i,r.i),d0(n),d0(n.next),n=t=r),n=n.next}while(n!==t);return oh(n)}function YHe(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&DHe(o,a)){let l=wee(o,a);o=oh(o,o.next),l=oh(l,l.next),g0(o,e,n,i,r,s,0),g0(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function kHe(t,e,n,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=bee(t,a,l,i,!1);c===c.next&&(c.steiner=!0),r.push(OHe(c))}r.sort(HHe);for(let s=0;s<r.length;s++)n=KHe(r[s],n);return n}function HHe(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){const i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function KHe(t,e){const n=LHe(t,e);if(!n)return e;const i=wee(n,t);return oh(i,i.next),oh(n,n.next)}function LHe(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,o;if(yC(t,n))return n;do{if(yC(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const d=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=i&&d>s&&(s=d,o=n.x<n.next.x?n:n.next,d===i))return o}n=n.next}while(n!==e);if(!o)return null;const a=o,l=o.x,c=o.y;let u=1/0;n=o;do{if(i>=n.x&&n.x>=l&&i!==n.x&&vee(r<c?i:s,r,l,c,r<c?s:i,r,n.x,n.y)){const d=Math.abs(r-n.y)/(i-n.x);u0(n,t)&&(d<u||d===u&&(n.x>o.x||n.x===o.x&&zHe(o,n)))&&(o=n,u=d)}n=n.next}while(n!==a);return o}function zHe(t,e){return Mi(t.prev,t,e.prev)<0&&Mi(e.next,t,t.next)<0}function jHe(t,e,n,i){let r=t;do r.z===0&&(r.z=V3(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,PHe(r)}function PHe(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let c=0;c<n&&(a++,o=o.nextZ,!!o);c++);let l=n;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=o}s.nextZ=null,n*=2}while(e>1);return t}function V3(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function OHe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function vee(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function mm(t,e,n,i,r,s,o,a){return!(t===o&&e===a)&&vee(t,e,n,i,r,s,o,a)}function DHe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!UHe(t,e)&&(u0(t,e)&&u0(e,t)&&JHe(t,e)&&(Mi(t.prev,t,e.prev)||Mi(t,e.prev,e))||yC(t,e)&&Mi(t.prev,t,t.next)>0&&Mi(e.prev,e,e.next)>0)}function Mi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function yC(t,e){return t.x===e.x&&t.y===e.y}function xee(t,e,n,i){const r=Rv(Mi(t,e,n)),s=Rv(Mi(t,e,i)),o=Rv(Mi(n,i,t)),a=Rv(Mi(n,i,e));return!!(r!==s&&o!==a||r===0&&Zv(t,n,e)||s===0&&Zv(t,i,e)||o===0&&Zv(n,t,i)||a===0&&Zv(n,e,i))}function Zv(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Rv(t){return t>0?1:t<0?-1:0}function UHe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&xee(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function u0(t,e){return Mi(t.prev,t,t.next)<0?Mi(t,e,t.next)>=0&&Mi(t,t.prev,e)>=0:Mi(t,e,t.prev)<0||Mi(t,t.next,e)<0}function JHe(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function wee(t,e){const n=F3(t.i,t.x,t.y),i=F3(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function XL(t,e,n,i){const r=F3(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function d0(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F3(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function QHe(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class qHe{static triangulate(e,n,i=2){return _He(e,n,i)}}class Ha{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Ha.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];EL(e),YL(i,e);let o=e.length;n.forEach(EL);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,YL(i,n[l]);const a=qHe.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function EL(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function YL(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class IS extends gn{constructor(e=new Hd([new He(.5,.5),new He(-.5,.5),new He(-.5,-.5),new He(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new _t(r,3)),this.setAttribute("uv",new _t(s,2)),this.computeVertexNormals();function o(a){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,d=n.depth!==void 0?n.depth:1;let h=n.bevelEnabled!==void 0?n.bevelEnabled:!0,I=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:I-.1,y=n.bevelOffset!==void 0?n.bevelOffset:0,A=n.bevelSegments!==void 0?n.bevelSegments:3;const m=n.extrudePath,b=n.UVGenerator!==void 0?n.UVGenerator:$He;let v,w=!1,x,B,Z,N;m&&(v=m.getSpacedPoints(u),w=!0,h=!1,x=m.computeFrenetFrames(u,!1),B=new J,Z=new J,N=new J),h||(A=0,I=0,p=0,y=0);const W=a.extractPoints(c);let M=W.shape;const F=W.holes;if(!Ha.isClockWise(M)){M=M.reverse();for(let ve=0,U=F.length;ve<U;ve++){const We=F[ve];Ha.isClockWise(We)&&(F[ve]=We.reverse())}}function H(ve){const We=10000000000000001e-36;let Xe=ve[0];for(let Qe=1;Qe<=ve.length;Qe++){const Le=Qe%ve.length,mt=ve[Le],ot=mt.x-Xe.x,ft=mt.y-Xe.y,Q=ot*ot+ft*ft,L=Math.max(Math.abs(mt.x),Math.abs(mt.y),Math.abs(Xe.x),Math.abs(Xe.y)),Ce=We*L*L;if(Q<=Ce){ve.splice(Le,1),Qe--;continue}Xe=mt}}H(M),F.forEach(H);const K=F.length,z=M;for(let ve=0;ve<K;ve++){const U=F[ve];M=M.concat(U)}function j(ve,U,We){return U||on("ExtrudeGeometry: vec does not exist"),ve.clone().addScaledVector(U,We)}const O=M.length;function _(ve,U,We){let Xe,Qe,Le;const mt=ve.x-U.x,ot=ve.y-U.y,ft=We.x-ve.x,Q=We.y-ve.y,L=mt*mt+ot*ot,Ce=mt*Q-ot*ft;if(Math.abs(Ce)>Number.EPSILON){const Ve=Math.sqrt(L),Ke=Math.sqrt(ft*ft+Q*Q),Ze=U.x-ot/Ve,Rt=U.y+mt/Ve,pt=We.x-Q/Ke,kt=We.y+ft/Ke,Nt=((pt-Ze)*Q-(kt-Rt)*ft)/(mt*Q-ot*ft);Xe=Ze+mt*Nt-ve.x,Qe=Rt+ot*Nt-ve.y;const Ue=Xe*Xe+Qe*Qe;if(Ue<=2)return new He(Xe,Qe);Le=Math.sqrt(Ue/2)}else{let Ve=!1;mt>Number.EPSILON?ft>Number.EPSILON&&(Ve=!0):mt<-Number.EPSILON?ft<-Number.EPSILON&&(Ve=!0):Math.sign(ot)===Math.sign(Q)&&(Ve=!0),Ve?(Xe=-ot,Qe=mt,Le=Math.sqrt(L)):(Xe=mt,Qe=ot,Le=Math.sqrt(L/2))}return new He(Xe/Le,Qe/Le)}const E=[];for(let ve=0,U=z.length,We=U-1,Xe=ve+1;ve<U;ve++,We++,Xe++)We===U&&(We=0),Xe===U&&(Xe=0),E[ve]=_(z[ve],z[We],z[Xe]);const P=[];let q,re=E.concat();for(let ve=0,U=K;ve<U;ve++){const We=F[ve];q=[];for(let Xe=0,Qe=We.length,Le=Qe-1,mt=Xe+1;Xe<Qe;Xe++,Le++,mt++)Le===Qe&&(Le=0),mt===Qe&&(mt=0),q[Xe]=_(We[Xe],We[Le],We[mt]);P.push(q),re=re.concat(q)}let de;if(A===0)de=Ha.triangulateShape(z,F);else{const ve=[],U=[];for(let We=0;We<A;We++){const Xe=We/A,Qe=I*Math.cos(Xe*Math.PI/2),Le=p*Math.sin(Xe*Math.PI/2)+y;for(let mt=0,ot=z.length;mt<ot;mt++){const ft=j(z[mt],E[mt],Le);be(ft.x,ft.y,-Qe),Xe===0&&ve.push(ft)}for(let mt=0,ot=K;mt<ot;mt++){const ft=F[mt];q=P[mt];const Q=[];for(let L=0,Ce=ft.length;L<Ce;L++){const Ve=j(ft[L],q[L],Le);be(Ve.x,Ve.y,-Qe),Xe===0&&Q.push(Ve)}Xe===0&&U.push(Q)}}de=Ha.triangulateShape(ve,U)}const Re=de.length,Pe=p+y;for(let ve=0;ve<O;ve++){const U=h?j(M[ve],re[ve],Pe):M[ve];w?(Z.copy(x.normals[0]).multiplyScalar(U.x),B.copy(x.binormals[0]).multiplyScalar(U.y),N.copy(v[0]).add(Z).add(B),be(N.x,N.y,N.z)):be(U.x,U.y,0)}for(let ve=1;ve<=u;ve++)for(let U=0;U<O;U++){const We=h?j(M[U],re[U],Pe):M[U];w?(Z.copy(x.normals[ve]).multiplyScalar(We.x),B.copy(x.binormals[ve]).multiplyScalar(We.y),N.copy(v[ve]).add(Z).add(B),be(N.x,N.y,N.z)):be(We.x,We.y,d/u*ve)}for(let ve=A-1;ve>=0;ve--){const U=ve/A,We=I*Math.cos(U*Math.PI/2),Xe=p*Math.sin(U*Math.PI/2)+y;for(let Qe=0,Le=z.length;Qe<Le;Qe++){const mt=j(z[Qe],E[Qe],Xe);be(mt.x,mt.y,d+We)}for(let Qe=0,Le=F.length;Qe<Le;Qe++){const mt=F[Qe];q=P[Qe];for(let ot=0,ft=mt.length;ot<ft;ot++){const Q=j(mt[ot],q[ot],Xe);w?be(Q.x,Q.y+v[u-1].y,v[u-1].x+We):be(Q.x,Q.y,d+We)}}}ae(),he();function ae(){const ve=r.length/3;if(h){let U=0,We=O*U;for(let Xe=0;Xe<Re;Xe++){const Qe=de[Xe];xe(Qe[2]+We,Qe[1]+We,Qe[0]+We)}U=u+A*2,We=O*U;for(let Xe=0;Xe<Re;Xe++){const Qe=de[Xe];xe(Qe[0]+We,Qe[1]+We,Qe[2]+We)}}else{for(let U=0;U<Re;U++){const We=de[U];xe(We[2],We[1],We[0])}for(let U=0;U<Re;U++){const We=de[U];xe(We[0]+O*u,We[1]+O*u,We[2]+O*u)}}i.addGroup(ve,r.length/3-ve,0)}function he(){const ve=r.length/3;let U=0;Me(z,U),U+=z.length;for(let We=0,Xe=F.length;We<Xe;We++){const Qe=F[We];Me(Qe,U),U+=Qe.length}i.addGroup(ve,r.length/3-ve,1)}function Me(ve,U){let We=ve.length;for(;--We>=0;){const Xe=We;let Qe=We-1;Qe<0&&(Qe=ve.length-1);for(let Le=0,mt=u+A*2;Le<mt;Le++){const ot=O*Le,ft=O*(Le+1),Q=U+Xe+ot,L=U+Qe+ot,Ce=U+Qe+ft,Ve=U+Xe+ft;Ge(Q,L,Ce,Ve)}}}function be(ve,U,We){l.push(ve),l.push(U),l.push(We)}function xe(ve,U,We){pe(ve),pe(U),pe(We);const Xe=r.length/3,Qe=b.generateTopUV(i,r,Xe-3,Xe-2,Xe-1);Oe(Qe[0]),Oe(Qe[1]),Oe(Qe[2])}function Ge(ve,U,We,Xe){pe(ve),pe(U),pe(Xe),pe(U),pe(We),pe(Xe);const Qe=r.length/3,Le=b.generateSideWallUV(i,r,Qe-6,Qe-3,Qe-2,Qe-1);Oe(Le[0]),Oe(Le[1]),Oe(Le[3]),Oe(Le[1]),Oe(Le[2]),Oe(Le[3])}function pe(ve){r.push(l[ve*3+0]),r.push(l[ve*3+1]),r.push(l[ve*3+2])}function Oe(ve){s.push(ve.x),s.push(ve.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return e9e(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new s2[r.type]().fromJSON(r)),new IS(i,e.options)}}const $He={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],u=e[r*3+1];return[new He(s,o),new He(a,l),new He(c,u)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],c=e[i*3],u=e[i*3+1],d=e[i*3+2],h=e[r*3],I=e[r*3+1],p=e[r*3+2],y=e[s*3],A=e[s*3+1],m=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new He(o,1-l),new He(c,1-d),new He(h,1-p),new He(y,1-m)]:[new He(a,1-l),new He(u,1-d),new He(I,1-p),new He(A,1-m)]}};function e9e(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class ay extends Gu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ay(e.radius,e.detail)}}class fS extends gn{constructor(e=[new He(0,-.5),new He(.5,0),new He(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=sn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/n,d=new J,h=new He,I=new J,p=new J,y=new J;let A=0,m=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:A=e[b+1].x-e[b].x,m=e[b+1].y-e[b].y,I.x=m*1,I.y=-A,I.z=m*0,y.copy(I),I.normalize(),l.push(I.x,I.y,I.z);break;case e.length-1:l.push(y.x,y.y,y.z);break;default:A=e[b+1].x-e[b].x,m=e[b+1].y-e[b].y,I.x=m*1,I.y=-A,I.z=m*0,p.copy(I),I.x+=y.x,I.y+=y.y,I.z+=y.z,I.normalize(),l.push(I.x,I.y,I.z),y.copy(p)}for(let b=0;b<=n;b++){const v=i+b*u*r,w=Math.sin(v),x=Math.cos(v);for(let B=0;B<=e.length-1;B++){d.x=e[B].x*w,d.y=e[B].y,d.z=e[B].x*x,o.push(d.x,d.y,d.z),h.x=b/n,h.y=B/(e.length-1),a.push(h.x,h.y);const Z=l[3*B+0]*w,N=l[3*B+1],W=l[3*B+0]*x;c.push(Z,N,W)}}for(let b=0;b<n;b++)for(let v=0;v<e.length-1;v++){const w=v+b*e.length,x=w,B=w+e.length,Z=w+e.length+1,N=w+1;s.push(x,B,N),s.push(Z,N,B)}this.setIndex(s),this.setAttribute("position",new _t(o,3)),this.setAttribute("uv",new _t(a,2)),this.setAttribute("normal",new _t(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fS(e.points,e.segments,e.phiStart,e.phiLength)}}class ly extends Gu{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ly(e.radius,e.detail)}}class Bu extends gn{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=n/l,I=[],p=[],y=[],A=[];for(let m=0;m<u;m++){const b=m*h-o;for(let v=0;v<c;v++){const w=v*d-s;p.push(w,-b,0),y.push(0,0,1),A.push(v/a),A.push(1-m/l)}}for(let m=0;m<l;m++)for(let b=0;b<a;b++){const v=b+c*m,w=b+c*(m+1),x=b+1+c*(m+1),B=b+1+c*m;I.push(v,w,B),I.push(w,x,B)}this.setIndex(I),this.setAttribute("position",new _t(p,3)),this.setAttribute("normal",new _t(y,3)),this.setAttribute("uv",new _t(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bu(e.width,e.height,e.widthSegments,e.heightSegments)}}class CS extends gn{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],c=[],u=[];let d=e;const h=(n-e)/r,I=new J,p=new He;for(let y=0;y<=r;y++){for(let A=0;A<=i;A++){const m=s+A/i*o;I.x=d*Math.cos(m),I.y=d*Math.sin(m),l.push(I.x,I.y,I.z),c.push(0,0,1),p.x=(I.x/n+1)/2,p.y=(I.y/n+1)/2,u.push(p.x,p.y)}d+=h}for(let y=0;y<r;y++){const A=y*(i+1);for(let m=0;m<i;m++){const b=m+A,v=b,w=b+i+1,x=b+i+2,B=b+1;a.push(v,w,B),a.push(w,x,B)}}this.setIndex(a),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new CS(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class pS extends gn{constructor(e=new Hd([new He(0,.5),new He(-.5,-.5),new He(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new _t(r,3)),this.setAttribute("normal",new _t(s,3)),this.setAttribute("uv",new _t(o,2));function c(u){const d=r.length/3,h=u.extractPoints(n);let I=h.shape;const p=h.holes;Ha.isClockWise(I)===!1&&(I=I.reverse());for(let A=0,m=p.length;A<m;A++){const b=p[A];Ha.isClockWise(b)===!0&&(p[A]=b.reverse())}const y=Ha.triangulateShape(I,p);for(let A=0,m=p.length;A<m;A++){const b=p[A];I=I.concat(b)}for(let A=0,m=I.length;A<m;A++){const b=I[A];r.push(b.x,b.y,0),s.push(0,0,1),o.push(b.x,b.y)}for(let A=0,m=y.length;A<m;A++){const b=y[A],v=b[0]+d,w=b[1]+d,x=b[2]+d;i.push(v,w,x),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return t9e(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=n[e.shapes[r]];i.push(o)}return new pS(i,e.curveSegments)}}function t9e(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class cy extends gn{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new J,h=new J,I=[],p=[],y=[],A=[];for(let m=0;m<=i;m++){const b=[],v=m/i;let w=0;m===0&&o===0?w=.5/n:m===i&&l===Math.PI&&(w=-.5/n);for(let x=0;x<=n;x++){const B=x/n;d.x=-e*Math.cos(r+B*s)*Math.sin(o+v*a),d.y=e*Math.cos(o+v*a),d.z=e*Math.sin(r+B*s)*Math.sin(o+v*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),y.push(h.x,h.y,h.z),A.push(B+w,1-v),b.push(c++)}u.push(b)}for(let m=0;m<i;m++)for(let b=0;b<n;b++){const v=u[m][b+1],w=u[m][b],x=u[m+1][b],B=u[m+1][b+1];(m!==0||o>0)&&I.push(v,w,B),(m!==i-1||l<Math.PI)&&I.push(w,x,B)}this.setIndex(I),this.setAttribute("position",new _t(p,3)),this.setAttribute("normal",new _t(y,3)),this.setAttribute("uv",new _t(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cy(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class mS extends Gu{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new mS(e.radius,e.detail)}}class AS extends gn{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new J,d=new J,h=new J;for(let I=0;I<=i;I++)for(let p=0;p<=r;p++){const y=p/r*s,A=I/i*Math.PI*2;d.x=(e+n*Math.cos(A))*Math.cos(y),d.y=(e+n*Math.cos(A))*Math.sin(y),d.z=n*Math.sin(A),a.push(d.x,d.y,d.z),u.x=e*Math.cos(y),u.y=e*Math.sin(y),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/r),c.push(I/i)}for(let I=1;I<=i;I++)for(let p=1;p<=r;p++){const y=(r+1)*I+p-1,A=(r+1)*(I-1)+p-1,m=(r+1)*(I-1)+p,b=(r+1)*I+p;o.push(y,A,b),o.push(A,m,b)}this.setIndex(o),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new AS(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class yS extends gn{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],u=[],d=new J,h=new J,I=new J,p=new J,y=new J,A=new J,m=new J;for(let v=0;v<=i;++v){const w=v/i*s*Math.PI*2;b(w,s,o,e,I),b(w+.01,s,o,e,p),A.subVectors(p,I),m.addVectors(p,I),y.crossVectors(A,m),m.crossVectors(y,A),y.normalize(),m.normalize();for(let x=0;x<=r;++x){const B=x/r*Math.PI*2,Z=-n*Math.cos(B),N=n*Math.sin(B);d.x=I.x+(Z*m.x+N*y.x),d.y=I.y+(Z*m.y+N*y.y),d.z=I.z+(Z*m.z+N*y.z),l.push(d.x,d.y,d.z),h.subVectors(d,I).normalize(),c.push(h.x,h.y,h.z),u.push(v/i),u.push(x/r)}}for(let v=1;v<=i;v++)for(let w=1;w<=r;w++){const x=(r+1)*(v-1)+(w-1),B=(r+1)*v+(w-1),Z=(r+1)*v+w,N=(r+1)*(v-1)+w;a.push(x,B,N),a.push(B,Z,N)}this.setIndex(a),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(u,2));function b(v,w,x,B,Z){const N=Math.cos(v),W=Math.sin(v),M=x/w*v,F=Math.cos(M);Z.x=B*(2+F)*.5*N,Z.y=B*(2+F)*W*.5,Z.z=B*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yS(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class bS extends gn{constructor(e=new v_(new J(-1,-1,0),new J(-1,1,0),new J(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new J,l=new J,c=new He;let u=new J;const d=[],h=[],I=[],p=[];y(),this.setIndex(p),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(h,3)),this.setAttribute("uv",new _t(I,2));function y(){for(let v=0;v<n;v++)A(v);A(s===!1?n:0),b(),m()}function A(v){u=e.getPointAt(v/n,u);const w=o.normals[v],x=o.binormals[v];for(let B=0;B<=r;B++){const Z=B/r*Math.PI*2,N=Math.sin(Z),W=-Math.cos(Z);l.x=W*w.x+N*x.x,l.y=W*w.y+N*x.y,l.z=W*w.z+N*x.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,d.push(a.x,a.y,a.z)}}function m(){for(let v=1;v<=n;v++)for(let w=1;w<=r;w++){const x=(r+1)*(v-1)+(w-1),B=(r+1)*v+(w-1),Z=(r+1)*v+w,N=(r+1)*(v-1)+w;p.push(x,B,N),p.push(B,Z,N)}}function b(){for(let v=0;v<=n;v++)for(let w=0;w<=r;w++)c.x=v/n,c.y=w/r,I.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new bS(new s2[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Gee extends gn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new J,s=new J;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],h=d.start,I=d.count;for(let p=h,y=h+I;p<y;p+=3)for(let A=0;A<3;A++){const m=a.getX(p+A),b=a.getX(p+(A+1)%3);r.fromBufferAttribute(o,m),s.fromBufferAttribute(o,b),kL(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,d=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,d),kL(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new _t(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function kL(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var HL=Object.freeze({__proto__:null,BoxGeometry:yh,CapsuleGeometry:gS,CircleGeometry:uS,ConeGeometry:oy,CylinderGeometry:sy,DodecahedronGeometry:dS,EdgesGeometry:fee,ExtrudeGeometry:IS,IcosahedronGeometry:ay,LatheGeometry:fS,OctahedronGeometry:ly,PlaneGeometry:Bu,PolyhedronGeometry:Gu,RingGeometry:CS,ShapeGeometry:pS,SphereGeometry:cy,TetrahedronGeometry:mS,TorusGeometry:AS,TorusKnotGeometry:yS,TubeGeometry:bS,WireframeGeometry:Gee});class Bee extends Yr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new wt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class See extends as{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class w_ extends Yr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new wt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new no,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Zee extends w_{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new He(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return sn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new wt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new wt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new wt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Ree extends Yr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wt(16777215),this.specular=new wt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new no,this.combine=$0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Nee extends Yr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Wee extends Yr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Mee extends Yr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new no,this.combine=$0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class G_ extends Yr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=P$,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class B_ extends Yr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Vee extends Yr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wu,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fee extends Ms{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function wd(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function _ee(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Tee(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function _3(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function S_(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push(...o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function n9e(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let I=0;I<c.times.length;++I){const p=c.times[I]*r;if(!(p<n||p>=i)){d.push(c.times[I]);for(let y=0;y<u;++y)h.push(c.values[I*u+y])}}d.length!==0&&(c.times=wd(d,c.times.constructor),c.values=wd(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function i9e(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(m){return m.name===a.name&&m.ValueTypeName===l});if(c===void 0)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const I=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=I/3);const p=a.times.length-1;let y;if(s<=a.times[0]){const m=u,b=d-u;y=a.values.slice(m,b)}else if(s>=a.times[p]){const m=p*d+u,b=m+d-u;y=a.values.slice(m,b)}else{const m=a.createInterpolant(),b=u,v=d-u;m.evaluate(s),y=m.resultBuffer.slice(b,v)}l==="quaternion"&&new Zr().fromArray(y).normalize().conjugate().toArray(y);const A=c.times.length;for(let m=0;m<A;++m){const b=m*I+h;if(l==="quaternion")Zr.multiplyQuaternionsFlat(c.values,b,y,0,c.values,b);else{const v=I-h*2;for(let w=0;w<v;++w)c.values[b+w]-=y[w]}}}return t.blendMode=i_,t}class r9e{static convertArray(e,n){return wd(e,n)}static isTypedArray(e){return _ee(e)}static getKeyframeOrder(e){return Tee(e)}static sortedArray(e,n,i){return _3(e,n,i)}static flattenJSON(e,n,i,r){S_(e,n,i,r)}static subclip(e,n,i,r,s=30){return n9e(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return i9e(e,n,i,r)}}class gy{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Xee extends gy{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:bd,endingEnd:bd}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case vd:s=e,a=2*n-i;break;case s0:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case vd:o=e,l=2*i-n;break;case s0:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}const c=(i-n)*.5,u=this.valueSize;this._weightPrev=c/(n-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,I=this._weightNext,p=(i-n)/(r-n),y=p*p,A=y*p,m=-h*A+2*h*y-h*p,b=(1+h)*A+(-1.5-2*h)*y+(-.5+h)*p+1,v=(-1-I)*A+(1.5+I)*y+.5*p,w=I*A-I*y;for(let x=0;x!==a;++x)s[x]=m*o[u+x]+b*o[c+x]+v*o[l+x]+w*o[d+x];return s}}class Z_ extends gy{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-n)/(r-n),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class Eee extends gy{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ha{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=wd(n,this.TimeBufferType),this.values=wd(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:wd(e.times,Array),values:wd(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Eee(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Z_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Xee(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case hC:n=this.InterpolantFactoryMethodDiscrete;break;case r0:n=this.InterpolantFactoryMethodLinear;break;case vx:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return vt("KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return hC;case this.InterpolantFactoryMethodLinear:return r0;case this.InterpolantFactoryMethodSmooth:return vx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(on("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(on("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){on("KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){on("KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&_ee(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){on("KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===vx,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,I=d+i;for(let p=0;p!==i;++p){const y=n[d+p];if(y!==n[h+p]||y!==n[I+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let I=0;I!==i;++I)n[h+I]=n[d+I]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)n[l+c]=n[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}ha.prototype.ValueTypeName="";ha.prototype.TimeBufferType=Float32Array;ha.prototype.ValueBufferType=Float32Array;ha.prototype.DefaultInterpolation=r0;class bh extends ha{constructor(e,n,i){super(e,n,i)}}bh.prototype.ValueTypeName="bool";bh.prototype.ValueBufferType=Array;bh.prototype.DefaultInterpolation=hC;bh.prototype.InterpolantFactoryMethodLinear=void 0;bh.prototype.InterpolantFactoryMethodSmooth=void 0;class R_ extends ha{constructor(e,n,i,r){super(e,n,i,r)}}R_.prototype.ValueTypeName="color";class h0 extends ha{constructor(e,n,i,r){super(e,n,i,r)}}h0.prototype.ValueTypeName="number";class Yee extends gy{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n);let c=e*a;for(let u=c+a;c!==u;c+=4)Zr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class uy extends ha{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new Yee(this.times,this.values,this.getValueSize(),e)}}uy.prototype.ValueTypeName="quaternion";uy.prototype.InterpolantFactoryMethodSmooth=void 0;class vh extends ha{constructor(e,n,i){super(e,n,i)}}vh.prototype.ValueTypeName="string";vh.prototype.ValueBufferType=Array;vh.prototype.DefaultInterpolation=hC;vh.prototype.InterpolantFactoryMethodLinear=void 0;vh.prototype.InterpolantFactoryMethodSmooth=void 0;class I0 extends ha{constructor(e,n,i,r){super(e,n,i,r)}}I0.prototype.ValueTypeName="vector";class f0{constructor(e="",n=-1,i=[],r=nS){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=Go(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(o9e(i[o]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,o=i.length;s!==o;++s)n.push(ha.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Tee(l);l=_3(l,1,u),c=_3(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new h0(".morphTargetInfluences["+n[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(vt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return on("AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,I,p,y){if(I.length!==0){const A=[],m=[];S_(I,A,m,p),A.length!==0&&y.push(new d(h,A,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const I={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let y=0;y<h[p].morphTargets.length;y++)I[h[p].morphTargets[y]]=-1;for(const y in I){const A=[],m=[];for(let b=0;b!==h[p].morphTargets.length;++b){const v=h[p];A.push(v.time),m.push(v.morphTarget===y?1:0)}r.push(new h0(".morphTargetInfluence["+y+"]",A,m))}l=I.length*o}else{const I=".bones["+n[d].name+"]";i(I0,I+".position",h,"pos",r),i(uy,I+".quaternion",h,"rot",r),i(I0,I+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const n=new this.constructor(this.name,this.duration,e,this.blendMode);return n.userData=JSON.parse(JSON.stringify(this.userData)),n}toJSON(){return this.constructor.toJSON(this)}}function s9e(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return h0;case"vector":case"vector2":case"vector3":case"vector4":return I0;case"color":return R_;case"quaternion":return uy;case"bool":case"boolean":return bh;case"string":return vh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function o9e(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=s9e(t.type);if(t.times===void 0){const n=[],i=[];S_(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Zl={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class vS{constructor(e,n,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this._abortController=null,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const I=c[d],p=c[d+1];if(I.global&&(I.lastIndex=0),I.test(u))return p}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const kee=new vS;class Vs{constructor(e){this.manager=e!==void 0?e:kee,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Vs.DEFAULT_MATERIAL_NAME="__DEFAULT";const gc={};class a9e extends Error{constructor(e,n){super(e),this.response=n}}class Bo extends Vs{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Zl.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(gc[e]!==void 0){gc[e].push({onLoad:n,onProgress:i,onError:r});return}gc[e]=[],gc[e].push({onLoad:n,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&vt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=gc[e],d=c.body.getReader(),h=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),I=h?parseInt(h):0,p=I!==0;let y=0;const A=new ReadableStream({start(m){b();function b(){d.read().then(({done:v,value:w})=>{if(v)m.close();else{y+=w.byteLength;const x=new ProgressEvent("progress",{lengthComputable:p,loaded:y,total:I});for(let B=0,Z=u.length;B<Z;B++){const N=u[B];N.onProgress&&N.onProgress(x)}m.enqueue(w),b()}},v=>{m.error(v)})}}});return new Response(A)}else throw new a9e(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a==="")return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,I=new TextDecoder(h);return c.arrayBuffer().then(p=>I.decode(p))}}}).then(c=>{Zl.add(`file:${e}`,c);const u=gc[e];delete gc[e];for(let d=0,h=u.length;d<h;d++){const I=u[d];I.onLoad&&I.onLoad(c)}}).catch(c=>{const u=gc[e];if(u===void 0)throw this.manager.itemError(e),c;delete gc[e];for(let d=0,h=u.length;d<h;d++){const I=u[d];I.onError&&I.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class l9e extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Bo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):on(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=f0.parse(e[i]);n.push(r)}return n}}class c9e extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=[],a=new kd,l=new Bo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(h){const I=s.parse(h,!0);o[d]={width:I.width,height:I.height,format:I.format,mipmaps:I.mipmaps},c+=1,c===6&&(I.mipmapCount===1&&(a.minFilter=Ln),a.image=o,a.format=I.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let d=0,h=e.length;d<h;++d)u(d);else l.load(e,function(d){const h=s.parse(d,!0);if(h.isCubemap){const I=h.mipmaps.length/h.mipmapCount;for(let p=0;p<I;p++){o[p]={mipmaps:[]};for(let y=0;y<h.mipmapCount;y++)o[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+y]),o[p].format=h.format,o[p].width=h.width,o[p].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=Ln),a.format=h.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}}const cI=new WeakMap;class C0 extends Vs{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Zl.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0);else{let d=cI.get(o);d===void 0&&(d=[],cI.set(o,d)),d.push({onLoad:n,onError:r})}return o}const a=l0("img");function l(){u(),n&&n(this);const d=cI.get(this)||[];for(let h=0;h<d.length;h++){const I=d[h];I.onLoad&&I.onLoad(this)}cI.delete(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),Zl.remove(`image:${e}`);const h=cI.get(this)||[];for(let I=0;I<h.length;I++){const p=h[I];p.onError&&p.onError(d)}cI.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),Zl.add(`image:${e}`,a),s.manager.itemStart(e),a.src=e,a}}class Hee extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=new ry;s.colorSpace=ts;const o=new C0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class N_ extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new sa,a=new Bo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{u(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Vi,o.wrapT=c.wrapT!==void 0?c.wrapT:Vi,o.magFilter=c.magFilter!==void 0?c.magFilter:Ln,o.minFilter=c.minFilter!==void 0?c.minFilter:Ln,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=ka),c.mipmapCount===1&&(o.minFilter=Ln),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,n&&n(o,c)},i,r),o}}class g9e extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=new $n,o=new C0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class Su extends Tn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new wt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class Kee extends Su{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Tn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new wt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const FR=new Qt,KL=new J,LL=new J;class W_{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new He(512,512),this.mapType=Ss,this.map=null,this.mapPass=null,this.matrix=new Qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qC,this._frameExtents=new He(1,1),this._viewportCount=1,this._viewports=[new _n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;KL.setFromMatrixPosition(e.matrixWorld),n.position.copy(KL),LL.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(LL),n.updateMatrixWorld(),FR.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FR,n.coordinateSystem,n.reversedDepth),n.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(FR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class u9e extends W_{constructor(){super(new Wi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const n=this.camera,i=CC*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Lee extends Su{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Tn.DEFAULT_UP),this.updateMatrix(),this.target=new Tn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new u9e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const zL=new Qt,Qp=new J,_R=new J;class d9e extends W_{constructor(){super(new Wi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new He(4,2),this._viewportCount=6,this._viewports=[new _n(2,1,1,1),new _n(0,1,1,1),new _n(3,1,1,1),new _n(1,1,1,1),new _n(3,0,1,1),new _n(1,0,1,1)],this._cubeDirections=[new J(1,0,0),new J(-1,0,0),new J(0,0,1),new J(0,0,-1),new J(0,1,0),new J(0,-1,0)],this._cubeUps=[new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,0,1),new J(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Qp.setFromMatrixPosition(e.matrixWorld),i.position.copy(Qp),_R.copy(i.position),_R.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(_R),i.updateMatrixWorld(),r.makeTranslation(-Qp.x,-Qp.y,-Qp.z),zL.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zL,i.coordinateSystem,i.reversedDepth)}}class zee extends Su{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new d9e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ua extends iy{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class h9e extends W_{constructor(){super(new Ua(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jee extends Su{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Tn.DEFAULT_UP),this.updateMatrix(),this.target=new Tn,this.shadow=new h9e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Pee extends Su{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Oee extends Su{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class Dee{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new J)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class Uee extends Su{constructor(e=new Dee,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class xS extends Vs{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,o=new Bo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):on(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&vt("MaterialLoader: Undefined texture",s),n[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new wt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new wt().setHex(o.value);break;case"v2":r.uniforms[s].value=new He().fromArray(o.value);break;case"v3":r.uniforms[s].value=new J().fromArray(o.value);break;case"v4":r.uniforms[s].value=new _n().fromArray(o.value);break;case"m3":r.uniforms[s].value=new hn().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Qt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new He().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new He().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return xS.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:Bee,SpriteMaterial:d_,RawShaderMaterial:See,ShaderMaterial:as,PointsMaterial:f_,MeshPhysicalMaterial:Zee,MeshStandardMaterial:w_,MeshPhongMaterial:Ree,MeshToonMaterial:Nee,MeshNormalMaterial:Wee,MeshLambertMaterial:Mee,MeshDepthMaterial:G_,MeshDistanceMaterial:B_,MeshBasicMaterial:Uc,MeshMatcapMaterial:Vee,LineDashedMaterial:Fee,LineBasicMaterial:Ms,Material:Yr};return new n[e]}}class T3{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class Jee extends gn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Qee extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Bo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):on(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(I,p){if(n[p]!==void 0)return n[p];const A=I.interleavedBuffers[p],m=s(I,A.buffer),b=FI(A.type,m),v=new aS(b,A.stride);return v.uuid=A.uuid,n[p]=v,v}function s(I,p){if(i[p]!==void 0)return i[p];const A=I.arrayBuffers[p],m=new Uint32Array(A).buffer;return i[p]=m,m}const o=e.isInstancedBufferGeometry?new Jee:new gn,a=e.data.index;if(a!==void 0){const I=FI(a.type,a.array);o.setIndex(new Wn(I,1))}const l=e.data.attributes;for(const I in l){const p=l[I];let y;if(p.isInterleavedBufferAttribute){const A=r(e.data,p.data);y=new sh(A,p.itemSize,p.offset,p.normalized)}else{const A=FI(p.type,p.array),m=p.isInstancedBufferAttribute?AC:Wn;y=new m(A,p.itemSize,p.normalized)}p.name!==void 0&&(y.name=p.name),p.usage!==void 0&&y.setUsage(p.usage),o.setAttribute(I,y)}const c=e.data.morphAttributes;if(c)for(const I in c){const p=c[I],y=[];for(let A=0,m=p.length;A<m;A++){const b=p[A];let v;if(b.isInterleavedBufferAttribute){const w=r(e.data,b.data);v=new sh(w,b.itemSize,b.offset,b.normalized)}else{const w=FI(b.type,b.array);v=new Wn(w,b.itemSize,b.normalized)}b.name!==void 0&&(v.name=b.name),y.push(v)}o.morphAttributes[I]=y}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let I=0,p=d.length;I!==p;++I){const y=d[I];o.addGroup(y.start,y.count,y.materialIndex)}const h=e.data.boundingSphere;return h!==void 0&&(o.boundingSphere=new Tr().fromJSON(h)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class I9e extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?T3.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Bo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){r!==void 0&&r(d),d("ObjectLoader: Can't parse "+e+".",d.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),on("ObjectLoader: Can't load "+e);return}s.parse(c,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?T3.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Bo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),n!==void 0){let d=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){d=!0;break}d===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new Hd().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new lS().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new Qee;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in HL?a=HL[l.type].fromJSON(l,n):vt(`ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new xS;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=f0.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(u)}else return l.data?{data:FI(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new vS(n);s=new C0(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],h=d.url;if(Array.isArray(h)){const I=[];for(let p=0,y=h.length;p<y;p++){const A=h[p],m=a(A);m!==null&&(m instanceof HTMLImageElement?I.push(m):I.push(new sa(m.data,m.width,m.height)))}r[d.uuid]=new Gc(I)}else{const I=a(d.url);r[d.uuid]=new Gc(I)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:FI(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new C0(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let d=0,h=c.length;d<h;d++){const I=c[d],p=await s(I);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new sa(p.data,p.width,p.height)))}i[l.uuid]=new Gc(u)}else{const u=await s(l.url);i[l.uuid]=new Gc(u)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(vt("ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&vt('ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&vt("ObjectLoader: Undefined image",a.image);const l=n[a.image],c=l.data;let u;Array.isArray(c)?(u=new ry,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new sa:u=new $n,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=i(a.mapping,f9e)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=i(a.wrap[0],jL),u.wrapT=i(a.wrap[1],jL)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=i(a.minFilter,PL)),a.magFilter!==void 0&&(u.magFilter=i(a.magFilter,PL)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,n,i,r,s){let o;function a(h){return n[h]===void 0&&vt("ObjectLoader: Undefined geometry",h),n[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const I=[];for(let p=0,y=h.length;p<y;p++){const A=h[p];i[A]===void 0&&vt("ObjectLoader: Undefined material",A),I.push(i[A])}return I}return i[h]===void 0&&vt("ObjectLoader: Undefined material",h),i[h]}}function c(h){return r[h]===void 0&&vt("ObjectLoader: Undefined texture",h),r[h]}let u,d;switch(e.type){case"Scene":o=new gu,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new wt(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new oS(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new sS(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Wi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ua(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Pee(e.color,e.intensity);break;case"DirectionalLight":o=new jee(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new zee(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Oee(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Lee(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new Kee(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Uee().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),d=l(e.material),o=new gee(u,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=l(e.material),o=new Li(u,d);break;case"InstancedMesh":u=a(e.geometry),d=l(e.material);const h=e.count,I=e.instanceMatrix,p=e.instanceColor;o=new I_(u,d,h),o.instanceMatrix=new AC(new Float32Array(I.array),16),p!==void 0&&(o.instanceColor=new AC(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=a(e.geometry),d=l(e.material),o=new uee(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(y=>{let A=null,m=null;return y.boundingBox!==void 0&&(A=new ss().fromJSON(y.boundingBox)),y.boundingSphere!==void 0&&(m=new Tr().fromJSON(y.boundingSphere)),{...y,boundingBox:A,boundingSphere:m}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=c(e.matricesTexture.uuid),o._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new Tr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new ss().fromJSON(e.boundingBox));break;case"LOD":o=new cee;break;case"Line":o=new uu(a(e.geometry),l(e.material));break;case"LineLoop":o=new dee(a(e.geometry),l(e.material));break;case"LineSegments":o=new Dl(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new hee(a(e.geometry),l(e.material));break;case"Sprite":o=new lee(l(e.material));break;case"Group":o=new _I;break;case"Bone":o=new h_;break;default:o=new Tn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let I=0;I<h.length;I++)o.add(this.parseObject(h[I],n,i,r,s))}if(e.animations!==void 0){const h=e.animations;for(let I=0;I<h.length;I++){const p=h[I];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let I=0;I<h.length;I++){const p=h[I],y=o.getObjectByProperty("uuid",p.object);y!==void 0&&o.addLevel(y,p.distance,p.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?vt("ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Tn}})}}const f9e={UVMapping:au,CubeReflectionMapping:kl,CubeRefractionMapping:lu,EquirectangularReflectionMapping:oC,EquirectangularRefractionMapping:i0,CubeUVReflectionMapping:QC},jL={RepeatWrapping:aC,ClampToEdgeWrapping:Vi,MirroredRepeatWrapping:lC},PL={NearestFilter:Sr,NearestMipmapNearestFilter:DB,NearestMipmapLinearFilter:yd,LinearFilter:Ln,LinearMipmapNearestFilter:$I,LinearMipmapLinearFilter:ka},TR=new WeakMap;class C9e extends Vs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&vt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&vt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Zl.get(`image-bitmap:${e}`);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{if(TR.has(o)===!0)r&&r(TR.get(o)),s.manager.itemError(e),s.manager.itemEnd(e);else return n&&n(c),s.manager.itemEnd(e),c});return}return setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,a.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Zl.add(`image-bitmap:${e}`,c),n&&n(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),TR.set(l,c),Zl.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});Zl.add(`image-bitmap:${e}`,l),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let Nv;class M_{static getContext(){return Nv===void 0&&(Nv=new(window.AudioContext||window.webkitAudioContext)),Nv}static setContext(e){Nv=e}}class p9e extends Vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Bo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);M_.getContext().decodeAudioData(c,function(d){n(d)}).catch(a)}catch(c){a(c)}},i,r);function a(l){r?r(l):on(l),s.manager.itemError(e)}}}const OL=new Qt,DL=new Qt,Pu=new Qt;class m9e{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Wi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Wi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Pu.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(Ed*n.fov*.5)/n.zoom;let a,l;DL.elements[12]=-r,OL.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,Pu.elements[0]=2*n.near/(l-a),Pu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Pu),a=-o*n.aspect-s,l=o*n.aspect-s,Pu.elements[0]=2*n.near/(l-a),Pu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Pu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(DL),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(OL)}}class qee extends Wi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class V_{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=performance.now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}const Ou=new J,XR=new Zr,A9e=new J,Du=new J,Uu=new J;class y9e extends Tn{constructor(){super(),this.type="AudioListener",this.context=M_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new V_}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ou,XR,A9e),Du.set(0,0,-1).applyQuaternion(XR),Uu.set(0,1,0).applyQuaternion(XR),n.positionX){const i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Ou.x,i),n.positionY.linearRampToValueAtTime(Ou.y,i),n.positionZ.linearRampToValueAtTime(Ou.z,i),n.forwardX.linearRampToValueAtTime(Du.x,i),n.forwardY.linearRampToValueAtTime(Du.y,i),n.forwardZ.linearRampToValueAtTime(Du.z,i),n.upX.linearRampToValueAtTime(Uu.x,i),n.upY.linearRampToValueAtTime(Uu.y,i),n.upZ.linearRampToValueAtTime(Uu.z,i)}else n.setPosition(Ou.x,Ou.y,Ou.z),n.setOrientation(Du.x,Du.y,Du.z,Uu.x,Uu.y,Uu.z)}}class $ee extends Tn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){vt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){vt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){vt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){vt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){vt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(vt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){vt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(vt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Ju=new J,UL=new Zr,b9e=new J,Qu=new J;class v9e extends $ee{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Ju,UL,b9e),Qu.set(0,0,1).applyQuaternion(UL);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Ju.x,i),n.positionY.linearRampToValueAtTime(Ju.y,i),n.positionZ.linearRampToValueAtTime(Ju.z,i),n.orientationX.linearRampToValueAtTime(Qu.x,i),n.orientationY.linearRampToValueAtTime(Qu.y,i),n.orientationZ.linearRampToValueAtTime(Qu.z,i)}else n.setPosition(Ju.x,Ju.y,Ju.z),n.setOrientation(Qu.x,Qu.y,Qu.z)}}class x9e{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class ete{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){Zr.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const o=this._workIndex*s;Zr.multiplyQuaternionsFlat(e,o,e,n,e,i),Zr.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[i+o]*r}}}const F_="\\[\\]\\.:\\/",w9e=new RegExp("["+F_+"]","g"),__="[^"+F_+"]",G9e="[^"+F_.replace("\\.","")+"]",B9e=/((?:WC+[\/:])*)/.source.replace("WC",__),S9e=/(WCOD+)?/.source.replace("WCOD",G9e),Z9e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",__),R9e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",__),N9e=new RegExp("^"+B9e+S9e+Z9e+R9e+"$"),W9e=["material","materials","bones","map"];class M9e{constructor(e,n,i){const r=i||Sn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Sn{constructor(e,n,i){this.path=n,this.parsedPath=i||Sn.parseTrackName(n),this.node=Sn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Sn.Composite(e,n,i):new Sn(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(w9e,"")}static parseTrackName(e){const n=N9e.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);W9e.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Sn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){vt("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=n.objectIndex;switch(i){case"materials":if(!e.material){on("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){on("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){on("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){on("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){on("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){on("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){on("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=n.nodeName;on("PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?a=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){on("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){on("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Sn.Composite=M9e;Sn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Sn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Sn.prototype.GetterByBindingType=[Sn.prototype._getValue_direct,Sn.prototype._getValue_array,Sn.prototype._getValue_arrayElement,Sn.prototype._getValue_toArray];Sn.prototype.SetterByBindingTypeAndVersioning=[[Sn.prototype._setValue_direct,Sn.prototype._setValue_direct_setNeedsUpdate,Sn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_array,Sn.prototype._setValue_array_setNeedsUpdate,Sn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_arrayElement,Sn.prototype._setValue_arrayElement_setNeedsUpdate,Sn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Sn.prototype._setValue_fromArray,Sn.prototype._setValue_fromArray_setNeedsUpdate,Sn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class V9e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Go(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const h=arguments[u],I=h.uuid;let p=n[I];if(p===void 0){p=l++,n[I]=p,e.push(h);for(let y=0,A=o;y!==A;++y)s[y].push(new Sn(h,i[y],r[y]))}else if(p<c){a=e[p];const y=--c,A=e[y];n[A.uuid]=p,e[p]=A,n[I]=y,e[y]=h;for(let m=0,b=o;m!==b;++m){const v=s[m],w=v[y];let x=v[p];v[p]=w,x===void 0&&(x=new Sn(h,i[m],r[m])),v[y]=x}}else e[p]!==a&&on("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=n[c];if(u!==void 0&&u>=s){const d=s++,h=e[d];n[h.uuid]=u,e[u]=h,n[c]=d,e[d]=l;for(let I=0,p=r;I!==p;++I){const y=i[I],A=y[d],m=y[u];y[u]=A,y[d]=m}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,d=n[u];if(d!==void 0)if(delete n[u],d<s){const h=--s,I=e[h],p=--o,y=e[p];n[I.uuid]=d,e[d]=I,n[y.uuid]=h,e[h]=y,e.pop();for(let A=0,m=r;A!==m;++A){const b=i[A],v=b[h],w=b[p];b[d]=v,b[h]=w,b.pop()}}else{const h=--o,I=e[h];h>0&&(n[I.uuid]=d),e[d]=I,e.pop();for(let p=0,y=r;p!==y;++p){const A=i[p];A[d]=A[h],A.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(d);for(let h=u,I=l.length;h!==I;++h){const p=l[h];d[h]=new Sn(p,e,n)}return d}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];n[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class tte{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:bd,endingEnd:bd};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=z$,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case i_:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case nS:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===j$;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===L$){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=vd,r.endingEnd=vd):(e?r.endingStart=this.zeroSlopeAtStart?vd:bd:r.endingStart=s0,n?r.endingEnd=this.zeroSlopeAtEnd?vd:bd:r.endingEnd=s0)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}}const F9e=new Float32Array(1);class _9e extends Ol{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=r[d],I=h.name;let p=u[I];if(p!==void 0)++p.referenceCount,o[d]=p;else{if(p=o[d],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,I));continue}const y=n&&n._propertyBindings[d].binding.parsedPath;p=new ete(Sn.create(i,I,y),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,I),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete d[h],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new Z_(new Float32Array(2),new Float32Array(2),1,F9e),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let o=typeof e=="string"?f0.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=nS),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new tte(this,o,n,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?f0.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)n[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,n[u]=d,n.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class T9e extends a_{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new rS(null,e,n,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class T_{constructor(e){this.value=e}clone(){return new T_(this.value.clone===void 0?this.value:this.value.clone())}}let X9e=0;class E9e extends Ol{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:X9e++}),this.name="",this.usage=a0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const s=Array.isArray(n[i])?n[i]:[n[i]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Y9e extends aS{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class k9e{constructor(e,n,i,r,s,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const JL=new Qt;class X_{constructor(e,n,i=0,r=1/0){this.ray=new Ah(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new Yd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):on("Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return JL.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(JL),this}intersectObject(e,n=!0,i=[]){return X3(e,this,i,n),i.sort(QL),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)X3(e[r],this,i,n);return i.sort(QL),i}}function QL(t,e){return t.distance-e.distance}function X3(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const s=t.children;for(let o=0,a=s.length;o<a;o++)X3(s[o],e,n,!0)}}class H9e{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=K9e.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function K9e(){this._document.hidden===!1&&this.reset()}class E3{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=sn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(sn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class L9e{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class E_{constructor(e,n,i,r){E_.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}}const qL=new He;class z9e{constructor(e=new He(1/0,1/0),n=new He(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=qL.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,qL).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $L=new J,Wv=new J,gI=new J,uI=new J,ER=new J,j9e=new J,P9e=new J;class O9e{constructor(e=new J,n=new J){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){$L.subVectors(e,this.start),Wv.subVectors(this.end,this.start);const i=Wv.dot(Wv);let s=Wv.dot($L)/i;return n&&(s=sn(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,n=j9e,i=P9e){const r=10000000000000001e-32;let s,o;const a=this.start,l=e.start,c=this.end,u=e.end;gI.subVectors(c,a),uI.subVectors(u,l),ER.subVectors(a,l);const d=gI.dot(gI),h=uI.dot(uI),I=uI.dot(ER);if(d<=r&&h<=r)return n.copy(a),i.copy(l),n.sub(i),n.dot(n);if(d<=r)s=0,o=I/h,o=sn(o,0,1);else{const p=gI.dot(ER);if(h<=r)o=0,s=sn(-p/d,0,1);else{const y=gI.dot(uI),A=d*h-y*y;A!==0?s=sn((y*I-p*h)/A,0,1):s=0,o=(y*s+I)/h,o<0?(o=0,s=sn(-p/d,0,1)):o>1&&(o=1,s=sn((y-p)/d,0,1))}}return n.copy(a).add(gI.multiplyScalar(s)),i.copy(l).add(uI.multiplyScalar(o)),n.sub(i),n.dot(n)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ez=new J;class D9e extends Tn{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new gn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new _t(r,3));const s=new Ms({fog:!1,toneMapped:!1});this.cone=new Dl(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),ez.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ez),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const hg=new J,Mv=new Qt,YR=new Qt;class U9e extends Dl{constructor(e){const n=nte(e),i=new gn,r=[],s=[];for(let c=0;c<n.length;c++){const u=n[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}i.setAttribute("position",new _t(r,3)),i.setAttribute("color",new _t(s,3));const o=new Ms({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const a=new wt(255),l=new wt(65280);this.setColors(a,l)}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");YR.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(Mv.multiplyMatrices(YR,a.matrixWorld),hg.setFromMatrixPosition(Mv),r.setXYZ(o,hg.x,hg.y,hg.z),Mv.multiplyMatrices(YR,a.parent.matrixWorld),hg.setFromMatrixPosition(Mv),r.setXYZ(o+1,hg.x,hg.y,hg.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,n){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,n.r,n.g,n.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function nte(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...nte(t.children[n]));return e}class J9e extends Li{constructor(e,n,i){const r=new cy(n,4,2),s=new Uc({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Q9e=new J,tz=new wt,nz=new wt;class q9e extends Tn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new ly(n);r.rotateY(Math.PI*.5),this.material=new Uc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Wn(o,3)),this.add(new Li(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");tz.copy(this.light.color),nz.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?tz:nz;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Q9e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class $9e extends Dl{constructor(e=10,n=10,i=4473924,r=8947848){i=new wt(i),r=new wt(r);const s=n/2,o=e/n,a=e/2,l=[],c=[];for(let h=0,I=0,p=-a;h<=n;h++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const y=h===s?i:r;y.toArray(c,I),I+=3,y.toArray(c,I),I+=3,y.toArray(c,I),I+=3,y.toArray(c,I),I+=3}const u=new gn;u.setAttribute("position",new _t(l,3)),u.setAttribute("color",new _t(c,3));const d=new Ms({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class eKe extends Dl{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new wt(s),o=new wt(o);const a=[],l=[];if(n>1)for(let d=0;d<n;d++){const h=d/n*(Math.PI*2),I=Math.sin(h)*e,p=Math.cos(h)*e;a.push(0,0,0),a.push(I,0,p);const y=d&1?s:o;l.push(y.r,y.g,y.b),l.push(y.r,y.g,y.b)}for(let d=0;d<i;d++){const h=d&1?s:o,I=e-e/i*d;for(let p=0;p<r;p++){let y=p/r*(Math.PI*2),A=Math.sin(y)*I,m=Math.cos(y)*I;a.push(A,0,m),l.push(h.r,h.g,h.b),y=(p+1)/r*(Math.PI*2),A=Math.sin(y)*I,m=Math.cos(y)*I,a.push(A,0,m),l.push(h.r,h.g,h.b)}}const c=new gn;c.setAttribute("position",new _t(a,3)),c.setAttribute("color",new _t(l,3));const u=new Ms({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const iz=new J,Vv=new J,rz=new J;class tKe extends Tn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new gn;r.setAttribute("position",new _t([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new Ms({fog:!1,toneMapped:!1});this.lightPlane=new uu(r,s),this.add(this.lightPlane),r=new gn,r.setAttribute("position",new _t([0,0,0,0,0,1],3)),this.targetLine=new uu(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),iz.setFromMatrixPosition(this.light.matrixWorld),Vv.setFromMatrixPosition(this.light.target.matrixWorld),rz.subVectors(Vv,iz),this.lightPlane.lookAt(Vv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Vv),this.targetLine.scale.z=rz.length()}}const Fv=new J,Ei=new iy;class nKe extends Dl{constructor(e){const n=new gn,i=new Ms({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,y){l(p),l(y)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}n.setAttribute("position",new _t(r,3)),n.setAttribute("color",new _t(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new wt(16755200),u=new wt(16711680),d=new wt(43775),h=new wt(16777215),I=new wt(3355443);this.setColors(c,u,d,h,I)}setColors(e,n,i,r,s){const a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0,this}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;let s,o;if(Ei.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,o=0;else if(this.camera.coordinateSystem===yo)s=-1,o=1;else if(this.camera.coordinateSystem===IC)s=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Pi("c",n,e,Ei,0,0,s),Pi("t",n,e,Ei,0,0,o),Pi("n1",n,e,Ei,-i,-r,s),Pi("n2",n,e,Ei,i,-r,s),Pi("n3",n,e,Ei,-i,r,s),Pi("n4",n,e,Ei,i,r,s),Pi("f1",n,e,Ei,-i,-r,o),Pi("f2",n,e,Ei,i,-r,o),Pi("f3",n,e,Ei,-i,r,o),Pi("f4",n,e,Ei,i,r,o),Pi("u1",n,e,Ei,i*.7,r*1.1,s),Pi("u2",n,e,Ei,-i*.7,r*1.1,s),Pi("u3",n,e,Ei,0,r*2,s),Pi("cf1",n,e,Ei,-i,0,o),Pi("cf2",n,e,Ei,i,0,o),Pi("cf3",n,e,Ei,0,-r,o),Pi("cf4",n,e,Ei,0,r,o),Pi("cn1",n,e,Ei,-i,0,s),Pi("cn2",n,e,Ei,i,0,s),Pi("cn3",n,e,Ei,0,-r,s),Pi("cn4",n,e,Ei,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Pi(t,e,n,i,r,s,o){Fv.set(r,s,o).unproject(i);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],Fv.x,Fv.y,Fv.z)}}const _v=new ss;class iKe extends Dl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new gn;s.setIndex(new Wn(i,1)),s.setAttribute("position",new Wn(r,3)),super(s,new Ms({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&_v.setFromObject(this.object),_v.isEmpty())return;const e=_v.min,n=_v.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class rKe extends Dl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new gn;s.setIndex(new Wn(i,1)),s.setAttribute("position",new _t(r,3)),super(s,new Ms({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class sKe extends uu{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new gn;o.setAttribute("position",new _t(s,3)),o.computeBoundingSphere(),super(o,new Ms({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new gn;l.setAttribute("position",new _t(a,3)),l.computeBoundingSphere(),this.add(new Li(l,new Uc({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const sz=new J;let Tv,kR;class oKe extends Tn{constructor(e=new J(0,0,1),n=new J(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Tv===void 0&&(Tv=new gn,Tv.setAttribute("position",new _t([0,0,0,0,1,0],3)),kR=new oy(.5,1,5,1),kR.translate(0,-.5,0)),this.position.copy(n),this.line=new uu(Tv,new Ms({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Li(kR,new Uc({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{sz.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(sz,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class aKe extends Dl{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new gn;r.setAttribute("position",new _t(n,3)),r.setAttribute("color",new _t(i,3));const s=new Ms({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new wt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class lKe{constructor(){this.type="ShapePath",this.color=new wt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new o2,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(m){const b=[];for(let v=0,w=m.length;v<w;v++){const x=m[v],B=new Hd;B.curves=x.curves,b.push(B)}return b}function i(m,b){const v=b.length;let w=!1;for(let x=v-1,B=0;B<v;x=B++){let Z=b[x],N=b[B],W=N.x-Z.x,M=N.y-Z.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(Z=b[B],W=-W,N=b[x],M=-M),m.y<Z.y||m.y>N.y)continue;if(m.y===Z.y){if(m.x===Z.x)return!0}else{const F=M*(m.x-Z.x)-W*(m.y-Z.y);if(F===0)return!0;if(F<0)continue;w=!w}}else{if(m.y!==Z.y)continue;if(N.x<=m.x&&m.x<=Z.x||Z.x<=m.x&&m.x<=N.x)return!0}}return w}const r=Ha.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Hd,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const d=[],h=[];let I=[],p=0,y;h[p]=void 0,I[p]=[];for(let m=0,b=s.length;m<b;m++)a=s[m],y=a.getPoints(),o=r(y),o=e?!o:o,o?(!u&&h[p]&&p++,h[p]={s:new Hd,p:y},h[p].s.curves=a.curves,u&&p++,I[p]=[]):I[p].push({h:a,p:y[0]});if(!h[0])return n(s);if(h.length>1){let m=!1,b=0;for(let v=0,w=h.length;v<w;v++)d[v]=[];for(let v=0,w=h.length;v<w;v++){const x=I[v];for(let B=0;B<x.length;B++){const Z=x[B];let N=!0;for(let W=0;W<h.length;W++)i(Z.p,h[W].p)&&(v!==W&&b++,N?(N=!1,d[W].push(Z)):m=!0);N&&d[v].push(Z)}}b>0&&m===!1&&(I=d)}let A;for(let m=0,b=h.length;m<b;m++){l=h[m].s,c.push(l),A=I[m];for(let v=0,w=A.length;v<w;v++)l.holes.push(A[v].h)}return c}}class cKe extends Ol{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){vt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function gKe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function uKe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function dKe(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function Y3(t,e,n,i){const r=hKe(i);switch(n){case t_:return t*e;case ty:return t*e/r.components*r.byteLength;case ny:return t*e/r.components*r.byteLength;case $B:return t*e*2/r.components*r.byteLength;case eS:return t*e*2/r.components*r.byteLength;case n_:return t*e*3/r.components*r.byteLength;case Ki:return t*e*4/r.components*r.byteLength;case tS:return t*e*4/r.components*r.byteLength;case Lm:case zm:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case jm:case Pm:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case NG:case MG:return Math.max(t,16)*Math.max(e,8)/4;case RG:case WG:return Math.max(t,8)*Math.max(e,8)/2;case VG:case FG:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case _G:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case TG:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case XG:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case EG:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case YG:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case kG:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case HG:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case KG:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case LG:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case zG:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case jG:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case PG:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case OG:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case DG:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case UG:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case JG:case QG:case qG:return Math.ceil(t/4)*Math.ceil(e/4)*16;case $G:case e2:return Math.ceil(t/4)*Math.ceil(e/4)*8;case t2:case n2:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function hKe(t){switch(t){case Ss:case UB:return{byteLength:1,components:1};case cC:case JB:case hr:return{byteLength:2,components:1};case QB:case qB:return{byteLength:2,components:4};case Hl:case ey:case Fi:return{byteLength:4,components:1};case $F:case e_:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class IKe{static contain(e,n){return gKe(e,n)}static cover(e,n){return uKe(e,n)}static fill(e){return dKe(e)}static getByteLength(e,n,i,r){return Y3(e,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:mh}}));typeof window<"u"&&(window.__THREE__?vt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=mh);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function ite(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function fKe(t){const e=new WeakMap;function n(a,l){const c=a.array,u=a.usage,d=c.byteLength,h=t.createBuffer();t.bindBuffer(l,h),t.bufferData(l,c,u),a.onUploadCallback();let I;if(c instanceof Float32Array)I=t.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)I=t.HALF_FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?I=t.HALF_FLOAT:I=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)I=t.SHORT;else if(c instanceof Uint32Array)I=t.UNSIGNED_INT;else if(c instanceof Int32Array)I=t.INT;else if(c instanceof Int8Array)I=t.BYTE;else if(c instanceof Uint8Array)I=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)I=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:I,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:d}}function i(a,l,c){const u=l.array,d=l.updateRanges;if(t.bindBuffer(c,a),d.length===0)t.bufferSubData(c,0,u);else{d.sort((I,p)=>I.start-p.start);let h=0;for(let I=1;I<d.length;I++){const p=d[h],y=d[I];y.start<=p.start+p.count+1?p.count=Math.max(p.count,y.start+y.count-p.start):(++h,d[h]=y)}d.length=h+1;for(let I=0,p=d.length;I<p;I++){const y=d[I];t.bufferSubData(c,y.start*u.BYTES_PER_ELEMENT,u,y.start,y.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(t.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,n(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,a,l),c.version=a.version}}return{get:r,remove:s,update:o}}var CKe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,pKe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,mKe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,AKe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,yKe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,bKe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vKe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xKe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,wKe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,GKe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,BKe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,SKe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ZKe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,RKe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,NKe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,WKe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,MKe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,VKe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,FKe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_Ke=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,TKe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,XKe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,EKe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,YKe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,kKe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,HKe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,KKe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,LKe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,zKe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,jKe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,PKe="gl_FragColor = linearToOutputTexel( gl_FragColor );",OKe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,DKe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,UKe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,JKe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,QKe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qKe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,$Ke=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,eLe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,tLe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,nLe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,iLe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,rLe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,sLe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,oLe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,aLe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lLe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,cLe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,gLe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,uLe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,dLe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hLe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,ILe=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 uv = vec2( roughness, dotNV );
	return texture2D( dfgLUT, uv ).rg;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );
	vec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );
	vec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,fLe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,CLe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,pLe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,mLe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ALe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,yLe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,bLe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,vLe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,xLe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wLe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,GLe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,BLe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,SLe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ZLe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,RLe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,NLe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,WLe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,MLe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,VLe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,FLe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,_Le=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,TLe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,XLe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ELe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,YLe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,kLe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,HLe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,KLe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,LLe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,zLe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,jLe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,PLe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,OLe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,DLe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,ULe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,JLe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,QLe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,qLe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,$Le=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,eze=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,tze=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,nze=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,ize=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,rze=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,sze=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,oze=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,aze=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,lze=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,cze=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,gze=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uze=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,dze=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,hze=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Ize=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const fze=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Cze=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,pze=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,mze=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Aze=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,yze=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bze=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,vze=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,xze=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,wze=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Gze=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Bze=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Sze=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Zze=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Rze=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Nze=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wze=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mze=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vze=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Fze=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_ze=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Tze=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Xze=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Eze=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yze=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,kze=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hze=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Kze=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lze=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,zze=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jze=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Pze=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Oze=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Dze=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,mn={alphahash_fragment:CKe,alphahash_pars_fragment:pKe,alphamap_fragment:mKe,alphamap_pars_fragment:AKe,alphatest_fragment:yKe,alphatest_pars_fragment:bKe,aomap_fragment:vKe,aomap_pars_fragment:xKe,batching_pars_vertex:wKe,batching_vertex:GKe,begin_vertex:BKe,beginnormal_vertex:SKe,bsdfs:ZKe,iridescence_fragment:RKe,bumpmap_pars_fragment:NKe,clipping_planes_fragment:WKe,clipping_planes_pars_fragment:MKe,clipping_planes_pars_vertex:VKe,clipping_planes_vertex:FKe,color_fragment:_Ke,color_pars_fragment:TKe,color_pars_vertex:XKe,color_vertex:EKe,common:YKe,cube_uv_reflection_fragment:kKe,defaultnormal_vertex:HKe,displacementmap_pars_vertex:KKe,displacementmap_vertex:LKe,emissivemap_fragment:zKe,emissivemap_pars_fragment:jKe,colorspace_fragment:PKe,colorspace_pars_fragment:OKe,envmap_fragment:DKe,envmap_common_pars_fragment:UKe,envmap_pars_fragment:JKe,envmap_pars_vertex:QKe,envmap_physical_pars_fragment:lLe,envmap_vertex:qKe,fog_vertex:$Ke,fog_pars_vertex:eLe,fog_fragment:tLe,fog_pars_fragment:nLe,gradientmap_pars_fragment:iLe,lightmap_pars_fragment:rLe,lights_lambert_fragment:sLe,lights_lambert_pars_fragment:oLe,lights_pars_begin:aLe,lights_toon_fragment:cLe,lights_toon_pars_fragment:gLe,lights_phong_fragment:uLe,lights_phong_pars_fragment:dLe,lights_physical_fragment:hLe,lights_physical_pars_fragment:ILe,lights_fragment_begin:fLe,lights_fragment_maps:CLe,lights_fragment_end:pLe,logdepthbuf_fragment:mLe,logdepthbuf_pars_fragment:ALe,logdepthbuf_pars_vertex:yLe,logdepthbuf_vertex:bLe,map_fragment:vLe,map_pars_fragment:xLe,map_particle_fragment:wLe,map_particle_pars_fragment:GLe,metalnessmap_fragment:BLe,metalnessmap_pars_fragment:SLe,morphinstance_vertex:ZLe,morphcolor_vertex:RLe,morphnormal_vertex:NLe,morphtarget_pars_vertex:WLe,morphtarget_vertex:MLe,normal_fragment_begin:VLe,normal_fragment_maps:FLe,normal_pars_fragment:_Le,normal_pars_vertex:TLe,normal_vertex:XLe,normalmap_pars_fragment:ELe,clearcoat_normal_fragment_begin:YLe,clearcoat_normal_fragment_maps:kLe,clearcoat_pars_fragment:HLe,iridescence_pars_fragment:KLe,opaque_fragment:LLe,packing:zLe,premultiplied_alpha_fragment:jLe,project_vertex:PLe,dithering_fragment:OLe,dithering_pars_fragment:DLe,roughnessmap_fragment:ULe,roughnessmap_pars_fragment:JLe,shadowmap_pars_fragment:QLe,shadowmap_pars_vertex:qLe,shadowmap_vertex:$Le,shadowmask_pars_fragment:eze,skinbase_vertex:tze,skinning_pars_vertex:nze,skinning_vertex:ize,skinnormal_vertex:rze,specularmap_fragment:sze,specularmap_pars_fragment:oze,tonemapping_fragment:aze,tonemapping_pars_fragment:lze,transmission_fragment:cze,transmission_pars_fragment:gze,uv_pars_fragment:uze,uv_pars_vertex:dze,uv_vertex:hze,worldpos_vertex:Ize,background_vert:fze,background_frag:Cze,backgroundCube_vert:pze,backgroundCube_frag:mze,cube_vert:Aze,cube_frag:yze,depth_vert:bze,depth_frag:vze,distanceRGBA_vert:xze,distanceRGBA_frag:wze,equirect_vert:Gze,equirect_frag:Bze,linedashed_vert:Sze,linedashed_frag:Zze,meshbasic_vert:Rze,meshbasic_frag:Nze,meshlambert_vert:Wze,meshlambert_frag:Mze,meshmatcap_vert:Vze,meshmatcap_frag:Fze,meshnormal_vert:_ze,meshnormal_frag:Tze,meshphong_vert:Xze,meshphong_frag:Eze,meshphysical_vert:Yze,meshphysical_frag:kze,meshtoon_vert:Hze,meshtoon_frag:Kze,points_vert:Lze,points_frag:zze,shadow_vert:jze,shadow_frag:Pze,sprite_vert:Oze,sprite_frag:Dze},bt={common:{diffuse:{value:new wt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new hn},alphaMap:{value:null},alphaMapTransform:{value:new hn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new hn}},envmap:{envMap:{value:null},envMapRotation:{value:new hn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new hn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new hn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new hn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new hn},normalScale:{value:new He(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new hn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new hn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new hn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new hn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new hn},alphaTest:{value:0},uvTransform:{value:new hn}},sprite:{diffuse:{value:new wt(16777215)},opacity:{value:1},center:{value:new He(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new hn},alphaMap:{value:null},alphaMapTransform:{value:new hn},alphaTest:{value:0}}},Ea={basic:{uniforms:hs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.fog]),vertexShader:mn.meshbasic_vert,fragmentShader:mn.meshbasic_frag},lambert:{uniforms:hs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new wt(0)}}]),vertexShader:mn.meshlambert_vert,fragmentShader:mn.meshlambert_frag},phong:{uniforms:hs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new wt(0)},specular:{value:new wt(1118481)},shininess:{value:30}}]),vertexShader:mn.meshphong_vert,fragmentShader:mn.meshphong_frag},standard:{uniforms:hs([bt.common,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.roughnessmap,bt.metalnessmap,bt.fog,bt.lights,{emissive:{value:new wt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag},toon:{uniforms:hs([bt.common,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.gradientmap,bt.fog,bt.lights,{emissive:{value:new wt(0)}}]),vertexShader:mn.meshtoon_vert,fragmentShader:mn.meshtoon_frag},matcap:{uniforms:hs([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,{matcap:{value:null}}]),vertexShader:mn.meshmatcap_vert,fragmentShader:mn.meshmatcap_frag},points:{uniforms:hs([bt.points,bt.fog]),vertexShader:mn.points_vert,fragmentShader:mn.points_frag},dashed:{uniforms:hs([bt.common,bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mn.linedashed_vert,fragmentShader:mn.linedashed_frag},depth:{uniforms:hs([bt.common,bt.displacementmap]),vertexShader:mn.depth_vert,fragmentShader:mn.depth_frag},normal:{uniforms:hs([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,{opacity:{value:1}}]),vertexShader:mn.meshnormal_vert,fragmentShader:mn.meshnormal_frag},sprite:{uniforms:hs([bt.sprite,bt.fog]),vertexShader:mn.sprite_vert,fragmentShader:mn.sprite_frag},background:{uniforms:{uvTransform:{value:new hn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:mn.background_vert,fragmentShader:mn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new hn}},vertexShader:mn.backgroundCube_vert,fragmentShader:mn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:mn.cube_vert,fragmentShader:mn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mn.equirect_vert,fragmentShader:mn.equirect_frag},distanceRGBA:{uniforms:hs([bt.common,bt.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mn.distanceRGBA_vert,fragmentShader:mn.distanceRGBA_frag},shadow:{uniforms:hs([bt.lights,bt.fog,{color:{value:new wt(0)},opacity:{value:1}}]),vertexShader:mn.shadow_vert,fragmentShader:mn.shadow_frag}};Ea.physical={uniforms:hs([Ea.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new hn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new hn},clearcoatNormalScale:{value:new He(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new hn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new hn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new hn},sheen:{value:0},sheenColor:{value:new wt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new hn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new hn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new hn},transmissionSamplerSize:{value:new He},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new hn},attenuationDistance:{value:0},attenuationColor:{value:new wt(0)},specularColor:{value:new wt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new hn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new hn},anisotropyVector:{value:new He},anisotropyMap:{value:null},anisotropyMapTransform:{value:new hn}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag};const Xv={r:0,b:0,g:0},qu=new no,Uze=new Qt;function Jze(t,e,n,i,r,s,o){const a=new wt(0);let l=s===!0?0:1,c,u,d=null,h=0,I=null;function p(v){let w=v.isScene===!0?v.background:null;return w&&w.isTexture&&(w=(v.backgroundBlurriness>0?n:e).get(w)),w}function y(v){let w=!1;const x=p(v);x===null?m(a,l):x&&x.isColor&&(m(x,1),w=!0);const B=t.xr.getEnvironmentBlendMode();B==="additive"?i.buffers.color.setClear(0,0,0,1,o):B==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||w)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function A(v,w){const x=p(w);x&&(x.isCubeTexture||x.mapping===QC)?(u===void 0&&(u=new Li(new yh(1,1,1),new as({name:"BackgroundCubeMaterial",uniforms:mC(Ea.backgroundCube.uniforms),vertexShader:Ea.backgroundCube.vertexShader,fragmentShader:Ea.backgroundCube.fragmentShader,side:Bs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(B,Z,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),qu.copy(w.backgroundRotation),qu.x*=-1,qu.y*=-1,qu.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(qu.y*=-1,qu.z*=-1),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(Uze.makeRotationFromEuler(qu)),u.material.toneMapped=Fn.getTransfer(x.colorSpace)!==Qn,(d!==x||h!==x.version||I!==t.toneMapping)&&(u.material.needsUpdate=!0,d=x,h=x.version,I=t.toneMapping),u.layers.enableAll(),v.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new Li(new Bu(2,2),new as({name:"BackgroundMaterial",uniforms:mC(Ea.background.uniforms),vertexShader:Ea.background.vertexShader,fragmentShader:Ea.background.fragmentShader,side:Lc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=Fn.getTransfer(x.colorSpace)!==Qn,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(d!==x||h!==x.version||I!==t.toneMapping)&&(c.material.needsUpdate=!0,d=x,h=x.version,I=t.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}function m(v,w){v.getRGB(Xv,see(t)),i.buffers.color.setClear(Xv.r,Xv.g,Xv.b,w,o)}function b(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return a},setClearColor:function(v,w=1){a.set(v),l=w,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,m(a,l)},render:y,addToRenderList:A,dispose:b}}function Qze(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=h(null);let s=r,o=!1;function a(M,F,T,H,K){let z=!1;const j=d(H,T,F);s!==j&&(s=j,c(s.object)),z=I(M,H,T,K),z&&p(M,H,T,K),K!==null&&e.update(K,t.ELEMENT_ARRAY_BUFFER),(z||o)&&(o=!1,w(M,F,T,H),K!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(K).buffer))}function l(){return t.createVertexArray()}function c(M){return t.bindVertexArray(M)}function u(M){return t.deleteVertexArray(M)}function d(M,F,T){const H=T.wireframe===!0;let K=i[M.id];K===void 0&&(K={},i[M.id]=K);let z=K[F.id];z===void 0&&(z={},K[F.id]=z);let j=z[H];return j===void 0&&(j=h(l()),z[H]=j),j}function h(M){const F=[],T=[],H=[];for(let K=0;K<n;K++)F[K]=0,T[K]=0,H[K]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:T,attributeDivisors:H,object:M,attributes:{},index:null}}function I(M,F,T,H){const K=s.attributes,z=F.attributes;let j=0;const O=T.getAttributes();for(const _ in O)if(O[_].location>=0){const P=K[_];let q=z[_];if(q===void 0&&(_==="instanceMatrix"&&M.instanceMatrix&&(q=M.instanceMatrix),_==="instanceColor"&&M.instanceColor&&(q=M.instanceColor)),P===void 0||P.attribute!==q||q&&P.data!==q.data)return!0;j++}return s.attributesNum!==j||s.index!==H}function p(M,F,T,H){const K={},z=F.attributes;let j=0;const O=T.getAttributes();for(const _ in O)if(O[_].location>=0){let P=z[_];P===void 0&&(_==="instanceMatrix"&&M.instanceMatrix&&(P=M.instanceMatrix),_==="instanceColor"&&M.instanceColor&&(P=M.instanceColor));const q={};q.attribute=P,P&&P.data&&(q.data=P.data),K[_]=q,j++}s.attributes=K,s.attributesNum=j,s.index=H}function y(){const M=s.newAttributes;for(let F=0,T=M.length;F<T;F++)M[F]=0}function A(M){m(M,0)}function m(M,F){const T=s.newAttributes,H=s.enabledAttributes,K=s.attributeDivisors;T[M]=1,H[M]===0&&(t.enableVertexAttribArray(M),H[M]=1),K[M]!==F&&(t.vertexAttribDivisor(M,F),K[M]=F)}function b(){const M=s.newAttributes,F=s.enabledAttributes;for(let T=0,H=F.length;T<H;T++)F[T]!==M[T]&&(t.disableVertexAttribArray(T),F[T]=0)}function v(M,F,T,H,K,z,j){j===!0?t.vertexAttribIPointer(M,F,T,K,z):t.vertexAttribPointer(M,F,T,H,K,z)}function w(M,F,T,H){y();const K=H.attributes,z=T.getAttributes(),j=F.defaultAttributeValues;for(const O in z){const _=z[O];if(_.location>=0){let E=K[O];if(E===void 0&&(O==="instanceMatrix"&&M.instanceMatrix&&(E=M.instanceMatrix),O==="instanceColor"&&M.instanceColor&&(E=M.instanceColor)),E!==void 0){const P=E.normalized,q=E.itemSize,re=e.get(E);if(re===void 0)continue;const de=re.buffer,Re=re.type,Pe=re.bytesPerElement,ae=Re===t.INT||Re===t.UNSIGNED_INT||E.gpuType===ey;if(E.isInterleavedBufferAttribute){const he=E.data,Me=he.stride,be=E.offset;if(he.isInstancedInterleavedBuffer){for(let xe=0;xe<_.locationSize;xe++)m(_.location+xe,he.meshPerAttribute);M.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let xe=0;xe<_.locationSize;xe++)A(_.location+xe);t.bindBuffer(t.ARRAY_BUFFER,de);for(let xe=0;xe<_.locationSize;xe++)v(_.location+xe,q/_.locationSize,Re,P,Me*Pe,(be+q/_.locationSize*xe)*Pe,ae)}else{if(E.isInstancedBufferAttribute){for(let he=0;he<_.locationSize;he++)m(_.location+he,E.meshPerAttribute);M.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=E.meshPerAttribute*E.count)}else for(let he=0;he<_.locationSize;he++)A(_.location+he);t.bindBuffer(t.ARRAY_BUFFER,de);for(let he=0;he<_.locationSize;he++)v(_.location+he,q/_.locationSize,Re,P,q*Pe,q/_.locationSize*he*Pe,ae)}}else if(j!==void 0){const P=j[O];if(P!==void 0)switch(P.length){case 2:t.vertexAttrib2fv(_.location,P);break;case 3:t.vertexAttrib3fv(_.location,P);break;case 4:t.vertexAttrib4fv(_.location,P);break;default:t.vertexAttrib1fv(_.location,P)}}}}b()}function x(){N();for(const M in i){const F=i[M];for(const T in F){const H=F[T];for(const K in H)u(H[K].object),delete H[K];delete F[T]}delete i[M]}}function B(M){if(i[M.id]===void 0)return;const F=i[M.id];for(const T in F){const H=F[T];for(const K in H)u(H[K].object),delete H[K];delete F[T]}delete i[M.id]}function Z(M){for(const F in i){const T=i[F];if(T[M.id]===void 0)continue;const H=T[M.id];for(const K in H)u(H[K].object),delete H[K];delete T[M.id]}}function N(){W(),o=!0,s!==r&&(s=r,c(s.object))}function W(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:N,resetDefaultState:W,dispose:x,releaseStatesOfGeometry:B,releaseStatesOfProgram:Z,initAttributes:y,enableAttribute:A,disableUnusedAttributes:b}}function qze(t,e,n){let i;function r(c){i=c}function s(c,u){t.drawArrays(i,c,u),n.update(u,i,1)}function o(c,u,d){d!==0&&(t.drawArraysInstanced(i,c,u,d),n.update(u,i,d))}function a(c,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,u,0,d);let I=0;for(let p=0;p<d;p++)I+=u[p];n.update(I,i,1)}function l(c,u,d,h){if(d===0)return;const I=e.get("WEBGL_multi_draw");if(I===null)for(let p=0;p<c.length;p++)o(c[p],u[p],h[p]);else{I.multiDrawArraysInstancedWEBGL(i,c,0,u,0,h,0,d);let p=0;for(let y=0;y<d;y++)p+=u[y]*h[y];n.update(p,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function $ze(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(Z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(Z){return!(Z!==Ki&&i.convert(Z)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(Z){const N=Z===hr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Z!==Ss&&i.convert(Z)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&Z!==Fi&&!N)}function l(Z){if(Z==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return Z==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=n.precision!==void 0?n.precision:"highp";const u=l(c);u!==c&&(vt("WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const d=n.logarithmicDepthBuffer===!0,h=n.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),I=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=t.getParameter(t.MAX_TEXTURE_SIZE),A=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),m=t.getParameter(t.MAX_VERTEX_ATTRIBS),b=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),v=t.getParameter(t.MAX_VARYING_VECTORS),w=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),x=p>0,B=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:d,reversedDepthBuffer:h,maxTextures:I,maxVertexTextures:p,maxTextureSize:y,maxCubemapSize:A,maxAttributes:m,maxVertexUniforms:b,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:x,maxSamples:B}}function eje(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Cc,a=new hn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const I=d.length!==0||h||i!==0||r;return r=h,i=d.length,I},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){n=u(d,h,0)},this.setState=function(d,h,I){const p=d.clippingPlanes,y=d.clipIntersection,A=d.clipShadows,m=t.get(d);if(!r||p===null||p.length===0||s&&!A)s?u(null):c();else{const b=s?0:i,v=b*4;let w=m.clippingState||null;l.value=w,w=u(p,h,v,I);for(let x=0;x!==v;++x)w[x]=n[x];m.clippingState=w,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=b}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,h,I,p){const y=d!==null?d.length:0;let A=null;if(y!==0){if(A=l.value,p!==!0||A===null){const m=I+y*4,b=h.matrixWorldInverse;a.getNormalMatrix(b),(A===null||A.length<m)&&(A=new Float32Array(m));for(let v=0,w=I;v!==y;++v,w+=4)o.copy(d[v]).applyMatrix4(b,a),o.normal.toArray(A,w),A[w+3]=o.constant}l.value=A,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,A}}function tje(t){let e=new WeakMap;function n(o,a){return a===oC?o.mapping=kl:a===i0&&(o.mapping=lu),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===oC||a===i0)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new u_(l.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const kg=4,oz=[.125,.215,.35,.446,.526,.582],cd=20,nje=256,qp=new Ua,az=new wt;let HR=null,KR=0,LR=0,zR=!1;const ije=new J;class k3{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,n=0,i=.1,r=100,s={}){const{size:o=256,position:a=ije}=s;HR=this._renderer.getRenderTarget(),KR=this._renderer.getActiveCubeFace(),LR=this._renderer.getActiveMipmapLevel(),zR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,a),n>0&&this._blur(l,0,0,n),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=cz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(HR,KR,LR),this._renderer.xr.enabled=zR,e.scissorTest=!1,dI(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===kl||e.mapping===lu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),HR=this._renderer.getRenderTarget(),KR=this._renderer.getActiveCubeFace(),LR=this._renderer.getActiveMipmapLevel(),zR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Ln,minFilter:Ln,generateMipmaps:!1,type:hr,format:Ki,colorSpace:Kl,depthBuffer:!1},r=lz(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=lz(e,n,i);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=rje(s)),this._blurMaterial=oje(s,e,n),this._ggxMaterial=sje(s,e,n)}return r}_compileMaterial(e){const n=new Li(new gn,e);this._renderer.compile(n,qp)}_sceneToCubeUV(e,n,i,r,s){const l=new Wi(90,1,n,i),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,I=d.toneMapping;d.getClearColor(az),d.toneMapping=Tl,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Li(new yh,new Uc({name:"PMREM.Background",side:Bs,depthWrite:!1,depthTest:!1})));const y=this._backgroundBox,A=y.material;let m=!1;const b=e.background;b?b.isColor&&(A.color.copy(b),e.background=null,m=!0):(A.color.copy(az),m=!0);for(let v=0;v<6;v++){const w=v%3;w===0?(l.up.set(0,c[v],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[v],s.y,s.z)):w===1?(l.up.set(0,0,c[v]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[v],s.z)):(l.up.set(0,c[v],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[v]));const x=this._cubeSize;dI(r,w*x,v>2?x:0,x,x),d.setRenderTarget(r),m&&d.render(y,l),d.render(e,l)}d.toneMapping=I,d.autoClear=h,e.background=b}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===kl||e.mapping===lu;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=gz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=cz());const s=r?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=s;const a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;dI(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,qp)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);n.autoClear=i}_applyGGXFilter(e,n,i){const r=this._renderer,s=this._pingPongRenderTarget,o=this._ggxMaterial,a=this._lodMeshes[i];a.material=o;const l=o.uniforms,c=i/(this._lodMeshes.length-1),u=n/(this._lodMeshes.length-1),d=Math.sqrt(c*c-u*u),h=.05+c*.95,I=d*h,{_lodMax:p}=this,y=this._sizeLods[i],A=3*y*(i>p-kg?i-p+kg:0),m=4*(this._cubeSize-y);l.envMap.value=e.texture,l.roughness.value=I,l.mipInt.value=p-n,dI(s,A,m,3*y,2*y),r.setRenderTarget(s),r.render(a,qp),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=p-i,dI(e,A,m,3*y,2*y),r.setRenderTarget(e),r.render(a,qp)}_blur(e,n,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&on("blur direction must be either latitudinal or longitudinal!");const u=3,d=this._lodMeshes[r];d.material=c;const h=c.uniforms,I=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*I):2*Math.PI/(2*cd-1),y=s/p,A=isFinite(s)?1+Math.floor(u*y):cd;A>cd&&vt(`sigmaRadians, ${s}, is too large and will clip, as it requested ${A} samples when the maximum is set to ${cd}`);const m=[];let b=0;for(let Z=0;Z<cd;++Z){const N=Z/y,W=Math.exp(-N*N/2);m.push(W),Z===0?b+=W:Z<A&&(b+=2*W)}for(let Z=0;Z<m.length;Z++)m[Z]=m[Z]/b;h.envMap.value=e.texture,h.samples.value=A,h.weights.value=m,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=p,h.mipInt.value=v-i;const w=this._sizeLods[r],x=3*w*(r>v-kg?r-v+kg:0),B=4*(this._cubeSize-w);dI(n,x,B,3*w,2*w),l.setRenderTarget(n),l.render(d,qp)}}function rje(t){const e=[],n=[],i=[];let r=t;const s=t-kg+1+oz.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);e.push(a);let l=1/a;o>t-kg?l=oz[o-t+kg-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],I=6,p=6,y=3,A=2,m=1,b=new Float32Array(y*p*I),v=new Float32Array(A*p*I),w=new Float32Array(m*p*I);for(let B=0;B<I;B++){const Z=B%3*2/3-1,N=B>2?0:-1,W=[Z,N,0,Z+2/3,N,0,Z+2/3,N+1,0,Z,N,0,Z+2/3,N+1,0,Z,N+1,0];b.set(W,y*p*B),v.set(h,A*p*B);const M=[B,B,B,B,B,B];w.set(M,m*p*B)}const x=new gn;x.setAttribute("position",new Wn(b,y)),x.setAttribute("uv",new Wn(v,A)),x.setAttribute("faceIndex",new Wn(w,m)),i.push(new Li(x,null)),r>kg&&r--}return{lodMeshes:i,sizeLods:e,sigmas:n}}function lz(t,e,n){const i=new ga(t,e,n);return i.texture.mapping=QC,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function dI(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function sje(t,e,n){return new as({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:nje,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:wS(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Da,depthTest:!1,depthWrite:!1})}function oje(t,e,n){const i=new Float32Array(cd),r=new J(0,1,0);return new as({name:"SphericalGaussianBlur",defines:{n:cd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:wS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Da,depthTest:!1,depthWrite:!1})}function cz(){return new as({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:wS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Da,depthTest:!1,depthWrite:!1})}function gz(){return new as({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:wS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Da,depthTest:!1,depthWrite:!1})}function wS(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function aje(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===oC||l===i0,u=l===kl||l===lu;if(c||u){let d=e.get(a);const h=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return n===null&&(n=new k3(t)),d=c?n.fromEquirectangular(a,d):n.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{const I=a.image;return c&&I&&I.height>0||u&&I&&r(I)?(n===null&&(n=new k3(t)),d=c?n.fromEquirectangular(a):n.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function lje(t){const e={};function n(i){if(e[i]!==void 0)return e[i];const r=t.getExtension(i);return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&fC("WebGLRenderer: "+i+" extension not supported."),r}}}function cje(t,e,n,i){const r={},s=new WeakMap;function o(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete r[h.id];const I=s.get(h);I&&(e.remove(I),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function a(d,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,n.memory.geometries++),h}function l(d){const h=d.attributes;for(const I in h)e.update(h[I],t.ARRAY_BUFFER)}function c(d){const h=[],I=d.index,p=d.attributes.position;let y=0;if(I!==null){const b=I.array;y=I.version;for(let v=0,w=b.length;v<w;v+=3){const x=b[v+0],B=b[v+1],Z=b[v+2];h.push(x,B,B,Z,Z,x)}}else if(p!==void 0){const b=p.array;y=p.version;for(let v=0,w=b.length/3-1;v<w;v+=3){const x=v+0,B=v+1,Z=v+2;h.push(x,B,B,Z,Z,x)}}else return;const A=new(nee(h)?c_:l_)(h,1);A.version=y;const m=s.get(d);m&&e.remove(m),s.set(d,A)}function u(d){const h=s.get(d);if(h){const I=d.index;I!==null&&h.version<I.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function gje(t,e,n){let i;function r(h){i=h}let s,o;function a(h){s=h.type,o=h.bytesPerElement}function l(h,I){t.drawElements(i,I,s,h*o),n.update(I,i,1)}function c(h,I,p){p!==0&&(t.drawElementsInstanced(i,I,s,h*o,p),n.update(I,i,p))}function u(h,I,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,I,0,s,h,0,p);let A=0;for(let m=0;m<p;m++)A+=I[m];n.update(A,i,1)}function d(h,I,p,y){if(p===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let m=0;m<h.length;m++)c(h[m]/o,I[m],y[m]);else{A.multiDrawElementsInstancedWEBGL(i,I,0,s,h,0,y,0,p);let m=0;for(let b=0;b<p;b++)m+=I[b]*y[b];n.update(m,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function uje(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:on("WebGLInfo: Unknown draw mode:",o);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function dje(t,e,n){const i=new WeakMap,r=new _n;function s(o,a,l){const c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0;let h=i.get(a);if(h===void 0||h.count!==d){let M=function(){N.dispose(),i.delete(a),a.removeEventListener("dispose",M)};var I=M;h!==void 0&&h.texture.dispose();const p=a.morphAttributes.position!==void 0,y=a.morphAttributes.normal!==void 0,A=a.morphAttributes.color!==void 0,m=a.morphAttributes.position||[],b=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let w=0;p===!0&&(w=1),y===!0&&(w=2),A===!0&&(w=3);let x=a.attributes.position.count*w,B=1;x>e.maxTextureSize&&(B=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const Z=new Float32Array(x*B*4*d),N=new iS(Z,x,B,d);N.type=Fi,N.needsUpdate=!0;const W=w*4;for(let F=0;F<d;F++){const T=m[F],H=b[F],K=v[F],z=x*B*4*F;for(let j=0;j<T.count;j++){const O=j*W;p===!0&&(r.fromBufferAttribute(T,j),Z[z+O+0]=r.x,Z[z+O+1]=r.y,Z[z+O+2]=r.z,Z[z+O+3]=0),y===!0&&(r.fromBufferAttribute(H,j),Z[z+O+4]=r.x,Z[z+O+5]=r.y,Z[z+O+6]=r.z,Z[z+O+7]=0),A===!0&&(r.fromBufferAttribute(K,j),Z[z+O+8]=r.x,Z[z+O+9]=r.y,Z[z+O+10]=r.z,Z[z+O+11]=K.itemSize===4?r.w:1)}}h={count:d,texture:N,size:new He(x,B)},i.set(a,h),a.addEventListener("dispose",M)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,n);else{let p=0;for(let A=0;A<c.length;A++)p+=c[A];const y=a.morphTargetsRelative?1:1-p;l.getUniforms().setValue(t,"morphTargetBaseInfluence",y),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",h.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",h.size)}return{update:s}}function hje(t,e,n,i){let r=new WeakMap;function s(l){const c=i.render.frame,u=l.geometry,d=e.get(l,u);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==c&&(h.update(),r.set(h,c))}return d}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}const rte=new $n,uz=new C_(1,1),ste=new iS,ote=new rS,ate=new ry,dz=[],hz=[],Iz=new Float32Array(16),fz=new Float32Array(9),Cz=new Float32Array(4);function $C(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=dz[r];if(s===void 0&&(s=new Float32Array(r),dz[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function fr(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Cr(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function GS(t,e){let n=hz[e];n===void 0&&(n=new Int32Array(e),hz[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Ije(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function fje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(fr(n,e))return;t.uniform2fv(this.addr,e),Cr(n,e)}}function Cje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(fr(n,e))return;t.uniform3fv(this.addr,e),Cr(n,e)}}function pje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(fr(n,e))return;t.uniform4fv(this.addr,e),Cr(n,e)}}function mje(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(fr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Cr(n,e)}else{if(fr(n,i))return;Cz.set(i),t.uniformMatrix2fv(this.addr,!1,Cz),Cr(n,i)}}function Aje(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(fr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Cr(n,e)}else{if(fr(n,i))return;fz.set(i),t.uniformMatrix3fv(this.addr,!1,fz),Cr(n,i)}}function yje(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(fr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Cr(n,e)}else{if(fr(n,i))return;Iz.set(i),t.uniformMatrix4fv(this.addr,!1,Iz),Cr(n,i)}}function bje(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function vje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(fr(n,e))return;t.uniform2iv(this.addr,e),Cr(n,e)}}function xje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(fr(n,e))return;t.uniform3iv(this.addr,e),Cr(n,e)}}function wje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(fr(n,e))return;t.uniform4iv(this.addr,e),Cr(n,e)}}function Gje(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Bje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(fr(n,e))return;t.uniform2uiv(this.addr,e),Cr(n,e)}}function Sje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(fr(n,e))return;t.uniform3uiv(this.addr,e),Cr(n,e)}}function Zje(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(fr(n,e))return;t.uniform4uiv(this.addr,e),Cr(n,e)}}function Rje(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(uz.compareFunction=r_,s=uz):s=rte,n.setTexture2D(e||s,r)}function Nje(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||ote,r)}function Wje(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||ate,r)}function Mje(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||ste,r)}function Vje(t){switch(t){case 5126:return Ije;case 35664:return fje;case 35665:return Cje;case 35666:return pje;case 35674:return mje;case 35675:return Aje;case 35676:return yje;case 5124:case 35670:return bje;case 35667:case 35671:return vje;case 35668:case 35672:return xje;case 35669:case 35673:return wje;case 5125:return Gje;case 36294:return Bje;case 36295:return Sje;case 36296:return Zje;case 35678:case 36198:case 36298:case 36306:case 35682:return Rje;case 35679:case 36299:case 36307:return Nje;case 35680:case 36300:case 36308:case 36293:return Wje;case 36289:case 36303:case 36311:case 36292:return Mje}}function Fje(t,e){t.uniform1fv(this.addr,e)}function _je(t,e){const n=$C(e,this.size,2);t.uniform2fv(this.addr,n)}function Tje(t,e){const n=$C(e,this.size,3);t.uniform3fv(this.addr,n)}function Xje(t,e){const n=$C(e,this.size,4);t.uniform4fv(this.addr,n)}function Eje(t,e){const n=$C(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Yje(t,e){const n=$C(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function kje(t,e){const n=$C(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Hje(t,e){t.uniform1iv(this.addr,e)}function Kje(t,e){t.uniform2iv(this.addr,e)}function Lje(t,e){t.uniform3iv(this.addr,e)}function zje(t,e){t.uniform4iv(this.addr,e)}function jje(t,e){t.uniform1uiv(this.addr,e)}function Pje(t,e){t.uniform2uiv(this.addr,e)}function Oje(t,e){t.uniform3uiv(this.addr,e)}function Dje(t,e){t.uniform4uiv(this.addr,e)}function Uje(t,e,n){const i=this.cache,r=e.length,s=GS(n,r);fr(i,s)||(t.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||rte,s[o])}function Jje(t,e,n){const i=this.cache,r=e.length,s=GS(n,r);fr(i,s)||(t.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||ote,s[o])}function Qje(t,e,n){const i=this.cache,r=e.length,s=GS(n,r);fr(i,s)||(t.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||ate,s[o])}function qje(t,e,n){const i=this.cache,r=e.length,s=GS(n,r);fr(i,s)||(t.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||ste,s[o])}function $je(t){switch(t){case 5126:return Fje;case 35664:return _je;case 35665:return Tje;case 35666:return Xje;case 35674:return Eje;case 35675:return Yje;case 35676:return kje;case 5124:case 35670:return Hje;case 35667:case 35671:return Kje;case 35668:case 35672:return Lje;case 35669:case 35673:return zje;case 5125:return jje;case 36294:return Pje;case 36295:return Oje;case 36296:return Dje;case 35678:case 36198:case 36298:case 36306:case 35682:return Uje;case 35679:case 36299:case 36307:return Jje;case 35680:case 36300:case 36308:case 36293:return Qje;case 36289:case 36303:case 36311:case 36292:return qje}}class ePe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=Vje(n.type)}}class tPe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=$je(n.type)}}class nPe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,n[a.id],i)}}}const jR=/(\w+)(\])?(\[|\.)?/g;function pz(t,e){t.seq.push(e),t.map[e.id]=e}function iPe(t,e,n){const i=t.name,r=i.length;for(jR.lastIndex=0;;){const s=jR.exec(i),o=jR.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){pz(n,c===void 0?new ePe(a,t,e):new tPe(a,t,e));break}else{let d=n.map[a];d===void 0&&(d=new nPe(a),pz(n,d)),n=d}}}class wx{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);iPe(s,o,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in n&&i.push(o)}return i}}function mz(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const rPe=37297;let sPe=0;function oPe(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}const Az=new hn;function aPe(t){Fn._getMatrix(Az,Fn.workingColorSpace,t);const e=`mat3( ${Az.elements.map(n=>n.toFixed(4))} )`;switch(Fn.getTransfer(t)){case o0:return[e,"LinearTransferOETF"];case Qn:return[e,"sRGBTransferOETF"];default:return vt("WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function yz(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),s=(t.getShaderInfoLog(e)||"").trim();if(i&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+oPe(t.getShaderSource(e),a)}else return s}function lPe(t,e){const n=aPe(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function cPe(t,e){let n;switch(e){case T$:n="Linear";break;case X$:n="Reinhard";break;case E$:n="Cineon";break;case qF:n="ACESFilmic";break;case k$:n="AgX";break;case H$:n="Neutral";break;case Y$:n="Custom";break;default:vt("WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Ev=new J;function gPe(){Fn.getLuminanceCoefficients(Ev);const t=Ev.x.toFixed(4),e=Ev.y.toFixed(4),n=Ev.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function uPe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Am).join(`
`)}function dPe(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function hPe(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Am(t){return t!==""}function bz(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function vz(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const IPe=/^[ \t]*#include +<([\w\d./]+)>/gm;function H3(t){return t.replace(IPe,CPe)}const fPe=new Map;function CPe(t,e){let n=mn[e];if(n===void 0){const i=fPe.get(e);if(i!==void 0)n=mn[i],vt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return H3(n)}const pPe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xz(t){return t.replace(pPe,mPe)}function mPe(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function wz(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function APe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===OB?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Km?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Na&&(e="SHADOWMAP_TYPE_VSM"),e}function yPe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case kl:case lu:e="ENVMAP_TYPE_CUBE";break;case QC:e="ENVMAP_TYPE_CUBE_UV";break}return e}function bPe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case lu:e="ENVMAP_MODE_REFRACTION";break}return e}function vPe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case $0:e="ENVMAP_BLENDING_MULTIPLY";break;case F$:e="ENVMAP_BLENDING_MIX";break;case _$:e="ENVMAP_BLENDING_ADD";break}return e}function xPe(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function wPe(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=APe(n),c=yPe(n),u=bPe(n),d=vPe(n),h=xPe(n),I=uPe(n),p=dPe(s),y=r.createProgram();let A,m,b=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(A=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Am).join(`
`),A.length>0&&(A+=`
`),m=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Am).join(`
`),m.length>0&&(m+=`
`)):(A=[wz(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Am).join(`
`),m=[wz(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Tl?"#define TONE_MAPPING":"",n.toneMapping!==Tl?mn.tonemapping_pars_fragment:"",n.toneMapping!==Tl?cPe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",mn.colorspace_pars_fragment,lPe("linearToOutputTexel",n.outputColorSpace),gPe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Am).join(`
`)),o=H3(o),o=bz(o,n),o=vz(o,n),a=H3(a),a=bz(a,n),a=vz(a,n),o=xz(o),a=xz(a),n.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,A=[I,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+A,m=["#define varying in",n.glslVersion===W3?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===W3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);const v=b+A+o,w=b+m+a,x=mz(r,r.VERTEX_SHADER,v),B=mz(r,r.FRAGMENT_SHADER,w);r.attachShader(y,x),r.attachShader(y,B),n.index0AttributeName!==void 0?r.bindAttribLocation(y,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);function Z(F){if(t.debug.checkShaderErrors){const T=r.getProgramInfoLog(y)||"",H=r.getShaderInfoLog(x)||"",K=r.getShaderInfoLog(B)||"",z=T.trim(),j=H.trim(),O=K.trim();let _=!0,E=!0;if(r.getProgramParameter(y,r.LINK_STATUS)===!1)if(_=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,y,x,B);else{const P=yz(r,x,"vertex"),q=yz(r,B,"fragment");on("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,r.VALIDATE_STATUS)+`

Material Name: `+F.name+`
Material Type: `+F.type+`

Program Info Log: `+z+`
`+P+`
`+q)}else z!==""?vt("WebGLProgram: Program Info Log:",z):(j===""||O==="")&&(E=!1);E&&(F.diagnostics={runnable:_,programLog:z,vertexShader:{log:j,prefix:A},fragmentShader:{log:O,prefix:m}})}r.deleteShader(x),r.deleteShader(B),N=new wx(r,y),W=hPe(r,y)}let N;this.getUniforms=function(){return N===void 0&&Z(this),N};let W;this.getAttributes=function(){return W===void 0&&Z(this),W};let M=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=r.getProgramParameter(y,rPe)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=sPe++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=x,this.fragmentShader=B,this}let GPe=0;class BPe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new SPe(e),n.set(e,i)),i}}class SPe{constructor(e){this.id=GPe++,this.code=e,this.usedTimes=0}}function ZPe(t,e,n,i,r,s,o){const a=new Yd,l=new BPe,c=new Set,u=[],d=r.logarithmicDepthBuffer,h=r.vertexTextures;let I=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(W){return c.add(W),W===0?"uv":`uv${W}`}function A(W,M,F,T,H){const K=T.fog,z=H.geometry,j=W.isMeshStandardMaterial?T.environment:null,O=(W.isMeshStandardMaterial?n:e).get(W.envMap||j),_=O&&O.mapping===QC?O.image.height:null,E=p[W.type];W.precision!==null&&(I=r.getMaxPrecision(W.precision),I!==W.precision&&vt("WebGLProgram.getParameters:",W.precision,"not supported, using",I,"instead."));const P=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,q=P!==void 0?P.length:0;let re=0;z.morphAttributes.position!==void 0&&(re=1),z.morphAttributes.normal!==void 0&&(re=2),z.morphAttributes.color!==void 0&&(re=3);let de,Re,Pe,ae;if(E){const xn=Ea[E];de=xn.vertexShader,Re=xn.fragmentShader}else de=W.vertexShader,Re=W.fragmentShader,l.update(W),Pe=l.getVertexShaderID(W),ae=l.getFragmentShaderID(W);const he=t.getRenderTarget(),Me=t.state.buffers.depth.getReversed(),be=H.isInstancedMesh===!0,xe=H.isBatchedMesh===!0,Ge=!!W.map,pe=!!W.matcap,Oe=!!O,ve=!!W.aoMap,U=!!W.lightMap,We=!!W.bumpMap,Xe=!!W.normalMap,Qe=!!W.displacementMap,Le=!!W.emissiveMap,mt=!!W.metalnessMap,ot=!!W.roughnessMap,ft=W.anisotropy>0,Q=W.clearcoat>0,L=W.dispersion>0,Ce=W.iridescence>0,Ve=W.sheen>0,Ke=W.transmission>0,Ze=ft&&!!W.anisotropyMap,Rt=Q&&!!W.clearcoatMap,pt=Q&&!!W.clearcoatNormalMap,kt=Q&&!!W.clearcoatRoughnessMap,Nt=Ce&&!!W.iridescenceMap,Ue=Ce&&!!W.iridescenceThicknessMap,qe=Ve&&!!W.sheenColorMap,Pt=Ve&&!!W.sheenRoughnessMap,le=!!W.specularMap,Ae=!!W.specularColorMap,De=!!W.specularIntensityMap,se=Ke&&!!W.transmissionMap,ye=Ke&&!!W.thicknessMap,it=!!W.gradientMap,ct=!!W.alphaMap,rt=W.alphaTest>0,ze=!!W.alphaHash,yt=!!W.extensions;let Kt=Tl;W.toneMapped&&(he===null||he.isXRRenderTarget===!0)&&(Kt=t.toneMapping);const Rn={shaderID:E,shaderType:W.type,shaderName:W.name,vertexShader:de,fragmentShader:Re,defines:W.defines,customVertexShaderID:Pe,customFragmentShaderID:ae,isRawShaderMaterial:W.isRawShaderMaterial===!0,glslVersion:W.glslVersion,precision:I,batching:xe,batchingColor:xe&&H._colorsTexture!==null,instancing:be,instancingColor:be&&H.instanceColor!==null,instancingMorph:be&&H.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:he===null?t.outputColorSpace:he.isXRRenderTarget===!0?he.texture.colorSpace:Kl,alphaToCoverage:!!W.alphaToCoverage,map:Ge,matcap:pe,envMap:Oe,envMapMode:Oe&&O.mapping,envMapCubeUVHeight:_,aoMap:ve,lightMap:U,bumpMap:We,normalMap:Xe,displacementMap:h&&Qe,emissiveMap:Le,normalMapObjectSpace:Xe&&W.normalMapType===D$,normalMapTangentSpace:Xe&&W.normalMapType===wu,metalnessMap:mt,roughnessMap:ot,anisotropy:ft,anisotropyMap:Ze,clearcoat:Q,clearcoatMap:Rt,clearcoatNormalMap:pt,clearcoatRoughnessMap:kt,dispersion:L,iridescence:Ce,iridescenceMap:Nt,iridescenceThicknessMap:Ue,sheen:Ve,sheenColorMap:qe,sheenRoughnessMap:Pt,specularMap:le,specularColorMap:Ae,specularIntensityMap:De,transmission:Ke,transmissionMap:se,thicknessMap:ye,gradientMap:it,opaque:W.transparent===!1&&W.blending===Xd&&W.alphaToCoverage===!1,alphaMap:ct,alphaTest:rt,alphaHash:ze,combine:W.combine,mapUv:Ge&&y(W.map.channel),aoMapUv:ve&&y(W.aoMap.channel),lightMapUv:U&&y(W.lightMap.channel),bumpMapUv:We&&y(W.bumpMap.channel),normalMapUv:Xe&&y(W.normalMap.channel),displacementMapUv:Qe&&y(W.displacementMap.channel),emissiveMapUv:Le&&y(W.emissiveMap.channel),metalnessMapUv:mt&&y(W.metalnessMap.channel),roughnessMapUv:ot&&y(W.roughnessMap.channel),anisotropyMapUv:Ze&&y(W.anisotropyMap.channel),clearcoatMapUv:Rt&&y(W.clearcoatMap.channel),clearcoatNormalMapUv:pt&&y(W.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:kt&&y(W.clearcoatRoughnessMap.channel),iridescenceMapUv:Nt&&y(W.iridescenceMap.channel),iridescenceThicknessMapUv:Ue&&y(W.iridescenceThicknessMap.channel),sheenColorMapUv:qe&&y(W.sheenColorMap.channel),sheenRoughnessMapUv:Pt&&y(W.sheenRoughnessMap.channel),specularMapUv:le&&y(W.specularMap.channel),specularColorMapUv:Ae&&y(W.specularColorMap.channel),specularIntensityMapUv:De&&y(W.specularIntensityMap.channel),transmissionMapUv:se&&y(W.transmissionMap.channel),thicknessMapUv:ye&&y(W.thicknessMap.channel),alphaMapUv:ct&&y(W.alphaMap.channel),vertexTangents:!!z.attributes.tangent&&(Xe||ft),vertexColors:W.vertexColors,vertexAlphas:W.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,pointsUvs:H.isPoints===!0&&!!z.attributes.uv&&(Ge||ct),fog:!!K,useFog:W.fog===!0,fogExp2:!!K&&K.isFogExp2,flatShading:W.flatShading===!0&&W.wireframe===!1,sizeAttenuation:W.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:Me,skinning:H.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:q,morphTextureStride:re,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:W.dithering,shadowMapEnabled:t.shadowMap.enabled&&F.length>0,shadowMapType:t.shadowMap.type,toneMapping:Kt,decodeVideoTexture:Ge&&W.map.isVideoTexture===!0&&Fn.getTransfer(W.map.colorSpace)===Qn,decodeVideoTextureEmissive:Le&&W.emissiveMap.isVideoTexture===!0&&Fn.getTransfer(W.emissiveMap.colorSpace)===Qn,premultipliedAlpha:W.premultipliedAlpha,doubleSided:W.side===rs,flipSided:W.side===Bs,useDepthPacking:W.depthPacking>=0,depthPacking:W.depthPacking||0,index0AttributeName:W.index0AttributeName,extensionClipCullDistance:yt&&W.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(yt&&W.extensions.multiDraw===!0||xe)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:W.customProgramCacheKey()};return Rn.vertexUv1s=c.has(1),Rn.vertexUv2s=c.has(2),Rn.vertexUv3s=c.has(3),c.clear(),Rn}function m(W){const M=[];if(W.shaderID?M.push(W.shaderID):(M.push(W.customVertexShaderID),M.push(W.customFragmentShaderID)),W.defines!==void 0)for(const F in W.defines)M.push(F),M.push(W.defines[F]);return W.isRawShaderMaterial===!1&&(b(M,W),v(M,W),M.push(t.outputColorSpace)),M.push(W.customProgramCacheKey),M.join()}function b(W,M){W.push(M.precision),W.push(M.outputColorSpace),W.push(M.envMapMode),W.push(M.envMapCubeUVHeight),W.push(M.mapUv),W.push(M.alphaMapUv),W.push(M.lightMapUv),W.push(M.aoMapUv),W.push(M.bumpMapUv),W.push(M.normalMapUv),W.push(M.displacementMapUv),W.push(M.emissiveMapUv),W.push(M.metalnessMapUv),W.push(M.roughnessMapUv),W.push(M.anisotropyMapUv),W.push(M.clearcoatMapUv),W.push(M.clearcoatNormalMapUv),W.push(M.clearcoatRoughnessMapUv),W.push(M.iridescenceMapUv),W.push(M.iridescenceThicknessMapUv),W.push(M.sheenColorMapUv),W.push(M.sheenRoughnessMapUv),W.push(M.specularMapUv),W.push(M.specularColorMapUv),W.push(M.specularIntensityMapUv),W.push(M.transmissionMapUv),W.push(M.thicknessMapUv),W.push(M.combine),W.push(M.fogExp2),W.push(M.sizeAttenuation),W.push(M.morphTargetsCount),W.push(M.morphAttributeCount),W.push(M.numDirLights),W.push(M.numPointLights),W.push(M.numSpotLights),W.push(M.numSpotLightMaps),W.push(M.numHemiLights),W.push(M.numRectAreaLights),W.push(M.numDirLightShadows),W.push(M.numPointLightShadows),W.push(M.numSpotLightShadows),W.push(M.numSpotLightShadowsWithMaps),W.push(M.numLightProbes),W.push(M.shadowMapType),W.push(M.toneMapping),W.push(M.numClippingPlanes),W.push(M.numClipIntersection),W.push(M.depthPacking)}function v(W,M){a.disableAll(),M.supportsVertexTextures&&a.enable(0),M.instancing&&a.enable(1),M.instancingColor&&a.enable(2),M.instancingMorph&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),M.alphaHash&&a.enable(18),M.batching&&a.enable(19),M.dispersion&&a.enable(20),M.batchingColor&&a.enable(21),M.gradientMap&&a.enable(22),W.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.reversedDepthBuffer&&a.enable(4),M.skinning&&a.enable(5),M.morphTargets&&a.enable(6),M.morphNormals&&a.enable(7),M.morphColors&&a.enable(8),M.premultipliedAlpha&&a.enable(9),M.shadowMapEnabled&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),M.decodeVideoTexture&&a.enable(19),M.decodeVideoTextureEmissive&&a.enable(20),M.alphaToCoverage&&a.enable(21),W.push(a.mask)}function w(W){const M=p[W.type];let F;if(M){const T=Ea[M];F=g_.clone(T.uniforms)}else F=W.uniforms;return F}function x(W,M){let F;for(let T=0,H=u.length;T<H;T++){const K=u[T];if(K.cacheKey===M){F=K,++F.usedTimes;break}}return F===void 0&&(F=new wPe(t,M,W,s),u.push(F)),F}function B(W){if(--W.usedTimes===0){const M=u.indexOf(W);u[M]=u[u.length-1],u.pop(),W.destroy()}}function Z(W){l.remove(W)}function N(){l.dispose()}return{getParameters:A,getProgramCacheKey:m,getUniforms:w,acquireProgram:x,releaseProgram:B,releaseShaderCache:Z,programs:u,dispose:N}}function RPe(){let t=new WeakMap;function e(o){return t.has(o)}function n(o){let a=t.get(o);return a===void 0&&(a={},t.set(o,a)),a}function i(o){t.delete(o)}function r(o,a,l){t.get(o)[a]=l}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function NPe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Gz(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Bz(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(d,h,I,p,y,A){let m=t[e];return m===void 0?(m={id:d.id,object:d,geometry:h,material:I,groupOrder:p,renderOrder:d.renderOrder,z:y,group:A},t[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=I,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=y,m.group=A),e++,m}function a(d,h,I,p,y,A){const m=o(d,h,I,p,y,A);I.transmission>0?i.push(m):I.transparent===!0?r.push(m):n.push(m)}function l(d,h,I,p,y,A){const m=o(d,h,I,p,y,A);I.transmission>0?i.unshift(m):I.transparent===!0?r.unshift(m):n.unshift(m)}function c(d,h){n.length>1&&n.sort(d||NPe),i.length>1&&i.sort(h||Gz),r.length>1&&r.sort(h||Gz)}function u(){for(let d=e,h=t.length;d<h;d++){const I=t[d];if(I.id===null)break;I.id=null,I.object=null,I.geometry=null,I.material=null,I.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function WPe(){let t=new WeakMap;function e(i,r){const s=t.get(i);let o;return s===void 0?(o=new Bz,t.set(i,[o])):r>=s.length?(o=new Bz,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function MPe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new J,color:new wt};break;case"SpotLight":n={position:new J,direction:new J,color:new wt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new J,color:new wt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new J,skyColor:new wt,groundColor:new wt};break;case"RectAreaLight":n={color:new wt,position:new J,halfWidth:new J,halfHeight:new J};break}return t[e.id]=n,n}}}function VPe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let FPe=0;function _Pe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function TPe(t){const e=new MPe,n=VPe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new J);const r=new J,s=new Qt,o=new Qt;function a(c){let u=0,d=0,h=0;for(let W=0;W<9;W++)i.probe[W].set(0,0,0);let I=0,p=0,y=0,A=0,m=0,b=0,v=0,w=0,x=0,B=0,Z=0;c.sort(_Pe);for(let W=0,M=c.length;W<M;W++){const F=c[W],T=F.color,H=F.intensity,K=F.distance,z=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)u+=T.r*H,d+=T.g*H,h+=T.b*H;else if(F.isLightProbe){for(let j=0;j<9;j++)i.probe[j].addScaledVector(F.sh.coefficients[j],H);Z++}else if(F.isDirectionalLight){const j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity),F.castShadow){const O=F.shadow,_=n.get(F);_.shadowIntensity=O.intensity,_.shadowBias=O.bias,_.shadowNormalBias=O.normalBias,_.shadowRadius=O.radius,_.shadowMapSize=O.mapSize,i.directionalShadow[I]=_,i.directionalShadowMap[I]=z,i.directionalShadowMatrix[I]=F.shadow.matrix,b++}i.directional[I]=j,I++}else if(F.isSpotLight){const j=e.get(F);j.position.setFromMatrixPosition(F.matrixWorld),j.color.copy(T).multiplyScalar(H),j.distance=K,j.coneCos=Math.cos(F.angle),j.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),j.decay=F.decay,i.spot[y]=j;const O=F.shadow;if(F.map&&(i.spotLightMap[x]=F.map,x++,O.updateMatrices(F),F.castShadow&&B++),i.spotLightMatrix[y]=O.matrix,F.castShadow){const _=n.get(F);_.shadowIntensity=O.intensity,_.shadowBias=O.bias,_.shadowNormalBias=O.normalBias,_.shadowRadius=O.radius,_.shadowMapSize=O.mapSize,i.spotShadow[y]=_,i.spotShadowMap[y]=z,w++}y++}else if(F.isRectAreaLight){const j=e.get(F);j.color.copy(T).multiplyScalar(H),j.halfWidth.set(F.width*.5,0,0),j.halfHeight.set(0,F.height*.5,0),i.rectArea[A]=j,A++}else if(F.isPointLight){const j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity),j.distance=F.distance,j.decay=F.decay,F.castShadow){const O=F.shadow,_=n.get(F);_.shadowIntensity=O.intensity,_.shadowBias=O.bias,_.shadowNormalBias=O.normalBias,_.shadowRadius=O.radius,_.shadowMapSize=O.mapSize,_.shadowCameraNear=O.camera.near,_.shadowCameraFar=O.camera.far,i.pointShadow[p]=_,i.pointShadowMap[p]=z,i.pointShadowMatrix[p]=F.shadow.matrix,v++}i.point[p]=j,p++}else if(F.isHemisphereLight){const j=e.get(F);j.skyColor.copy(F.color).multiplyScalar(H),j.groundColor.copy(F.groundColor).multiplyScalar(H),i.hemi[m]=j,m++}}A>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=bt.LTC_FLOAT_1,i.rectAreaLTC2=bt.LTC_FLOAT_2):(i.rectAreaLTC1=bt.LTC_HALF_1,i.rectAreaLTC2=bt.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=d,i.ambient[2]=h;const N=i.hash;(N.directionalLength!==I||N.pointLength!==p||N.spotLength!==y||N.rectAreaLength!==A||N.hemiLength!==m||N.numDirectionalShadows!==b||N.numPointShadows!==v||N.numSpotShadows!==w||N.numSpotMaps!==x||N.numLightProbes!==Z)&&(i.directional.length=I,i.spot.length=y,i.rectArea.length=A,i.point.length=p,i.hemi.length=m,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=v,i.pointShadowMap.length=v,i.spotShadow.length=w,i.spotShadowMap.length=w,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=v,i.spotLightMatrix.length=w+x-B,i.spotLightMap.length=x,i.numSpotLightShadowsWithMaps=B,i.numLightProbes=Z,N.directionalLength=I,N.pointLength=p,N.spotLength=y,N.rectAreaLength=A,N.hemiLength=m,N.numDirectionalShadows=b,N.numPointShadows=v,N.numSpotShadows=w,N.numSpotMaps=x,N.numLightProbes=Z,i.version=FPe++)}function l(c,u){let d=0,h=0,I=0,p=0,y=0;const A=u.matrixWorldInverse;for(let m=0,b=c.length;m<b;m++){const v=c[m];if(v.isDirectionalLight){const w=i.directional[d];w.direction.setFromMatrixPosition(v.matrixWorld),r.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(r),w.direction.transformDirection(A),d++}else if(v.isSpotLight){const w=i.spot[I];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(A),w.direction.setFromMatrixPosition(v.matrixWorld),r.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(r),w.direction.transformDirection(A),I++}else if(v.isRectAreaLight){const w=i.rectArea[p];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(A),o.identity(),s.copy(v.matrixWorld),s.premultiply(A),o.extractRotation(s),w.halfWidth.set(v.width*.5,0,0),w.halfHeight.set(0,v.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),p++}else if(v.isPointLight){const w=i.point[h];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(A),h++}else if(v.isHemisphereLight){const w=i.hemi[y];w.direction.setFromMatrixPosition(v.matrixWorld),w.direction.transformDirection(A),y++}}}return{setup:a,setupView:l,state:i}}function Sz(t){const e=new TPe(t),n=[],i=[];function r(u){c.camera=u,n.length=0,i.length=0}function s(u){n.push(u)}function o(u){i.push(u)}function a(){e.setup(n)}function l(u){e.setupView(n,u)}const c={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function XPe(t){let e=new WeakMap;function n(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new Sz(t),e.set(r,[a])):s>=o.length?(a=new Sz(t),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:n,dispose:i}}const EPe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,YPe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function kPe(t,e,n){let i=new qC;const r=new He,s=new He,o=new _n,a=new G_({depthPacking:O$}),l=new B_,c={},u=n.maxTextureSize,d={[Lc]:Bs,[Bs]:Lc,[rs]:rs},h=new as({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new He},radius:{value:4}},vertexShader:EPe,fragmentShader:YPe}),I=h.clone();I.defines.HORIZONTAL_PASS=1;const p=new gn;p.setAttribute("position",new Wn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Li(p,h),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=OB;let m=this.type;this.render=function(B,Z,N){if(A.enabled===!1||A.autoUpdate===!1&&A.needsUpdate===!1||B.length===0)return;const W=t.getRenderTarget(),M=t.getActiveCubeFace(),F=t.getActiveMipmapLevel(),T=t.state;T.setBlending(Da),T.buffers.depth.getReversed()===!0?T.buffers.color.setClear(0,0,0,0):T.buffers.color.setClear(1,1,1,1),T.buffers.depth.setTest(!0),T.setScissorTest(!1);const H=m!==Na&&this.type===Na,K=m===Na&&this.type!==Na;for(let z=0,j=B.length;z<j;z++){const O=B[z],_=O.shadow;if(_===void 0){vt("WebGLShadowMap:",O,"has no shadow.");continue}if(_.autoUpdate===!1&&_.needsUpdate===!1)continue;r.copy(_.mapSize);const E=_.getFrameExtents();if(r.multiply(E),s.copy(_.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/E.x),r.x=s.x*E.x,_.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/E.y),r.y=s.y*E.y,_.mapSize.y=s.y)),_.map===null||H===!0||K===!0){const q=this.type!==Na?{minFilter:Sr,magFilter:Sr}:{};_.map!==null&&_.map.dispose(),_.map=new ga(r.x,r.y,q),_.map.texture.name=O.name+".shadowMap",_.camera.updateProjectionMatrix()}t.setRenderTarget(_.map),t.clear();const P=_.getViewportCount();for(let q=0;q<P;q++){const re=_.getViewport(q);o.set(s.x*re.x,s.y*re.y,s.x*re.z,s.y*re.w),T.viewport(o),_.updateMatrices(O,q),i=_.getFrustum(),w(Z,N,_.camera,O,this.type)}_.isPointLightShadow!==!0&&this.type===Na&&b(_,N),_.needsUpdate=!1}m=this.type,A.needsUpdate=!1,t.setRenderTarget(W,M,F)};function b(B,Z){const N=e.update(y);h.defines.VSM_SAMPLES!==B.blurSamples&&(h.defines.VSM_SAMPLES=B.blurSamples,I.defines.VSM_SAMPLES=B.blurSamples,h.needsUpdate=!0,I.needsUpdate=!0),B.mapPass===null&&(B.mapPass=new ga(r.x,r.y)),h.uniforms.shadow_pass.value=B.map.texture,h.uniforms.resolution.value=B.mapSize,h.uniforms.radius.value=B.radius,t.setRenderTarget(B.mapPass),t.clear(),t.renderBufferDirect(Z,null,N,h,y,null),I.uniforms.shadow_pass.value=B.mapPass.texture,I.uniforms.resolution.value=B.mapSize,I.uniforms.radius.value=B.radius,t.setRenderTarget(B.map),t.clear(),t.renderBufferDirect(Z,null,N,I,y,null)}function v(B,Z,N,W){let M=null;const F=N.isPointLight===!0?B.customDistanceMaterial:B.customDepthMaterial;if(F!==void 0)M=F;else if(M=N.isPointLight===!0?l:a,t.localClippingEnabled&&Z.clipShadows===!0&&Array.isArray(Z.clippingPlanes)&&Z.clippingPlanes.length!==0||Z.displacementMap&&Z.displacementScale!==0||Z.alphaMap&&Z.alphaTest>0||Z.map&&Z.alphaTest>0||Z.alphaToCoverage===!0){const T=M.uuid,H=Z.uuid;let K=c[T];K===void 0&&(K={},c[T]=K);let z=K[H];z===void 0&&(z=M.clone(),K[H]=z,Z.addEventListener("dispose",x)),M=z}if(M.visible=Z.visible,M.wireframe=Z.wireframe,W===Na?M.side=Z.shadowSide!==null?Z.shadowSide:Z.side:M.side=Z.shadowSide!==null?Z.shadowSide:d[Z.side],M.alphaMap=Z.alphaMap,M.alphaTest=Z.alphaToCoverage===!0?.5:Z.alphaTest,M.map=Z.map,M.clipShadows=Z.clipShadows,M.clippingPlanes=Z.clippingPlanes,M.clipIntersection=Z.clipIntersection,M.displacementMap=Z.displacementMap,M.displacementScale=Z.displacementScale,M.displacementBias=Z.displacementBias,M.wireframeLinewidth=Z.wireframeLinewidth,M.linewidth=Z.linewidth,N.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const T=t.properties.get(M);T.light=N}return M}function w(B,Z,N,W,M){if(B.visible===!1)return;if(B.layers.test(Z.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&M===Na)&&(!B.frustumCulled||i.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,B.matrixWorld);const H=e.update(B),K=B.material;if(Array.isArray(K)){const z=H.groups;for(let j=0,O=z.length;j<O;j++){const _=z[j],E=K[_.materialIndex];if(E&&E.visible){const P=v(B,E,W,M);B.onBeforeShadow(t,B,Z,N,H,P,_),t.renderBufferDirect(N,null,H,P,B,_),B.onAfterShadow(t,B,Z,N,H,P,_)}}}else if(K.visible){const z=v(B,K,W,M);B.onBeforeShadow(t,B,Z,N,H,z,null),t.renderBufferDirect(N,null,H,z,B,null),B.onAfterShadow(t,B,Z,N,H,z,null)}}const T=B.children;for(let H=0,K=T.length;H<K;H++)w(T[H],Z,N,W,M)}function x(B){B.target.removeEventListener("dispose",x);for(const N in c){const W=c[N],M=B.target.uuid;M in W&&(W[M].dispose(),delete W[M])}}}const HPe={[vG]:xG,[wG]:SG,[GG]:ZG,[rh]:BG,[xG]:vG,[SG]:wG,[ZG]:GG,[BG]:rh};function KPe(t,e){function n(){let se=!1;const ye=new _n;let it=null;const ct=new _n(0,0,0,0);return{setMask:function(rt){it!==rt&&!se&&(t.colorMask(rt,rt,rt,rt),it=rt)},setLocked:function(rt){se=rt},setClear:function(rt,ze,yt,Kt,Rn){Rn===!0&&(rt*=Kt,ze*=Kt,yt*=Kt),ye.set(rt,ze,yt,Kt),ct.equals(ye)===!1&&(t.clearColor(rt,ze,yt,Kt),ct.copy(ye))},reset:function(){se=!1,it=null,ct.set(-1,0,0,0)}}}function i(){let se=!1,ye=!1,it=null,ct=null,rt=null;return{setReversed:function(ze){if(ye!==ze){const yt=e.get("EXT_clip_control");ze?yt.clipControlEXT(yt.LOWER_LEFT_EXT,yt.ZERO_TO_ONE_EXT):yt.clipControlEXT(yt.LOWER_LEFT_EXT,yt.NEGATIVE_ONE_TO_ONE_EXT),ye=ze;const Kt=rt;rt=null,this.setClear(Kt)}},getReversed:function(){return ye},setTest:function(ze){ze?he(t.DEPTH_TEST):Me(t.DEPTH_TEST)},setMask:function(ze){it!==ze&&!se&&(t.depthMask(ze),it=ze)},setFunc:function(ze){if(ye&&(ze=HPe[ze]),ct!==ze){switch(ze){case vG:t.depthFunc(t.NEVER);break;case xG:t.depthFunc(t.ALWAYS);break;case wG:t.depthFunc(t.LESS);break;case rh:t.depthFunc(t.LEQUAL);break;case GG:t.depthFunc(t.EQUAL);break;case BG:t.depthFunc(t.GEQUAL);break;case SG:t.depthFunc(t.GREATER);break;case ZG:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}ct=ze}},setLocked:function(ze){se=ze},setClear:function(ze){rt!==ze&&(ye&&(ze=1-ze),t.clearDepth(ze),rt=ze)},reset:function(){se=!1,it=null,ct=null,rt=null,ye=!1}}}function r(){let se=!1,ye=null,it=null,ct=null,rt=null,ze=null,yt=null,Kt=null,Rn=null;return{setTest:function(xn){se||(xn?he(t.STENCIL_TEST):Me(t.STENCIL_TEST))},setMask:function(xn){ye!==xn&&!se&&(t.stencilMask(xn),ye=xn)},setFunc:function(xn,zi,Di){(it!==xn||ct!==zi||rt!==Di)&&(t.stencilFunc(xn,zi,Di),it=xn,ct=zi,rt=Di)},setOp:function(xn,zi,Di){(ze!==xn||yt!==zi||Kt!==Di)&&(t.stencilOp(xn,zi,Di),ze=xn,yt=zi,Kt=Di)},setLocked:function(xn){se=xn},setClear:function(xn){Rn!==xn&&(t.clearStencil(xn),Rn=xn)},reset:function(){se=!1,ye=null,it=null,ct=null,rt=null,ze=null,yt=null,Kt=null,Rn=null}}}const s=new n,o=new i,a=new r,l=new WeakMap,c=new WeakMap;let u={},d={},h=new WeakMap,I=[],p=null,y=!1,A=null,m=null,b=null,v=null,w=null,x=null,B=null,Z=new wt(0,0,0),N=0,W=!1,M=null,F=null,T=null,H=null,K=null;const z=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,O=0;const _=t.getParameter(t.VERSION);_.indexOf("WebGL")!==-1?(O=parseFloat(/^WebGL (\d)/.exec(_)[1]),j=O>=1):_.indexOf("OpenGL ES")!==-1&&(O=parseFloat(/^OpenGL ES (\d)/.exec(_)[1]),j=O>=2);let E=null,P={};const q=t.getParameter(t.SCISSOR_BOX),re=t.getParameter(t.VIEWPORT),de=new _n().fromArray(q),Re=new _n().fromArray(re);function Pe(se,ye,it,ct){const rt=new Uint8Array(4),ze=t.createTexture();t.bindTexture(se,ze),t.texParameteri(se,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(se,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let yt=0;yt<it;yt++)se===t.TEXTURE_3D||se===t.TEXTURE_2D_ARRAY?t.texImage3D(ye,0,t.RGBA,1,1,ct,0,t.RGBA,t.UNSIGNED_BYTE,rt):t.texImage2D(ye+yt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,rt);return ze}const ae={};ae[t.TEXTURE_2D]=Pe(t.TEXTURE_2D,t.TEXTURE_2D,1),ae[t.TEXTURE_CUBE_MAP]=Pe(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),ae[t.TEXTURE_2D_ARRAY]=Pe(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),ae[t.TEXTURE_3D]=Pe(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),he(t.DEPTH_TEST),o.setFunc(rh),We(!1),Xe(w3),he(t.CULL_FACE),ve(Da);function he(se){u[se]!==!0&&(t.enable(se),u[se]=!0)}function Me(se){u[se]!==!1&&(t.disable(se),u[se]=!1)}function be(se,ye){return d[se]!==ye?(t.bindFramebuffer(se,ye),d[se]=ye,se===t.DRAW_FRAMEBUFFER&&(d[t.FRAMEBUFFER]=ye),se===t.FRAMEBUFFER&&(d[t.DRAW_FRAMEBUFFER]=ye),!0):!1}function xe(se,ye){let it=I,ct=!1;if(se){it=h.get(ye),it===void 0&&(it=[],h.set(ye,it));const rt=se.textures;if(it.length!==rt.length||it[0]!==t.COLOR_ATTACHMENT0){for(let ze=0,yt=rt.length;ze<yt;ze++)it[ze]=t.COLOR_ATTACHMENT0+ze;it.length=rt.length,ct=!0}}else it[0]!==t.BACK&&(it[0]=t.BACK,ct=!0);ct&&t.drawBuffers(it)}function Ge(se){return p!==se?(t.useProgram(se),p=se,!0):!1}const pe={[Gg]:t.FUNC_ADD,[p$]:t.FUNC_SUBTRACT,[m$]:t.FUNC_REVERSE_SUBTRACT};pe[A$]=t.MIN,pe[y$]=t.MAX;const Oe={[b$]:t.ZERO,[v$]:t.ONE,[x$]:t.SRC_COLOR,[yG]:t.SRC_ALPHA,[R$]:t.SRC_ALPHA_SATURATE,[S$]:t.DST_COLOR,[G$]:t.DST_ALPHA,[w$]:t.ONE_MINUS_SRC_COLOR,[bG]:t.ONE_MINUS_SRC_ALPHA,[Z$]:t.ONE_MINUS_DST_COLOR,[B$]:t.ONE_MINUS_DST_ALPHA,[N$]:t.CONSTANT_COLOR,[W$]:t.ONE_MINUS_CONSTANT_COLOR,[M$]:t.CONSTANT_ALPHA,[V$]:t.ONE_MINUS_CONSTANT_ALPHA};function ve(se,ye,it,ct,rt,ze,yt,Kt,Rn,xn){if(se===Da){y===!0&&(Me(t.BLEND),y=!1);return}if(y===!1&&(he(t.BLEND),y=!0),se!==C$){if(se!==A||xn!==W){if((m!==Gg||w!==Gg)&&(t.blendEquation(t.FUNC_ADD),m=Gg,w=Gg),xn)switch(se){case Xd:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case G3:t.blendFunc(t.ONE,t.ONE);break;case B3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case S3:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:on("WebGLState: Invalid blending: ",se);break}else switch(se){case Xd:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case G3:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case B3:on("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case S3:on("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:on("WebGLState: Invalid blending: ",se);break}b=null,v=null,x=null,B=null,Z.set(0,0,0),N=0,A=se,W=xn}return}rt=rt||ye,ze=ze||it,yt=yt||ct,(ye!==m||rt!==w)&&(t.blendEquationSeparate(pe[ye],pe[rt]),m=ye,w=rt),(it!==b||ct!==v||ze!==x||yt!==B)&&(t.blendFuncSeparate(Oe[it],Oe[ct],Oe[ze],Oe[yt]),b=it,v=ct,x=ze,B=yt),(Kt.equals(Z)===!1||Rn!==N)&&(t.blendColor(Kt.r,Kt.g,Kt.b,Rn),Z.copy(Kt),N=Rn),A=se,W=!1}function U(se,ye){se.side===rs?Me(t.CULL_FACE):he(t.CULL_FACE);let it=se.side===Bs;ye&&(it=!it),We(it),se.blending===Xd&&se.transparent===!1?ve(Da):ve(se.blending,se.blendEquation,se.blendSrc,se.blendDst,se.blendEquationAlpha,se.blendSrcAlpha,se.blendDstAlpha,se.blendColor,se.blendAlpha,se.premultipliedAlpha),o.setFunc(se.depthFunc),o.setTest(se.depthTest),o.setMask(se.depthWrite),s.setMask(se.colorWrite);const ct=se.stencilWrite;a.setTest(ct),ct&&(a.setMask(se.stencilWriteMask),a.setFunc(se.stencilFunc,se.stencilRef,se.stencilFuncMask),a.setOp(se.stencilFail,se.stencilZFail,se.stencilZPass)),Le(se.polygonOffset,se.polygonOffsetFactor,se.polygonOffsetUnits),se.alphaToCoverage===!0?he(t.SAMPLE_ALPHA_TO_COVERAGE):Me(t.SAMPLE_ALPHA_TO_COVERAGE)}function We(se){M!==se&&(se?t.frontFace(t.CW):t.frontFace(t.CCW),M=se)}function Xe(se){se!==h$?(he(t.CULL_FACE),se!==F&&(se===w3?t.cullFace(t.BACK):se===I$?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Me(t.CULL_FACE),F=se}function Qe(se){se!==T&&(j&&t.lineWidth(se),T=se)}function Le(se,ye,it){se?(he(t.POLYGON_OFFSET_FILL),(H!==ye||K!==it)&&(t.polygonOffset(ye,it),H=ye,K=it)):Me(t.POLYGON_OFFSET_FILL)}function mt(se){se?he(t.SCISSOR_TEST):Me(t.SCISSOR_TEST)}function ot(se){se===void 0&&(se=t.TEXTURE0+z-1),E!==se&&(t.activeTexture(se),E=se)}function ft(se,ye,it){it===void 0&&(E===null?it=t.TEXTURE0+z-1:it=E);let ct=P[it];ct===void 0&&(ct={type:void 0,texture:void 0},P[it]=ct),(ct.type!==se||ct.texture!==ye)&&(E!==it&&(t.activeTexture(it),E=it),t.bindTexture(se,ye||ae[se]),ct.type=se,ct.texture=ye)}function Q(){const se=P[E];se!==void 0&&se.type!==void 0&&(t.bindTexture(se.type,null),se.type=void 0,se.texture=void 0)}function L(){try{t.compressedTexImage2D(...arguments)}catch(se){se("WebGLState:",se)}}function Ce(){try{t.compressedTexImage3D(...arguments)}catch(se){se("WebGLState:",se)}}function Ve(){try{t.texSubImage2D(...arguments)}catch(se){se("WebGLState:",se)}}function Ke(){try{t.texSubImage3D(...arguments)}catch(se){se("WebGLState:",se)}}function Ze(){try{t.compressedTexSubImage2D(...arguments)}catch(se){se("WebGLState:",se)}}function Rt(){try{t.compressedTexSubImage3D(...arguments)}catch(se){se("WebGLState:",se)}}function pt(){try{t.texStorage2D(...arguments)}catch(se){se("WebGLState:",se)}}function kt(){try{t.texStorage3D(...arguments)}catch(se){se("WebGLState:",se)}}function Nt(){try{t.texImage2D(...arguments)}catch(se){se("WebGLState:",se)}}function Ue(){try{t.texImage3D(...arguments)}catch(se){se("WebGLState:",se)}}function qe(se){de.equals(se)===!1&&(t.scissor(se.x,se.y,se.z,se.w),de.copy(se))}function Pt(se){Re.equals(se)===!1&&(t.viewport(se.x,se.y,se.z,se.w),Re.copy(se))}function le(se,ye){let it=c.get(ye);it===void 0&&(it=new WeakMap,c.set(ye,it));let ct=it.get(se);ct===void 0&&(ct=t.getUniformBlockIndex(ye,se.name),it.set(se,ct))}function Ae(se,ye){const ct=c.get(ye).get(se);l.get(ye)!==ct&&(t.uniformBlockBinding(ye,ct,se.__bindingPointIndex),l.set(ye,ct))}function De(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},E=null,P={},d={},h=new WeakMap,I=[],p=null,y=!1,A=null,m=null,b=null,v=null,w=null,x=null,B=null,Z=new wt(0,0,0),N=0,W=!1,M=null,F=null,T=null,H=null,K=null,de.set(0,0,t.canvas.width,t.canvas.height),Re.set(0,0,t.canvas.width,t.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:he,disable:Me,bindFramebuffer:be,drawBuffers:xe,useProgram:Ge,setBlending:ve,setMaterial:U,setFlipSided:We,setCullFace:Xe,setLineWidth:Qe,setPolygonOffset:Le,setScissorTest:mt,activeTexture:ot,bindTexture:ft,unbindTexture:Q,compressedTexImage2D:L,compressedTexImage3D:Ce,texImage2D:Nt,texImage3D:Ue,updateUBOMapping:le,uniformBlockBinding:Ae,texStorage2D:pt,texStorage3D:kt,texSubImage2D:Ve,texSubImage3D:Ke,compressedTexSubImage2D:Ze,compressedTexSubImage3D:Rt,scissor:qe,viewport:Pt,reset:De}}function LPe(t,e,n,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new He,u=new WeakMap;let d;const h=new WeakMap;let I=!1;try{I=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(Q,L){return I?new OffscreenCanvas(Q,L):l0("canvas")}function y(Q,L,Ce){let Ve=1;const Ke=ft(Q);if((Ke.width>Ce||Ke.height>Ce)&&(Ve=Ce/Math.max(Ke.width,Ke.height)),Ve<1)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap||typeof VideoFrame<"u"&&Q instanceof VideoFrame){const Ze=Math.floor(Ve*Ke.width),Rt=Math.floor(Ve*Ke.height);d===void 0&&(d=p(Ze,Rt));const pt=L?p(Ze,Rt):d;return pt.width=Ze,pt.height=Rt,pt.getContext("2d").drawImage(Q,0,0,Ze,Rt),vt("WebGLRenderer: Texture has been resized from ("+Ke.width+"x"+Ke.height+") to ("+Ze+"x"+Rt+")."),pt}else return"data"in Q&&vt("WebGLRenderer: Image in DataTexture is too big ("+Ke.width+"x"+Ke.height+")."),Q;return Q}function A(Q){return Q.generateMipmaps}function m(Q){t.generateMipmap(Q)}function b(Q){return Q.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Q.isWebGL3DRenderTarget?t.TEXTURE_3D:Q.isWebGLArrayRenderTarget||Q.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function v(Q,L,Ce,Ve,Ke=!1){if(Q!==null){if(t[Q]!==void 0)return t[Q];vt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let Ze=L;if(L===t.RED&&(Ce===t.FLOAT&&(Ze=t.R32F),Ce===t.HALF_FLOAT&&(Ze=t.R16F),Ce===t.UNSIGNED_BYTE&&(Ze=t.R8)),L===t.RED_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.R8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.R16UI),Ce===t.UNSIGNED_INT&&(Ze=t.R32UI),Ce===t.BYTE&&(Ze=t.R8I),Ce===t.SHORT&&(Ze=t.R16I),Ce===t.INT&&(Ze=t.R32I)),L===t.RG&&(Ce===t.FLOAT&&(Ze=t.RG32F),Ce===t.HALF_FLOAT&&(Ze=t.RG16F),Ce===t.UNSIGNED_BYTE&&(Ze=t.RG8)),L===t.RG_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.RG8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.RG16UI),Ce===t.UNSIGNED_INT&&(Ze=t.RG32UI),Ce===t.BYTE&&(Ze=t.RG8I),Ce===t.SHORT&&(Ze=t.RG16I),Ce===t.INT&&(Ze=t.RG32I)),L===t.RGB_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.RGB8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.RGB16UI),Ce===t.UNSIGNED_INT&&(Ze=t.RGB32UI),Ce===t.BYTE&&(Ze=t.RGB8I),Ce===t.SHORT&&(Ze=t.RGB16I),Ce===t.INT&&(Ze=t.RGB32I)),L===t.RGBA_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.RGBA8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.RGBA16UI),Ce===t.UNSIGNED_INT&&(Ze=t.RGBA32UI),Ce===t.BYTE&&(Ze=t.RGBA8I),Ce===t.SHORT&&(Ze=t.RGBA16I),Ce===t.INT&&(Ze=t.RGBA32I)),L===t.RGB&&(Ce===t.UNSIGNED_INT_5_9_9_9_REV&&(Ze=t.RGB9_E5),Ce===t.UNSIGNED_INT_10F_11F_11F_REV&&(Ze=t.R11F_G11F_B10F)),L===t.RGBA){const Rt=Ke?o0:Fn.getTransfer(Ve);Ce===t.FLOAT&&(Ze=t.RGBA32F),Ce===t.HALF_FLOAT&&(Ze=t.RGBA16F),Ce===t.UNSIGNED_BYTE&&(Ze=Rt===Qn?t.SRGB8_ALPHA8:t.RGBA8),Ce===t.UNSIGNED_SHORT_4_4_4_4&&(Ze=t.RGBA4),Ce===t.UNSIGNED_SHORT_5_5_5_1&&(Ze=t.RGB5_A1)}return(Ze===t.R16F||Ze===t.R32F||Ze===t.RG16F||Ze===t.RG32F||Ze===t.RGBA16F||Ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ze}function w(Q,L){let Ce;return Q?L===null||L===Hl||L===gC?Ce=t.DEPTH24_STENCIL8:L===Fi?Ce=t.DEPTH32F_STENCIL8:L===cC&&(Ce=t.DEPTH24_STENCIL8,vt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):L===null||L===Hl||L===gC?Ce=t.DEPTH_COMPONENT24:L===Fi?Ce=t.DEPTH_COMPONENT32F:L===cC&&(Ce=t.DEPTH_COMPONENT16),Ce}function x(Q,L){return A(Q)===!0||Q.isFramebufferTexture&&Q.minFilter!==Sr&&Q.minFilter!==Ln?Math.log2(Math.max(L.width,L.height))+1:Q.mipmaps!==void 0&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?L.mipmaps.length:1}function B(Q){const L=Q.target;L.removeEventListener("dispose",B),N(L),L.isVideoTexture&&u.delete(L)}function Z(Q){const L=Q.target;L.removeEventListener("dispose",Z),M(L)}function N(Q){const L=i.get(Q);if(L.__webglInit===void 0)return;const Ce=Q.source,Ve=h.get(Ce);if(Ve){const Ke=Ve[L.__cacheKey];Ke.usedTimes--,Ke.usedTimes===0&&W(Q),Object.keys(Ve).length===0&&h.delete(Ce)}i.remove(Q)}function W(Q){const L=i.get(Q);t.deleteTexture(L.__webglTexture);const Ce=Q.source,Ve=h.get(Ce);delete Ve[L.__cacheKey],o.memory.textures--}function M(Q){const L=i.get(Q);if(Q.depthTexture&&(Q.depthTexture.dispose(),i.remove(Q.depthTexture)),Q.isWebGLCubeRenderTarget)for(let Ve=0;Ve<6;Ve++){if(Array.isArray(L.__webglFramebuffer[Ve]))for(let Ke=0;Ke<L.__webglFramebuffer[Ve].length;Ke++)t.deleteFramebuffer(L.__webglFramebuffer[Ve][Ke]);else t.deleteFramebuffer(L.__webglFramebuffer[Ve]);L.__webglDepthbuffer&&t.deleteRenderbuffer(L.__webglDepthbuffer[Ve])}else{if(Array.isArray(L.__webglFramebuffer))for(let Ve=0;Ve<L.__webglFramebuffer.length;Ve++)t.deleteFramebuffer(L.__webglFramebuffer[Ve]);else t.deleteFramebuffer(L.__webglFramebuffer);if(L.__webglDepthbuffer&&t.deleteRenderbuffer(L.__webglDepthbuffer),L.__webglMultisampledFramebuffer&&t.deleteFramebuffer(L.__webglMultisampledFramebuffer),L.__webglColorRenderbuffer)for(let Ve=0;Ve<L.__webglColorRenderbuffer.length;Ve++)L.__webglColorRenderbuffer[Ve]&&t.deleteRenderbuffer(L.__webglColorRenderbuffer[Ve]);L.__webglDepthRenderbuffer&&t.deleteRenderbuffer(L.__webglDepthRenderbuffer)}const Ce=Q.textures;for(let Ve=0,Ke=Ce.length;Ve<Ke;Ve++){const Ze=i.get(Ce[Ve]);Ze.__webglTexture&&(t.deleteTexture(Ze.__webglTexture),o.memory.textures--),i.remove(Ce[Ve])}i.remove(Q)}let F=0;function T(){F=0}function H(){const Q=F;return Q>=r.maxTextures&&vt("WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+r.maxTextures),F+=1,Q}function K(Q){const L=[];return L.push(Q.wrapS),L.push(Q.wrapT),L.push(Q.wrapR||0),L.push(Q.magFilter),L.push(Q.minFilter),L.push(Q.anisotropy),L.push(Q.internalFormat),L.push(Q.format),L.push(Q.type),L.push(Q.generateMipmaps),L.push(Q.premultiplyAlpha),L.push(Q.flipY),L.push(Q.unpackAlignment),L.push(Q.colorSpace),L.join()}function z(Q,L){const Ce=i.get(Q);if(Q.isVideoTexture&&mt(Q),Q.isRenderTargetTexture===!1&&Q.isExternalTexture!==!0&&Q.version>0&&Ce.__version!==Q.version){const Ve=Q.image;if(Ve===null)vt("WebGLRenderer: Texture marked for update but no image data found.");else if(Ve.complete===!1)vt("WebGLRenderer: Texture marked for update but image is incomplete");else{ae(Ce,Q,L);return}}else Q.isExternalTexture&&(Ce.__webglTexture=Q.sourceTexture?Q.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,Ce.__webglTexture,t.TEXTURE0+L)}function j(Q,L){const Ce=i.get(Q);if(Q.isRenderTargetTexture===!1&&Q.version>0&&Ce.__version!==Q.version){ae(Ce,Q,L);return}else Q.isExternalTexture&&(Ce.__webglTexture=Q.sourceTexture?Q.sourceTexture:null);n.bindTexture(t.TEXTURE_2D_ARRAY,Ce.__webglTexture,t.TEXTURE0+L)}function O(Q,L){const Ce=i.get(Q);if(Q.isRenderTargetTexture===!1&&Q.version>0&&Ce.__version!==Q.version){ae(Ce,Q,L);return}n.bindTexture(t.TEXTURE_3D,Ce.__webglTexture,t.TEXTURE0+L)}function _(Q,L){const Ce=i.get(Q);if(Q.version>0&&Ce.__version!==Q.version){he(Ce,Q,L);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Ce.__webglTexture,t.TEXTURE0+L)}const E={[aC]:t.REPEAT,[Vi]:t.CLAMP_TO_EDGE,[lC]:t.MIRRORED_REPEAT},P={[Sr]:t.NEAREST,[DB]:t.NEAREST_MIPMAP_NEAREST,[yd]:t.NEAREST_MIPMAP_LINEAR,[Ln]:t.LINEAR,[$I]:t.LINEAR_MIPMAP_NEAREST,[ka]:t.LINEAR_MIPMAP_LINEAR},q={[U$]:t.NEVER,[tee]:t.ALWAYS,[J$]:t.LESS,[r_]:t.LEQUAL,[Q$]:t.EQUAL,[eee]:t.GEQUAL,[q$]:t.GREATER,[$$]:t.NOTEQUAL};function re(Q,L){if(L.type===Fi&&e.has("OES_texture_float_linear")===!1&&(L.magFilter===Ln||L.magFilter===$I||L.magFilter===yd||L.magFilter===ka||L.minFilter===Ln||L.minFilter===$I||L.minFilter===yd||L.minFilter===ka)&&vt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Q,t.TEXTURE_WRAP_S,E[L.wrapS]),t.texParameteri(Q,t.TEXTURE_WRAP_T,E[L.wrapT]),(Q===t.TEXTURE_3D||Q===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Q,t.TEXTURE_WRAP_R,E[L.wrapR]),t.texParameteri(Q,t.TEXTURE_MAG_FILTER,P[L.magFilter]),t.texParameteri(Q,t.TEXTURE_MIN_FILTER,P[L.minFilter]),L.compareFunction&&(t.texParameteri(Q,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Q,t.TEXTURE_COMPARE_FUNC,q[L.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(L.magFilter===Sr||L.minFilter!==yd&&L.minFilter!==ka||L.type===Fi&&e.has("OES_texture_float_linear")===!1)return;if(L.anisotropy>1||i.get(L).__currentAnisotropy){const Ce=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Q,Ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy}}}function de(Q,L){let Ce=!1;Q.__webglInit===void 0&&(Q.__webglInit=!0,L.addEventListener("dispose",B));const Ve=L.source;let Ke=h.get(Ve);Ke===void 0&&(Ke={},h.set(Ve,Ke));const Ze=K(L);if(Ze!==Q.__cacheKey){Ke[Ze]===void 0&&(Ke[Ze]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,Ce=!0),Ke[Ze].usedTimes++;const Rt=Ke[Q.__cacheKey];Rt!==void 0&&(Ke[Q.__cacheKey].usedTimes--,Rt.usedTimes===0&&W(L)),Q.__cacheKey=Ze,Q.__webglTexture=Ke[Ze].texture}return Ce}function Re(Q,L,Ce){return Math.floor(Math.floor(Q/Ce)/L)}function Pe(Q,L,Ce,Ve){const Ze=Q.updateRanges;if(Ze.length===0)n.texSubImage2D(t.TEXTURE_2D,0,0,0,L.width,L.height,Ce,Ve,L.data);else{Ze.sort((Ue,qe)=>Ue.start-qe.start);let Rt=0;for(let Ue=1;Ue<Ze.length;Ue++){const qe=Ze[Rt],Pt=Ze[Ue],le=qe.start+qe.count,Ae=Re(Pt.start,L.width,4),De=Re(qe.start,L.width,4);Pt.start<=le+1&&Ae===De&&Re(Pt.start+Pt.count-1,L.width,4)===Ae?qe.count=Math.max(qe.count,Pt.start+Pt.count-qe.start):(++Rt,Ze[Rt]=Pt)}Ze.length=Rt+1;const pt=t.getParameter(t.UNPACK_ROW_LENGTH),kt=t.getParameter(t.UNPACK_SKIP_PIXELS),Nt=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,L.width);for(let Ue=0,qe=Ze.length;Ue<qe;Ue++){const Pt=Ze[Ue],le=Math.floor(Pt.start/4),Ae=Math.ceil(Pt.count/4),De=le%L.width,se=Math.floor(le/L.width),ye=Ae,it=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,De),t.pixelStorei(t.UNPACK_SKIP_ROWS,se),n.texSubImage2D(t.TEXTURE_2D,0,De,se,ye,it,Ce,Ve,L.data)}Q.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,pt),t.pixelStorei(t.UNPACK_SKIP_PIXELS,kt),t.pixelStorei(t.UNPACK_SKIP_ROWS,Nt)}}function ae(Q,L,Ce){let Ve=t.TEXTURE_2D;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(Ve=t.TEXTURE_2D_ARRAY),L.isData3DTexture&&(Ve=t.TEXTURE_3D);const Ke=de(Q,L),Ze=L.source;n.bindTexture(Ve,Q.__webglTexture,t.TEXTURE0+Ce);const Rt=i.get(Ze);if(Ze.version!==Rt.__version||Ke===!0){n.activeTexture(t.TEXTURE0+Ce);const pt=Fn.getPrimaries(Fn.workingColorSpace),kt=L.colorSpace===Gl?null:Fn.getPrimaries(L.colorSpace),Nt=L.colorSpace===Gl||pt===kt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nt);let Ue=y(L.image,!1,r.maxTextureSize);Ue=ot(L,Ue);const qe=s.convert(L.format,L.colorSpace),Pt=s.convert(L.type);let le=v(L.internalFormat,qe,Pt,L.colorSpace,L.isVideoTexture);re(Ve,L);let Ae;const De=L.mipmaps,se=L.isVideoTexture!==!0,ye=Rt.__version===void 0||Ke===!0,it=Ze.dataReady,ct=x(L,Ue);if(L.isDepthTexture)le=w(L.format===dC,L.type),ye&&(se?n.texStorage2D(t.TEXTURE_2D,1,le,Ue.width,Ue.height):n.texImage2D(t.TEXTURE_2D,0,le,Ue.width,Ue.height,0,qe,Pt,null));else if(L.isDataTexture)if(De.length>0){se&&ye&&n.texStorage2D(t.TEXTURE_2D,ct,le,De[0].width,De[0].height);for(let rt=0,ze=De.length;rt<ze;rt++)Ae=De[rt],se?it&&n.texSubImage2D(t.TEXTURE_2D,rt,0,0,Ae.width,Ae.height,qe,Pt,Ae.data):n.texImage2D(t.TEXTURE_2D,rt,le,Ae.width,Ae.height,0,qe,Pt,Ae.data);L.generateMipmaps=!1}else se?(ye&&n.texStorage2D(t.TEXTURE_2D,ct,le,Ue.width,Ue.height),it&&Pe(L,Ue,qe,Pt)):n.texImage2D(t.TEXTURE_2D,0,le,Ue.width,Ue.height,0,qe,Pt,Ue.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){se&&ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,ct,le,De[0].width,De[0].height,Ue.depth);for(let rt=0,ze=De.length;rt<ze;rt++)if(Ae=De[rt],L.format!==Ki)if(qe!==null)if(se){if(it)if(L.layerUpdates.size>0){const yt=Y3(Ae.width,Ae.height,L.format,L.type);for(const Kt of L.layerUpdates){const Rn=Ae.data.subarray(Kt*yt/Ae.data.BYTES_PER_ELEMENT,(Kt+1)*yt/Ae.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,rt,0,0,Kt,Ae.width,Ae.height,1,qe,Rn)}L.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,rt,0,0,0,Ae.width,Ae.height,Ue.depth,qe,Ae.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,rt,le,Ae.width,Ae.height,Ue.depth,0,Ae.data,0,0);else vt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else se?it&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,rt,0,0,0,Ae.width,Ae.height,Ue.depth,qe,Pt,Ae.data):n.texImage3D(t.TEXTURE_2D_ARRAY,rt,le,Ae.width,Ae.height,Ue.depth,0,qe,Pt,Ae.data)}else{se&&ye&&n.texStorage2D(t.TEXTURE_2D,ct,le,De[0].width,De[0].height);for(let rt=0,ze=De.length;rt<ze;rt++)Ae=De[rt],L.format!==Ki?qe!==null?se?it&&n.compressedTexSubImage2D(t.TEXTURE_2D,rt,0,0,Ae.width,Ae.height,qe,Ae.data):n.compressedTexImage2D(t.TEXTURE_2D,rt,le,Ae.width,Ae.height,0,Ae.data):vt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):se?it&&n.texSubImage2D(t.TEXTURE_2D,rt,0,0,Ae.width,Ae.height,qe,Pt,Ae.data):n.texImage2D(t.TEXTURE_2D,rt,le,Ae.width,Ae.height,0,qe,Pt,Ae.data)}else if(L.isDataArrayTexture)if(se){if(ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,ct,le,Ue.width,Ue.height,Ue.depth),it)if(L.layerUpdates.size>0){const rt=Y3(Ue.width,Ue.height,L.format,L.type);for(const ze of L.layerUpdates){const yt=Ue.data.subarray(ze*rt/Ue.data.BYTES_PER_ELEMENT,(ze+1)*rt/Ue.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,ze,Ue.width,Ue.height,1,qe,Pt,yt)}L.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Ue.width,Ue.height,Ue.depth,qe,Pt,Ue.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,le,Ue.width,Ue.height,Ue.depth,0,qe,Pt,Ue.data);else if(L.isData3DTexture)se?(ye&&n.texStorage3D(t.TEXTURE_3D,ct,le,Ue.width,Ue.height,Ue.depth),it&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Ue.width,Ue.height,Ue.depth,qe,Pt,Ue.data)):n.texImage3D(t.TEXTURE_3D,0,le,Ue.width,Ue.height,Ue.depth,0,qe,Pt,Ue.data);else if(L.isFramebufferTexture){if(ye)if(se)n.texStorage2D(t.TEXTURE_2D,ct,le,Ue.width,Ue.height);else{let rt=Ue.width,ze=Ue.height;for(let yt=0;yt<ct;yt++)n.texImage2D(t.TEXTURE_2D,yt,le,rt,ze,0,qe,Pt,null),rt>>=1,ze>>=1}}else if(De.length>0){if(se&&ye){const rt=ft(De[0]);n.texStorage2D(t.TEXTURE_2D,ct,le,rt.width,rt.height)}for(let rt=0,ze=De.length;rt<ze;rt++)Ae=De[rt],se?it&&n.texSubImage2D(t.TEXTURE_2D,rt,0,0,qe,Pt,Ae):n.texImage2D(t.TEXTURE_2D,rt,le,qe,Pt,Ae);L.generateMipmaps=!1}else if(se){if(ye){const rt=ft(Ue);n.texStorage2D(t.TEXTURE_2D,ct,le,rt.width,rt.height)}it&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,qe,Pt,Ue)}else n.texImage2D(t.TEXTURE_2D,0,le,qe,Pt,Ue);A(L)&&m(Ve),Rt.__version=Ze.version,L.onUpdate&&L.onUpdate(L)}Q.__version=L.version}function he(Q,L,Ce){if(L.image.length!==6)return;const Ve=de(Q,L),Ke=L.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Q.__webglTexture,t.TEXTURE0+Ce);const Ze=i.get(Ke);if(Ke.version!==Ze.__version||Ve===!0){n.activeTexture(t.TEXTURE0+Ce);const Rt=Fn.getPrimaries(Fn.workingColorSpace),pt=L.colorSpace===Gl?null:Fn.getPrimaries(L.colorSpace),kt=L.colorSpace===Gl||Rt===pt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,kt);const Nt=L.isCompressedTexture||L.image[0].isCompressedTexture,Ue=L.image[0]&&L.image[0].isDataTexture,qe=[];for(let ze=0;ze<6;ze++)!Nt&&!Ue?qe[ze]=y(L.image[ze],!0,r.maxCubemapSize):qe[ze]=Ue?L.image[ze].image:L.image[ze],qe[ze]=ot(L,qe[ze]);const Pt=qe[0],le=s.convert(L.format,L.colorSpace),Ae=s.convert(L.type),De=v(L.internalFormat,le,Ae,L.colorSpace),se=L.isVideoTexture!==!0,ye=Ze.__version===void 0||Ve===!0,it=Ke.dataReady;let ct=x(L,Pt);re(t.TEXTURE_CUBE_MAP,L);let rt;if(Nt){se&&ye&&n.texStorage2D(t.TEXTURE_CUBE_MAP,ct,De,Pt.width,Pt.height);for(let ze=0;ze<6;ze++){rt=qe[ze].mipmaps;for(let yt=0;yt<rt.length;yt++){const Kt=rt[yt];L.format!==Ki?le!==null?se?it&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt,0,0,Kt.width,Kt.height,le,Kt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt,De,Kt.width,Kt.height,0,Kt.data):vt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):se?it&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt,0,0,Kt.width,Kt.height,le,Ae,Kt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt,De,Kt.width,Kt.height,0,le,Ae,Kt.data)}}}else{if(rt=L.mipmaps,se&&ye){rt.length>0&&ct++;const ze=ft(qe[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,ct,De,ze.width,ze.height)}for(let ze=0;ze<6;ze++)if(Ue){se?it&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,0,0,qe[ze].width,qe[ze].height,le,Ae,qe[ze].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,De,qe[ze].width,qe[ze].height,0,le,Ae,qe[ze].data);for(let yt=0;yt<rt.length;yt++){const Rn=rt[yt].image[ze].image;se?it&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt+1,0,0,Rn.width,Rn.height,le,Ae,Rn.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt+1,De,Rn.width,Rn.height,0,le,Ae,Rn.data)}}else{se?it&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,0,0,le,Ae,qe[ze]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,De,le,Ae,qe[ze]);for(let yt=0;yt<rt.length;yt++){const Kt=rt[yt];se?it&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt+1,0,0,le,Ae,Kt.image[ze]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,yt+1,De,le,Ae,Kt.image[ze])}}}A(L)&&m(t.TEXTURE_CUBE_MAP),Ze.__version=Ke.version,L.onUpdate&&L.onUpdate(L)}Q.__version=L.version}function Me(Q,L,Ce,Ve,Ke,Ze){const Rt=s.convert(Ce.format,Ce.colorSpace),pt=s.convert(Ce.type),kt=v(Ce.internalFormat,Rt,pt,Ce.colorSpace),Nt=i.get(L),Ue=i.get(Ce);if(Ue.__renderTarget=L,!Nt.__hasExternalTextures){const qe=Math.max(1,L.width>>Ze),Pt=Math.max(1,L.height>>Ze);Ke===t.TEXTURE_3D||Ke===t.TEXTURE_2D_ARRAY?n.texImage3D(Ke,Ze,kt,qe,Pt,L.depth,0,Rt,pt,null):n.texImage2D(Ke,Ze,kt,qe,Pt,0,Rt,pt,null)}n.bindFramebuffer(t.FRAMEBUFFER,Q),Le(L)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Ve,Ke,Ue.__webglTexture,0,Qe(L)):(Ke===t.TEXTURE_2D||Ke>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ke<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Ve,Ke,Ue.__webglTexture,Ze),n.bindFramebuffer(t.FRAMEBUFFER,null)}function be(Q,L,Ce){if(t.bindRenderbuffer(t.RENDERBUFFER,Q),L.depthBuffer){const Ve=L.depthTexture,Ke=Ve&&Ve.isDepthTexture?Ve.type:null,Ze=w(L.stencilBuffer,Ke),Rt=L.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,pt=Qe(L);Le(L)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,pt,Ze,L.width,L.height):Ce?t.renderbufferStorageMultisample(t.RENDERBUFFER,pt,Ze,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,Ze,L.width,L.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,Rt,t.RENDERBUFFER,Q)}else{const Ve=L.textures;for(let Ke=0;Ke<Ve.length;Ke++){const Ze=Ve[Ke],Rt=s.convert(Ze.format,Ze.colorSpace),pt=s.convert(Ze.type),kt=v(Ze.internalFormat,Rt,pt,Ze.colorSpace),Nt=Qe(L);Ce&&Le(L)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Nt,kt,L.width,L.height):Le(L)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Nt,kt,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,kt,L.width,L.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function xe(Q,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Q),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Ve=i.get(L.depthTexture);Ve.__renderTarget=L,(!Ve.__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),z(L.depthTexture,0);const Ke=Ve.__webglTexture,Ze=Qe(L);if(L.depthTexture.format===uC)Le(L)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ke,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ke,0);else if(L.depthTexture.format===dC)Le(L)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ke,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ke,0);else throw new Error("Unknown depthTexture format")}function Ge(Q){const L=i.get(Q),Ce=Q.isWebGLCubeRenderTarget===!0;if(L.__boundDepthTexture!==Q.depthTexture){const Ve=Q.depthTexture;if(L.__depthDisposeCallback&&L.__depthDisposeCallback(),Ve){const Ke=()=>{delete L.__boundDepthTexture,delete L.__depthDisposeCallback,Ve.removeEventListener("dispose",Ke)};Ve.addEventListener("dispose",Ke),L.__depthDisposeCallback=Ke}L.__boundDepthTexture=Ve}if(Q.depthTexture&&!L.__autoAllocateDepthBuffer){if(Ce)throw new Error("target.depthTexture not supported in Cube render targets");const Ve=Q.texture.mipmaps;Ve&&Ve.length>0?xe(L.__webglFramebuffer[0],Q):xe(L.__webglFramebuffer,Q)}else if(Ce){L.__webglDepthbuffer=[];for(let Ve=0;Ve<6;Ve++)if(n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer[Ve]),L.__webglDepthbuffer[Ve]===void 0)L.__webglDepthbuffer[Ve]=t.createRenderbuffer(),be(L.__webglDepthbuffer[Ve],Q,!1);else{const Ke=Q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ze=L.__webglDepthbuffer[Ve];t.bindRenderbuffer(t.RENDERBUFFER,Ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ke,t.RENDERBUFFER,Ze)}}else{const Ve=Q.texture.mipmaps;if(Ve&&Ve.length>0?n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer),L.__webglDepthbuffer===void 0)L.__webglDepthbuffer=t.createRenderbuffer(),be(L.__webglDepthbuffer,Q,!1);else{const Ke=Q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ze=L.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ke,t.RENDERBUFFER,Ze)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function pe(Q,L,Ce){const Ve=i.get(Q);L!==void 0&&Me(Ve.__webglFramebuffer,Q,Q.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Ce!==void 0&&Ge(Q)}function Oe(Q){const L=Q.texture,Ce=i.get(Q),Ve=i.get(L);Q.addEventListener("dispose",Z);const Ke=Q.textures,Ze=Q.isWebGLCubeRenderTarget===!0,Rt=Ke.length>1;if(Rt||(Ve.__webglTexture===void 0&&(Ve.__webglTexture=t.createTexture()),Ve.__version=L.version,o.memory.textures++),Ze){Ce.__webglFramebuffer=[];for(let pt=0;pt<6;pt++)if(L.mipmaps&&L.mipmaps.length>0){Ce.__webglFramebuffer[pt]=[];for(let kt=0;kt<L.mipmaps.length;kt++)Ce.__webglFramebuffer[pt][kt]=t.createFramebuffer()}else Ce.__webglFramebuffer[pt]=t.createFramebuffer()}else{if(L.mipmaps&&L.mipmaps.length>0){Ce.__webglFramebuffer=[];for(let pt=0;pt<L.mipmaps.length;pt++)Ce.__webglFramebuffer[pt]=t.createFramebuffer()}else Ce.__webglFramebuffer=t.createFramebuffer();if(Rt)for(let pt=0,kt=Ke.length;pt<kt;pt++){const Nt=i.get(Ke[pt]);Nt.__webglTexture===void 0&&(Nt.__webglTexture=t.createTexture(),o.memory.textures++)}if(Q.samples>0&&Le(Q)===!1){Ce.__webglMultisampledFramebuffer=t.createFramebuffer(),Ce.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Ce.__webglMultisampledFramebuffer);for(let pt=0;pt<Ke.length;pt++){const kt=Ke[pt];Ce.__webglColorRenderbuffer[pt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Ce.__webglColorRenderbuffer[pt]);const Nt=s.convert(kt.format,kt.colorSpace),Ue=s.convert(kt.type),qe=v(kt.internalFormat,Nt,Ue,kt.colorSpace,Q.isXRRenderTarget===!0),Pt=Qe(Q);t.renderbufferStorageMultisample(t.RENDERBUFFER,Pt,qe,Q.width,Q.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+pt,t.RENDERBUFFER,Ce.__webglColorRenderbuffer[pt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Q.depthBuffer&&(Ce.__webglDepthRenderbuffer=t.createRenderbuffer(),be(Ce.__webglDepthRenderbuffer,Q,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ze){n.bindTexture(t.TEXTURE_CUBE_MAP,Ve.__webglTexture),re(t.TEXTURE_CUBE_MAP,L);for(let pt=0;pt<6;pt++)if(L.mipmaps&&L.mipmaps.length>0)for(let kt=0;kt<L.mipmaps.length;kt++)Me(Ce.__webglFramebuffer[pt][kt],Q,L,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+pt,kt);else Me(Ce.__webglFramebuffer[pt],Q,L,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+pt,0);A(L)&&m(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Rt){for(let pt=0,kt=Ke.length;pt<kt;pt++){const Nt=Ke[pt],Ue=i.get(Nt);let qe=t.TEXTURE_2D;(Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(qe=Q.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(qe,Ue.__webglTexture),re(qe,Nt),Me(Ce.__webglFramebuffer,Q,Nt,t.COLOR_ATTACHMENT0+pt,qe,0),A(Nt)&&m(qe)}n.unbindTexture()}else{let pt=t.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(pt=Q.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(pt,Ve.__webglTexture),re(pt,L),L.mipmaps&&L.mipmaps.length>0)for(let kt=0;kt<L.mipmaps.length;kt++)Me(Ce.__webglFramebuffer[kt],Q,L,t.COLOR_ATTACHMENT0,pt,kt);else Me(Ce.__webglFramebuffer,Q,L,t.COLOR_ATTACHMENT0,pt,0);A(L)&&m(pt),n.unbindTexture()}Q.depthBuffer&&Ge(Q)}function ve(Q){const L=Q.textures;for(let Ce=0,Ve=L.length;Ce<Ve;Ce++){const Ke=L[Ce];if(A(Ke)){const Ze=b(Q),Rt=i.get(Ke).__webglTexture;n.bindTexture(Ze,Rt),m(Ze),n.unbindTexture()}}}const U=[],We=[];function Xe(Q){if(Q.samples>0){if(Le(Q)===!1){const L=Q.textures,Ce=Q.width,Ve=Q.height;let Ke=t.COLOR_BUFFER_BIT;const Ze=Q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Rt=i.get(Q),pt=L.length>1;if(pt)for(let Nt=0;Nt<L.length;Nt++)n.bindFramebuffer(t.FRAMEBUFFER,Rt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Rt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Rt.__webglMultisampledFramebuffer);const kt=Q.texture.mipmaps;kt&&kt.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Rt.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Rt.__webglFramebuffer);for(let Nt=0;Nt<L.length;Nt++){if(Q.resolveDepthBuffer&&(Q.depthBuffer&&(Ke|=t.DEPTH_BUFFER_BIT),Q.stencilBuffer&&Q.resolveStencilBuffer&&(Ke|=t.STENCIL_BUFFER_BIT)),pt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Rt.__webglColorRenderbuffer[Nt]);const Ue=i.get(L[Nt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Ue,0)}t.blitFramebuffer(0,0,Ce,Ve,0,0,Ce,Ve,Ke,t.NEAREST),l===!0&&(U.length=0,We.length=0,U.push(t.COLOR_ATTACHMENT0+Nt),Q.depthBuffer&&Q.resolveDepthBuffer===!1&&(U.push(Ze),We.push(Ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,We)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,U))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),pt)for(let Nt=0;Nt<L.length;Nt++){n.bindFramebuffer(t.FRAMEBUFFER,Rt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.RENDERBUFFER,Rt.__webglColorRenderbuffer[Nt]);const Ue=i.get(L[Nt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Rt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.TEXTURE_2D,Ue,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Rt.__webglMultisampledFramebuffer)}else if(Q.depthBuffer&&Q.resolveDepthBuffer===!1&&l){const L=Q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[L])}}}function Qe(Q){return Math.min(r.maxSamples,Q.samples)}function Le(Q){const L=i.get(Q);return Q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function mt(Q){const L=o.render.frame;u.get(Q)!==L&&(u.set(Q,L),Q.update())}function ot(Q,L){const Ce=Q.colorSpace,Ve=Q.format,Ke=Q.type;return Q.isCompressedTexture===!0||Q.isVideoTexture===!0||Ce!==Kl&&Ce!==Gl&&(Fn.getTransfer(Ce)===Qn?(Ve!==Ki||Ke!==Ss)&&vt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):on("WebGLTextures: Unsupported texture color space:",Ce)),L}function ft(Q){return typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement?(c.width=Q.naturalWidth||Q.width,c.height=Q.naturalHeight||Q.height):typeof VideoFrame<"u"&&Q instanceof VideoFrame?(c.width=Q.displayWidth,c.height=Q.displayHeight):(c.width=Q.width,c.height=Q.height),c}this.allocateTextureUnit=H,this.resetTextureUnits=T,this.setTexture2D=z,this.setTexture2DArray=j,this.setTexture3D=O,this.setTextureCube=_,this.rebindTextures=pe,this.setupRenderTarget=Oe,this.updateRenderTargetMipmap=ve,this.updateMultisampleRenderTarget=Xe,this.setupDepthRenderbuffer=Ge,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=Le}function lte(t,e){function n(i,r=Gl){let s;const o=Fn.getTransfer(r);if(i===Ss)return t.UNSIGNED_BYTE;if(i===QB)return t.UNSIGNED_SHORT_4_4_4_4;if(i===qB)return t.UNSIGNED_SHORT_5_5_5_1;if(i===$F)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===e_)return t.UNSIGNED_INT_10F_11F_11F_REV;if(i===UB)return t.BYTE;if(i===JB)return t.SHORT;if(i===cC)return t.UNSIGNED_SHORT;if(i===ey)return t.INT;if(i===Hl)return t.UNSIGNED_INT;if(i===Fi)return t.FLOAT;if(i===hr)return t.HALF_FLOAT;if(i===t_)return t.ALPHA;if(i===n_)return t.RGB;if(i===Ki)return t.RGBA;if(i===uC)return t.DEPTH_COMPONENT;if(i===dC)return t.DEPTH_STENCIL;if(i===ty)return t.RED;if(i===ny)return t.RED_INTEGER;if(i===$B)return t.RG;if(i===eS)return t.RG_INTEGER;if(i===tS)return t.RGBA_INTEGER;if(i===Lm||i===zm||i===jm||i===Pm)if(o===Qn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===Lm)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===zm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===jm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Pm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===Lm)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===zm)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===jm)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Pm)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===RG||i===NG||i===WG||i===MG)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===RG)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===NG)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===WG)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===MG)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===VG||i===FG||i===_G)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===VG||i===FG)return o===Qn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===_G)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===TG||i===XG||i===EG||i===YG||i===kG||i===HG||i===KG||i===LG||i===zG||i===jG||i===PG||i===OG||i===DG||i===UG)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===TG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===XG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===EG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===YG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===kG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===HG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===KG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===LG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===zG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===jG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===PG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===OG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===DG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===UG)return o===Qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===JG||i===QG||i===qG)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===JG)return o===Qn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===QG)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===qG)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===$G||i===e2||i===t2||i===n2)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===$G)return s.COMPRESSED_RED_RGTC1_EXT;if(i===e2)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===t2)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===n2)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===gC?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}const zPe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,jPe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class PPe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n){if(this.texture===null){const i=new p_(e.texture);(e.depthNear!==n.depthNear||e.depthFar!==n.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new as({vertexShader:zPe,fragmentShader:jPe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Li(new Bu(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class OPe extends Ol{constructor(e,n){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,I=null,p=null;const y=typeof XRWebGLBinding<"u",A=new PPe,m={},b=n.getContextAttributes();let v=null,w=null;const x=[],B=[],Z=new He;let N=null;const W=new Wi;W.viewport=new _n;const M=new Wi;M.viewport=new _n;const F=[W,M],T=new qee;let H=null,K=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ae){let he=x[ae];return he===void 0&&(he=new xx,x[ae]=he),he.getTargetRaySpace()},this.getControllerGrip=function(ae){let he=x[ae];return he===void 0&&(he=new xx,x[ae]=he),he.getGripSpace()},this.getHand=function(ae){let he=x[ae];return he===void 0&&(he=new xx,x[ae]=he),he.getHandSpace()};function z(ae){const he=B.indexOf(ae.inputSource);if(he===-1)return;const Me=x[he];Me!==void 0&&(Me.update(ae.inputSource,ae.frame,c||o),Me.dispatchEvent({type:ae.type,data:ae.inputSource}))}function j(){r.removeEventListener("select",z),r.removeEventListener("selectstart",z),r.removeEventListener("selectend",z),r.removeEventListener("squeeze",z),r.removeEventListener("squeezestart",z),r.removeEventListener("squeezeend",z),r.removeEventListener("end",j),r.removeEventListener("inputsourceschange",O);for(let ae=0;ae<x.length;ae++){const he=B[ae];he!==null&&(B[ae]=null,x[ae].disconnect(he))}H=null,K=null,A.reset();for(const ae in m)delete m[ae];e.setRenderTarget(v),I=null,h=null,d=null,r=null,w=null,Pe.stop(),i.isPresenting=!1,e.setPixelRatio(N),e.setSize(Z.width,Z.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ae){s=ae,i.isPresenting===!0&&vt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ae){a=ae,i.isPresenting===!0&&vt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(ae){c=ae},this.getBaseLayer=function(){return h!==null?h:I},this.getBinding=function(){return d===null&&y&&(d=new XRWebGLBinding(r,n)),d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(ae){if(r=ae,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",z),r.addEventListener("selectstart",z),r.addEventListener("selectend",z),r.addEventListener("squeeze",z),r.addEventListener("squeezestart",z),r.addEventListener("squeezeend",z),r.addEventListener("end",j),r.addEventListener("inputsourceschange",O),b.xrCompatible!==!0&&await n.makeXRCompatible(),N=e.getPixelRatio(),e.getSize(Z),y&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,be=null,xe=null;b.depth&&(xe=b.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Me=b.stencil?dC:uC,be=b.stencil?gC:Hl);const Ge={colorFormat:n.RGBA8,depthFormat:xe,scaleFactor:s};d=this.getBinding(),h=d.createProjectionLayer(Ge),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),w=new ga(h.textureWidth,h.textureHeight,{format:Ki,type:Ss,depthTexture:new C_(h.textureWidth,h.textureHeight,be,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{const Me={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:s};I=new XRWebGLLayer(r,n,Me),r.updateRenderState({baseLayer:I}),e.setPixelRatio(1),e.setSize(I.framebufferWidth,I.framebufferHeight,!1),w=new ga(I.framebufferWidth,I.framebufferHeight,{format:Ki,type:Ss,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:I.ignoreDepthValues===!1,resolveStencilBuffer:I.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),Pe.setContext(r),Pe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return A.getDepthTexture()};function O(ae){for(let he=0;he<ae.removed.length;he++){const Me=ae.removed[he],be=B.indexOf(Me);be>=0&&(B[be]=null,x[be].disconnect(Me))}for(let he=0;he<ae.added.length;he++){const Me=ae.added[he];let be=B.indexOf(Me);if(be===-1){for(let Ge=0;Ge<x.length;Ge++)if(Ge>=B.length){B.push(Me),be=Ge;break}else if(B[Ge]===null){B[Ge]=Me,be=Ge;break}if(be===-1)break}const xe=x[be];xe&&xe.connect(Me)}}const _=new J,E=new J;function P(ae,he,Me){_.setFromMatrixPosition(he.matrixWorld),E.setFromMatrixPosition(Me.matrixWorld);const be=_.distanceTo(E),xe=he.projectionMatrix.elements,Ge=Me.projectionMatrix.elements,pe=xe[14]/(xe[10]-1),Oe=xe[14]/(xe[10]+1),ve=(xe[9]+1)/xe[5],U=(xe[9]-1)/xe[5],We=(xe[8]-1)/xe[0],Xe=(Ge[8]+1)/Ge[0],Qe=pe*We,Le=pe*Xe,mt=be/(-We+Xe),ot=mt*-We;if(he.matrixWorld.decompose(ae.position,ae.quaternion,ae.scale),ae.translateX(ot),ae.translateZ(mt),ae.matrixWorld.compose(ae.position,ae.quaternion,ae.scale),ae.matrixWorldInverse.copy(ae.matrixWorld).invert(),xe[10]===-1)ae.projectionMatrix.copy(he.projectionMatrix),ae.projectionMatrixInverse.copy(he.projectionMatrixInverse);else{const ft=pe+mt,Q=Oe+mt,L=Qe-ot,Ce=Le+(be-ot),Ve=ve*Oe/Q*ft,Ke=U*Oe/Q*ft;ae.projectionMatrix.makePerspective(L,Ce,Ve,Ke,ft,Q),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert()}}function q(ae,he){he===null?ae.matrixWorld.copy(ae.matrix):ae.matrixWorld.multiplyMatrices(he.matrixWorld,ae.matrix),ae.matrixWorldInverse.copy(ae.matrixWorld).invert()}this.updateCamera=function(ae){if(r===null)return;let he=ae.near,Me=ae.far;A.texture!==null&&(A.depthNear>0&&(he=A.depthNear),A.depthFar>0&&(Me=A.depthFar)),T.near=M.near=W.near=he,T.far=M.far=W.far=Me,(H!==T.near||K!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),H=T.near,K=T.far),T.layers.mask=ae.layers.mask|6,W.layers.mask=T.layers.mask&3,M.layers.mask=T.layers.mask&5;const be=ae.parent,xe=T.cameras;q(T,be);for(let Ge=0;Ge<xe.length;Ge++)q(xe[Ge],be);xe.length===2?P(T,W,M):T.projectionMatrix.copy(W.projectionMatrix),re(ae,T,be)};function re(ae,he,Me){Me===null?ae.matrix.copy(he.matrixWorld):(ae.matrix.copy(Me.matrixWorld),ae.matrix.invert(),ae.matrix.multiply(he.matrixWorld)),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.updateMatrixWorld(!0),ae.projectionMatrix.copy(he.projectionMatrix),ae.projectionMatrixInverse.copy(he.projectionMatrixInverse),ae.isPerspectiveCamera&&(ae.fov=CC*2*Math.atan(1/ae.projectionMatrix.elements[5]),ae.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(h===null&&I===null))return l},this.setFoveation=function(ae){l=ae,h!==null&&(h.fixedFoveation=ae),I!==null&&I.fixedFoveation!==void 0&&(I.fixedFoveation=ae)},this.hasDepthSensing=function(){return A.texture!==null},this.getDepthSensingMesh=function(){return A.getMesh(T)},this.getCameraTexture=function(ae){return m[ae]};let de=null;function Re(ae,he){if(u=he.getViewerPose(c||o),p=he,u!==null){const Me=u.views;I!==null&&(e.setRenderTargetFramebuffer(w,I.framebuffer),e.setRenderTarget(w));let be=!1;Me.length!==T.cameras.length&&(T.cameras.length=0,be=!0);for(let Oe=0;Oe<Me.length;Oe++){const ve=Me[Oe];let U=null;if(I!==null)U=I.getViewport(ve);else{const Xe=d.getViewSubImage(h,ve);U=Xe.viewport,Oe===0&&(e.setRenderTargetTextures(w,Xe.colorTexture,Xe.depthStencilTexture),e.setRenderTarget(w))}let We=F[Oe];We===void 0&&(We=new Wi,We.layers.enable(Oe),We.viewport=new _n,F[Oe]=We),We.matrix.fromArray(ve.transform.matrix),We.matrix.decompose(We.position,We.quaternion,We.scale),We.projectionMatrix.fromArray(ve.projectionMatrix),We.projectionMatrixInverse.copy(We.projectionMatrix).invert(),We.viewport.set(U.x,U.y,U.width,U.height),Oe===0&&(T.matrix.copy(We.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),be===!0&&T.cameras.push(We)}const xe=r.enabledFeatures;if(xe&&xe.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&y){d=i.getBinding();const Oe=d.getDepthInformation(Me[0]);Oe&&Oe.isValid&&Oe.texture&&A.init(Oe,r.renderState)}if(xe&&xe.includes("camera-access")&&y){e.state.unbindTexture(),d=i.getBinding();for(let Oe=0;Oe<Me.length;Oe++){const ve=Me[Oe].camera;if(ve){let U=m[ve];U||(U=new p_,m[ve]=U);const We=d.getCameraImage(ve);U.sourceTexture=We}}}}for(let Me=0;Me<x.length;Me++){const be=B[Me],xe=x[Me];be!==null&&xe!==void 0&&xe.update(be,he,c||o)}de&&de(ae,he),he.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:he}),p=null}const Pe=new ite;Pe.setAnimationLoop(Re),this.setAnimationLoop=function(ae){de=ae},this.dispose=function(){}}}const $u=new no,DPe=new Qt;function UPe(t,e){function n(A,m){A.matrixAutoUpdate===!0&&A.updateMatrix(),m.value.copy(A.matrix)}function i(A,m){m.color.getRGB(A.fogColor.value,see(t)),m.isFog?(A.fogNear.value=m.near,A.fogFar.value=m.far):m.isFogExp2&&(A.fogDensity.value=m.density)}function r(A,m,b,v,w){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(A,m):m.isMeshToonMaterial?(s(A,m),d(A,m)):m.isMeshPhongMaterial?(s(A,m),u(A,m)):m.isMeshStandardMaterial?(s(A,m),h(A,m),m.isMeshPhysicalMaterial&&I(A,m,w)):m.isMeshMatcapMaterial?(s(A,m),p(A,m)):m.isMeshDepthMaterial?s(A,m):m.isMeshDistanceMaterial?(s(A,m),y(A,m)):m.isMeshNormalMaterial?s(A,m):m.isLineBasicMaterial?(o(A,m),m.isLineDashedMaterial&&a(A,m)):m.isPointsMaterial?l(A,m,b,v):m.isSpriteMaterial?c(A,m):m.isShadowMaterial?(A.color.value.copy(m.color),A.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(A,m){A.opacity.value=m.opacity,m.color&&A.diffuse.value.copy(m.color),m.emissive&&A.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(A.map.value=m.map,n(m.map,A.mapTransform)),m.alphaMap&&(A.alphaMap.value=m.alphaMap,n(m.alphaMap,A.alphaMapTransform)),m.bumpMap&&(A.bumpMap.value=m.bumpMap,n(m.bumpMap,A.bumpMapTransform),A.bumpScale.value=m.bumpScale,m.side===Bs&&(A.bumpScale.value*=-1)),m.normalMap&&(A.normalMap.value=m.normalMap,n(m.normalMap,A.normalMapTransform),A.normalScale.value.copy(m.normalScale),m.side===Bs&&A.normalScale.value.negate()),m.displacementMap&&(A.displacementMap.value=m.displacementMap,n(m.displacementMap,A.displacementMapTransform),A.displacementScale.value=m.displacementScale,A.displacementBias.value=m.displacementBias),m.emissiveMap&&(A.emissiveMap.value=m.emissiveMap,n(m.emissiveMap,A.emissiveMapTransform)),m.specularMap&&(A.specularMap.value=m.specularMap,n(m.specularMap,A.specularMapTransform)),m.alphaTest>0&&(A.alphaTest.value=m.alphaTest);const b=e.get(m),v=b.envMap,w=b.envMapRotation;v&&(A.envMap.value=v,$u.copy(w),$u.x*=-1,$u.y*=-1,$u.z*=-1,v.isCubeTexture&&v.isRenderTargetTexture===!1&&($u.y*=-1,$u.z*=-1),A.envMapRotation.value.setFromMatrix4(DPe.makeRotationFromEuler($u)),A.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,A.reflectivity.value=m.reflectivity,A.ior.value=m.ior,A.refractionRatio.value=m.refractionRatio),m.lightMap&&(A.lightMap.value=m.lightMap,A.lightMapIntensity.value=m.lightMapIntensity,n(m.lightMap,A.lightMapTransform)),m.aoMap&&(A.aoMap.value=m.aoMap,A.aoMapIntensity.value=m.aoMapIntensity,n(m.aoMap,A.aoMapTransform))}function o(A,m){A.diffuse.value.copy(m.color),A.opacity.value=m.opacity,m.map&&(A.map.value=m.map,n(m.map,A.mapTransform))}function a(A,m){A.dashSize.value=m.dashSize,A.totalSize.value=m.dashSize+m.gapSize,A.scale.value=m.scale}function l(A,m,b,v){A.diffuse.value.copy(m.color),A.opacity.value=m.opacity,A.size.value=m.size*b,A.scale.value=v*.5,m.map&&(A.map.value=m.map,n(m.map,A.uvTransform)),m.alphaMap&&(A.alphaMap.value=m.alphaMap,n(m.alphaMap,A.alphaMapTransform)),m.alphaTest>0&&(A.alphaTest.value=m.alphaTest)}function c(A,m){A.diffuse.value.copy(m.color),A.opacity.value=m.opacity,A.rotation.value=m.rotation,m.map&&(A.map.value=m.map,n(m.map,A.mapTransform)),m.alphaMap&&(A.alphaMap.value=m.alphaMap,n(m.alphaMap,A.alphaMapTransform)),m.alphaTest>0&&(A.alphaTest.value=m.alphaTest)}function u(A,m){A.specular.value.copy(m.specular),A.shininess.value=Math.max(m.shininess,1e-4)}function d(A,m){m.gradientMap&&(A.gradientMap.value=m.gradientMap)}function h(A,m){A.metalness.value=m.metalness,m.metalnessMap&&(A.metalnessMap.value=m.metalnessMap,n(m.metalnessMap,A.metalnessMapTransform)),A.roughness.value=m.roughness,m.roughnessMap&&(A.roughnessMap.value=m.roughnessMap,n(m.roughnessMap,A.roughnessMapTransform)),m.envMap&&(A.envMapIntensity.value=m.envMapIntensity)}function I(A,m,b){A.ior.value=m.ior,m.sheen>0&&(A.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),A.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(A.sheenColorMap.value=m.sheenColorMap,n(m.sheenColorMap,A.sheenColorMapTransform)),m.sheenRoughnessMap&&(A.sheenRoughnessMap.value=m.sheenRoughnessMap,n(m.sheenRoughnessMap,A.sheenRoughnessMapTransform))),m.clearcoat>0&&(A.clearcoat.value=m.clearcoat,A.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(A.clearcoatMap.value=m.clearcoatMap,n(m.clearcoatMap,A.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,n(m.clearcoatRoughnessMap,A.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(A.clearcoatNormalMap.value=m.clearcoatNormalMap,n(m.clearcoatNormalMap,A.clearcoatNormalMapTransform),A.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Bs&&A.clearcoatNormalScale.value.negate())),m.dispersion>0&&(A.dispersion.value=m.dispersion),m.iridescence>0&&(A.iridescence.value=m.iridescence,A.iridescenceIOR.value=m.iridescenceIOR,A.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],A.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(A.iridescenceMap.value=m.iridescenceMap,n(m.iridescenceMap,A.iridescenceMapTransform)),m.iridescenceThicknessMap&&(A.iridescenceThicknessMap.value=m.iridescenceThicknessMap,n(m.iridescenceThicknessMap,A.iridescenceThicknessMapTransform))),m.transmission>0&&(A.transmission.value=m.transmission,A.transmissionSamplerMap.value=b.texture,A.transmissionSamplerSize.value.set(b.width,b.height),m.transmissionMap&&(A.transmissionMap.value=m.transmissionMap,n(m.transmissionMap,A.transmissionMapTransform)),A.thickness.value=m.thickness,m.thicknessMap&&(A.thicknessMap.value=m.thicknessMap,n(m.thicknessMap,A.thicknessMapTransform)),A.attenuationDistance.value=m.attenuationDistance,A.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(A.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(A.anisotropyMap.value=m.anisotropyMap,n(m.anisotropyMap,A.anisotropyMapTransform))),A.specularIntensity.value=m.specularIntensity,A.specularColor.value.copy(m.specularColor),m.specularColorMap&&(A.specularColorMap.value=m.specularColorMap,n(m.specularColorMap,A.specularColorMapTransform)),m.specularIntensityMap&&(A.specularIntensityMap.value=m.specularIntensityMap,n(m.specularIntensityMap,A.specularIntensityMapTransform))}function p(A,m){m.matcap&&(A.matcap.value=m.matcap)}function y(A,m){const b=e.get(m).light;A.referencePosition.value.setFromMatrixPosition(b.matrixWorld),A.nearDistance.value=b.shadow.camera.near,A.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function JPe(t,e,n,i){let r={},s={},o=[];const a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(b,v){const w=v.program;i.uniformBlockBinding(b,w)}function c(b,v){let w=r[b.id];w===void 0&&(p(b),w=u(b),r[b.id]=w,b.addEventListener("dispose",A));const x=v.program;i.updateUBOMapping(b,x);const B=e.render.frame;s[b.id]!==B&&(h(b),s[b.id]=B)}function u(b){const v=d();b.__bindingPointIndex=v;const w=t.createBuffer(),x=b.__size,B=b.usage;return t.bindBuffer(t.UNIFORM_BUFFER,w),t.bufferData(t.UNIFORM_BUFFER,x,B),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,v,w),w}function d(){for(let b=0;b<a;b++)if(o.indexOf(b)===-1)return o.push(b),b;return on("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(b){const v=r[b.id],w=b.uniforms,x=b.__cache;t.bindBuffer(t.UNIFORM_BUFFER,v);for(let B=0,Z=w.length;B<Z;B++){const N=Array.isArray(w[B])?w[B]:[w[B]];for(let W=0,M=N.length;W<M;W++){const F=N[W];if(I(F,B,W,x)===!0){const T=F.__offset,H=Array.isArray(F.value)?F.value:[F.value];let K=0;for(let z=0;z<H.length;z++){const j=H[z],O=y(j);typeof j=="number"||typeof j=="boolean"?(F.__data[0]=j,t.bufferSubData(t.UNIFORM_BUFFER,T+K,F.__data)):j.isMatrix3?(F.__data[0]=j.elements[0],F.__data[1]=j.elements[1],F.__data[2]=j.elements[2],F.__data[3]=0,F.__data[4]=j.elements[3],F.__data[5]=j.elements[4],F.__data[6]=j.elements[5],F.__data[7]=0,F.__data[8]=j.elements[6],F.__data[9]=j.elements[7],F.__data[10]=j.elements[8],F.__data[11]=0):(j.toArray(F.__data,K),K+=O.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,T,F.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function I(b,v,w,x){const B=b.value,Z=v+"_"+w;if(x[Z]===void 0)return typeof B=="number"||typeof B=="boolean"?x[Z]=B:x[Z]=B.clone(),!0;{const N=x[Z];if(typeof B=="number"||typeof B=="boolean"){if(N!==B)return x[Z]=B,!0}else if(N.equals(B)===!1)return N.copy(B),!0}return!1}function p(b){const v=b.uniforms;let w=0;const x=16;for(let Z=0,N=v.length;Z<N;Z++){const W=Array.isArray(v[Z])?v[Z]:[v[Z]];for(let M=0,F=W.length;M<F;M++){const T=W[M],H=Array.isArray(T.value)?T.value:[T.value];for(let K=0,z=H.length;K<z;K++){const j=H[K],O=y(j),_=w%x,E=_%O.boundary,P=_+E;w+=E,P!==0&&x-P<O.storage&&(w+=x-P),T.__data=new Float32Array(O.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=w,w+=O.storage}}}const B=w%x;return B>0&&(w+=x-B),b.__size=w,b.__cache={},this}function y(b){const v={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(v.boundary=4,v.storage=4):b.isVector2?(v.boundary=8,v.storage=8):b.isVector3||b.isColor?(v.boundary=16,v.storage=12):b.isVector4?(v.boundary=16,v.storage=16):b.isMatrix3?(v.boundary=48,v.storage=48):b.isMatrix4?(v.boundary=64,v.storage=64):b.isTexture?vt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):vt("WebGLRenderer: Unsupported uniform value type.",b),v}function A(b){const v=b.target;v.removeEventListener("dispose",A);const w=o.indexOf(v.__bindingPointIndex);o.splice(w,1),t.deleteBuffer(r[v.id]),delete r[v.id],delete s[v.id]}function m(){for(const b in r)t.deleteBuffer(r[b]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}const QPe=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let uc=null;function qPe(){return uc===null&&(uc=new sa(QPe,32,32,$B,hr),uc.minFilter=Ln,uc.magFilter=Ln,uc.wrapS=Vi,uc.wrapT=Vi,uc.generateMipmaps=!1,uc.needsUpdate=!0),uc}class Y_{constructor(e={}){const{canvas:n=iee(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let I;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");I=i.getContextAttributes().alpha}else I=o;const p=new Set([tS,eS,ny]),y=new Set([Ss,Hl,cC,gC,QB,qB]),A=new Uint32Array(4),m=new Int32Array(4);let b=null,v=null;const w=[],x=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Tl,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const B=this;let Z=!1;this._outputColorSpace=ts;let N=0,W=0,M=null,F=-1,T=null;const H=new _n,K=new _n;let z=null;const j=new wt(0);let O=0,_=n.width,E=n.height,P=1,q=null,re=null;const de=new _n(0,0,_,E),Re=new _n(0,0,_,E);let Pe=!1;const ae=new qC;let he=!1,Me=!1;const be=new Qt,xe=new J,Ge=new _n,pe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Oe=!1;function ve(){return M===null?P:1}let U=i;function We(k,ie){return n.getContext(k,ie)}try{const k={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${mh}`),n.addEventListener("webglcontextlost",rt,!1),n.addEventListener("webglcontextrestored",ze,!1),n.addEventListener("webglcontextcreationerror",yt,!1),U===null){const ie="webgl2";if(U=We(ie,k),U===null)throw We(ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(k){throw k("WebGLRenderer: "+k.message),k}let Xe,Qe,Le,mt,ot,ft,Q,L,Ce,Ve,Ke,Ze,Rt,pt,kt,Nt,Ue,qe,Pt,le,Ae,De,se,ye;function it(){Xe=new lje(U),Xe.init(),De=new lte(U,Xe),Qe=new $ze(U,Xe,e,De),Le=new KPe(U,Xe),Qe.reversedDepthBuffer&&h&&Le.buffers.depth.setReversed(!0),mt=new uje(U),ot=new RPe,ft=new LPe(U,Xe,Le,ot,Qe,De,mt),Q=new tje(B),L=new aje(B),Ce=new fKe(U),se=new Qze(U,Ce),Ve=new cje(U,Ce,mt,se),Ke=new hje(U,Ve,Ce,mt),Pt=new dje(U,Qe,ft),Nt=new eje(ot),Ze=new ZPe(B,Q,L,Xe,Qe,se,Nt),Rt=new UPe(B,ot),pt=new WPe,kt=new XPe(Xe),qe=new Jze(B,Q,L,Le,Ke,I,l),Ue=new kPe(B,Ke,Qe),ye=new JPe(U,mt,Qe,Le),le=new qze(U,Xe,mt),Ae=new gje(U,Xe,mt),mt.programs=Ze.programs,B.capabilities=Qe,B.extensions=Xe,B.properties=ot,B.renderLists=pt,B.shadowMap=Ue,B.state=Le,B.info=mt}it();const ct=new OPe(B,U);this.xr=ct,this.getContext=function(){return U},this.getContextAttributes=function(){return U.getContextAttributes()},this.forceContextLoss=function(){const k=Xe.get("WEBGL_lose_context");k&&k.loseContext()},this.forceContextRestore=function(){const k=Xe.get("WEBGL_lose_context");k&&k.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(k){k!==void 0&&(P=k,this.setSize(_,E,!1))},this.getSize=function(k){return k.set(_,E)},this.setSize=function(k,ie,ce=!0){if(ct.isPresenting){vt("WebGLRenderer: Can't change size while VR device is presenting.");return}_=k,E=ie,n.width=Math.floor(k*P),n.height=Math.floor(ie*P),ce===!0&&(n.style.width=k+"px",n.style.height=ie+"px"),this.setViewport(0,0,k,ie)},this.getDrawingBufferSize=function(k){return k.set(_*P,E*P).floor()},this.setDrawingBufferSize=function(k,ie,ce){_=k,E=ie,P=ce,n.width=Math.floor(k*ce),n.height=Math.floor(ie*ce),this.setViewport(0,0,k,ie)},this.getCurrentViewport=function(k){return k.copy(H)},this.getViewport=function(k){return k.copy(de)},this.setViewport=function(k,ie,ce,me){k.isVector4?de.set(k.x,k.y,k.z,k.w):de.set(k,ie,ce,me),Le.viewport(H.copy(de).multiplyScalar(P).round())},this.getScissor=function(k){return k.copy(Re)},this.setScissor=function(k,ie,ce,me){k.isVector4?Re.set(k.x,k.y,k.z,k.w):Re.set(k,ie,ce,me),Le.scissor(K.copy(Re).multiplyScalar(P).round())},this.getScissorTest=function(){return Pe},this.setScissorTest=function(k){Le.setScissorTest(Pe=k)},this.setOpaqueSort=function(k){q=k},this.setTransparentSort=function(k){re=k},this.getClearColor=function(k){return k.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor(...arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha(...arguments)},this.clear=function(k=!0,ie=!0,ce=!0){let me=0;if(k){let oe=!1;if(M!==null){const Se=M.texture.format;oe=p.has(Se)}if(oe){const Se=M.texture.type,je=y.has(Se),Je=qe.getClearColor(),$e=qe.getClearAlpha(),It=Je.r,at=Je.g,st=Je.b;je?(A[0]=It,A[1]=at,A[2]=st,A[3]=$e,U.clearBufferuiv(U.COLOR,0,A)):(m[0]=It,m[1]=at,m[2]=st,m[3]=$e,U.clearBufferiv(U.COLOR,0,m))}else me|=U.COLOR_BUFFER_BIT}ie&&(me|=U.DEPTH_BUFFER_BIT),ce&&(me|=U.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),U.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",rt,!1),n.removeEventListener("webglcontextrestored",ze,!1),n.removeEventListener("webglcontextcreationerror",yt,!1),qe.dispose(),pt.dispose(),kt.dispose(),ot.dispose(),Q.dispose(),L.dispose(),Ke.dispose(),se.dispose(),ye.dispose(),Ze.dispose(),ct.dispose(),ct.removeEventListener("sessionstart",wh),ct.removeEventListener("sessionend",il),ro.stop()};function rt(k){k.preventDefault(),c0("WebGLRenderer: Context Lost."),Z=!0}function ze(){c0("WebGLRenderer: Context Restored."),Z=!1;const k=mt.autoReset,ie=Ue.enabled,ce=Ue.autoUpdate,me=Ue.needsUpdate,oe=Ue.type;it(),mt.autoReset=k,Ue.enabled=ie,Ue.autoUpdate=ce,Ue.needsUpdate=me,Ue.type=oe}function yt(k){on("WebGLRenderer: A WebGL context could not be created. Reason: ",k.statusMessage)}function Kt(k){const ie=k.target;ie.removeEventListener("dispose",Kt),Rn(ie)}function Rn(k){xn(k),ot.remove(k)}function xn(k){const ie=ot.get(k).programs;ie!==void 0&&(ie.forEach(function(ce){Ze.releaseProgram(ce)}),k.isShaderMaterial&&Ze.releaseShaderCache(k))}this.renderBufferDirect=function(k,ie,ce,me,oe,Se){ie===null&&(ie=pe);const je=oe.isMesh&&oe.matrixWorld.determinant()<0,Je=Be(k,ie,ce,me,oe);Le.setMaterial(me,je);let $e=ce.index,It=1;if(me.wireframe===!0){if($e=Ve.getWireframeAttribute(ce),$e===void 0)return;It=2}const at=ce.drawRange,st=ce.attributes.position;let Gt=at.start*It,Dt=(at.start+at.count)*It;Se!==null&&(Gt=Math.max(Gt,Se.start*It),Dt=Math.min(Dt,(Se.start+Se.count)*It)),$e!==null?(Gt=Math.max(Gt,0),Dt=Math.min(Dt,$e.count)):st!=null&&(Gt=Math.max(Gt,0),Dt=Math.min(Dt,st.count));const Tt=Dt-Gt;if(Tt<0||Tt===1/0)return;se.setup(oe,me,Je,ce,$e);let rn,cn=le;if($e!==null&&(rn=Ce.get($e),cn=Ae,cn.setIndex(rn)),oe.isMesh)me.wireframe===!0?(Le.setLineWidth(me.wireframeLinewidth*ve()),cn.setMode(U.LINES)):cn.setMode(U.TRIANGLES);else if(oe.isLine){let Bt=me.linewidth;Bt===void 0&&(Bt=1),Le.setLineWidth(Bt*ve()),oe.isLineSegments?cn.setMode(U.LINES):oe.isLineLoop?cn.setMode(U.LINE_LOOP):cn.setMode(U.LINE_STRIP)}else oe.isPoints?cn.setMode(U.POINTS):oe.isSprite&&cn.setMode(U.TRIANGLES);if(oe.isBatchedMesh)if(oe._multiDrawInstances!==null)fC("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),cn.renderMultiDrawInstances(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount,oe._multiDrawInstances);else if(Xe.get("WEBGL_multi_draw"))cn.renderMultiDraw(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount);else{const Bt=oe._multiDrawStarts,Cn=oe._multiDrawCounts,Xt=oe._multiDrawCount,Xn=$e?Ce.get($e).bytesPerElement:1,Nn=ot.get(me).currentProgram.getUniforms();for(let an=0;an<Xt;an++)Nn.setValue(U,"_gl_DrawID",an),cn.render(Bt[an]/Xn,Cn[an])}else if(oe.isInstancedMesh)cn.renderInstances(Gt,Tt,oe.count);else if(ce.isInstancedBufferGeometry){const Bt=ce._maxInstanceCount!==void 0?ce._maxInstanceCount:1/0,Cn=Math.min(ce.instanceCount,Bt);cn.renderInstances(Gt,Tt,Cn)}else cn.render(Gt,Tt)};function zi(k,ie,ce){k.transparent===!0&&k.side===rs&&k.forceSinglePass===!1?(k.side=Bs,k.needsUpdate=!0,Y(k,ie,ce),k.side=Lc,k.needsUpdate=!0,Y(k,ie,ce),k.side=rs):Y(k,ie,ce)}this.compile=function(k,ie,ce=null){ce===null&&(ce=k),v=kt.get(ce),v.init(ie),x.push(v),ce.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ie.layers)&&(v.pushLight(oe),oe.castShadow&&v.pushShadow(oe))}),k!==ce&&k.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ie.layers)&&(v.pushLight(oe),oe.castShadow&&v.pushShadow(oe))}),v.setupLights();const me=new Set;return k.traverse(function(oe){if(!(oe.isMesh||oe.isPoints||oe.isLine||oe.isSprite))return;const Se=oe.material;if(Se)if(Array.isArray(Se))for(let je=0;je<Se.length;je++){const Je=Se[je];zi(Je,ce,oe),me.add(Je)}else zi(Se,ce,oe),me.add(Se)}),v=x.pop(),me},this.compileAsync=function(k,ie,ce=null){const me=this.compile(k,ie,ce);return new Promise(oe=>{function Se(){if(me.forEach(function(je){ot.get(je).currentProgram.isReady()&&me.delete(je)}),me.size===0){oe(k);return}setTimeout(Se,10)}Xe.get("KHR_parallel_shader_compile")!==null?Se():setTimeout(Se,10)})};let Di=null;function tp(k){Di&&Di(k)}function wh(){ro.stop()}function il(){ro.start()}const ro=new ite;ro.setAnimationLoop(tp),typeof self<"u"&&ro.setContext(self),this.setAnimationLoop=function(k){Di=k,ct.setAnimationLoop(k),k===null?ro.stop():ro.start()},ct.addEventListener("sessionstart",wh),ct.addEventListener("sessionend",il),this.render=function(k,ie){if(ie!==void 0&&ie.isCamera!==!0){on("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Z===!0)return;if(k.matrixWorldAutoUpdate===!0&&k.updateMatrixWorld(),ie.parent===null&&ie.matrixWorldAutoUpdate===!0&&ie.updateMatrixWorld(),ct.enabled===!0&&ct.isPresenting===!0&&(ct.cameraAutoUpdate===!0&&ct.updateCamera(ie),ie=ct.getCamera()),k.isScene===!0&&k.onBeforeRender(B,k,ie,M),v=kt.get(k,x.length),v.init(ie),x.push(v),be.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),ae.setFromProjectionMatrix(be,yo,ie.reversedDepth),Me=this.localClippingEnabled,he=Nt.init(this.clippingPlanes,Me),b=pt.get(k,w.length),b.init(),w.push(b),ct.enabled===!0&&ct.isPresenting===!0){const Se=B.xr.getDepthSensingMesh();Se!==null&&Ca(Se,ie,-1/0,B.sortObjects)}Ca(k,ie,0,B.sortObjects),b.finish(),B.sortObjects===!0&&b.sort(q,re),Oe=ct.enabled===!1||ct.isPresenting===!1||ct.hasDepthSensing()===!1,Oe&&qe.addToRenderList(b,k),this.info.render.frame++,he===!0&&Nt.beginShadows();const ce=v.state.shadowsArray;Ue.render(ce,k,ie),he===!0&&Nt.endShadows(),this.info.autoReset===!0&&this.info.reset();const me=b.opaque,oe=b.transmissive;if(v.setupLights(),ie.isArrayCamera){const Se=ie.cameras;if(oe.length>0)for(let je=0,Je=Se.length;je<Je;je++){const $e=Se[je];yn(me,oe,k,$e)}Oe&&qe.render(k);for(let je=0,Je=Se.length;je<Je;je++){const $e=Se[je];_s(b,k,$e,$e.viewport)}}else oe.length>0&&yn(me,oe,k,ie),Oe&&qe.render(k),_s(b,k,ie);M!==null&&W===0&&(ft.updateMultisampleRenderTarget(M),ft.updateRenderTargetMipmap(M)),k.isScene===!0&&k.onAfterRender(B,k,ie),se.resetDefaultState(),F=-1,T=null,x.pop(),x.length>0?(v=x[x.length-1],he===!0&&Nt.setGlobalState(B.clippingPlanes,v.state.camera)):v=null,w.pop(),w.length>0?b=w[w.length-1]:b=null};function Ca(k,ie,ce,me){if(k.visible===!1)return;if(k.layers.test(ie.layers)){if(k.isGroup)ce=k.renderOrder;else if(k.isLOD)k.autoUpdate===!0&&k.update(ie);else if(k.isLight)v.pushLight(k),k.castShadow&&v.pushShadow(k);else if(k.isSprite){if(!k.frustumCulled||ae.intersectsSprite(k)){me&&Ge.setFromMatrixPosition(k.matrixWorld).applyMatrix4(be);const je=Ke.update(k),Je=k.material;Je.visible&&b.push(k,je,Je,ce,Ge.z,null)}}else if((k.isMesh||k.isLine||k.isPoints)&&(!k.frustumCulled||ae.intersectsObject(k))){const je=Ke.update(k),Je=k.material;if(me&&(k.boundingSphere!==void 0?(k.boundingSphere===null&&k.computeBoundingSphere(),Ge.copy(k.boundingSphere.center)):(je.boundingSphere===null&&je.computeBoundingSphere(),Ge.copy(je.boundingSphere.center)),Ge.applyMatrix4(k.matrixWorld).applyMatrix4(be)),Array.isArray(Je)){const $e=je.groups;for(let It=0,at=$e.length;It<at;It++){const st=$e[It],Gt=Je[st.materialIndex];Gt&&Gt.visible&&b.push(k,je,Gt,ce,Ge.z,st)}}else Je.visible&&b.push(k,je,Je,ce,Ge.z,null)}}const Se=k.children;for(let je=0,Je=Se.length;je<Je;je++)Ca(Se[je],ie,ce,me)}function _s(k,ie,ce,me){const{opaque:oe,transmissive:Se,transparent:je}=k;v.setupLightsView(ce),he===!0&&Nt.setGlobalState(B.clippingPlanes,ce),me&&Le.viewport(H.copy(me)),oe.length>0&&Ul(oe,ie,ce),Se.length>0&&Ul(Se,ie,ce),je.length>0&&Ul(je,ie,ce),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1)}function yn(k,ie,ce,me){if((ce.isScene===!0?ce.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[me.id]===void 0&&(v.state.transmissionRenderTarget[me.id]=new ga(1,1,{generateMipmaps:!0,type:Xe.has("EXT_color_buffer_half_float")||Xe.has("EXT_color_buffer_float")?hr:Ss,minFilter:ka,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Fn.workingColorSpace}));const Se=v.state.transmissionRenderTarget[me.id],je=me.viewport||H;Se.setSize(je.z*B.transmissionResolutionScale,je.w*B.transmissionResolutionScale);const Je=B.getRenderTarget(),$e=B.getActiveCubeFace(),It=B.getActiveMipmapLevel();B.setRenderTarget(Se),B.getClearColor(j),O=B.getClearAlpha(),O<1&&B.setClearColor(16777215,.5),B.clear(),Oe&&qe.render(ce);const at=B.toneMapping;B.toneMapping=Tl;const st=me.viewport;if(me.viewport!==void 0&&(me.viewport=void 0),v.setupLightsView(me),he===!0&&Nt.setGlobalState(B.clippingPlanes,me),Ul(k,ce,me),ft.updateMultisampleRenderTarget(Se),ft.updateRenderTargetMipmap(Se),Xe.has("WEBGL_multisampled_render_to_texture")===!1){let Gt=!1;for(let Dt=0,Tt=ie.length;Dt<Tt;Dt++){const rn=ie[Dt],{object:cn,geometry:Bt,material:Cn,group:Xt}=rn;if(Cn.side===rs&&cn.layers.test(me.layers)){const Xn=Cn.side;Cn.side=Bs,Cn.needsUpdate=!0,Gh(cn,ce,me,Bt,Cn,Xt),Cn.side=Xn,Cn.needsUpdate=!0,Gt=!0}}Gt===!0&&(ft.updateMultisampleRenderTarget(Se),ft.updateRenderTargetMipmap(Se))}B.setRenderTarget(Je,$e,It),B.setClearColor(j,O),st!==void 0&&(me.viewport=st),B.toneMapping=at}function Ul(k,ie,ce){const me=ie.isScene===!0?ie.overrideMaterial:null;for(let oe=0,Se=k.length;oe<Se;oe++){const je=k[oe],{object:Je,geometry:$e,group:It}=je;let at=je.material;at.allowOverride===!0&&me!==null&&(at=me),Je.layers.test(ce.layers)&&Gh(Je,ie,ce,$e,at,It)}}function Gh(k,ie,ce,me,oe,Se){k.onBeforeRender(B,ie,ce,me,oe,Se),k.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,k.matrixWorld),k.normalMatrix.getNormalMatrix(k.modelViewMatrix),oe.onBeforeRender(B,ie,ce,me,k,Se),oe.transparent===!0&&oe.side===rs&&oe.forceSinglePass===!1?(oe.side=Bs,oe.needsUpdate=!0,B.renderBufferDirect(ce,ie,me,oe,k,Se),oe.side=Lc,oe.needsUpdate=!0,B.renderBufferDirect(ce,ie,me,oe,k,Se),oe.side=rs):B.renderBufferDirect(ce,ie,me,oe,k,Se),k.onAfterRender(B,ie,ce,me,oe,Se)}function Y(k,ie,ce){ie.isScene!==!0&&(ie=pe);const me=ot.get(k),oe=v.state.lights,Se=v.state.shadowsArray,je=oe.state.version,Je=Ze.getParameters(k,oe.state,Se,ie,ce),$e=Ze.getProgramCacheKey(Je);let It=me.programs;me.environment=k.isMeshStandardMaterial?ie.environment:null,me.fog=ie.fog,me.envMap=(k.isMeshStandardMaterial?L:Q).get(k.envMap||me.environment),me.envMapRotation=me.environment!==null&&k.envMap===null?ie.environmentRotation:k.envMapRotation,It===void 0&&(k.addEventListener("dispose",Kt),It=new Map,me.programs=It);let at=It.get($e);if(at!==void 0){if(me.currentProgram===at&&me.lightsStateVersion===je)return ge(k,Je),at}else Je.uniforms=Ze.getUniforms(k),k.onBeforeCompile(Je,B),at=Ze.acquireProgram(Je,$e),It.set($e,at),me.uniforms=Je.uniforms;const st=me.uniforms;return(!k.isShaderMaterial&&!k.isRawShaderMaterial||k.clipping===!0)&&(st.clippingPlanes=Nt.uniform),ge(k,Je),me.needsLights=_e(k),me.lightsStateVersion=je,me.needsLights&&(st.ambientLightColor.value=oe.state.ambient,st.lightProbe.value=oe.state.probe,st.directionalLights.value=oe.state.directional,st.directionalLightShadows.value=oe.state.directionalShadow,st.spotLights.value=oe.state.spot,st.spotLightShadows.value=oe.state.spotShadow,st.rectAreaLights.value=oe.state.rectArea,st.ltc_1.value=oe.state.rectAreaLTC1,st.ltc_2.value=oe.state.rectAreaLTC2,st.pointLights.value=oe.state.point,st.pointLightShadows.value=oe.state.pointShadow,st.hemisphereLights.value=oe.state.hemi,st.directionalShadowMap.value=oe.state.directionalShadowMap,st.directionalShadowMatrix.value=oe.state.directionalShadowMatrix,st.spotShadowMap.value=oe.state.spotShadowMap,st.spotLightMatrix.value=oe.state.spotLightMatrix,st.spotLightMap.value=oe.state.spotLightMap,st.pointShadowMap.value=oe.state.pointShadowMap,st.pointShadowMatrix.value=oe.state.pointShadowMatrix),me.currentProgram=at,me.uniformsList=null,at}function D(k){if(k.uniformsList===null){const ie=k.currentProgram.getUniforms();k.uniformsList=wx.seqWithValue(ie.seq,k.uniforms)}return k.uniformsList}function ge(k,ie){const ce=ot.get(k);ce.outputColorSpace=ie.outputColorSpace,ce.batching=ie.batching,ce.batchingColor=ie.batchingColor,ce.instancing=ie.instancing,ce.instancingColor=ie.instancingColor,ce.instancingMorph=ie.instancingMorph,ce.skinning=ie.skinning,ce.morphTargets=ie.morphTargets,ce.morphNormals=ie.morphNormals,ce.morphColors=ie.morphColors,ce.morphTargetsCount=ie.morphTargetsCount,ce.numClippingPlanes=ie.numClippingPlanes,ce.numIntersection=ie.numClipIntersection,ce.vertexAlphas=ie.vertexAlphas,ce.vertexTangents=ie.vertexTangents,ce.toneMapping=ie.toneMapping}function Be(k,ie,ce,me,oe){ie.isScene!==!0&&(ie=pe),ft.resetTextureUnits();const Se=ie.fog,je=me.isMeshStandardMaterial?ie.environment:null,Je=M===null?B.outputColorSpace:M.isXRRenderTarget===!0?M.texture.colorSpace:Kl,$e=(me.isMeshStandardMaterial?L:Q).get(me.envMap||je),It=me.vertexColors===!0&&!!ce.attributes.color&&ce.attributes.color.itemSize===4,at=!!ce.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),st=!!ce.morphAttributes.position,Gt=!!ce.morphAttributes.normal,Dt=!!ce.morphAttributes.color;let Tt=Tl;me.toneMapped&&(M===null||M.isXRRenderTarget===!0)&&(Tt=B.toneMapping);const rn=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,cn=rn!==void 0?rn.length:0,Bt=ot.get(me),Cn=v.state.lights;if(he===!0&&(Me===!0||k!==T)){const Ui=k===T&&me.id===F;Nt.setState(me,k,Ui)}let Xt=!1;me.version===Bt.__version?(Bt.needsLights&&Bt.lightsStateVersion!==Cn.state.version||Bt.outputColorSpace!==Je||oe.isBatchedMesh&&Bt.batching===!1||!oe.isBatchedMesh&&Bt.batching===!0||oe.isBatchedMesh&&Bt.batchingColor===!0&&oe.colorTexture===null||oe.isBatchedMesh&&Bt.batchingColor===!1&&oe.colorTexture!==null||oe.isInstancedMesh&&Bt.instancing===!1||!oe.isInstancedMesh&&Bt.instancing===!0||oe.isSkinnedMesh&&Bt.skinning===!1||!oe.isSkinnedMesh&&Bt.skinning===!0||oe.isInstancedMesh&&Bt.instancingColor===!0&&oe.instanceColor===null||oe.isInstancedMesh&&Bt.instancingColor===!1&&oe.instanceColor!==null||oe.isInstancedMesh&&Bt.instancingMorph===!0&&oe.morphTexture===null||oe.isInstancedMesh&&Bt.instancingMorph===!1&&oe.morphTexture!==null||Bt.envMap!==$e||me.fog===!0&&Bt.fog!==Se||Bt.numClippingPlanes!==void 0&&(Bt.numClippingPlanes!==Nt.numPlanes||Bt.numIntersection!==Nt.numIntersection)||Bt.vertexAlphas!==It||Bt.vertexTangents!==at||Bt.morphTargets!==st||Bt.morphNormals!==Gt||Bt.morphColors!==Dt||Bt.toneMapping!==Tt||Bt.morphTargetsCount!==cn)&&(Xt=!0):(Xt=!0,Bt.__version=me.version);let Xn=Bt.currentProgram;Xt===!0&&(Xn=Y(me,ie,oe));let Nn=!1,an=!1,On=!1;const En=Xn.getUniforms(),Dn=Bt.uniforms;if(Le.useProgram(Xn.program)&&(Nn=!0,an=!0,On=!0),me.id!==F&&(F=me.id,an=!0),Nn||T!==k){Le.buffers.depth.getReversed()&&k.reversedDepth!==!0&&(k._reversedDepth=!0,k.updateProjectionMatrix()),En.setValue(U,"projectionMatrix",k.projectionMatrix),En.setValue(U,"viewMatrix",k.matrixWorldInverse);const rr=En.map.cameraPosition;rr!==void 0&&rr.setValue(U,xe.setFromMatrixPosition(k.matrixWorld)),Qe.logarithmicDepthBuffer&&En.setValue(U,"logDepthBufFC",2/(Math.log(k.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&En.setValue(U,"isOrthographic",k.isOrthographicCamera===!0),T!==k&&(T=k,an=!0,On=!0)}if(oe.isSkinnedMesh){En.setOptional(U,oe,"bindMatrix"),En.setOptional(U,oe,"bindMatrixInverse");const Ui=oe.skeleton;Ui&&(Ui.boneTexture===null&&Ui.computeBoneTexture(),En.setValue(U,"boneTexture",Ui.boneTexture,ft))}oe.isBatchedMesh&&(En.setOptional(U,oe,"batchingTexture"),En.setValue(U,"batchingTexture",oe._matricesTexture,ft),En.setOptional(U,oe,"batchingIdTexture"),En.setValue(U,"batchingIdTexture",oe._indirectTexture,ft),En.setOptional(U,oe,"batchingColorTexture"),oe._colorsTexture!==null&&En.setValue(U,"batchingColorTexture",oe._colorsTexture,ft));const Si=ce.morphAttributes;if((Si.position!==void 0||Si.normal!==void 0||Si.color!==void 0)&&Pt.update(oe,ce,Xn),(an||Bt.receiveShadow!==oe.receiveShadow)&&(Bt.receiveShadow=oe.receiveShadow,En.setValue(U,"receiveShadow",oe.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(Dn.envMap.value=$e,Dn.flipEnvMap.value=$e.isCubeTexture&&$e.isRenderTargetTexture===!1?-1:1),me.isMeshStandardMaterial&&me.envMap===null&&ie.environment!==null&&(Dn.envMapIntensity.value=ie.environmentIntensity),Dn.dfgLUT!==void 0&&(Dn.dfgLUT.value=qPe()),an&&(En.setValue(U,"toneMappingExposure",B.toneMappingExposure),Bt.needsLights&&Fe(Dn,On),Se&&me.fog===!0&&Rt.refreshFogUniforms(Dn,Se),Rt.refreshMaterialUniforms(Dn,me,P,E,v.state.transmissionRenderTarget[k.id]),wx.upload(U,D(Bt),Dn,ft)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(wx.upload(U,D(Bt),Dn,ft),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&En.setValue(U,"center",oe.center),En.setValue(U,"modelViewMatrix",oe.modelViewMatrix),En.setValue(U,"normalMatrix",oe.normalMatrix),En.setValue(U,"modelMatrix",oe.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const Ui=me.uniformsGroups;for(let rr=0,Jl=Ui.length;rr<Jl;rr++){const Wo=Ui[rr];ye.update(Wo,Xn),ye.bind(Wo,Xn)}}return Xn}function Fe(k,ie){k.ambientLightColor.needsUpdate=ie,k.lightProbe.needsUpdate=ie,k.directionalLights.needsUpdate=ie,k.directionalLightShadows.needsUpdate=ie,k.pointLights.needsUpdate=ie,k.pointLightShadows.needsUpdate=ie,k.spotLights.needsUpdate=ie,k.spotLightShadows.needsUpdate=ie,k.rectAreaLights.needsUpdate=ie,k.hemisphereLights.needsUpdate=ie}function _e(k){return k.isMeshLambertMaterial||k.isMeshToonMaterial||k.isMeshPhongMaterial||k.isMeshStandardMaterial||k.isShadowMaterial||k.isShaderMaterial&&k.lights===!0}this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return W},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(k,ie,ce){const me=ot.get(k);me.__autoAllocateDepthBuffer=k.resolveDepthBuffer===!1,me.__autoAllocateDepthBuffer===!1&&(me.__useRenderToTexture=!1),ot.get(k.texture).__webglTexture=ie,ot.get(k.depthTexture).__webglTexture=me.__autoAllocateDepthBuffer?void 0:ce,me.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(k,ie){const ce=ot.get(k);ce.__webglFramebuffer=ie,ce.__useDefaultFramebuffer=ie===void 0};const gt=U.createFramebuffer();this.setRenderTarget=function(k,ie=0,ce=0){M=k,N=ie,W=ce;let me=!0,oe=null,Se=!1,je=!1;if(k){const $e=ot.get(k);if($e.__useDefaultFramebuffer!==void 0)Le.bindFramebuffer(U.FRAMEBUFFER,null),me=!1;else if($e.__webglFramebuffer===void 0)ft.setupRenderTarget(k);else if($e.__hasExternalTextures)ft.rebindTextures(k,ot.get(k.texture).__webglTexture,ot.get(k.depthTexture).__webglTexture);else if(k.depthBuffer){const st=k.depthTexture;if($e.__boundDepthTexture!==st){if(st!==null&&ot.has(st)&&(k.width!==st.image.width||k.height!==st.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ft.setupDepthRenderbuffer(k)}}const It=k.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(je=!0);const at=ot.get(k).__webglFramebuffer;k.isWebGLCubeRenderTarget?(Array.isArray(at[ie])?oe=at[ie][ce]:oe=at[ie],Se=!0):k.samples>0&&ft.useMultisampledRTT(k)===!1?oe=ot.get(k).__webglMultisampledFramebuffer:Array.isArray(at)?oe=at[ce]:oe=at,H.copy(k.viewport),K.copy(k.scissor),z=k.scissorTest}else H.copy(de).multiplyScalar(P).floor(),K.copy(Re).multiplyScalar(P).floor(),z=Pe;if(ce!==0&&(oe=gt),Le.bindFramebuffer(U.FRAMEBUFFER,oe)&&me&&Le.drawBuffers(k,oe),Le.viewport(H),Le.scissor(K),Le.setScissorTest(z),Se){const $e=ot.get(k.texture);U.framebufferTexture2D(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_CUBE_MAP_POSITIVE_X+ie,$e.__webglTexture,ce)}else if(je){const $e=ie;for(let It=0;It<k.textures.length;It++){const at=ot.get(k.textures[It]);U.framebufferTextureLayer(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0+It,at.__webglTexture,ce,$e)}}else if(k!==null&&ce!==0){const $e=ot.get(k.texture);U.framebufferTexture2D(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,$e.__webglTexture,ce)}F=-1},this.readRenderTargetPixels=function(k,ie,ce,me,oe,Se,je,Je=0){if(!(k&&k.isWebGLRenderTarget)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let $e=ot.get(k).__webglFramebuffer;if(k.isWebGLCubeRenderTarget&&je!==void 0&&($e=$e[je]),$e){Le.bindFramebuffer(U.FRAMEBUFFER,$e);try{const It=k.textures[Je],at=It.format,st=It.type;if(!Qe.textureFormatReadable(at)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Qe.textureTypeReadable(st)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ie>=0&&ie<=k.width-me&&ce>=0&&ce<=k.height-oe&&(k.textures.length>1&&U.readBuffer(U.COLOR_ATTACHMENT0+Je),U.readPixels(ie,ce,me,oe,De.convert(at),De.convert(st),Se))}finally{const It=M!==null?ot.get(M).__webglFramebuffer:null;Le.bindFramebuffer(U.FRAMEBUFFER,It)}}},this.readRenderTargetPixelsAsync=async function(k,ie,ce,me,oe,Se,je,Je=0){if(!(k&&k.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let $e=ot.get(k).__webglFramebuffer;if(k.isWebGLCubeRenderTarget&&je!==void 0&&($e=$e[je]),$e)if(ie>=0&&ie<=k.width-me&&ce>=0&&ce<=k.height-oe){Le.bindFramebuffer(U.FRAMEBUFFER,$e);const It=k.textures[Je],at=It.format,st=It.type;if(!Qe.textureFormatReadable(at))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Qe.textureTypeReadable(st))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Gt=U.createBuffer();U.bindBuffer(U.PIXEL_PACK_BUFFER,Gt),U.bufferData(U.PIXEL_PACK_BUFFER,Se.byteLength,U.STREAM_READ),k.textures.length>1&&U.readBuffer(U.COLOR_ATTACHMENT0+Je),U.readPixels(ie,ce,me,oe,De.convert(at),De.convert(st),0);const Dt=M!==null?ot.get(M).__webglFramebuffer:null;Le.bindFramebuffer(U.FRAMEBUFFER,Dt);const Tt=U.fenceSync(U.SYNC_GPU_COMMANDS_COMPLETE,0);return U.flush(),await yke(U,Tt,4),U.bindBuffer(U.PIXEL_PACK_BUFFER,Gt),U.getBufferSubData(U.PIXEL_PACK_BUFFER,0,Se),U.deleteBuffer(Gt),U.deleteSync(Tt),Se}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(k,ie=null,ce=0){const me=Math.pow(2,-ce),oe=Math.floor(k.image.width*me),Se=Math.floor(k.image.height*me),je=ie!==null?ie.x:0,Je=ie!==null?ie.y:0;ft.setTexture2D(k,0),U.copyTexSubImage2D(U.TEXTURE_2D,ce,0,0,je,Je,oe,Se),Le.unbindTexture()};const et=U.createFramebuffer(),Ct=U.createFramebuffer();this.copyTextureToTexture=function(k,ie,ce=null,me=null,oe=0,Se=null){Se===null&&(oe!==0?(fC("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Se=oe,oe=0):Se=0);let je,Je,$e,It,at,st,Gt,Dt,Tt;const rn=k.isCompressedTexture?k.mipmaps[Se]:k.image;if(ce!==null)je=ce.max.x-ce.min.x,Je=ce.max.y-ce.min.y,$e=ce.isBox3?ce.max.z-ce.min.z:1,It=ce.min.x,at=ce.min.y,st=ce.isBox3?ce.min.z:0;else{const Si=Math.pow(2,-oe);je=Math.floor(rn.width*Si),Je=Math.floor(rn.height*Si),k.isDataArrayTexture?$e=rn.depth:k.isData3DTexture?$e=Math.floor(rn.depth*Si):$e=1,It=0,at=0,st=0}me!==null?(Gt=me.x,Dt=me.y,Tt=me.z):(Gt=0,Dt=0,Tt=0);const cn=De.convert(ie.format),Bt=De.convert(ie.type);let Cn;ie.isData3DTexture?(ft.setTexture3D(ie,0),Cn=U.TEXTURE_3D):ie.isDataArrayTexture||ie.isCompressedArrayTexture?(ft.setTexture2DArray(ie,0),Cn=U.TEXTURE_2D_ARRAY):(ft.setTexture2D(ie,0),Cn=U.TEXTURE_2D),U.pixelStorei(U.UNPACK_FLIP_Y_WEBGL,ie.flipY),U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),U.pixelStorei(U.UNPACK_ALIGNMENT,ie.unpackAlignment);const Xt=U.getParameter(U.UNPACK_ROW_LENGTH),Xn=U.getParameter(U.UNPACK_IMAGE_HEIGHT),Nn=U.getParameter(U.UNPACK_SKIP_PIXELS),an=U.getParameter(U.UNPACK_SKIP_ROWS),On=U.getParameter(U.UNPACK_SKIP_IMAGES);U.pixelStorei(U.UNPACK_ROW_LENGTH,rn.width),U.pixelStorei(U.UNPACK_IMAGE_HEIGHT,rn.height),U.pixelStorei(U.UNPACK_SKIP_PIXELS,It),U.pixelStorei(U.UNPACK_SKIP_ROWS,at),U.pixelStorei(U.UNPACK_SKIP_IMAGES,st);const En=k.isDataArrayTexture||k.isData3DTexture,Dn=ie.isDataArrayTexture||ie.isData3DTexture;if(k.isDepthTexture){const Si=ot.get(k),Ui=ot.get(ie),rr=ot.get(Si.__renderTarget),Jl=ot.get(Ui.__renderTarget);Le.bindFramebuffer(U.READ_FRAMEBUFFER,rr.__webglFramebuffer),Le.bindFramebuffer(U.DRAW_FRAMEBUFFER,Jl.__webglFramebuffer);for(let Wo=0;Wo<$e;Wo++)En&&(U.framebufferTextureLayer(U.READ_FRAMEBUFFER,U.COLOR_ATTACHMENT0,ot.get(k).__webglTexture,oe,st+Wo),U.framebufferTextureLayer(U.DRAW_FRAMEBUFFER,U.COLOR_ATTACHMENT0,ot.get(ie).__webglTexture,Se,Tt+Wo)),U.blitFramebuffer(It,at,je,Je,Gt,Dt,je,Je,U.DEPTH_BUFFER_BIT,U.NEAREST);Le.bindFramebuffer(U.READ_FRAMEBUFFER,null),Le.bindFramebuffer(U.DRAW_FRAMEBUFFER,null)}else if(oe!==0||k.isRenderTargetTexture||ot.has(k)){const Si=ot.get(k),Ui=ot.get(ie);Le.bindFramebuffer(U.READ_FRAMEBUFFER,et),Le.bindFramebuffer(U.DRAW_FRAMEBUFFER,Ct);for(let rr=0;rr<$e;rr++)En?U.framebufferTextureLayer(U.READ_FRAMEBUFFER,U.COLOR_ATTACHMENT0,Si.__webglTexture,oe,st+rr):U.framebufferTexture2D(U.READ_FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,Si.__webglTexture,oe),Dn?U.framebufferTextureLayer(U.DRAW_FRAMEBUFFER,U.COLOR_ATTACHMENT0,Ui.__webglTexture,Se,Tt+rr):U.framebufferTexture2D(U.DRAW_FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,Ui.__webglTexture,Se),oe!==0?U.blitFramebuffer(It,at,je,Je,Gt,Dt,je,Je,U.COLOR_BUFFER_BIT,U.NEAREST):Dn?U.copyTexSubImage3D(Cn,Se,Gt,Dt,Tt+rr,It,at,je,Je):U.copyTexSubImage2D(Cn,Se,Gt,Dt,It,at,je,Je);Le.bindFramebuffer(U.READ_FRAMEBUFFER,null),Le.bindFramebuffer(U.DRAW_FRAMEBUFFER,null)}else Dn?k.isDataTexture||k.isData3DTexture?U.texSubImage3D(Cn,Se,Gt,Dt,Tt,je,Je,$e,cn,Bt,rn.data):ie.isCompressedArrayTexture?U.compressedTexSubImage3D(Cn,Se,Gt,Dt,Tt,je,Je,$e,cn,rn.data):U.texSubImage3D(Cn,Se,Gt,Dt,Tt,je,Je,$e,cn,Bt,rn):k.isDataTexture?U.texSubImage2D(U.TEXTURE_2D,Se,Gt,Dt,je,Je,cn,Bt,rn.data):k.isCompressedTexture?U.compressedTexSubImage2D(U.TEXTURE_2D,Se,Gt,Dt,rn.width,rn.height,cn,rn.data):U.texSubImage2D(U.TEXTURE_2D,Se,Gt,Dt,je,Je,cn,Bt,rn);U.pixelStorei(U.UNPACK_ROW_LENGTH,Xt),U.pixelStorei(U.UNPACK_IMAGE_HEIGHT,Xn),U.pixelStorei(U.UNPACK_SKIP_PIXELS,Nn),U.pixelStorei(U.UNPACK_SKIP_ROWS,an),U.pixelStorei(U.UNPACK_SKIP_IMAGES,On),Se===0&&ie.generateMipmaps&&U.generateMipmap(Cn),Le.unbindTexture()},this.initRenderTarget=function(k){ot.get(k).__webglFramebuffer===void 0&&ft.setupRenderTarget(k)},this.initTexture=function(k){k.isCubeTexture?ft.setTextureCube(k,0):k.isData3DTexture?ft.setTexture3D(k,0):k.isDataArrayTexture||k.isCompressedArrayTexture?ft.setTexture2DArray(k,0):ft.setTexture2D(k,0),Le.unbindTexture()},this.resetState=function(){N=0,W=0,M=null,Le.reset(),se.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return yo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Fn._getDrawingBufferColorSpace(e),n.unpackColorSpace=Fn._getUnpackColorSpace()}}const $Pe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:qF,AddEquation:Gg,AddOperation:_$,AdditiveAnimationBlendMode:i_,AdditiveBlending:G3,AgXToneMapping:k$,AlphaFormat:t_,AlwaysCompare:tee,AlwaysDepth:xG,AlwaysStencilFunc:N3,AmbientLight:Pee,AnimationAction:tte,AnimationClip:f0,AnimationLoader:l9e,AnimationMixer:_9e,AnimationObjectGroup:V9e,AnimationUtils:r9e,ArcCurve:Cee,ArrayCamera:qee,ArrowHelper:oKe,AttachedBindMode:Z3,Audio:$ee,AudioAnalyser:x9e,AudioContext:M_,AudioListener:y9e,AudioLoader:p9e,AxesHelper:aKe,BackSide:Bs,BasicDepthPacking:P$,BasicShadowMap:f$,BatchedMesh:uee,Bone:h_,BooleanKeyframeTrack:bh,Box2:z9e,Box3:ss,Box3Helper:rKe,BoxGeometry:yh,BoxHelper:iKe,BufferAttribute:Wn,BufferGeometry:gn,BufferGeometryLoader:Qee,ByteType:UB,Cache:Zl,Camera:iy,CameraHelper:nKe,CanvasTexture:SHe,CapsuleGeometry:gS,CatmullRomCurve3:pee,CineonToneMapping:E$,CircleGeometry:uS,ClampToEdgeWrapping:Vi,Clock:V_,Color:wt,ColorKeyframeTrack:R_,ColorManagement:Fn,CompressedArrayTexture:GHe,CompressedCubeTexture:BHe,CompressedTexture:kd,CompressedTextureLoader:c9e,ConeGeometry:oy,ConstantAlphaFactor:M$,ConstantColorFactor:N$,Controls:cKe,CubeCamera:oee,CubeReflectionMapping:kl,CubeRefractionMapping:lu,CubeTexture:ry,CubeTextureLoader:Hee,CubeUVReflectionMapping:QC,CubicBezierCurve:A_,CubicBezierCurve3:mee,CubicInterpolant:Xee,CullFaceBack:w3,CullFaceFront:I$,CullFaceFrontBack:_Ye,CullFaceNone:h$,Curve:nl,CurvePath:yee,CustomBlending:C$,CustomToneMapping:Y$,CylinderGeometry:sy,Cylindrical:L9e,Data3DTexture:rS,DataArrayTexture:iS,DataTexture:sa,DataTextureLoader:N_,DataUtils:xd,DecrementStencilOp:DYe,DecrementWrapStencilOp:JYe,DefaultLoadingManager:kee,DepthFormat:uC,DepthStencilFormat:dC,DepthTexture:C_,DetachedBindMode:K$,DirectionalLight:jee,DirectionalLightHelper:tKe,DiscreteInterpolant:Eee,DodecahedronGeometry:dS,DoubleSide:rs,DstAlphaFactor:G$,DstColorFactor:S$,DynamicCopyUsage:uke,DynamicDrawUsage:ske,DynamicReadUsage:lke,EdgesGeometry:fee,EllipseCurve:hS,EqualCompare:Q$,EqualDepth:GG,EqualStencilFunc:eke,EquirectangularReflectionMapping:oC,EquirectangularRefractionMapping:i0,Euler:no,EventDispatcher:Ol,ExternalTexture:p_,ExtrudeGeometry:IS,FileLoader:Bo,Float16BufferAttribute:iHe,Float32BufferAttribute:_t,FloatType:Fi,Fog:oS,FogExp2:sS,FramebufferTexture:wHe,FrontSide:Lc,Frustum:qC,FrustumArray:cS,GLBufferAttribute:k9e,GLSL1:hke,GLSL3:W3,GreaterCompare:q$,GreaterDepth:SG,GreaterEqualCompare:eee,GreaterEqualDepth:BG,GreaterEqualStencilFunc:rke,GreaterStencilFunc:nke,GridHelper:$9e,Group:_I,HalfFloatType:hr,HemisphereLight:Kee,HemisphereLightHelper:q9e,IcosahedronGeometry:ay,ImageBitmapLoader:C9e,ImageLoader:C0,ImageUtils:o_,IncrementStencilOp:OYe,IncrementWrapStencilOp:UYe,InstancedBufferAttribute:AC,InstancedBufferGeometry:Jee,InstancedInterleavedBuffer:Y9e,InstancedMesh:I_,Int16BufferAttribute:tHe,Int32BufferAttribute:nHe,Int8BufferAttribute:qke,IntType:ey,InterleavedBuffer:aS,InterleavedBufferAttribute:sh,Interpolant:gy,InterpolateDiscrete:hC,InterpolateLinear:r0,InterpolateSmooth:vx,InterpolationSamplingMode:Cke,InterpolationSamplingType:fke,InvertStencilOp:QYe,KeepStencilOp:ad,KeyframeTrack:ha,LOD:cee,LatheGeometry:fS,Layers:Yd,LessCompare:J$,LessDepth:wG,LessEqualCompare:r_,LessEqualDepth:rh,LessEqualStencilFunc:tke,LessStencilFunc:$Ye,Light:Su,LightProbe:Uee,Line:uu,Line3:O9e,LineBasicMaterial:Ms,LineCurve:y_,LineCurve3:Aee,LineDashedMaterial:Fee,LineLoop:dee,LineSegments:Dl,LinearFilter:Ln,LinearInterpolant:Z_,LinearMipMapLinearFilter:R3,LinearMipMapNearestFilter:EYe,LinearMipmapLinearFilter:ka,LinearMipmapNearestFilter:$I,LinearSRGBColorSpace:Kl,LinearToneMapping:T$,LinearTransfer:o0,Loader:Vs,LoaderUtils:T3,LoadingManager:vS,LoopOnce:L$,LoopPingPong:j$,LoopRepeat:z$,MOUSE:sd,Material:Yr,MaterialLoader:xS,MathUtils:pC,Matrix2:E_,Matrix3:hn,Matrix4:Qt,MaxEquation:y$,Mesh:Li,MeshBasicMaterial:Uc,MeshDepthMaterial:G_,MeshDistanceMaterial:B_,MeshLambertMaterial:Mee,MeshMatcapMaterial:Vee,MeshNormalMaterial:Wee,MeshPhongMaterial:Ree,MeshPhysicalMaterial:Zee,MeshStandardMaterial:w_,MeshToonMaterial:Nee,MinEquation:A$,MirroredRepeatWrapping:lC,MixOperation:F$,MultiplyBlending:S3,MultiplyOperation:$0,NearestFilter:Sr,NearestMipMapLinearFilter:XYe,NearestMipMapNearestFilter:TYe,NearestMipmapLinearFilter:yd,NearestMipmapNearestFilter:DB,NeutralToneMapping:H$,NeverCompare:U$,NeverDepth:vG,NeverStencilFunc:qYe,NoBlending:Da,NoColorSpace:Gl,NoToneMapping:Tl,NormalAnimationBlendMode:nS,NormalBlending:Xd,NotEqualCompare:$$,NotEqualDepth:ZG,NotEqualStencilFunc:ike,NumberKeyframeTrack:h0,Object3D:Tn,ObjectLoader:I9e,ObjectSpaceNormalMap:D$,OctahedronGeometry:ly,OneFactor:v$,OneMinusConstantAlphaFactor:V$,OneMinusConstantColorFactor:W$,OneMinusDstAlphaFactor:B$,OneMinusDstColorFactor:Z$,OneMinusSrcAlphaFactor:bG,OneMinusSrcColorFactor:w$,OrthographicCamera:Ua,PCFShadowMap:OB,PCFSoftShadowMap:Km,PMREMGenerator:k3,Path:o2,PerspectiveCamera:Wi,Plane:Cc,PlaneGeometry:Bu,PlaneHelper:sKe,PointLight:zee,PointLightHelper:J9e,Points:hee,PointsMaterial:f_,PolarGridHelper:eKe,PolyhedronGeometry:Gu,PositionalAudio:v9e,PropertyBinding:Sn,PropertyMixer:ete,QuadraticBezierCurve:b_,QuadraticBezierCurve3:v_,Quaternion:Zr,QuaternionKeyframeTrack:uy,QuaternionLinearInterpolant:Yee,RED_GREEN_RGTC2_Format:t2,RED_RGTC1_Format:$G,REVISION:mh,RGBADepthPacking:O$,RGBAFormat:Ki,RGBAIntegerFormat:tS,RGBA_ASTC_10x10_Format:OG,RGBA_ASTC_10x5_Format:zG,RGBA_ASTC_10x6_Format:jG,RGBA_ASTC_10x8_Format:PG,RGBA_ASTC_12x10_Format:DG,RGBA_ASTC_12x12_Format:UG,RGBA_ASTC_4x4_Format:TG,RGBA_ASTC_5x4_Format:XG,RGBA_ASTC_5x5_Format:EG,RGBA_ASTC_6x5_Format:YG,RGBA_ASTC_6x6_Format:kG,RGBA_ASTC_8x5_Format:HG,RGBA_ASTC_8x6_Format:KG,RGBA_ASTC_8x8_Format:LG,RGBA_BPTC_Format:JG,RGBA_ETC2_EAC_Format:_G,RGBA_PVRTC_2BPPV1_Format:MG,RGBA_PVRTC_4BPPV1_Format:WG,RGBA_S3TC_DXT1_Format:zm,RGBA_S3TC_DXT3_Format:jm,RGBA_S3TC_DXT5_Format:Pm,RGBDepthPacking:LYe,RGBFormat:n_,RGBIntegerFormat:YYe,RGB_BPTC_SIGNED_Format:QG,RGB_BPTC_UNSIGNED_Format:qG,RGB_ETC1_Format:VG,RGB_ETC2_Format:FG,RGB_PVRTC_2BPPV1_Format:NG,RGB_PVRTC_4BPPV1_Format:RG,RGB_S3TC_DXT1_Format:Lm,RGDepthPacking:zYe,RGFormat:$B,RGIntegerFormat:eS,RawShaderMaterial:See,Ray:Ah,Raycaster:X_,RectAreaLight:Oee,RedFormat:ty,RedIntegerFormat:ny,ReinhardToneMapping:X$,RenderTarget:a_,RenderTarget3D:T9e,RepeatWrapping:aC,ReplaceStencilOp:PYe,ReverseSubtractEquation:m$,RingGeometry:CS,SIGNED_RED_GREEN_RGTC2_Format:n2,SIGNED_RED_RGTC1_Format:e2,SRGBColorSpace:ts,SRGBTransfer:Qn,Scene:gu,ShaderChunk:mn,ShaderLib:Ea,ShaderMaterial:as,ShadowMaterial:Bee,Shape:Hd,ShapeGeometry:pS,ShapePath:lKe,ShapeUtils:Ha,ShortType:JB,Skeleton:lS,SkeletonHelper:U9e,SkinnedMesh:gee,Source:Gc,Sphere:Tr,SphereGeometry:cy,Spherical:E3,SphericalHarmonics3:Dee,SplineCurve:x_,SpotLight:Lee,SpotLightHelper:D9e,Sprite:lee,SpriteMaterial:d_,SrcAlphaFactor:yG,SrcAlphaSaturateFactor:R$,SrcColorFactor:x$,StaticCopyUsage:gke,StaticDrawUsage:a0,StaticReadUsage:ake,StereoCamera:m9e,StreamCopyUsage:dke,StreamDrawUsage:oke,StreamReadUsage:cke,StringKeyframeTrack:vh,SubtractEquation:p$,SubtractiveBlending:B3,TOUCH:od,TangentSpaceNormalMap:wu,TetrahedronGeometry:mS,Texture:$n,TextureLoader:g9e,TextureUtils:IKe,Timer:H9e,TimestampQuery:Ike,TorusGeometry:AS,TorusKnotGeometry:yS,Triangle:Us,TriangleFanDrawMode:KYe,TriangleStripDrawMode:HYe,TrianglesDrawMode:kYe,TubeGeometry:bS,UVMapping:au,Uint16BufferAttribute:l_,Uint32BufferAttribute:c_,Uint8BufferAttribute:$ke,Uint8ClampedBufferAttribute:eHe,Uniform:T_,UniformsGroup:E9e,UniformsLib:bt,UniformsUtils:g_,UnsignedByteType:Ss,UnsignedInt101111Type:e_,UnsignedInt248Type:gC,UnsignedInt5999Type:$F,UnsignedIntType:Hl,UnsignedShort4444Type:QB,UnsignedShort5551Type:qB,UnsignedShortType:cC,VSMShadowMap:Na,Vector2:He,Vector3:J,Vector4:_n,VectorKeyframeTrack:I0,VideoFrameTexture:xHe,VideoTexture:Iee,WebGL3DRenderTarget:Hke,WebGLArrayRenderTarget:kke,WebGLCoordinateSystem:yo,WebGLCubeRenderTarget:u_,WebGLRenderTarget:ga,WebGLRenderer:Y_,WebGLUtils:lte,WebGPUCoordinateSystem:IC,WebXRController:xx,WireframeGeometry:Gee,WrapAroundEnding:s0,ZeroCurvatureEnding:bd,ZeroFactor:b$,ZeroSlopeEnding:vd,ZeroStencilOp:jYe,createCanvasElement:iee,error:on,getConsoleFunction:Ake,log:c0,setConsoleFunction:mke,warn:vt,warnOnce:fC},Symbol.toStringTag,{value:"Module"}));var cte={exports:{}},xh={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */xh.ConcurrentRoot=1;xh.ContinuousEventPriority=4;xh.DefaultEventPriority=16;xh.DiscreteEventPriority=1;xh.IdleEventPriority=536870912;xh.LegacyRoot=0;cte.exports=xh;var TI=cte.exports;function eOe(t){let e;const n=new Set,i=(c,u)=>{const d=typeof c=="function"?c(e):c;if(d!==e){const h=e;e=u?d:Object.assign({},e,d),n.forEach(I=>I(e,h))}},r=()=>e,s=(c,u=r,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=u(e);function I(){const p=u(e);if(!d(h,p)){const y=h;c(h=p,y)}}return n.add(I),()=>n.delete(I)},l={setState:i,getState:r,subscribe:(c,u,d)=>u||d?s(c,u,d):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(i,r,l),l}const tOe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Zz=tOe?S.useEffect:S.useLayoutEffect;function gte(t){const e=typeof t=="function"?eOe(t):t,n=(i=e.getState,r=Object.is)=>{const[,s]=S.useReducer(A=>A+1,0),o=e.getState(),a=S.useRef(o),l=S.useRef(i),c=S.useRef(r),u=S.useRef(!1),d=S.useRef();d.current===void 0&&(d.current=i(o));let h,I=!1;(a.current!==o||l.current!==i||c.current!==r||u.current)&&(h=i(o),I=!r(d.current,h)),Zz(()=>{I&&(d.current=h),a.current=o,l.current=i,c.current=r,u.current=!1});const p=S.useRef(o);Zz(()=>{const A=()=>{try{const b=e.getState(),v=l.current(b);c.current(d.current,v)||(a.current=b,d.current=v,s())}catch{u.current=!0,s()}},m=e.subscribe(A);return e.getState()!==p.current&&A(),m},[]);const y=I?h:d.current;return S.useDebugValue(y),y};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}var ute={exports:{}},PR={exports:{}},OR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rz;function nOe(){return Rz||(Rz=1,function(t){function e(_,E){var P=_.length;_.push(E);e:for(;0<P;){var q=P-1>>>1,re=_[q];if(0<r(re,E))_[q]=E,_[P]=re,P=q;else break e}}function n(_){return _.length===0?null:_[0]}function i(_){if(_.length===0)return null;var E=_[0],P=_.pop();if(P!==E){_[0]=P;e:for(var q=0,re=_.length,de=re>>>1;q<de;){var Re=2*(q+1)-1,Pe=_[Re],ae=Re+1,he=_[ae];if(0>r(Pe,P))ae<re&&0>r(he,Pe)?(_[q]=he,_[ae]=P,q=ae):(_[q]=Pe,_[Re]=P,q=Re);else if(ae<re&&0>r(he,P))_[q]=he,_[ae]=P,q=ae;else break e}}return E}function r(_,E){var P=_.sortIndex-E.sortIndex;return P!==0?P:_.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,I=!1,p=!1,y=!1,A=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(_){for(var E=n(c);E!==null;){if(E.callback===null)i(c);else if(E.startTime<=_)i(c),E.sortIndex=E.expirationTime,e(l,E);else break;E=n(c)}}function w(_){if(y=!1,v(_),!p)if(n(l)!==null)p=!0,j(x);else{var E=n(c);E!==null&&O(w,E.startTime-_)}}function x(_,E){p=!1,y&&(y=!1,m(N),N=-1),I=!0;var P=h;try{for(v(E),d=n(l);d!==null&&(!(d.expirationTime>E)||_&&!F());){var q=d.callback;if(typeof q=="function"){d.callback=null,h=d.priorityLevel;var re=q(d.expirationTime<=E);E=t.unstable_now(),typeof re=="function"?d.callback=re:d===n(l)&&i(l),v(E)}else i(l);d=n(l)}if(d!==null)var de=!0;else{var Re=n(c);Re!==null&&O(w,Re.startTime-E),de=!1}return de}finally{d=null,h=P,I=!1}}var B=!1,Z=null,N=-1,W=5,M=-1;function F(){return!(t.unstable_now()-M<W)}function T(){if(Z!==null){var _=t.unstable_now();M=_;var E=!0;try{E=Z(!0,_)}finally{E?H():(B=!1,Z=null)}}else B=!1}var H;if(typeof b=="function")H=function(){b(T)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,z=K.port2;K.port1.onmessage=T,H=function(){z.postMessage(null)}}else H=function(){A(T,0)};function j(_){Z=_,B||(B=!0,H())}function O(_,E){N=A(function(){_(t.unstable_now())},E)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){p||I||(p=!0,j(x))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var E=3;break;default:E=h}var P=h;h=E;try{return _()}finally{h=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,E){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var P=h;h=_;try{return E()}finally{h=P}},t.unstable_scheduleCallback=function(_,E,P){var q=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?q+P:q):P=q,_){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=P+re,_={id:u++,callback:E,priorityLevel:_,startTime:P,expirationTime:re,sortIndex:-1},P>q?(_.sortIndex=P,e(c,_),n(l)===null&&_===n(c)&&(y?(m(N),N=-1):y=!0,O(w,P-q))):(_.sortIndex=re,e(l,_),p||I||(p=!0,j(x))),_},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(_){var E=h;return function(){var P=h;h=E;try{return _.apply(this,arguments)}finally{h=P}}}}(OR)),OR}var Nz;function iOe(){return Nz||(Nz=1,PR.exports=nOe()),PR.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rOe=function(e){var n={},i=S,r=iOe(),s=Object.assign;function o(f){for(var C="https://reactjs.org/docs/error-decoder.html?invariant="+f,G=1;G<arguments.length;G++)C+="&args[]="+encodeURIComponent(arguments[G]);return"Minified React error #"+f+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),p=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),x=Symbol.iterator;function B(f){return f===null||typeof f!="object"?null:(f=x&&f[x]||f["@@iterator"],typeof f=="function"?f:null)}function Z(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case u:return"Fragment";case c:return"Portal";case h:return"Profiler";case d:return"StrictMode";case A:return"Suspense";case m:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case p:return(f.displayName||"Context")+".Consumer";case I:return(f._context.displayName||"Context")+".Provider";case y:var C=f.render;return f=f.displayName,f||(f=C.displayName||C.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case b:return C=f.displayName||null,C!==null?C:Z(f.type)||"Memo";case v:C=f._payload,f=f._init;try{return Z(f(C))}catch{}}return null}function N(f){var C=f.type;switch(f.tag){case 24:return"Cache";case 9:return(C.displayName||"Context")+".Consumer";case 10:return(C._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=C.render,f=f.displayName||f.name||"",C.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return C;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(C);case 8:return C===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof C=="function")return C.displayName||C.name||null;if(typeof C=="string")return C}return null}function W(f){var C=f,G=f;if(f.alternate)for(;C.return;)C=C.return;else{f=C;do C=f,C.flags&4098&&(G=C.return),f=C.return;while(f)}return C.tag===3?G:null}function M(f){if(W(f)!==f)throw Error(o(188))}function F(f){var C=f.alternate;if(!C){if(C=W(f),C===null)throw Error(o(188));return C!==f?null:f}for(var G=f,R=C;;){var V=G.return;if(V===null)break;var X=V.alternate;if(X===null){if(R=V.return,R!==null){G=R;continue}break}if(V.child===X.child){for(X=V.child;X;){if(X===G)return M(V),f;if(X===R)return M(V),C;X=X.sibling}throw Error(o(188))}if(G.return!==R.return)G=V,R=X;else{for(var ne=!1,Ie=V.child;Ie;){if(Ie===G){ne=!0,G=V,R=X;break}if(Ie===R){ne=!0,R=V,G=X;break}Ie=Ie.sibling}if(!ne){for(Ie=X.child;Ie;){if(Ie===G){ne=!0,G=X,R=V;break}if(Ie===R){ne=!0,R=X,G=V;break}Ie=Ie.sibling}if(!ne)throw Error(o(189))}}if(G.alternate!==R)throw Error(o(190))}if(G.tag!==3)throw Error(o(188));return G.stateNode.current===G?f:C}function T(f){return f=F(f),f!==null?H(f):null}function H(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var C=H(f);if(C!==null)return C;f=f.sibling}return null}function K(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var C=K(f);if(C!==null)return C}f=f.sibling}return null}var z=Array.isArray,j=e.getPublicInstance,O=e.getRootHostContext,_=e.getChildHostContext,E=e.prepareForCommit,P=e.resetAfterCommit,q=e.createInstance,re=e.appendInitialChild,de=e.finalizeInitialChildren,Re=e.prepareUpdate,Pe=e.shouldSetTextContent,ae=e.createTextInstance,he=e.scheduleTimeout,Me=e.cancelTimeout,be=e.noTimeout,xe=e.isPrimaryRenderer,Ge=e.supportsMutation,pe=e.supportsPersistence,Oe=e.supportsHydration,ve=e.getInstanceFromNode,U=e.preparePortalMount,We=e.getCurrentEventPriority,Xe=e.detachDeletedInstance,Qe=e.supportsMicrotasks,Le=e.scheduleMicrotask,mt=e.supportsTestSelectors,ot=e.findFiberRoot,ft=e.getBoundingRect,Q=e.getTextContent,L=e.isHiddenSubtree,Ce=e.matchAccessibilityRole,Ve=e.setFocusIfFocusable,Ke=e.setupIntersectionObserver,Ze=e.appendChild,Rt=e.appendChildToContainer,pt=e.commitTextUpdate,kt=e.commitMount,Nt=e.commitUpdate,Ue=e.insertBefore,qe=e.insertInContainerBefore,Pt=e.removeChild,le=e.removeChildFromContainer,Ae=e.resetTextContent,De=e.hideInstance,se=e.hideTextInstance,ye=e.unhideInstance,it=e.unhideTextInstance,ct=e.clearContainer,rt=e.cloneInstance,ze=e.createContainerChildSet,yt=e.appendChildToContainerChildSet,Kt=e.finalizeContainerChildren,Rn=e.replaceContainerChildren,xn=e.cloneHiddenInstance,zi=e.cloneHiddenTextInstance,Di=e.canHydrateInstance,tp=e.canHydrateTextInstance,wh=e.canHydrateSuspenseInstance,il=e.isSuspenseInstancePending,ro=e.isSuspenseInstanceFallback,Ca=e.registerSuspenseInstanceRetry,_s=e.getNextHydratableSibling,yn=e.getFirstHydratableChild,Ul=e.getFirstHydratableChildWithinContainer,Gh=e.getFirstHydratableChildWithinSuspenseInstance,Y=e.hydrateInstance,D=e.hydrateTextInstance,ge=e.hydrateSuspenseInstance,Be=e.getNextHydratableInstanceAfterSuspenseInstance,Fe=e.commitHydratedContainer,_e=e.commitHydratedSuspenseInstance,gt=e.clearSuspenseBoundary,et=e.clearSuspenseBoundaryFromContainer,Ct=e.shouldDeleteUnhydratedTailInstances,k=e.didNotMatchHydratedContainerTextInstance,ie=e.didNotMatchHydratedTextInstance,ce;function me(f){if(ce===void 0)try{throw Error()}catch(G){var C=G.stack.trim().match(/\n( *(at )?)/);ce=C&&C[1]||""}return`
`+ce+f}var oe=!1;function Se(f,C){if(!f||oe)return"";oe=!0;var G=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(C)if(C=function(){throw Error()},Object.defineProperty(C.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(C,[])}catch(dt){var R=dt}Reflect.construct(f,[],C)}else{try{C.call()}catch(dt){R=dt}f.call(C.prototype)}else{try{throw Error()}catch(dt){R=dt}f()}}catch(dt){if(dt&&R&&typeof dt.stack=="string"){for(var V=dt.stack.split(`
`),X=R.stack.split(`
`),ne=V.length-1,Ie=X.length-1;1<=ne&&0<=Ie&&V[ne]!==X[Ie];)Ie--;for(;1<=ne&&0<=Ie;ne--,Ie--)if(V[ne]!==X[Ie]){if(ne!==1||Ie!==1)do if(ne--,Ie--,0>Ie||V[ne]!==X[Ie]){var Te=`
`+V[ne].replace(" at new "," at ");return f.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",f.displayName)),Te}while(1<=ne&&0<=Ie);break}}}finally{oe=!1,Error.prepareStackTrace=G}return(f=f?f.displayName||f.name:"")?me(f):""}var je=Object.prototype.hasOwnProperty,Je=[],$e=-1;function It(f){return{current:f}}function at(f){0>$e||(f.current=Je[$e],Je[$e]=null,$e--)}function st(f,C){$e++,Je[$e]=f.current,f.current=C}var Gt={},Dt=It(Gt),Tt=It(!1),rn=Gt;function cn(f,C){var G=f.type.contextTypes;if(!G)return Gt;var R=f.stateNode;if(R&&R.__reactInternalMemoizedUnmaskedChildContext===C)return R.__reactInternalMemoizedMaskedChildContext;var V={},X;for(X in G)V[X]=C[X];return R&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=C,f.__reactInternalMemoizedMaskedChildContext=V),V}function Bt(f){return f=f.childContextTypes,f!=null}function Cn(){at(Tt),at(Dt)}function Xt(f,C,G){if(Dt.current!==Gt)throw Error(o(168));st(Dt,C),st(Tt,G)}function Xn(f,C,G){var R=f.stateNode;if(C=C.childContextTypes,typeof R.getChildContext!="function")return G;R=R.getChildContext();for(var V in R)if(!(V in C))throw Error(o(108,N(f)||"Unknown",V));return s({},G,R)}function Nn(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Gt,rn=Dt.current,st(Dt,f),st(Tt,Tt.current),!0}function an(f,C,G){var R=f.stateNode;if(!R)throw Error(o(169));G?(f=Xn(f,C,rn),R.__reactInternalMemoizedMergedChildContext=f,at(Tt),at(Dt),st(Dt,f)):at(Tt),st(Tt,G)}var On=Math.clz32?Math.clz32:Si,En=Math.log,Dn=Math.LN2;function Si(f){return f>>>=0,f===0?32:31-(En(f)/Dn|0)|0}var Ui=64,rr=4194304;function Jl(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Wo(f,C){var G=f.pendingLanes;if(G===0)return 0;var R=0,V=f.suspendedLanes,X=f.pingedLanes,ne=G&268435455;if(ne!==0){var Ie=ne&~V;Ie!==0?R=Jl(Ie):(X&=ne,X!==0&&(R=Jl(X)))}else ne=G&~V,ne!==0?R=Jl(ne):X!==0&&(R=Jl(X));if(R===0)return 0;if(C!==0&&C!==R&&!(C&V)&&(V=R&-R,X=C&-C,V>=X||V===16&&(X&4194240)!==0))return C;if(R&4&&(R|=G&16),C=f.entangledLanes,C!==0)for(f=f.entanglements,C&=R;0<C;)G=31-On(C),V=1<<G,R|=f[G],C&=~V;return R}function Xne(f,C){switch(f){case 1:case 2:case 4:return C+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return C+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ene(f,C){for(var G=f.suspendedLanes,R=f.pingedLanes,V=f.expirationTimes,X=f.pendingLanes;0<X;){var ne=31-On(X),Ie=1<<ne,Te=V[ne];Te===-1?(!(Ie&G)||Ie&R)&&(V[ne]=Xne(Ie,C)):Te<=C&&(f.expiredLanes|=Ie),X&=~Ie}}function RS(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function NS(f){for(var C=[],G=0;31>G;G++)C.push(f);return C}function np(f,C,G){f.pendingLanes|=C,C!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,C=31-On(C),f[C]=G}function Yne(f,C){var G=f.pendingLanes&~C;f.pendingLanes=C,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=C,f.mutableReadLanes&=C,f.entangledLanes&=C,C=f.entanglements;var R=f.eventTimes;for(f=f.expirationTimes;0<G;){var V=31-On(G),X=1<<V;C[V]=0,R[V]=-1,f[V]=-1,G&=~X}}function WS(f,C){var G=f.entangledLanes|=C;for(f=f.entanglements;G;){var R=31-On(G),V=1<<R;V&C|f[R]&C&&(f[R]|=C),G&=~V}}var kn=0;function lT(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var MS=r.unstable_scheduleCallback,cT=r.unstable_cancelCallback,kne=r.unstable_shouldYield,Hne=r.unstable_requestPaint,mr=r.unstable_now,VS=r.unstable_ImmediatePriority,Kne=r.unstable_UserBlockingPriority,FS=r.unstable_NormalPriority,Lne=r.unstable_IdlePriority,fy=null,rl=null;function zne(f){if(rl&&typeof rl.onCommitFiberRoot=="function")try{rl.onCommitFiberRoot(fy,f,void 0,(f.current.flags&128)===128)}catch{}}function jne(f,C){return f===C&&(f!==0||1/f===1/C)||f!==f&&C!==C}var sl=typeof Object.is=="function"?Object.is:jne,Ql=null,Cy=!1,_S=!1;function gT(f){Ql===null?Ql=[f]:Ql.push(f)}function Pne(f){Cy=!0,gT(f)}function ol(){if(!_S&&Ql!==null){_S=!0;var f=0,C=kn;try{var G=Ql;for(kn=1;f<G.length;f++){var R=G[f];do R=R(!0);while(R!==null)}Ql=null,Cy=!1}catch(V){throw Ql!==null&&(Ql=Ql.slice(f+1)),MS(VS,ol),V}finally{kn=C,_S=!1}}return null}var One=a.ReactCurrentBatchConfig;function py(f,C){if(sl(f,C))return!0;if(typeof f!="object"||f===null||typeof C!="object"||C===null)return!1;var G=Object.keys(f),R=Object.keys(C);if(G.length!==R.length)return!1;for(R=0;R<G.length;R++){var V=G[R];if(!je.call(C,V)||!sl(f[V],C[V]))return!1}return!0}function Dne(f){switch(f.tag){case 5:return me(f.type);case 16:return me("Lazy");case 13:return me("Suspense");case 19:return me("SuspenseList");case 0:case 2:case 15:return f=Se(f.type,!1),f;case 11:return f=Se(f.type.render,!1),f;case 1:return f=Se(f.type,!0),f;default:return""}}function pa(f,C){if(f&&f.defaultProps){C=s({},C),f=f.defaultProps;for(var G in f)C[G]===void 0&&(C[G]=f[G]);return C}return C}var my=It(null),Ay=null,Bh=null,TS=null;function XS(){TS=Bh=Ay=null}function uT(f,C,G){xe?(st(my,C._currentValue),C._currentValue=G):(st(my,C._currentValue2),C._currentValue2=G)}function ES(f){var C=my.current;at(my),xe?f._currentValue=C:f._currentValue2=C}function YS(f,C,G){for(;f!==null;){var R=f.alternate;if((f.childLanes&C)!==C?(f.childLanes|=C,R!==null&&(R.childLanes|=C)):R!==null&&(R.childLanes&C)!==C&&(R.childLanes|=C),f===G)break;f=f.return}}function Sh(f,C){Ay=f,TS=Bh=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&C&&(ao=!0),f.firstContext=null)}function Mo(f){var C=xe?f._currentValue:f._currentValue2;if(TS!==f)if(f={context:f,memoizedValue:C,next:null},Bh===null){if(Ay===null)throw Error(o(308));Bh=f,Ay.dependencies={lanes:0,firstContext:f}}else Bh=Bh.next=f;return C}var al=null,Jc=!1;function kS(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dT(f,C){f=f.updateQueue,C.updateQueue===f&&(C.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function ql(f,C){return{eventTime:f,lane:C,tag:0,payload:null,callback:null,next:null}}function Qc(f,C){var G=f.updateQueue;G!==null&&(G=G.shared,Ji!==null&&f.mode&1&&!(wn&2)?(f=G.interleaved,f===null?(C.next=C,al===null?al=[G]:al.push(G)):(C.next=f.next,f.next=C),G.interleaved=C):(f=G.pending,f===null?C.next=C:(C.next=f.next,f.next=C),G.pending=C))}function yy(f,C,G){if(C=C.updateQueue,C!==null&&(C=C.shared,(G&4194240)!==0)){var R=C.lanes;R&=f.pendingLanes,G|=R,C.lanes=G,WS(f,G)}}function hT(f,C){var G=f.updateQueue,R=f.alternate;if(R!==null&&(R=R.updateQueue,G===R)){var V=null,X=null;if(G=G.firstBaseUpdate,G!==null){do{var ne={eventTime:G.eventTime,lane:G.lane,tag:G.tag,payload:G.payload,callback:G.callback,next:null};X===null?V=X=ne:X=X.next=ne,G=G.next}while(G!==null);X===null?V=X=C:X=X.next=C}else V=X=C;G={baseState:R.baseState,firstBaseUpdate:V,lastBaseUpdate:X,shared:R.shared,effects:R.effects},f.updateQueue=G;return}f=G.lastBaseUpdate,f===null?G.firstBaseUpdate=C:f.next=C,G.lastBaseUpdate=C}function by(f,C,G,R){var V=f.updateQueue;Jc=!1;var X=V.firstBaseUpdate,ne=V.lastBaseUpdate,Ie=V.shared.pending;if(Ie!==null){V.shared.pending=null;var Te=Ie,dt=Te.next;Te.next=null,ne===null?X=dt:ne.next=dt,ne=Te;var Ft=f.alternate;Ft!==null&&(Ft=Ft.updateQueue,Ie=Ft.lastBaseUpdate,Ie!==ne&&(Ie===null?Ft.firstBaseUpdate=dt:Ie.next=dt,Ft.lastBaseUpdate=Te))}if(X!==null){var un=V.baseState;ne=0,Ft=dt=Te=null,Ie=X;do{var Ut=Ie.lane,oi=Ie.eventTime;if((R&Ut)===Ut){Ft!==null&&(Ft=Ft.next={eventTime:oi,lane:0,tag:Ie.tag,payload:Ie.payload,callback:Ie.callback,next:null});e:{var Ot=f,Lr=Ie;switch(Ut=C,oi=G,Lr.tag){case 1:if(Ot=Lr.payload,typeof Ot=="function"){un=Ot.call(oi,un,Ut);break e}un=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=Lr.payload,Ut=typeof Ot=="function"?Ot.call(oi,un,Ut):Ot,Ut==null)break e;un=s({},un,Ut);break e;case 2:Jc=!0}}Ie.callback!==null&&Ie.lane!==0&&(f.flags|=64,Ut=V.effects,Ut===null?V.effects=[Ie]:Ut.push(Ie))}else oi={eventTime:oi,lane:Ut,tag:Ie.tag,payload:Ie.payload,callback:Ie.callback,next:null},Ft===null?(dt=Ft=oi,Te=un):Ft=Ft.next=oi,ne|=Ut;if(Ie=Ie.next,Ie===null){if(Ie=V.shared.pending,Ie===null)break;Ut=Ie,Ie=Ut.next,Ut.next=null,V.lastBaseUpdate=Ut,V.shared.pending=null}}while(!0);if(Ft===null&&(Te=un),V.baseState=Te,V.firstBaseUpdate=dt,V.lastBaseUpdate=Ft,C=V.shared.interleaved,C!==null){V=C;do ne|=V.lane,V=V.next;while(V!==C)}else X===null&&(V.shared.lanes=0);Th|=ne,f.lanes=ne,f.memoizedState=un}}function IT(f,C,G){if(f=C.effects,C.effects=null,f!==null)for(C=0;C<f.length;C++){var R=f[C],V=R.callback;if(V!==null){if(R.callback=null,R=G,typeof V!="function")throw Error(o(191,V));V.call(R)}}}var fT=new i.Component().refs;function HS(f,C,G,R){C=f.memoizedState,G=G(R,C),G=G==null?C:s({},C,G),f.memoizedState=G,f.lanes===0&&(f.updateQueue.baseState=G)}var vy={isMounted:function(f){return(f=f._reactInternals)?W(f)===f:!1},enqueueSetState:function(f,C,G){f=f._reactInternals;var R=cs(),V=eg(f),X=ql(R,V);X.payload=C,G!=null&&(X.callback=G),Qc(f,X),C=Xo(f,V,R),C!==null&&yy(C,f,V)},enqueueReplaceState:function(f,C,G){f=f._reactInternals;var R=cs(),V=eg(f),X=ql(R,V);X.tag=1,X.payload=C,G!=null&&(X.callback=G),Qc(f,X),C=Xo(f,V,R),C!==null&&yy(C,f,V)},enqueueForceUpdate:function(f,C){f=f._reactInternals;var G=cs(),R=eg(f),V=ql(G,R);V.tag=2,C!=null&&(V.callback=C),Qc(f,V),C=Xo(f,R,G),C!==null&&yy(C,f,R)}};function CT(f,C,G,R,V,X,ne){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(R,X,ne):C.prototype&&C.prototype.isPureReactComponent?!py(G,R)||!py(V,X):!0}function pT(f,C,G){var R=!1,V=Gt,X=C.contextType;return typeof X=="object"&&X!==null?X=Mo(X):(V=Bt(C)?rn:Dt.current,R=C.contextTypes,X=(R=R!=null)?cn(f,V):Gt),C=new C(G,X),f.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=vy,f.stateNode=C,C._reactInternals=f,R&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=V,f.__reactInternalMemoizedMaskedChildContext=X),C}function mT(f,C,G,R){f=C.state,typeof C.componentWillReceiveProps=="function"&&C.componentWillReceiveProps(G,R),typeof C.UNSAFE_componentWillReceiveProps=="function"&&C.UNSAFE_componentWillReceiveProps(G,R),C.state!==f&&vy.enqueueReplaceState(C,C.state,null)}function KS(f,C,G,R){var V=f.stateNode;V.props=G,V.state=f.memoizedState,V.refs=fT,kS(f);var X=C.contextType;typeof X=="object"&&X!==null?V.context=Mo(X):(X=Bt(C)?rn:Dt.current,V.context=cn(f,X)),V.state=f.memoizedState,X=C.getDerivedStateFromProps,typeof X=="function"&&(HS(f,C,X,G),V.state=f.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof V.getSnapshotBeforeUpdate=="function"||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(C=V.state,typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount(),C!==V.state&&vy.enqueueReplaceState(V,V.state,null),by(f,G,V,R),V.state=f.memoizedState),typeof V.componentDidMount=="function"&&(f.flags|=4194308)}var Zh=[],Rh=0,xy=null,wy=0,Vo=[],Fo=0,Zu=null,$l=1,ec="";function Ru(f,C){Zh[Rh++]=wy,Zh[Rh++]=xy,xy=f,wy=C}function AT(f,C,G){Vo[Fo++]=$l,Vo[Fo++]=ec,Vo[Fo++]=Zu,Zu=f;var R=$l;f=ec;var V=32-On(R)-1;R&=~(1<<V),G+=1;var X=32-On(C)+V;if(30<X){var ne=V-V%5;X=(R&(1<<ne)-1).toString(32),R>>=ne,V-=ne,$l=1<<32-On(C)+V|G<<V|R,ec=X+f}else $l=1<<X|G<<V|R,ec=f}function LS(f){f.return!==null&&(Ru(f,1),AT(f,1,0))}function zS(f){for(;f===xy;)xy=Zh[--Rh],Zh[Rh]=null,wy=Zh[--Rh],Zh[Rh]=null;for(;f===Zu;)Zu=Vo[--Fo],Vo[Fo]=null,ec=Vo[--Fo],Vo[Fo]=null,$l=Vo[--Fo],Vo[Fo]=null}var so=null,oo=null,xi=!1,ip=!1,ma=null;function yT(f,C){var G=Eo(5,null,null,0);G.elementType="DELETED",G.stateNode=C,G.return=f,C=f.deletions,C===null?(f.deletions=[G],f.flags|=16):C.push(G)}function bT(f,C){switch(f.tag){case 5:return C=Di(C,f.type,f.pendingProps),C!==null?(f.stateNode=C,so=f,oo=yn(C),!0):!1;case 6:return C=tp(C,f.pendingProps),C!==null?(f.stateNode=C,so=f,oo=null,!0):!1;case 13:if(C=wh(C),C!==null){var G=Zu!==null?{id:$l,overflow:ec}:null;return f.memoizedState={dehydrated:C,treeContext:G,retryLane:1073741824},G=Eo(18,null,null,0),G.stateNode=C,G.return=f,f.child=G,so=f,oo=null,!0}return!1;default:return!1}}function jS(f){return(f.mode&1)!==0&&(f.flags&128)===0}function PS(f){if(xi){var C=oo;if(C){var G=C;if(!bT(f,C)){if(jS(f))throw Error(o(418));C=_s(G);var R=so;C&&bT(f,C)?yT(R,G):(f.flags=f.flags&-4097|2,xi=!1,so=f)}}else{if(jS(f))throw Error(o(418));f.flags=f.flags&-4097|2,xi=!1,so=f}}}function vT(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;so=f}function rp(f){if(!Oe||f!==so)return!1;if(!xi)return vT(f),xi=!0,!1;if(f.tag!==3&&(f.tag!==5||Ct(f.type)&&!Pe(f.type,f.memoizedProps))){var C=oo;if(C){if(jS(f)){for(f=oo;f;)f=_s(f);throw Error(o(418))}for(;C;)yT(f,C),C=_s(C)}}if(vT(f),f.tag===13){if(!Oe)throw Error(o(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));oo=Be(f)}else oo=so?_s(f.stateNode):null;return!0}function Nh(){Oe&&(oo=so=null,ip=xi=!1)}function OS(f){ma===null?ma=[f]:ma.push(f)}function sp(f,C,G){if(f=G.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(G._owner){if(G=G._owner,G){if(G.tag!==1)throw Error(o(309));var R=G.stateNode}if(!R)throw Error(o(147,f));var V=R,X=""+f;return C!==null&&C.ref!==null&&typeof C.ref=="function"&&C.ref._stringRef===X?C.ref:(C=function(ne){var Ie=V.refs;Ie===fT&&(Ie=V.refs={}),ne===null?delete Ie[X]:Ie[X]=ne},C._stringRef=X,C)}if(typeof f!="string")throw Error(o(284));if(!G._owner)throw Error(o(290,f))}return f}function Gy(f,C){throw f=Object.prototype.toString.call(C),Error(o(31,f==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":f))}function xT(f){var C=f._init;return C(f._payload)}function wT(f){function C(we,fe){if(f){var Ne=we.deletions;Ne===null?(we.deletions=[fe],we.flags|=16):Ne.push(fe)}}function G(we,fe){if(!f)return null;for(;fe!==null;)C(we,fe),fe=fe.sibling;return null}function R(we,fe){for(we=new Map;fe!==null;)fe.key!==null?we.set(fe.key,fe):we.set(fe.index,fe),fe=fe.sibling;return we}function V(we,fe){return we=ng(we,fe),we.index=0,we.sibling=null,we}function X(we,fe,Ne){return we.index=Ne,f?(Ne=we.alternate,Ne!==null?(Ne=Ne.index,Ne<fe?(we.flags|=2,fe):Ne):(we.flags|=2,fe)):(we.flags|=1048576,fe)}function ne(we){return f&&we.alternate===null&&(we.flags|=2),we}function Ie(we,fe,Ne,St){return fe===null||fe.tag!==6?(fe=N1(Ne,we.mode,St),fe.return=we,fe):(fe=V(fe,Ne),fe.return=we,fe)}function Te(we,fe,Ne,St){var Lt=Ne.type;return Lt===u?Ft(we,fe,Ne.props.children,St,Ne.key):fe!==null&&(fe.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===v&&xT(Lt)===fe.type)?(St=V(fe,Ne.props),St.ref=sp(we,fe,Ne),St.return=we,St):(St=nb(Ne.type,Ne.key,Ne.props,null,we.mode,St),St.ref=sp(we,fe,Ne),St.return=we,St)}function dt(we,fe,Ne,St){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==Ne.containerInfo||fe.stateNode.implementation!==Ne.implementation?(fe=W1(Ne,we.mode,St),fe.return=we,fe):(fe=V(fe,Ne.children||[]),fe.return=we,fe)}function Ft(we,fe,Ne,St,Lt){return fe===null||fe.tag!==7?(fe=Tu(Ne,we.mode,St,Lt),fe.return=we,fe):(fe=V(fe,Ne),fe.return=we,fe)}function un(we,fe,Ne){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=N1(""+fe,we.mode,Ne),fe.return=we,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case l:return Ne=nb(fe.type,fe.key,fe.props,null,we.mode,Ne),Ne.ref=sp(we,null,fe),Ne.return=we,Ne;case c:return fe=W1(fe,we.mode,Ne),fe.return=we,fe;case v:var St=fe._init;return un(we,St(fe._payload),Ne)}if(z(fe)||B(fe))return fe=Tu(fe,we.mode,Ne,null),fe.return=we,fe;Gy(we,fe)}return null}function Ut(we,fe,Ne,St){var Lt=fe!==null?fe.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return Lt!==null?null:Ie(we,fe,""+Ne,St);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case l:return Ne.key===Lt?Te(we,fe,Ne,St):null;case c:return Ne.key===Lt?dt(we,fe,Ne,St):null;case v:return Lt=Ne._init,Ut(we,fe,Lt(Ne._payload),St)}if(z(Ne)||B(Ne))return Lt!==null?null:Ft(we,fe,Ne,St,null);Gy(we,Ne)}return null}function oi(we,fe,Ne,St,Lt){if(typeof St=="string"&&St!==""||typeof St=="number")return we=we.get(Ne)||null,Ie(fe,we,""+St,Lt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case l:return we=we.get(St.key===null?Ne:St.key)||null,Te(fe,we,St,Lt);case c:return we=we.get(St.key===null?Ne:St.key)||null,dt(fe,we,St,Lt);case v:var bn=St._init;return oi(we,fe,Ne,bn(St._payload),Lt)}if(z(St)||B(St))return we=we.get(Ne)||null,Ft(fe,we,St,Lt,null);Gy(fe,St)}return null}function Ot(we,fe,Ne,St){for(var Lt=null,bn=null,dn=fe,Hn=fe=0,yr=null;dn!==null&&Hn<Ne.length;Hn++){dn.index>Hn?(yr=dn,dn=null):yr=dn.sibling;var Kn=Ut(we,dn,Ne[Hn],St);if(Kn===null){dn===null&&(dn=yr);break}f&&dn&&Kn.alternate===null&&C(we,dn),fe=X(Kn,fe,Hn),bn===null?Lt=Kn:bn.sibling=Kn,bn=Kn,dn=yr}if(Hn===Ne.length)return G(we,dn),xi&&Ru(we,Hn),Lt;if(dn===null){for(;Hn<Ne.length;Hn++)dn=un(we,Ne[Hn],St),dn!==null&&(fe=X(dn,fe,Hn),bn===null?Lt=dn:bn.sibling=dn,bn=dn);return xi&&Ru(we,Hn),Lt}for(dn=R(we,dn);Hn<Ne.length;Hn++)yr=oi(dn,we,Hn,Ne[Hn],St),yr!==null&&(f&&yr.alternate!==null&&dn.delete(yr.key===null?Hn:yr.key),fe=X(yr,fe,Hn),bn===null?Lt=yr:bn.sibling=yr,bn=yr);return f&&dn.forEach(function(ig){return C(we,ig)}),xi&&Ru(we,Hn),Lt}function Lr(we,fe,Ne,St){var Lt=B(Ne);if(typeof Lt!="function")throw Error(o(150));if(Ne=Lt.call(Ne),Ne==null)throw Error(o(151));for(var bn=Lt=null,dn=fe,Hn=fe=0,yr=null,Kn=Ne.next();dn!==null&&!Kn.done;Hn++,Kn=Ne.next()){dn.index>Hn?(yr=dn,dn=null):yr=dn.sibling;var ig=Ut(we,dn,Kn.value,St);if(ig===null){dn===null&&(dn=yr);break}f&&dn&&ig.alternate===null&&C(we,dn),fe=X(ig,fe,Hn),bn===null?Lt=ig:bn.sibling=ig,bn=ig,dn=yr}if(Kn.done)return G(we,dn),xi&&Ru(we,Hn),Lt;if(dn===null){for(;!Kn.done;Hn++,Kn=Ne.next())Kn=un(we,Kn.value,St),Kn!==null&&(fe=X(Kn,fe,Hn),bn===null?Lt=Kn:bn.sibling=Kn,bn=Kn);return xi&&Ru(we,Hn),Lt}for(dn=R(we,dn);!Kn.done;Hn++,Kn=Ne.next())Kn=oi(dn,we,Hn,Kn.value,St),Kn!==null&&(f&&Kn.alternate!==null&&dn.delete(Kn.key===null?Hn:Kn.key),fe=X(Kn,fe,Hn),bn===null?Lt=Kn:bn.sibling=Kn,bn=Kn);return f&&dn.forEach(function(wie){return C(we,wie)}),xi&&Ru(we,Hn),Lt}function Yo(we,fe,Ne,St){if(typeof Ne=="object"&&Ne!==null&&Ne.type===u&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case l:e:{for(var Lt=Ne.key,bn=fe;bn!==null;){if(bn.key===Lt){if(Lt=Ne.type,Lt===u){if(bn.tag===7){G(we,bn.sibling),fe=V(bn,Ne.props.children),fe.return=we,we=fe;break e}}else if(bn.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===v&&xT(Lt)===bn.type){G(we,bn.sibling),fe=V(bn,Ne.props),fe.ref=sp(we,bn,Ne),fe.return=we,we=fe;break e}G(we,bn);break}else C(we,bn);bn=bn.sibling}Ne.type===u?(fe=Tu(Ne.props.children,we.mode,St,Ne.key),fe.return=we,we=fe):(St=nb(Ne.type,Ne.key,Ne.props,null,we.mode,St),St.ref=sp(we,fe,Ne),St.return=we,we=St)}return ne(we);case c:e:{for(bn=Ne.key;fe!==null;){if(fe.key===bn)if(fe.tag===4&&fe.stateNode.containerInfo===Ne.containerInfo&&fe.stateNode.implementation===Ne.implementation){G(we,fe.sibling),fe=V(fe,Ne.children||[]),fe.return=we,we=fe;break e}else{G(we,fe);break}else C(we,fe);fe=fe.sibling}fe=W1(Ne,we.mode,St),fe.return=we,we=fe}return ne(we);case v:return bn=Ne._init,Yo(we,fe,bn(Ne._payload),St)}if(z(Ne))return Ot(we,fe,Ne,St);if(B(Ne))return Lr(we,fe,Ne,St);Gy(we,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"?(Ne=""+Ne,fe!==null&&fe.tag===6?(G(we,fe.sibling),fe=V(fe,Ne),fe.return=we,we=fe):(G(we,fe),fe=N1(Ne,we.mode,St),fe.return=we,we=fe),ne(we)):G(we,fe)}return Yo}var Wh=wT(!0),GT=wT(!1),op={},_o=It(op),ap=It(op),Mh=It(op);function ll(f){if(f===op)throw Error(o(174));return f}function DS(f,C){st(Mh,C),st(ap,f),st(_o,op),f=O(C),at(_o),st(_o,f)}function Vh(){at(_o),at(ap),at(Mh)}function BT(f){var C=ll(Mh.current),G=ll(_o.current);C=_(G,f.type,C),G!==C&&(st(ap,f),st(_o,C))}function US(f){ap.current===f&&(at(_o),at(ap))}var Zi=It(0);function By(f){for(var C=f;C!==null;){if(C.tag===13){var G=C.memoizedState;if(G!==null&&(G=G.dehydrated,G===null||il(G)||ro(G)))return C}else if(C.tag===19&&C.memoizedProps.revealOrder!==void 0){if(C.flags&128)return C}else if(C.child!==null){C.child.return=C,C=C.child;continue}if(C===f)break;for(;C.sibling===null;){if(C.return===null||C.return===f)return null;C=C.return}C.sibling.return=C.return,C=C.sibling}return null}var JS=[];function QS(){for(var f=0;f<JS.length;f++){var C=JS[f];xe?C._workInProgressVersionPrimary=null:C._workInProgressVersionSecondary=null}JS.length=0}var Sy=a.ReactCurrentDispatcher,To=a.ReactCurrentBatchConfig,Fh=0,Xi=null,kr=null,Ar=null,Zy=!1,lp=!1,cp=0,Une=0;function Hr(){throw Error(o(321))}function qS(f,C){if(C===null)return!1;for(var G=0;G<C.length&&G<f.length;G++)if(!sl(f[G],C[G]))return!1;return!0}function $S(f,C,G,R,V,X){if(Fh=X,Xi=C,C.memoizedState=null,C.updateQueue=null,C.lanes=0,Sy.current=f===null||f.memoizedState===null?$ne:eie,f=G(R,V),lp){X=0;do{if(lp=!1,cp=0,25<=X)throw Error(o(301));X+=1,Ar=kr=null,C.updateQueue=null,Sy.current=tie,f=G(R,V)}while(lp)}if(Sy.current=Vy,C=kr!==null&&kr.next!==null,Fh=0,Ar=kr=Xi=null,Zy=!1,C)throw Error(o(300));return f}function e1(){var f=cp!==0;return cp=0,f}function tc(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Xi.memoizedState=Ar=f:Ar=Ar.next=f,Ar}function cl(){if(kr===null){var f=Xi.alternate;f=f!==null?f.memoizedState:null}else f=kr.next;var C=Ar===null?Xi.memoizedState:Ar.next;if(C!==null)Ar=C,kr=f;else{if(f===null)throw Error(o(310));kr=f,f={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Ar===null?Xi.memoizedState=Ar=f:Ar=Ar.next=f}return Ar}function Nu(f,C){return typeof C=="function"?C(f):C}function Ry(f){var C=cl(),G=C.queue;if(G===null)throw Error(o(311));G.lastRenderedReducer=f;var R=kr,V=R.baseQueue,X=G.pending;if(X!==null){if(V!==null){var ne=V.next;V.next=X.next,X.next=ne}R.baseQueue=V=X,G.pending=null}if(V!==null){X=V.next,R=R.baseState;var Ie=ne=null,Te=null,dt=X;do{var Ft=dt.lane;if((Fh&Ft)===Ft)Te!==null&&(Te=Te.next={lane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),R=dt.hasEagerState?dt.eagerState:f(R,dt.action);else{var un={lane:Ft,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null};Te===null?(Ie=Te=un,ne=R):Te=Te.next=un,Xi.lanes|=Ft,Th|=Ft}dt=dt.next}while(dt!==null&&dt!==X);Te===null?ne=R:Te.next=Ie,sl(R,C.memoizedState)||(ao=!0),C.memoizedState=R,C.baseState=ne,C.baseQueue=Te,G.lastRenderedState=R}if(f=G.interleaved,f!==null){V=f;do X=V.lane,Xi.lanes|=X,Th|=X,V=V.next;while(V!==f)}else V===null&&(G.lanes=0);return[C.memoizedState,G.dispatch]}function Ny(f){var C=cl(),G=C.queue;if(G===null)throw Error(o(311));G.lastRenderedReducer=f;var R=G.dispatch,V=G.pending,X=C.memoizedState;if(V!==null){G.pending=null;var ne=V=V.next;do X=f(X,ne.action),ne=ne.next;while(ne!==V);sl(X,C.memoizedState)||(ao=!0),C.memoizedState=X,C.baseQueue===null&&(C.baseState=X),G.lastRenderedState=X}return[X,R]}function ST(){}function ZT(f,C){var G=Xi,R=cl(),V=C(),X=!sl(R.memoizedState,V);if(X&&(R.memoizedState=V,ao=!0),R=R.queue,up(WT.bind(null,G,R,f),[f]),R.getSnapshot!==C||X||Ar!==null&&Ar.memoizedState.tag&1){if(G.flags|=2048,gp(9,NT.bind(null,G,R,V,C),void 0,null),Ji===null)throw Error(o(349));Fh&30||RT(G,C,V)}return V}function RT(f,C,G){f.flags|=16384,f={getSnapshot:C,value:G},C=Xi.updateQueue,C===null?(C={lastEffect:null,stores:null},Xi.updateQueue=C,C.stores=[f]):(G=C.stores,G===null?C.stores=[f]:G.push(f))}function NT(f,C,G,R){C.value=G,C.getSnapshot=R,MT(C)&&Xo(f,1,-1)}function WT(f,C,G){return G(function(){MT(C)&&Xo(f,1,-1)})}function MT(f){var C=f.getSnapshot;f=f.value;try{var G=C();return!sl(f,G)}catch{return!0}}function t1(f){var C=tc();return typeof f=="function"&&(f=f()),C.memoizedState=C.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nu,lastRenderedState:f},C.queue=f,f=f.dispatch=qne.bind(null,Xi,f),[C.memoizedState,f]}function gp(f,C,G,R){return f={tag:f,create:C,destroy:G,deps:R,next:null},C=Xi.updateQueue,C===null?(C={lastEffect:null,stores:null},Xi.updateQueue=C,C.lastEffect=f.next=f):(G=C.lastEffect,G===null?C.lastEffect=f.next=f:(R=G.next,G.next=f,f.next=R,C.lastEffect=f)),f}function VT(){return cl().memoizedState}function Wy(f,C,G,R){var V=tc();Xi.flags|=f,V.memoizedState=gp(1|C,G,void 0,R===void 0?null:R)}function My(f,C,G,R){var V=cl();R=R===void 0?null:R;var X=void 0;if(kr!==null){var ne=kr.memoizedState;if(X=ne.destroy,R!==null&&qS(R,ne.deps)){V.memoizedState=gp(C,G,X,R);return}}Xi.flags|=f,V.memoizedState=gp(1|C,G,X,R)}function n1(f,C){return Wy(8390656,8,f,C)}function up(f,C){return My(2048,8,f,C)}function FT(f,C){return My(4,2,f,C)}function _T(f,C){return My(4,4,f,C)}function TT(f,C){if(typeof C=="function")return f=f(),C(f),function(){C(null)};if(C!=null)return f=f(),C.current=f,function(){C.current=null}}function XT(f,C,G){return G=G!=null?G.concat([f]):null,My(4,4,TT.bind(null,C,f),G)}function i1(){}function ET(f,C){var G=cl();C=C===void 0?null:C;var R=G.memoizedState;return R!==null&&C!==null&&qS(C,R[1])?R[0]:(G.memoizedState=[f,C],f)}function YT(f,C){var G=cl();C=C===void 0?null:C;var R=G.memoizedState;return R!==null&&C!==null&&qS(C,R[1])?R[0]:(f=f(),G.memoizedState=[f,C],f)}function Jne(f,C){var G=kn;kn=G!==0&&4>G?G:4,f(!0);var R=To.transition;To.transition={};try{f(!1),C()}finally{kn=G,To.transition=R}}function kT(){return cl().memoizedState}function Qne(f,C,G){var R=eg(f);G={lane:R,action:G,hasEagerState:!1,eagerState:null,next:null},HT(f)?KT(C,G):(LT(f,C,G),G=cs(),f=Xo(f,R,G),f!==null&&zT(f,C,R))}function qne(f,C,G){var R=eg(f),V={lane:R,action:G,hasEagerState:!1,eagerState:null,next:null};if(HT(f))KT(C,V);else{LT(f,C,V);var X=f.alternate;if(f.lanes===0&&(X===null||X.lanes===0)&&(X=C.lastRenderedReducer,X!==null))try{var ne=C.lastRenderedState,Ie=X(ne,G);if(V.hasEagerState=!0,V.eagerState=Ie,sl(Ie,ne))return}catch{}finally{}G=cs(),f=Xo(f,R,G),f!==null&&zT(f,C,R)}}function HT(f){var C=f.alternate;return f===Xi||C!==null&&C===Xi}function KT(f,C){lp=Zy=!0;var G=f.pending;G===null?C.next=C:(C.next=G.next,G.next=C),f.pending=C}function LT(f,C,G){Ji!==null&&f.mode&1&&!(wn&2)?(f=C.interleaved,f===null?(G.next=G,al===null?al=[C]:al.push(C)):(G.next=f.next,f.next=G),C.interleaved=G):(f=C.pending,f===null?G.next=G:(G.next=f.next,f.next=G),C.pending=G)}function zT(f,C,G){if(G&4194240){var R=C.lanes;R&=f.pendingLanes,G|=R,C.lanes=G,WS(f,G)}}var Vy={readContext:Mo,useCallback:Hr,useContext:Hr,useEffect:Hr,useImperativeHandle:Hr,useInsertionEffect:Hr,useLayoutEffect:Hr,useMemo:Hr,useReducer:Hr,useRef:Hr,useState:Hr,useDebugValue:Hr,useDeferredValue:Hr,useTransition:Hr,useMutableSource:Hr,useSyncExternalStore:Hr,useId:Hr,unstable_isNewReconciler:!1},$ne={readContext:Mo,useCallback:function(f,C){return tc().memoizedState=[f,C===void 0?null:C],f},useContext:Mo,useEffect:n1,useImperativeHandle:function(f,C,G){return G=G!=null?G.concat([f]):null,Wy(4194308,4,TT.bind(null,C,f),G)},useLayoutEffect:function(f,C){return Wy(4194308,4,f,C)},useInsertionEffect:function(f,C){return Wy(4,2,f,C)},useMemo:function(f,C){var G=tc();return C=C===void 0?null:C,f=f(),G.memoizedState=[f,C],f},useReducer:function(f,C,G){var R=tc();return C=G!==void 0?G(C):C,R.memoizedState=R.baseState=C,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:C},R.queue=f,f=f.dispatch=Qne.bind(null,Xi,f),[R.memoizedState,f]},useRef:function(f){var C=tc();return f={current:f},C.memoizedState=f},useState:t1,useDebugValue:i1,useDeferredValue:function(f){var C=t1(f),G=C[0],R=C[1];return n1(function(){var V=To.transition;To.transition={};try{R(f)}finally{To.transition=V}},[f]),G},useTransition:function(){var f=t1(!1),C=f[0];return f=Jne.bind(null,f[1]),tc().memoizedState=f,[C,f]},useMutableSource:function(){},useSyncExternalStore:function(f,C,G){var R=Xi,V=tc();if(xi){if(G===void 0)throw Error(o(407));G=G()}else{if(G=C(),Ji===null)throw Error(o(349));Fh&30||RT(R,C,G)}V.memoizedState=G;var X={value:G,getSnapshot:C};return V.queue=X,n1(WT.bind(null,R,X,f),[f]),R.flags|=2048,gp(9,NT.bind(null,R,X,G,C),void 0,null),G},useId:function(){var f=tc(),C=Ji.identifierPrefix;if(xi){var G=ec,R=$l;G=(R&~(1<<32-On(R)-1)).toString(32)+G,C=":"+C+"R"+G,G=cp++,0<G&&(C+="H"+G.toString(32)),C+=":"}else G=Une++,C=":"+C+"r"+G.toString(32)+":";return f.memoizedState=C},unstable_isNewReconciler:!1},eie={readContext:Mo,useCallback:ET,useContext:Mo,useEffect:up,useImperativeHandle:XT,useInsertionEffect:FT,useLayoutEffect:_T,useMemo:YT,useReducer:Ry,useRef:VT,useState:function(){return Ry(Nu)},useDebugValue:i1,useDeferredValue:function(f){var C=Ry(Nu),G=C[0],R=C[1];return up(function(){var V=To.transition;To.transition={};try{R(f)}finally{To.transition=V}},[f]),G},useTransition:function(){var f=Ry(Nu)[0],C=cl().memoizedState;return[f,C]},useMutableSource:ST,useSyncExternalStore:ZT,useId:kT,unstable_isNewReconciler:!1},tie={readContext:Mo,useCallback:ET,useContext:Mo,useEffect:up,useImperativeHandle:XT,useInsertionEffect:FT,useLayoutEffect:_T,useMemo:YT,useReducer:Ny,useRef:VT,useState:function(){return Ny(Nu)},useDebugValue:i1,useDeferredValue:function(f){var C=Ny(Nu),G=C[0],R=C[1];return up(function(){var V=To.transition;To.transition={};try{R(f)}finally{To.transition=V}},[f]),G},useTransition:function(){var f=Ny(Nu)[0],C=cl().memoizedState;return[f,C]},useMutableSource:ST,useSyncExternalStore:ZT,useId:kT,unstable_isNewReconciler:!1};function r1(f,C){try{var G="",R=C;do G+=Dne(R),R=R.return;while(R);var V=G}catch(X){V=`
Error generating stack: `+X.message+`
`+X.stack}return{value:f,source:C,stack:V}}function s1(f,C){try{console.error(C.value)}catch(G){setTimeout(function(){throw G})}}var nie=typeof WeakMap=="function"?WeakMap:Map;function jT(f,C,G){G=ql(-1,G),G.tag=3,G.payload={element:null};var R=C.value;return G.callback=function(){Uy||(Uy=!0,x1=R),s1(f,C)},G}function PT(f,C,G){G=ql(-1,G),G.tag=3;var R=f.type.getDerivedStateFromError;if(typeof R=="function"){var V=C.value;G.payload=function(){return R(V)},G.callback=function(){s1(f,C)}}var X=f.stateNode;return X!==null&&typeof X.componentDidCatch=="function"&&(G.callback=function(){s1(f,C),typeof R!="function"&&(qc===null?qc=new Set([this]):qc.add(this));var ne=C.stack;this.componentDidCatch(C.value,{componentStack:ne!==null?ne:""})}),G}function OT(f,C,G){var R=f.pingCache;if(R===null){R=f.pingCache=new nie;var V=new Set;R.set(C,V)}else V=R.get(C),V===void 0&&(V=new Set,R.set(C,V));V.has(G)||(V.add(G),f=Cie.bind(null,f,C,G),C.then(f,f))}function DT(f){do{var C;if((C=f.tag===13)&&(C=f.memoizedState,C=C!==null?C.dehydrated!==null:!0),C)return f;f=f.return}while(f!==null);return null}function UT(f,C,G,R,V){return f.mode&1?(f.flags|=65536,f.lanes=V,f):(f===C?f.flags|=65536:(f.flags|=128,G.flags|=131072,G.flags&=-52805,G.tag===1&&(G.alternate===null?G.tag=17:(C=ql(-1,1),C.tag=2,Qc(G,C))),G.lanes|=1),f)}function gl(f){f.flags|=4}function JT(f,C){if(f!==null&&f.child===C.child)return!0;if(C.flags&16)return!1;for(f=C.child;f!==null;){if(f.flags&12854||f.subtreeFlags&12854)return!1;f=f.sibling}return!0}var dp,hp,Fy,_y;if(Ge)dp=function(f,C){for(var G=C.child;G!==null;){if(G.tag===5||G.tag===6)re(f,G.stateNode);else if(G.tag!==4&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===C)break;for(;G.sibling===null;){if(G.return===null||G.return===C)return;G=G.return}G.sibling.return=G.return,G=G.sibling}},hp=function(){},Fy=function(f,C,G,R,V){if(f=f.memoizedProps,f!==R){var X=C.stateNode,ne=ll(_o.current);G=Re(X,G,f,R,V,ne),(C.updateQueue=G)&&gl(C)}},_y=function(f,C,G,R){G!==R&&gl(C)};else if(pe){dp=function(f,C,G,R){for(var V=C.child;V!==null;){if(V.tag===5){var X=V.stateNode;G&&R&&(X=xn(X,V.type,V.memoizedProps,V)),re(f,X)}else if(V.tag===6)X=V.stateNode,G&&R&&(X=zi(X,V.memoizedProps,V)),re(f,X);else if(V.tag!==4){if(V.tag===22&&V.memoizedState!==null)X=V.child,X!==null&&(X.return=V),dp(f,V,!0,!0);else if(V.child!==null){V.child.return=V,V=V.child;continue}}if(V===C)break;for(;V.sibling===null;){if(V.return===null||V.return===C)return;V=V.return}V.sibling.return=V.return,V=V.sibling}};var QT=function(f,C,G,R){for(var V=C.child;V!==null;){if(V.tag===5){var X=V.stateNode;G&&R&&(X=xn(X,V.type,V.memoizedProps,V)),yt(f,X)}else if(V.tag===6)X=V.stateNode,G&&R&&(X=zi(X,V.memoizedProps,V)),yt(f,X);else if(V.tag!==4){if(V.tag===22&&V.memoizedState!==null)X=V.child,X!==null&&(X.return=V),QT(f,V,!0,!0);else if(V.child!==null){V.child.return=V,V=V.child;continue}}if(V===C)break;for(;V.sibling===null;){if(V.return===null||V.return===C)return;V=V.return}V.sibling.return=V.return,V=V.sibling}};hp=function(f,C){var G=C.stateNode;if(!JT(f,C)){f=G.containerInfo;var R=ze(f);QT(R,C,!1,!1),G.pendingChildren=R,gl(C),Kt(f,R)}},Fy=function(f,C,G,R,V){var X=f.stateNode,ne=f.memoizedProps;if((f=JT(f,C))&&ne===R)C.stateNode=X;else{var Ie=C.stateNode,Te=ll(_o.current),dt=null;ne!==R&&(dt=Re(Ie,G,ne,R,V,Te)),f&&dt===null?C.stateNode=X:(X=rt(X,dt,G,ne,R,C,f,Ie),de(X,G,R,V,Te)&&gl(C),C.stateNode=X,f?gl(C):dp(X,C,!1,!1))}},_y=function(f,C,G,R){G!==R?(f=ll(Mh.current),G=ll(_o.current),C.stateNode=ae(R,f,G,C),gl(C)):C.stateNode=f.stateNode}}else hp=function(){},Fy=function(){},_y=function(){};function Ip(f,C){if(!xi)switch(f.tailMode){case"hidden":C=f.tail;for(var G=null;C!==null;)C.alternate!==null&&(G=C),C=C.sibling;G===null?f.tail=null:G.sibling=null;break;case"collapsed":G=f.tail;for(var R=null;G!==null;)G.alternate!==null&&(R=G),G=G.sibling;R===null?C||f.tail===null?f.tail=null:f.tail.sibling=null:R.sibling=null}}function Kr(f){var C=f.alternate!==null&&f.alternate.child===f.child,G=0,R=0;if(C)for(var V=f.child;V!==null;)G|=V.lanes|V.childLanes,R|=V.subtreeFlags&14680064,R|=V.flags&14680064,V.return=f,V=V.sibling;else for(V=f.child;V!==null;)G|=V.lanes|V.childLanes,R|=V.subtreeFlags,R|=V.flags,V.return=f,V=V.sibling;return f.subtreeFlags|=R,f.childLanes=G,C}function iie(f,C,G){var R=C.pendingProps;switch(zS(C),C.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(C),null;case 1:return Bt(C.type)&&Cn(),Kr(C),null;case 3:return R=C.stateNode,Vh(),at(Tt),at(Dt),QS(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(f===null||f.child===null)&&(rp(C)?gl(C):f===null||f.memoizedState.isDehydrated&&!(C.flags&256)||(C.flags|=1024,ma!==null&&(B1(ma),ma=null))),hp(f,C),Kr(C),null;case 5:US(C),G=ll(Mh.current);var V=C.type;if(f!==null&&C.stateNode!=null)Fy(f,C,V,R,G),f.ref!==C.ref&&(C.flags|=512,C.flags|=2097152);else{if(!R){if(C.stateNode===null)throw Error(o(166));return Kr(C),null}if(f=ll(_o.current),rp(C)){if(!Oe)throw Error(o(175));f=Y(C.stateNode,C.type,C.memoizedProps,G,f,C,!ip),C.updateQueue=f,f!==null&&gl(C)}else{var X=q(V,R,G,f,C);dp(X,C,!1,!1),C.stateNode=X,de(X,V,R,G,f)&&gl(C)}C.ref!==null&&(C.flags|=512,C.flags|=2097152)}return Kr(C),null;case 6:if(f&&C.stateNode!=null)_y(f,C,f.memoizedProps,R);else{if(typeof R!="string"&&C.stateNode===null)throw Error(o(166));if(f=ll(Mh.current),G=ll(_o.current),rp(C)){if(!Oe)throw Error(o(176));if(f=C.stateNode,R=C.memoizedProps,(G=D(f,R,C,!ip))&&(V=so,V!==null))switch(X=(V.mode&1)!==0,V.tag){case 3:k(V.stateNode.containerInfo,f,R,X);break;case 5:ie(V.type,V.memoizedProps,V.stateNode,f,R,X)}G&&gl(C)}else C.stateNode=ae(R,f,G,C)}return Kr(C),null;case 13:if(at(Zi),R=C.memoizedState,xi&&oo!==null&&C.mode&1&&!(C.flags&128)){for(f=oo;f;)f=_s(f);return Nh(),C.flags|=98560,C}if(R!==null&&R.dehydrated!==null){if(R=rp(C),f===null){if(!R)throw Error(o(318));if(!Oe)throw Error(o(344));if(f=C.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));ge(f,C)}else Nh(),!(C.flags&128)&&(C.memoizedState=null),C.flags|=4;return Kr(C),null}return ma!==null&&(B1(ma),ma=null),C.flags&128?(C.lanes=G,C):(R=R!==null,G=!1,f===null?rp(C):G=f.memoizedState!==null,R&&!G&&(C.child.flags|=8192,C.mode&1&&(f===null||Zi.current&1?sr===0&&(sr=3):Z1())),C.updateQueue!==null&&(C.flags|=4),Kr(C),null);case 4:return Vh(),hp(f,C),f===null&&U(C.stateNode.containerInfo),Kr(C),null;case 10:return ES(C.type._context),Kr(C),null;case 17:return Bt(C.type)&&Cn(),Kr(C),null;case 19:if(at(Zi),V=C.memoizedState,V===null)return Kr(C),null;if(R=(C.flags&128)!==0,X=V.rendering,X===null)if(R)Ip(V,!1);else{if(sr!==0||f!==null&&f.flags&128)for(f=C.child;f!==null;){if(X=By(f),X!==null){for(C.flags|=128,Ip(V,!1),f=X.updateQueue,f!==null&&(C.updateQueue=f,C.flags|=4),C.subtreeFlags=0,f=G,R=C.child;R!==null;)G=R,V=f,G.flags&=14680066,X=G.alternate,X===null?(G.childLanes=0,G.lanes=V,G.child=null,G.subtreeFlags=0,G.memoizedProps=null,G.memoizedState=null,G.updateQueue=null,G.dependencies=null,G.stateNode=null):(G.childLanes=X.childLanes,G.lanes=X.lanes,G.child=X.child,G.subtreeFlags=0,G.deletions=null,G.memoizedProps=X.memoizedProps,G.memoizedState=X.memoizedState,G.updateQueue=X.updateQueue,G.type=X.type,V=X.dependencies,G.dependencies=V===null?null:{lanes:V.lanes,firstContext:V.firstContext}),R=R.sibling;return st(Zi,Zi.current&1|2),C.child}f=f.sibling}V.tail!==null&&mr()>v1&&(C.flags|=128,R=!0,Ip(V,!1),C.lanes=4194304)}else{if(!R)if(f=By(X),f!==null){if(C.flags|=128,R=!0,f=f.updateQueue,f!==null&&(C.updateQueue=f,C.flags|=4),Ip(V,!0),V.tail===null&&V.tailMode==="hidden"&&!X.alternate&&!xi)return Kr(C),null}else 2*mr()-V.renderingStartTime>v1&&G!==1073741824&&(C.flags|=128,R=!0,Ip(V,!1),C.lanes=4194304);V.isBackwards?(X.sibling=C.child,C.child=X):(f=V.last,f!==null?f.sibling=X:C.child=X,V.last=X)}return V.tail!==null?(C=V.tail,V.rendering=C,V.tail=C.sibling,V.renderingStartTime=mr(),C.sibling=null,f=Zi.current,st(Zi,R?f&1|2:f&1),C):(Kr(C),null);case 22:case 23:return S1(),R=C.memoizedState!==null,f!==null&&f.memoizedState!==null!==R&&(C.flags|=8192),R&&C.mode&1?lo&1073741824&&(Kr(C),Ge&&C.subtreeFlags&6&&(C.flags|=8192)):Kr(C),null;case 24:return null;case 25:return null}throw Error(o(156,C.tag))}var rie=a.ReactCurrentOwner,ao=!1;function ls(f,C,G,R){C.child=f===null?GT(C,null,G,R):Wh(C,f.child,G,R)}function qT(f,C,G,R,V){G=G.render;var X=C.ref;return Sh(C,V),R=$S(f,C,G,R,X,V),G=e1(),f!==null&&!ao?(C.updateQueue=f.updateQueue,C.flags&=-2053,f.lanes&=~V,nc(f,C,V)):(xi&&G&&LS(C),C.flags|=1,ls(f,C,R,V),C.child)}function $T(f,C,G,R,V){if(f===null){var X=G.type;return typeof X=="function"&&!R1(X)&&X.defaultProps===void 0&&G.compare===null&&G.defaultProps===void 0?(C.tag=15,C.type=X,eX(f,C,X,R,V)):(f=nb(G.type,null,R,C,C.mode,V),f.ref=C.ref,f.return=C,C.child=f)}if(X=f.child,!(f.lanes&V)){var ne=X.memoizedProps;if(G=G.compare,G=G!==null?G:py,G(ne,R)&&f.ref===C.ref)return nc(f,C,V)}return C.flags|=1,f=ng(X,R),f.ref=C.ref,f.return=C,C.child=f}function eX(f,C,G,R,V){if(f!==null&&py(f.memoizedProps,R)&&f.ref===C.ref)if(ao=!1,(f.lanes&V)!==0)f.flags&131072&&(ao=!0);else return C.lanes=f.lanes,nc(f,C,V);return o1(f,C,G,R,V)}function tX(f,C,G){var R=C.pendingProps,V=R.children,X=f!==null?f.memoizedState:null;if(R.mode==="hidden")if(!(C.mode&1))C.memoizedState={baseLanes:0,cachePool:null},st(_h,lo),lo|=G;else if(G&1073741824)C.memoizedState={baseLanes:0,cachePool:null},R=X!==null?X.baseLanes:G,st(_h,lo),lo|=R;else return f=X!==null?X.baseLanes|G:G,C.lanes=C.childLanes=1073741824,C.memoizedState={baseLanes:f,cachePool:null},C.updateQueue=null,st(_h,lo),lo|=f,null;else X!==null?(R=X.baseLanes|G,C.memoizedState=null):R=G,st(_h,lo),lo|=R;return ls(f,C,V,G),C.child}function nX(f,C){var G=C.ref;(f===null&&G!==null||f!==null&&f.ref!==G)&&(C.flags|=512,C.flags|=2097152)}function o1(f,C,G,R,V){var X=Bt(G)?rn:Dt.current;return X=cn(C,X),Sh(C,V),G=$S(f,C,G,R,X,V),R=e1(),f!==null&&!ao?(C.updateQueue=f.updateQueue,C.flags&=-2053,f.lanes&=~V,nc(f,C,V)):(xi&&R&&LS(C),C.flags|=1,ls(f,C,G,V),C.child)}function iX(f,C,G,R,V){if(Bt(G)){var X=!0;Nn(C)}else X=!1;if(Sh(C,V),C.stateNode===null)f!==null&&(f.alternate=null,C.alternate=null,C.flags|=2),pT(C,G,R),KS(C,G,R,V),R=!0;else if(f===null){var ne=C.stateNode,Ie=C.memoizedProps;ne.props=Ie;var Te=ne.context,dt=G.contextType;typeof dt=="object"&&dt!==null?dt=Mo(dt):(dt=Bt(G)?rn:Dt.current,dt=cn(C,dt));var Ft=G.getDerivedStateFromProps,un=typeof Ft=="function"||typeof ne.getSnapshotBeforeUpdate=="function";un||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(Ie!==R||Te!==dt)&&mT(C,ne,R,dt),Jc=!1;var Ut=C.memoizedState;ne.state=Ut,by(C,R,ne,V),Te=C.memoizedState,Ie!==R||Ut!==Te||Tt.current||Jc?(typeof Ft=="function"&&(HS(C,G,Ft,R),Te=C.memoizedState),(Ie=Jc||CT(C,G,Ie,R,Ut,Te,dt))?(un||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(C.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(C.flags|=4194308),C.memoizedProps=R,C.memoizedState=Te),ne.props=R,ne.state=Te,ne.context=dt,R=Ie):(typeof ne.componentDidMount=="function"&&(C.flags|=4194308),R=!1)}else{ne=C.stateNode,dT(f,C),Ie=C.memoizedProps,dt=C.type===C.elementType?Ie:pa(C.type,Ie),ne.props=dt,un=C.pendingProps,Ut=ne.context,Te=G.contextType,typeof Te=="object"&&Te!==null?Te=Mo(Te):(Te=Bt(G)?rn:Dt.current,Te=cn(C,Te));var oi=G.getDerivedStateFromProps;(Ft=typeof oi=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(Ie!==un||Ut!==Te)&&mT(C,ne,R,Te),Jc=!1,Ut=C.memoizedState,ne.state=Ut,by(C,R,ne,V);var Ot=C.memoizedState;Ie!==un||Ut!==Ot||Tt.current||Jc?(typeof oi=="function"&&(HS(C,G,oi,R),Ot=C.memoizedState),(dt=Jc||CT(C,G,dt,R,Ut,Ot,Te)||!1)?(Ft||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(R,Ot,Te),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(R,Ot,Te)),typeof ne.componentDidUpdate=="function"&&(C.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(C.flags|=1024)):(typeof ne.componentDidUpdate!="function"||Ie===f.memoizedProps&&Ut===f.memoizedState||(C.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||Ie===f.memoizedProps&&Ut===f.memoizedState||(C.flags|=1024),C.memoizedProps=R,C.memoizedState=Ot),ne.props=R,ne.state=Ot,ne.context=Te,R=dt):(typeof ne.componentDidUpdate!="function"||Ie===f.memoizedProps&&Ut===f.memoizedState||(C.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||Ie===f.memoizedProps&&Ut===f.memoizedState||(C.flags|=1024),R=!1)}return a1(f,C,G,R,X,V)}function a1(f,C,G,R,V,X){nX(f,C);var ne=(C.flags&128)!==0;if(!R&&!ne)return V&&an(C,G,!1),nc(f,C,X);R=C.stateNode,rie.current=C;var Ie=ne&&typeof G.getDerivedStateFromError!="function"?null:R.render();return C.flags|=1,f!==null&&ne?(C.child=Wh(C,f.child,null,X),C.child=Wh(C,null,Ie,X)):ls(f,C,Ie,X),C.memoizedState=R.state,V&&an(C,G,!0),C.child}function rX(f){var C=f.stateNode;C.pendingContext?Xt(f,C.pendingContext,C.pendingContext!==C.context):C.context&&Xt(f,C.context,!1),DS(f,C.containerInfo)}function sX(f,C,G,R,V){return Nh(),OS(V),C.flags|=256,ls(f,C,G,R),C.child}var Ty={dehydrated:null,treeContext:null,retryLane:0};function Xy(f){return{baseLanes:f,cachePool:null}}function oX(f,C,G){var R=C.pendingProps,V=Zi.current,X=!1,ne=(C.flags&128)!==0,Ie;if((Ie=ne)||(Ie=f!==null&&f.memoizedState===null?!1:(V&2)!==0),Ie?(X=!0,C.flags&=-129):(f===null||f.memoizedState!==null)&&(V|=1),st(Zi,V&1),f===null)return PS(C),f=C.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(C.mode&1?ro(f)?C.lanes=8:C.lanes=1073741824:C.lanes=1,null):(V=R.children,f=R.fallback,X?(R=C.mode,X=C.child,V={mode:"hidden",children:V},!(R&1)&&X!==null?(X.childLanes=0,X.pendingProps=V):X=ib(V,R,0,null),f=Tu(f,R,G,null),X.return=C,f.return=C,X.sibling=f,C.child=X,C.child.memoizedState=Xy(G),C.memoizedState=Ty,f):l1(C,V));if(V=f.memoizedState,V!==null){if(Ie=V.dehydrated,Ie!==null){if(ne)return C.flags&256?(C.flags&=-257,Ey(f,C,G,Error(o(422)))):C.memoizedState!==null?(C.child=f.child,C.flags|=128,null):(X=R.fallback,V=C.mode,R=ib({mode:"visible",children:R.children},V,0,null),X=Tu(X,V,G,null),X.flags|=2,R.return=C,X.return=C,R.sibling=X,C.child=R,C.mode&1&&Wh(C,f.child,null,G),C.child.memoizedState=Xy(G),C.memoizedState=Ty,X);if(!(C.mode&1))C=Ey(f,C,G,null);else if(ro(Ie))C=Ey(f,C,G,Error(o(419)));else if(R=(G&f.childLanes)!==0,ao||R){if(R=Ji,R!==null){switch(G&-G){case 4:X=2;break;case 16:X=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:X=32;break;case 536870912:X=268435456;break;default:X=0}R=X&(R.suspendedLanes|G)?0:X,R!==0&&R!==V.retryLane&&(V.retryLane=R,Xo(f,R,-1))}Z1(),C=Ey(f,C,G,Error(o(421)))}else il(Ie)?(C.flags|=128,C.child=f.child,C=pie.bind(null,f),Ca(Ie,C),C=null):(G=V.treeContext,Oe&&(oo=Gh(Ie),so=C,xi=!0,ma=null,ip=!1,G!==null&&(Vo[Fo++]=$l,Vo[Fo++]=ec,Vo[Fo++]=Zu,$l=G.id,ec=G.overflow,Zu=C)),C=l1(C,C.pendingProps.children),C.flags|=4096);return C}return X?(R=lX(f,C,R.children,R.fallback,G),X=C.child,V=f.child.memoizedState,X.memoizedState=V===null?Xy(G):{baseLanes:V.baseLanes|G,cachePool:null},X.childLanes=f.childLanes&~G,C.memoizedState=Ty,R):(G=aX(f,C,R.children,G),C.memoizedState=null,G)}return X?(R=lX(f,C,R.children,R.fallback,G),X=C.child,V=f.child.memoizedState,X.memoizedState=V===null?Xy(G):{baseLanes:V.baseLanes|G,cachePool:null},X.childLanes=f.childLanes&~G,C.memoizedState=Ty,R):(G=aX(f,C,R.children,G),C.memoizedState=null,G)}function l1(f,C){return C=ib({mode:"visible",children:C},f.mode,0,null),C.return=f,f.child=C}function aX(f,C,G,R){var V=f.child;return f=V.sibling,G=ng(V,{mode:"visible",children:G}),!(C.mode&1)&&(G.lanes=R),G.return=C,G.sibling=null,f!==null&&(R=C.deletions,R===null?(C.deletions=[f],C.flags|=16):R.push(f)),C.child=G}function lX(f,C,G,R,V){var X=C.mode;f=f.child;var ne=f.sibling,Ie={mode:"hidden",children:G};return!(X&1)&&C.child!==f?(G=C.child,G.childLanes=0,G.pendingProps=Ie,C.deletions=null):(G=ng(f,Ie),G.subtreeFlags=f.subtreeFlags&14680064),ne!==null?R=ng(ne,R):(R=Tu(R,X,V,null),R.flags|=2),R.return=C,G.return=C,G.sibling=R,C.child=G,R}function Ey(f,C,G,R){return R!==null&&OS(R),Wh(C,f.child,null,G),f=l1(C,C.pendingProps.children),f.flags|=2,C.memoizedState=null,f}function cX(f,C,G){f.lanes|=C;var R=f.alternate;R!==null&&(R.lanes|=C),YS(f.return,C,G)}function c1(f,C,G,R,V){var X=f.memoizedState;X===null?f.memoizedState={isBackwards:C,rendering:null,renderingStartTime:0,last:R,tail:G,tailMode:V}:(X.isBackwards=C,X.rendering=null,X.renderingStartTime=0,X.last=R,X.tail=G,X.tailMode=V)}function gX(f,C,G){var R=C.pendingProps,V=R.revealOrder,X=R.tail;if(ls(f,C,R.children,G),R=Zi.current,R&2)R=R&1|2,C.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=C.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&cX(f,G,C);else if(f.tag===19)cX(f,G,C);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===C)break e;for(;f.sibling===null;){if(f.return===null||f.return===C)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}R&=1}if(st(Zi,R),!(C.mode&1))C.memoizedState=null;else switch(V){case"forwards":for(G=C.child,V=null;G!==null;)f=G.alternate,f!==null&&By(f)===null&&(V=G),G=G.sibling;G=V,G===null?(V=C.child,C.child=null):(V=G.sibling,G.sibling=null),c1(C,!1,V,G,X);break;case"backwards":for(G=null,V=C.child,C.child=null;V!==null;){if(f=V.alternate,f!==null&&By(f)===null){C.child=V;break}f=V.sibling,V.sibling=G,G=V,V=f}c1(C,!0,G,null,X);break;case"together":c1(C,!1,null,null,void 0);break;default:C.memoizedState=null}return C.child}function nc(f,C,G){if(f!==null&&(C.dependencies=f.dependencies),Th|=C.lanes,!(G&C.childLanes))return null;if(f!==null&&C.child!==f.child)throw Error(o(153));if(C.child!==null){for(f=C.child,G=ng(f,f.pendingProps),C.child=G,G.return=C;f.sibling!==null;)f=f.sibling,G=G.sibling=ng(f,f.pendingProps),G.return=C;G.sibling=null}return C.child}function sie(f,C,G){switch(C.tag){case 3:rX(C),Nh();break;case 5:BT(C);break;case 1:Bt(C.type)&&Nn(C);break;case 4:DS(C,C.stateNode.containerInfo);break;case 10:uT(C,C.type._context,C.memoizedProps.value);break;case 13:var R=C.memoizedState;if(R!==null)return R.dehydrated!==null?(st(Zi,Zi.current&1),C.flags|=128,null):G&C.child.childLanes?oX(f,C,G):(st(Zi,Zi.current&1),f=nc(f,C,G),f!==null?f.sibling:null);st(Zi,Zi.current&1);break;case 19:if(R=(G&C.childLanes)!==0,f.flags&128){if(R)return gX(f,C,G);C.flags|=128}var V=C.memoizedState;if(V!==null&&(V.rendering=null,V.tail=null,V.lastEffect=null),st(Zi,Zi.current),R)break;return null;case 22:case 23:return C.lanes=0,tX(f,C,G)}return nc(f,C,G)}function oie(f,C){switch(zS(C),C.tag){case 1:return Bt(C.type)&&Cn(),f=C.flags,f&65536?(C.flags=f&-65537|128,C):null;case 3:return Vh(),at(Tt),at(Dt),QS(),f=C.flags,f&65536&&!(f&128)?(C.flags=f&-65537|128,C):null;case 5:return US(C),null;case 13:if(at(Zi),f=C.memoizedState,f!==null&&f.dehydrated!==null){if(C.alternate===null)throw Error(o(340));Nh()}return f=C.flags,f&65536?(C.flags=f&-65537|128,C):null;case 19:return at(Zi),null;case 4:return Vh(),null;case 10:return ES(C.type._context),null;case 22:case 23:return S1(),null;case 24:return null;default:return null}}var Yy=!1,Wu=!1,aie=typeof WeakSet=="function"?WeakSet:Set,xt=null;function ky(f,C){var G=f.ref;if(G!==null)if(typeof G=="function")try{G(null)}catch(R){Es(f,C,R)}else G.current=null}function g1(f,C,G){try{G()}catch(R){Es(f,C,R)}}var uX=!1;function lie(f,C){for(E(f.containerInfo),xt=C;xt!==null;)if(f=xt,C=f.child,(f.subtreeFlags&1028)!==0&&C!==null)C.return=f,xt=C;else for(;xt!==null;){f=xt;try{var G=f.alternate;if(f.flags&1024)switch(f.tag){case 0:case 11:case 15:break;case 1:if(G!==null){var R=G.memoizedProps,V=G.memoizedState,X=f.stateNode,ne=X.getSnapshotBeforeUpdate(f.elementType===f.type?R:pa(f.type,R),V);X.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:Ge&&ct(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ie){Es(f,f.return,Ie)}if(C=f.sibling,C!==null){C.return=f.return,xt=C;break}xt=f.return}return G=uX,uX=!1,G}function Mu(f,C,G){var R=C.updateQueue;if(R=R!==null?R.lastEffect:null,R!==null){var V=R=R.next;do{if((V.tag&f)===f){var X=V.destroy;V.destroy=void 0,X!==void 0&&g1(C,G,X)}V=V.next}while(V!==R)}}function fp(f,C){if(C=C.updateQueue,C=C!==null?C.lastEffect:null,C!==null){var G=C=C.next;do{if((G.tag&f)===f){var R=G.create;G.destroy=R()}G=G.next}while(G!==C)}}function u1(f){var C=f.ref;if(C!==null){var G=f.stateNode;switch(f.tag){case 5:f=j(G);break;default:f=G}typeof C=="function"?C(f):C.current=f}}function dX(f,C,G){if(rl&&typeof rl.onCommitFiberUnmount=="function")try{rl.onCommitFiberUnmount(fy,C)}catch{}switch(C.tag){case 0:case 11:case 14:case 15:if(f=C.updateQueue,f!==null&&(f=f.lastEffect,f!==null)){var R=f=f.next;do{var V=R,X=V.destroy;V=V.tag,X!==void 0&&(V&2||V&4)&&g1(C,G,X),R=R.next}while(R!==f)}break;case 1:if(ky(C,G),f=C.stateNode,typeof f.componentWillUnmount=="function")try{f.props=C.memoizedProps,f.state=C.memoizedState,f.componentWillUnmount()}catch(ne){Es(C,G,ne)}break;case 5:ky(C,G);break;case 4:Ge?mX(f,C,G):pe&&pe&&(C=C.stateNode.containerInfo,G=ze(C),Rn(C,G))}}function hX(f,C,G){for(var R=C;;)if(dX(f,R,G),R.child===null||Ge&&R.tag===4){if(R===C)break;for(;R.sibling===null;){if(R.return===null||R.return===C)return;R=R.return}R.sibling.return=R.return,R=R.sibling}else R.child.return=R,R=R.child}function IX(f){var C=f.alternate;C!==null&&(f.alternate=null,IX(C)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(C=f.stateNode,C!==null&&Xe(C)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function fX(f){return f.tag===5||f.tag===3||f.tag===4}function CX(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||fX(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function pX(f){if(Ge){e:{for(var C=f.return;C!==null;){if(fX(C))break e;C=C.return}throw Error(o(160))}var G=C;switch(G.tag){case 5:C=G.stateNode,G.flags&32&&(Ae(C),G.flags&=-33),G=CX(f),h1(f,G,C);break;case 3:case 4:C=G.stateNode.containerInfo,G=CX(f),d1(f,G,C);break;default:throw Error(o(161))}}}function d1(f,C,G){var R=f.tag;if(R===5||R===6)f=f.stateNode,C?qe(G,f,C):Rt(G,f);else if(R!==4&&(f=f.child,f!==null))for(d1(f,C,G),f=f.sibling;f!==null;)d1(f,C,G),f=f.sibling}function h1(f,C,G){var R=f.tag;if(R===5||R===6)f=f.stateNode,C?Ue(G,f,C):Ze(G,f);else if(R!==4&&(f=f.child,f!==null))for(h1(f,C,G),f=f.sibling;f!==null;)h1(f,C,G),f=f.sibling}function mX(f,C,G){for(var R=C,V=!1,X,ne;;){if(!V){V=R.return;e:for(;;){if(V===null)throw Error(o(160));switch(X=V.stateNode,V.tag){case 5:ne=!1;break e;case 3:X=X.containerInfo,ne=!0;break e;case 4:X=X.containerInfo,ne=!0;break e}V=V.return}V=!0}if(R.tag===5||R.tag===6)hX(f,R,G),ne?le(X,R.stateNode):Pt(X,R.stateNode);else if(R.tag===18)ne?et(X,R.stateNode):gt(X,R.stateNode);else if(R.tag===4){if(R.child!==null){X=R.stateNode.containerInfo,ne=!0,R.child.return=R,R=R.child;continue}}else if(dX(f,R,G),R.child!==null){R.child.return=R,R=R.child;continue}if(R===C)break;for(;R.sibling===null;){if(R.return===null||R.return===C)return;R=R.return,R.tag===4&&(V=!1)}R.sibling.return=R.return,R=R.sibling}}function I1(f,C){if(Ge){switch(C.tag){case 0:case 11:case 14:case 15:Mu(3,C,C.return),fp(3,C),Mu(5,C,C.return);return;case 1:return;case 5:var G=C.stateNode;if(G!=null){var R=C.memoizedProps;f=f!==null?f.memoizedProps:R;var V=C.type,X=C.updateQueue;C.updateQueue=null,X!==null&&Nt(G,X,V,f,R,C)}return;case 6:if(C.stateNode===null)throw Error(o(162));G=C.memoizedProps,pt(C.stateNode,f!==null?f.memoizedProps:G,G);return;case 3:Oe&&f!==null&&f.memoizedState.isDehydrated&&Fe(C.stateNode.containerInfo);return;case 12:return;case 13:Hy(C);return;case 19:Hy(C);return;case 17:return}throw Error(o(163))}switch(C.tag){case 0:case 11:case 14:case 15:Mu(3,C,C.return),fp(3,C),Mu(5,C,C.return);return;case 12:return;case 13:Hy(C);return;case 19:Hy(C);return;case 3:Oe&&f!==null&&f.memoizedState.isDehydrated&&Fe(C.stateNode.containerInfo);break;case 22:case 23:return}e:if(pe){switch(C.tag){case 1:case 5:case 6:break e;case 3:case 4:C=C.stateNode,Rn(C.containerInfo,C.pendingChildren);break e}throw Error(o(163))}}function Hy(f){var C=f.updateQueue;if(C!==null){f.updateQueue=null;var G=f.stateNode;G===null&&(G=f.stateNode=new aie),C.forEach(function(R){var V=mie.bind(null,f,R);G.has(R)||(G.add(R),R.then(V,V))})}}function cie(f,C){for(xt=C;xt!==null;){C=xt;var G=C.deletions;if(G!==null)for(var R=0;R<G.length;R++){var V=G[R];try{var X=f;Ge?mX(X,V,C):hX(X,V,C);var ne=V.alternate;ne!==null&&(ne.return=null),V.return=null}catch(Lt){Es(V,C,Lt)}}if(G=C.child,C.subtreeFlags&12854&&G!==null)G.return=C,xt=G;else for(;xt!==null;){C=xt;try{var Ie=C.flags;if(Ie&32&&Ge&&Ae(C.stateNode),Ie&512){var Te=C.alternate;if(Te!==null){var dt=Te.ref;dt!==null&&(typeof dt=="function"?dt(null):dt.current=null)}}if(Ie&8192)switch(C.tag){case 13:if(C.memoizedState!==null){var Ft=C.alternate;(Ft===null||Ft.memoizedState===null)&&(b1=mr())}break;case 22:var un=C.memoizedState!==null,Ut=C.alternate,oi=Ut!==null&&Ut.memoizedState!==null;if(G=C,Ge){e:if(R=G,V=un,X=null,Ge)for(var Ot=R;;){if(Ot.tag===5){if(X===null){X=Ot;var Lr=Ot.stateNode;V?De(Lr):ye(Ot.stateNode,Ot.memoizedProps)}}else if(Ot.tag===6){if(X===null){var Yo=Ot.stateNode;V?se(Yo):it(Yo,Ot.memoizedProps)}}else if((Ot.tag!==22&&Ot.tag!==23||Ot.memoizedState===null||Ot===R)&&Ot.child!==null){Ot.child.return=Ot,Ot=Ot.child;continue}if(Ot===R)break;for(;Ot.sibling===null;){if(Ot.return===null||Ot.return===R)break e;X===Ot&&(X=null),Ot=Ot.return}X===Ot&&(X=null),Ot.sibling.return=Ot.return,Ot=Ot.sibling}}if(un&&!oi&&G.mode&1){xt=G;for(var we=G.child;we!==null;){for(G=xt=we;xt!==null;){R=xt;var fe=R.child;switch(R.tag){case 0:case 11:case 14:case 15:Mu(4,R,R.return);break;case 1:ky(R,R.return);var Ne=R.stateNode;if(typeof Ne.componentWillUnmount=="function"){var St=R.return;try{Ne.props=R.memoizedProps,Ne.state=R.memoizedState,Ne.componentWillUnmount()}catch(Lt){Es(R,St,Lt)}}break;case 5:ky(R,R.return);break;case 22:if(R.memoizedState!==null){bX(G);continue}}fe!==null?(fe.return=R,xt=fe):bX(G)}we=we.sibling}}}switch(Ie&4102){case 2:pX(C),C.flags&=-3;break;case 6:pX(C),C.flags&=-3,I1(C.alternate,C);break;case 4096:C.flags&=-4097;break;case 4100:C.flags&=-4097,I1(C.alternate,C);break;case 4:I1(C.alternate,C)}}catch(Lt){Es(C,C.return,Lt)}if(G=C.sibling,G!==null){G.return=C.return,xt=G;break}xt=C.return}}}function gie(f,C,G){xt=f,AX(f)}function AX(f,C,G){for(var R=(f.mode&1)!==0;xt!==null;){var V=xt,X=V.child;if(V.tag===22&&R){var ne=V.memoizedState!==null||Yy;if(!ne){var Ie=V.alternate,Te=Ie!==null&&Ie.memoizedState!==null||Wu;Ie=Yy;var dt=Wu;if(Yy=ne,(Wu=Te)&&!dt)for(xt=V;xt!==null;)ne=xt,Te=ne.child,ne.tag===22&&ne.memoizedState!==null?vX(V):Te!==null?(Te.return=ne,xt=Te):vX(V);for(;X!==null;)xt=X,AX(X),X=X.sibling;xt=V,Yy=Ie,Wu=dt}yX(f)}else V.subtreeFlags&8772&&X!==null?(X.return=V,xt=X):yX(f)}}function yX(f){for(;xt!==null;){var C=xt;if(C.flags&8772){var G=C.alternate;try{if(C.flags&8772)switch(C.tag){case 0:case 11:case 15:Wu||fp(5,C);break;case 1:var R=C.stateNode;if(C.flags&4&&!Wu)if(G===null)R.componentDidMount();else{var V=C.elementType===C.type?G.memoizedProps:pa(C.type,G.memoizedProps);R.componentDidUpdate(V,G.memoizedState,R.__reactInternalSnapshotBeforeUpdate)}var X=C.updateQueue;X!==null&&IT(C,X,R);break;case 3:var ne=C.updateQueue;if(ne!==null){if(G=null,C.child!==null)switch(C.child.tag){case 5:G=j(C.child.stateNode);break;case 1:G=C.child.stateNode}IT(C,ne,G)}break;case 5:var Ie=C.stateNode;G===null&&C.flags&4&&kt(Ie,C.type,C.memoizedProps,C);break;case 6:break;case 4:break;case 12:break;case 13:if(Oe&&C.memoizedState===null){var Te=C.alternate;if(Te!==null){var dt=Te.memoizedState;if(dt!==null){var Ft=dt.dehydrated;Ft!==null&&_e(Ft)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Wu||C.flags&512&&u1(C)}catch(un){Es(C,C.return,un)}}if(C===f){xt=null;break}if(G=C.sibling,G!==null){G.return=C.return,xt=G;break}xt=C.return}}function bX(f){for(;xt!==null;){var C=xt;if(C===f){xt=null;break}var G=C.sibling;if(G!==null){G.return=C.return,xt=G;break}xt=C.return}}function vX(f){for(;xt!==null;){var C=xt;try{switch(C.tag){case 0:case 11:case 15:var G=C.return;try{fp(4,C)}catch(Te){Es(C,G,Te)}break;case 1:var R=C.stateNode;if(typeof R.componentDidMount=="function"){var V=C.return;try{R.componentDidMount()}catch(Te){Es(C,V,Te)}}var X=C.return;try{u1(C)}catch(Te){Es(C,X,Te)}break;case 5:var ne=C.return;try{u1(C)}catch(Te){Es(C,ne,Te)}}}catch(Te){Es(C,C.return,Te)}if(C===f){xt=null;break}var Ie=C.sibling;if(Ie!==null){Ie.return=C.return,xt=Ie;break}xt=C.return}}var Ky=0,Ly=1,zy=2,jy=3,Py=4;if(typeof Symbol=="function"&&Symbol.for){var Cp=Symbol.for;Ky=Cp("selector.component"),Ly=Cp("selector.has_pseudo_class"),zy=Cp("selector.role"),jy=Cp("selector.test_id"),Py=Cp("selector.text")}function f1(f){var C=ve(f);if(C!=null){if(typeof C.memoizedProps["data-testname"]!="string")throw Error(o(364));return C}if(f=ot(f),f===null)throw Error(o(362));return f.stateNode.current}function C1(f,C){switch(C.$$typeof){case Ky:if(f.type===C.value)return!0;break;case Ly:e:{C=C.value,f=[f,0];for(var G=0;G<f.length;){var R=f[G++],V=f[G++],X=C[V];if(R.tag!==5||!L(R)){for(;X!=null&&C1(R,X);)V++,X=C[V];if(V===C.length){C=!0;break e}else for(R=R.child;R!==null;)f.push(R,V),R=R.sibling}}C=!1}return C;case zy:if(f.tag===5&&Ce(f.stateNode,C.value))return!0;break;case Py:if((f.tag===5||f.tag===6)&&(f=Q(f),f!==null&&0<=f.indexOf(C.value)))return!0;break;case jy:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===C.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function p1(f){switch(f.$$typeof){case Ky:return"<"+(Z(f.value)||"Unknown")+">";case Ly:return":has("+(p1(f)||"")+")";case zy:return'[role="'+f.value+'"]';case Py:return'"'+f.value+'"';case jy:return'[data-testname="'+f.value+'"]';default:throw Error(o(365))}}function xX(f,C){var G=[];f=[f,0];for(var R=0;R<f.length;){var V=f[R++],X=f[R++],ne=C[X];if(V.tag!==5||!L(V)){for(;ne!=null&&C1(V,ne);)X++,ne=C[X];if(X===C.length)G.push(V);else for(V=V.child;V!==null;)f.push(V,X),V=V.sibling}}return G}function m1(f,C){if(!mt)throw Error(o(363));f=f1(f),f=xX(f,C),C=[],f=Array.from(f);for(var G=0;G<f.length;){var R=f[G++];if(R.tag===5)L(R)||C.push(R.stateNode);else for(R=R.child;R!==null;)f.push(R),R=R.sibling}return C}var uie=Math.ceil,Oy=a.ReactCurrentDispatcher,A1=a.ReactCurrentOwner,ji=a.ReactCurrentBatchConfig,wn=0,Ji=null,Qi=null,Nr=0,lo=0,_h=It(0),sr=0,pp=null,Th=0,Dy=0,y1=0,mp=null,Ts=null,b1=0,v1=1/0;function Xh(){v1=mr()+500}var Uy=!1,x1=null,qc=null,Jy=!1,$c=null,Qy=0,Ap=0,w1=null,qy=-1,$y=0;function cs(){return wn&6?mr():qy!==-1?qy:qy=mr()}function eg(f){return f.mode&1?wn&2&&Nr!==0?Nr&-Nr:One.transition!==null?($y===0&&(f=Ui,Ui<<=1,!(Ui&4194240)&&(Ui=64),$y=f),$y):(f=kn,f!==0?f:We()):1}function Xo(f,C,G){if(50<Ap)throw Ap=0,w1=null,Error(o(185));var R=eb(f,C);return R===null?null:(np(R,C,G),(!(wn&2)||R!==Ji)&&(R===Ji&&(!(wn&2)&&(Dy|=C),sr===4&&tg(R,Nr)),Xs(R,G),C===1&&wn===0&&!(f.mode&1)&&(Xh(),Cy&&ol())),R)}function eb(f,C){f.lanes|=C;var G=f.alternate;for(G!==null&&(G.lanes|=C),G=f,f=f.return;f!==null;)f.childLanes|=C,G=f.alternate,G!==null&&(G.childLanes|=C),G=f,f=f.return;return G.tag===3?G.stateNode:null}function Xs(f,C){var G=f.callbackNode;Ene(f,C);var R=Wo(f,f===Ji?Nr:0);if(R===0)G!==null&&cT(G),f.callbackNode=null,f.callbackPriority=0;else if(C=R&-R,f.callbackPriority!==C){if(G!=null&&cT(G),C===1)f.tag===0?Pne(GX.bind(null,f)):gT(GX.bind(null,f)),Qe?Le(function(){wn===0&&ol()}):MS(VS,ol),G=null;else{switch(lT(R)){case 1:G=VS;break;case 4:G=Kne;break;case 16:G=FS;break;case 536870912:G=Lne;break;default:G=FS}G=FX(G,wX.bind(null,f))}f.callbackPriority=C,f.callbackNode=G}}function wX(f,C){if(qy=-1,$y=0,wn&6)throw Error(o(327));var G=f.callbackNode;if(_u()&&f.callbackNode!==G)return null;var R=Wo(f,f===Ji?Nr:0);if(R===0)return null;if(R&30||R&f.expiredLanes||C)C=tb(f,R);else{C=R;var V=wn;wn|=2;var X=ZX();(Ji!==f||Nr!==C)&&(Xh(),Vu(f,C));do try{Iie();break}catch(Ie){SX(f,Ie)}while(!0);XS(),Oy.current=X,wn=V,Qi!==null?C=0:(Ji=null,Nr=0,C=sr)}if(C!==0){if(C===2&&(V=RS(f),V!==0&&(R=V,C=G1(f,V))),C===1)throw G=pp,Vu(f,0),tg(f,R),Xs(f,mr()),G;if(C===6)tg(f,R);else{if(V=f.current.alternate,!(R&30)&&!die(V)&&(C=tb(f,R),C===2&&(X=RS(f),X!==0&&(R=X,C=G1(f,X))),C===1))throw G=pp,Vu(f,0),tg(f,R),Xs(f,mr()),G;switch(f.finishedWork=V,f.finishedLanes=R,C){case 0:case 1:throw Error(o(345));case 2:Fu(f,Ts);break;case 3:if(tg(f,R),(R&130023424)===R&&(C=b1+500-mr(),10<C)){if(Wo(f,0)!==0)break;if(V=f.suspendedLanes,(V&R)!==R){cs(),f.pingedLanes|=f.suspendedLanes&V;break}f.timeoutHandle=he(Fu.bind(null,f,Ts),C);break}Fu(f,Ts);break;case 4:if(tg(f,R),(R&4194240)===R)break;for(C=f.eventTimes,V=-1;0<R;){var ne=31-On(R);X=1<<ne,ne=C[ne],ne>V&&(V=ne),R&=~X}if(R=V,R=mr()-R,R=(120>R?120:480>R?480:1080>R?1080:1920>R?1920:3e3>R?3e3:4320>R?4320:1960*uie(R/1960))-R,10<R){f.timeoutHandle=he(Fu.bind(null,f,Ts),R);break}Fu(f,Ts);break;case 5:Fu(f,Ts);break;default:throw Error(o(329))}}}return Xs(f,mr()),f.callbackNode===G?wX.bind(null,f):null}function G1(f,C){var G=mp;return f.current.memoizedState.isDehydrated&&(Vu(f,C).flags|=256),f=tb(f,C),f!==2&&(C=Ts,Ts=G,C!==null&&B1(C)),f}function B1(f){Ts===null?Ts=f:Ts.push.apply(Ts,f)}function die(f){for(var C=f;;){if(C.flags&16384){var G=C.updateQueue;if(G!==null&&(G=G.stores,G!==null))for(var R=0;R<G.length;R++){var V=G[R],X=V.getSnapshot;V=V.value;try{if(!sl(X(),V))return!1}catch{return!1}}}if(G=C.child,C.subtreeFlags&16384&&G!==null)G.return=C,C=G;else{if(C===f)break;for(;C.sibling===null;){if(C.return===null||C.return===f)return!0;C=C.return}C.sibling.return=C.return,C=C.sibling}}return!0}function tg(f,C){for(C&=~y1,C&=~Dy,f.suspendedLanes|=C,f.pingedLanes&=~C,f=f.expirationTimes;0<C;){var G=31-On(C),R=1<<G;f[G]=-1,C&=~R}}function GX(f){if(wn&6)throw Error(o(327));_u();var C=Wo(f,0);if(!(C&1))return Xs(f,mr()),null;var G=tb(f,C);if(f.tag!==0&&G===2){var R=RS(f);R!==0&&(C=R,G=G1(f,R))}if(G===1)throw G=pp,Vu(f,0),tg(f,C),Xs(f,mr()),G;if(G===6)throw Error(o(345));return f.finishedWork=f.current.alternate,f.finishedLanes=C,Fu(f,Ts),Xs(f,mr()),null}function BX(f){$c!==null&&$c.tag===0&&!(wn&6)&&_u();var C=wn;wn|=1;var G=ji.transition,R=kn;try{if(ji.transition=null,kn=1,f)return f()}finally{kn=R,ji.transition=G,wn=C,!(wn&6)&&ol()}}function S1(){lo=_h.current,at(_h)}function Vu(f,C){f.finishedWork=null,f.finishedLanes=0;var G=f.timeoutHandle;if(G!==be&&(f.timeoutHandle=be,Me(G)),Qi!==null)for(G=Qi.return;G!==null;){var R=G;switch(zS(R),R.tag){case 1:R=R.type.childContextTypes,R!=null&&Cn();break;case 3:Vh(),at(Tt),at(Dt),QS();break;case 5:US(R);break;case 4:Vh();break;case 13:at(Zi);break;case 19:at(Zi);break;case 10:ES(R.type._context);break;case 22:case 23:S1()}G=G.return}if(Ji=f,Qi=f=ng(f.current,null),Nr=lo=C,sr=0,pp=null,y1=Dy=Th=0,Ts=mp=null,al!==null){for(C=0;C<al.length;C++)if(G=al[C],R=G.interleaved,R!==null){G.interleaved=null;var V=R.next,X=G.pending;if(X!==null){var ne=X.next;X.next=V,R.next=ne}G.pending=R}al=null}return f}function SX(f,C){do{var G=Qi;try{if(XS(),Sy.current=Vy,Zy){for(var R=Xi.memoizedState;R!==null;){var V=R.queue;V!==null&&(V.pending=null),R=R.next}Zy=!1}if(Fh=0,Ar=kr=Xi=null,lp=!1,cp=0,A1.current=null,G===null||G.return===null){sr=1,pp=C,Qi=null;break}e:{var X=f,ne=G.return,Ie=G,Te=C;if(C=Nr,Ie.flags|=32768,Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var dt=Te,Ft=Ie,un=Ft.tag;if(!(Ft.mode&1)&&(un===0||un===11||un===15)){var Ut=Ft.alternate;Ut?(Ft.updateQueue=Ut.updateQueue,Ft.memoizedState=Ut.memoizedState,Ft.lanes=Ut.lanes):(Ft.updateQueue=null,Ft.memoizedState=null)}var oi=DT(ne);if(oi!==null){oi.flags&=-257,UT(oi,ne,Ie,X,C),oi.mode&1&&OT(X,dt,C),C=oi,Te=dt;var Ot=C.updateQueue;if(Ot===null){var Lr=new Set;Lr.add(Te),C.updateQueue=Lr}else Ot.add(Te);break e}else{if(!(C&1)){OT(X,dt,C),Z1();break e}Te=Error(o(426))}}else if(xi&&Ie.mode&1){var Yo=DT(ne);if(Yo!==null){!(Yo.flags&65536)&&(Yo.flags|=256),UT(Yo,ne,Ie,X,C),OS(Te);break e}}X=Te,sr!==4&&(sr=2),mp===null?mp=[X]:mp.push(X),Te=r1(Te,Ie),Ie=ne;do{switch(Ie.tag){case 3:Ie.flags|=65536,C&=-C,Ie.lanes|=C;var we=jT(Ie,Te,C);hT(Ie,we);break e;case 1:X=Te;var fe=Ie.type,Ne=Ie.stateNode;if(!(Ie.flags&128)&&(typeof fe.getDerivedStateFromError=="function"||Ne!==null&&typeof Ne.componentDidCatch=="function"&&(qc===null||!qc.has(Ne)))){Ie.flags|=65536,C&=-C,Ie.lanes|=C;var St=PT(Ie,X,C);hT(Ie,St);break e}}Ie=Ie.return}while(Ie!==null)}NX(G)}catch(Lt){C=Lt,Qi===G&&G!==null&&(Qi=G=G.return);continue}break}while(!0)}function ZX(){var f=Oy.current;return Oy.current=Vy,f===null?Vy:f}function Z1(){(sr===0||sr===3||sr===2)&&(sr=4),Ji===null||!(Th&268435455)&&!(Dy&268435455)||tg(Ji,Nr)}function tb(f,C){var G=wn;wn|=2;var R=ZX();Ji===f&&Nr===C||Vu(f,C);do try{hie();break}catch(V){SX(f,V)}while(!0);if(XS(),wn=G,Oy.current=R,Qi!==null)throw Error(o(261));return Ji=null,Nr=0,sr}function hie(){for(;Qi!==null;)RX(Qi)}function Iie(){for(;Qi!==null&&!kne();)RX(Qi)}function RX(f){var C=VX(f.alternate,f,lo);f.memoizedProps=f.pendingProps,C===null?NX(f):Qi=C,A1.current=null}function NX(f){var C=f;do{var G=C.alternate;if(f=C.return,C.flags&32768){if(G=oie(G,C),G!==null){G.flags&=32767,Qi=G;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{sr=6,Qi=null;return}}else if(G=iie(G,C,lo),G!==null){Qi=G;return}if(C=C.sibling,C!==null){Qi=C;return}Qi=C=f}while(C!==null);sr===0&&(sr=5)}function Fu(f,C){var G=kn,R=ji.transition;try{ji.transition=null,kn=1,fie(f,C,G)}finally{ji.transition=R,kn=G}return null}function fie(f,C,G){do _u();while($c!==null);if(wn&6)throw Error(o(327));var R=f.finishedWork,V=f.finishedLanes;if(R===null)return null;if(f.finishedWork=null,f.finishedLanes=0,R===f.current)throw Error(o(177));f.callbackNode=null,f.callbackPriority=0;var X=R.lanes|R.childLanes;if(Yne(f,X),f===Ji&&(Qi=Ji=null,Nr=0),!(R.subtreeFlags&2064)&&!(R.flags&2064)||Jy||(Jy=!0,FX(FS,function(){return _u(),null})),X=(R.flags&15990)!==0,R.subtreeFlags&15990||X){X=ji.transition,ji.transition=null;var ne=kn;kn=1;var Ie=wn;wn|=4,A1.current=null,lie(f,R),cie(f,R),P(f.containerInfo),f.current=R,gie(R),Hne(),wn=Ie,kn=ne,ji.transition=X}else f.current=R;if(Jy&&(Jy=!1,$c=f,Qy=V),X=f.pendingLanes,X===0&&(qc=null),zne(R.stateNode),Xs(f,mr()),C!==null)for(G=f.onRecoverableError,R=0;R<C.length;R++)G(C[R]);if(Uy)throw Uy=!1,f=x1,x1=null,f;return Qy&1&&f.tag!==0&&_u(),X=f.pendingLanes,X&1?f===w1?Ap++:(Ap=0,w1=f):Ap=0,ol(),null}function _u(){if($c!==null){var f=lT(Qy),C=ji.transition,G=kn;try{if(ji.transition=null,kn=16>f?16:f,$c===null)var R=!1;else{if(f=$c,$c=null,Qy=0,wn&6)throw Error(o(331));var V=wn;for(wn|=4,xt=f.current;xt!==null;){var X=xt,ne=X.child;if(xt.flags&16){var Ie=X.deletions;if(Ie!==null){for(var Te=0;Te<Ie.length;Te++){var dt=Ie[Te];for(xt=dt;xt!==null;){var Ft=xt;switch(Ft.tag){case 0:case 11:case 15:Mu(8,Ft,X)}var un=Ft.child;if(un!==null)un.return=Ft,xt=un;else for(;xt!==null;){Ft=xt;var Ut=Ft.sibling,oi=Ft.return;if(IX(Ft),Ft===dt){xt=null;break}if(Ut!==null){Ut.return=oi,xt=Ut;break}xt=oi}}}var Ot=X.alternate;if(Ot!==null){var Lr=Ot.child;if(Lr!==null){Ot.child=null;do{var Yo=Lr.sibling;Lr.sibling=null,Lr=Yo}while(Lr!==null)}}xt=X}}if(X.subtreeFlags&2064&&ne!==null)ne.return=X,xt=ne;else e:for(;xt!==null;){if(X=xt,X.flags&2048)switch(X.tag){case 0:case 11:case 15:Mu(9,X,X.return)}var we=X.sibling;if(we!==null){we.return=X.return,xt=we;break e}xt=X.return}}var fe=f.current;for(xt=fe;xt!==null;){ne=xt;var Ne=ne.child;if(ne.subtreeFlags&2064&&Ne!==null)Ne.return=ne,xt=Ne;else e:for(ne=fe;xt!==null;){if(Ie=xt,Ie.flags&2048)try{switch(Ie.tag){case 0:case 11:case 15:fp(9,Ie)}}catch(Lt){Es(Ie,Ie.return,Lt)}if(Ie===ne){xt=null;break e}var St=Ie.sibling;if(St!==null){St.return=Ie.return,xt=St;break e}xt=Ie.return}}if(wn=V,ol(),rl&&typeof rl.onPostCommitFiberRoot=="function")try{rl.onPostCommitFiberRoot(fy,f)}catch{}R=!0}return R}finally{kn=G,ji.transition=C}}return!1}function WX(f,C,G){C=r1(G,C),C=jT(f,C,1),Qc(f,C),C=cs(),f=eb(f,1),f!==null&&(np(f,1,C),Xs(f,C))}function Es(f,C,G){if(f.tag===3)WX(f,f,G);else for(;C!==null;){if(C.tag===3){WX(C,f,G);break}else if(C.tag===1){var R=C.stateNode;if(typeof C.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(qc===null||!qc.has(R))){f=r1(G,f),f=PT(C,f,1),Qc(C,f),f=cs(),C=eb(C,1),C!==null&&(np(C,1,f),Xs(C,f));break}}C=C.return}}function Cie(f,C,G){var R=f.pingCache;R!==null&&R.delete(C),C=cs(),f.pingedLanes|=f.suspendedLanes&G,Ji===f&&(Nr&G)===G&&(sr===4||sr===3&&(Nr&130023424)===Nr&&500>mr()-b1?Vu(f,0):y1|=G),Xs(f,C)}function MX(f,C){C===0&&(f.mode&1?(C=rr,rr<<=1,!(rr&130023424)&&(rr=4194304)):C=1);var G=cs();f=eb(f,C),f!==null&&(np(f,C,G),Xs(f,G))}function pie(f){var C=f.memoizedState,G=0;C!==null&&(G=C.retryLane),MX(f,G)}function mie(f,C){var G=0;switch(f.tag){case 13:var R=f.stateNode,V=f.memoizedState;V!==null&&(G=V.retryLane);break;case 19:R=f.stateNode;break;default:throw Error(o(314))}R!==null&&R.delete(C),MX(f,G)}var VX;VX=function(f,C,G){if(f!==null)if(f.memoizedProps!==C.pendingProps||Tt.current)ao=!0;else{if(!(f.lanes&G)&&!(C.flags&128))return ao=!1,sie(f,C,G);ao=!!(f.flags&131072)}else ao=!1,xi&&C.flags&1048576&&AT(C,wy,C.index);switch(C.lanes=0,C.tag){case 2:var R=C.type;f!==null&&(f.alternate=null,C.alternate=null,C.flags|=2),f=C.pendingProps;var V=cn(C,Dt.current);Sh(C,G),V=$S(null,C,R,f,V,G);var X=e1();return C.flags|=1,typeof V=="object"&&V!==null&&typeof V.render=="function"&&V.$$typeof===void 0?(C.tag=1,C.memoizedState=null,C.updateQueue=null,Bt(R)?(X=!0,Nn(C)):X=!1,C.memoizedState=V.state!==null&&V.state!==void 0?V.state:null,kS(C),V.updater=vy,C.stateNode=V,V._reactInternals=C,KS(C,R,f,G),C=a1(null,C,R,!0,X,G)):(C.tag=0,xi&&X&&LS(C),ls(null,C,V,G),C=C.child),C;case 16:R=C.elementType;e:{switch(f!==null&&(f.alternate=null,C.alternate=null,C.flags|=2),f=C.pendingProps,V=R._init,R=V(R._payload),C.type=R,V=C.tag=yie(R),f=pa(R,f),V){case 0:C=o1(null,C,R,f,G);break e;case 1:C=iX(null,C,R,f,G);break e;case 11:C=qT(null,C,R,f,G);break e;case 14:C=$T(null,C,R,pa(R.type,f),G);break e}throw Error(o(306,R,""))}return C;case 0:return R=C.type,V=C.pendingProps,V=C.elementType===R?V:pa(R,V),o1(f,C,R,V,G);case 1:return R=C.type,V=C.pendingProps,V=C.elementType===R?V:pa(R,V),iX(f,C,R,V,G);case 3:e:{if(rX(C),f===null)throw Error(o(387));R=C.pendingProps,X=C.memoizedState,V=X.element,dT(f,C),by(C,R,null,G);var ne=C.memoizedState;if(R=ne.element,Oe&&X.isDehydrated)if(X={element:R,isDehydrated:!1,cache:ne.cache,transitions:ne.transitions},C.updateQueue.baseState=X,C.memoizedState=X,C.flags&256){V=Error(o(423)),C=sX(f,C,R,G,V);break e}else if(R!==V){V=Error(o(424)),C=sX(f,C,R,G,V);break e}else for(Oe&&(oo=Ul(C.stateNode.containerInfo),so=C,xi=!0,ma=null,ip=!1),G=GT(C,null,R,G),C.child=G;G;)G.flags=G.flags&-3|4096,G=G.sibling;else{if(Nh(),R===V){C=nc(f,C,G);break e}ls(f,C,R,G)}C=C.child}return C;case 5:return BT(C),f===null&&PS(C),R=C.type,V=C.pendingProps,X=f!==null?f.memoizedProps:null,ne=V.children,Pe(R,V)?ne=null:X!==null&&Pe(R,X)&&(C.flags|=32),nX(f,C),ls(f,C,ne,G),C.child;case 6:return f===null&&PS(C),null;case 13:return oX(f,C,G);case 4:return DS(C,C.stateNode.containerInfo),R=C.pendingProps,f===null?C.child=Wh(C,null,R,G):ls(f,C,R,G),C.child;case 11:return R=C.type,V=C.pendingProps,V=C.elementType===R?V:pa(R,V),qT(f,C,R,V,G);case 7:return ls(f,C,C.pendingProps,G),C.child;case 8:return ls(f,C,C.pendingProps.children,G),C.child;case 12:return ls(f,C,C.pendingProps.children,G),C.child;case 10:e:{if(R=C.type._context,V=C.pendingProps,X=C.memoizedProps,ne=V.value,uT(C,R,ne),X!==null)if(sl(X.value,ne)){if(X.children===V.children&&!Tt.current){C=nc(f,C,G);break e}}else for(X=C.child,X!==null&&(X.return=C);X!==null;){var Ie=X.dependencies;if(Ie!==null){ne=X.child;for(var Te=Ie.firstContext;Te!==null;){if(Te.context===R){if(X.tag===1){Te=ql(-1,G&-G),Te.tag=2;var dt=X.updateQueue;if(dt!==null){dt=dt.shared;var Ft=dt.pending;Ft===null?Te.next=Te:(Te.next=Ft.next,Ft.next=Te),dt.pending=Te}}X.lanes|=G,Te=X.alternate,Te!==null&&(Te.lanes|=G),YS(X.return,G,C),Ie.lanes|=G;break}Te=Te.next}}else if(X.tag===10)ne=X.type===C.type?null:X.child;else if(X.tag===18){if(ne=X.return,ne===null)throw Error(o(341));ne.lanes|=G,Ie=ne.alternate,Ie!==null&&(Ie.lanes|=G),YS(ne,G,C),ne=X.sibling}else ne=X.child;if(ne!==null)ne.return=X;else for(ne=X;ne!==null;){if(ne===C){ne=null;break}if(X=ne.sibling,X!==null){X.return=ne.return,ne=X;break}ne=ne.return}X=ne}ls(f,C,V.children,G),C=C.child}return C;case 9:return V=C.type,R=C.pendingProps.children,Sh(C,G),V=Mo(V),R=R(V),C.flags|=1,ls(f,C,R,G),C.child;case 14:return R=C.type,V=pa(R,C.pendingProps),V=pa(R.type,V),$T(f,C,R,V,G);case 15:return eX(f,C,C.type,C.pendingProps,G);case 17:return R=C.type,V=C.pendingProps,V=C.elementType===R?V:pa(R,V),f!==null&&(f.alternate=null,C.alternate=null,C.flags|=2),C.tag=1,Bt(R)?(f=!0,Nn(C)):f=!1,Sh(C,G),pT(C,R,V),KS(C,R,V,G),a1(null,C,R,!0,f,G);case 19:return gX(f,C,G);case 22:return tX(f,C,G)}throw Error(o(156,C.tag))};function FX(f,C){return MS(f,C)}function Aie(f,C,G,R){this.tag=f,this.key=G,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=C,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Eo(f,C,G,R){return new Aie(f,C,G,R)}function R1(f){return f=f.prototype,!(!f||!f.isReactComponent)}function yie(f){if(typeof f=="function")return R1(f)?1:0;if(f!=null){if(f=f.$$typeof,f===y)return 11;if(f===b)return 14}return 2}function ng(f,C){var G=f.alternate;return G===null?(G=Eo(f.tag,C,f.key,f.mode),G.elementType=f.elementType,G.type=f.type,G.stateNode=f.stateNode,G.alternate=f,f.alternate=G):(G.pendingProps=C,G.type=f.type,G.flags=0,G.subtreeFlags=0,G.deletions=null),G.flags=f.flags&14680064,G.childLanes=f.childLanes,G.lanes=f.lanes,G.child=f.child,G.memoizedProps=f.memoizedProps,G.memoizedState=f.memoizedState,G.updateQueue=f.updateQueue,C=f.dependencies,G.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext},G.sibling=f.sibling,G.index=f.index,G.ref=f.ref,G}function nb(f,C,G,R,V,X){var ne=2;if(R=f,typeof f=="function")R1(f)&&(ne=1);else if(typeof f=="string")ne=5;else e:switch(f){case u:return Tu(G.children,V,X,C);case d:ne=8,V|=8;break;case h:return f=Eo(12,G,C,V|2),f.elementType=h,f.lanes=X,f;case A:return f=Eo(13,G,C,V),f.elementType=A,f.lanes=X,f;case m:return f=Eo(19,G,C,V),f.elementType=m,f.lanes=X,f;case w:return ib(G,V,X,C);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case I:ne=10;break e;case p:ne=9;break e;case y:ne=11;break e;case b:ne=14;break e;case v:ne=16,R=null;break e}throw Error(o(130,f==null?f:typeof f,""))}return C=Eo(ne,G,C,V),C.elementType=f,C.type=R,C.lanes=X,C}function Tu(f,C,G,R){return f=Eo(7,f,R,C),f.lanes=G,f}function ib(f,C,G,R){return f=Eo(22,f,R,C),f.elementType=w,f.lanes=G,f.stateNode={},f}function N1(f,C,G){return f=Eo(6,f,null,C),f.lanes=G,f}function W1(f,C,G){return C=Eo(4,f.children!==null?f.children:[],f.key,C),C.lanes=G,C.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},C}function bie(f,C,G,R,V){this.tag=C,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=be,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=NS(0),this.expirationTimes=NS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=NS(0),this.identifierPrefix=R,this.onRecoverableError=V,Oe&&(this.mutableSourceEagerHydrationData=null)}function _X(f,C,G,R,V,X,ne,Ie,Te){return f=new bie(f,C,G,Ie,Te),C===1?(C=1,X===!0&&(C|=8)):C=0,X=Eo(3,null,null,C),f.current=X,X.stateNode=f,X.memoizedState={element:R,isDehydrated:G,cache:null,transitions:null},kS(X),f}function TX(f){if(!f)return Gt;f=f._reactInternals;e:{if(W(f)!==f||f.tag!==1)throw Error(o(170));var C=f;do{switch(C.tag){case 3:C=C.stateNode.context;break e;case 1:if(Bt(C.type)){C=C.stateNode.__reactInternalMemoizedMergedChildContext;break e}}C=C.return}while(C!==null);throw Error(o(171))}if(f.tag===1){var G=f.type;if(Bt(G))return Xn(f,G,C)}return C}function XX(f){var C=f._reactInternals;if(C===void 0)throw typeof f.render=="function"?Error(o(188)):(f=Object.keys(f).join(","),Error(o(268,f)));return f=T(C),f===null?null:f.stateNode}function EX(f,C){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var G=f.retryLane;f.retryLane=G!==0&&G<C?G:C}}function M1(f,C){EX(f,C),(f=f.alternate)&&EX(f,C)}function vie(f){return f=T(f),f===null?null:f.stateNode}function xie(){return null}return n.attemptContinuousHydration=function(f){if(f.tag===13){var C=cs();Xo(f,134217728,C),M1(f,134217728)}},n.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var C=cs(),G=eg(f);Xo(f,G,C),M1(f,G)}},n.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var C=f.stateNode;if(C.current.memoizedState.isDehydrated){var G=Jl(C.pendingLanes);G!==0&&(WS(C,G|1),Xs(C,mr()),!(wn&6)&&(Xh(),ol()))}break;case 13:var R=cs();BX(function(){return Xo(f,1,R)}),M1(f,1)}},n.batchedUpdates=function(f,C){var G=wn;wn|=1;try{return f(C)}finally{wn=G,wn===0&&(Xh(),Cy&&ol())}},n.createComponentSelector=function(f){return{$$typeof:Ky,value:f}},n.createContainer=function(f,C,G,R,V,X,ne){return _X(f,C,!1,null,G,R,V,X,ne)},n.createHasPseudoClassSelector=function(f){return{$$typeof:Ly,value:f}},n.createHydrationContainer=function(f,C,G,R,V,X,ne,Ie,Te){return f=_X(G,R,!0,f,V,X,ne,Ie,Te),f.context=TX(null),G=f.current,R=cs(),V=eg(G),X=ql(R,V),X.callback=C??null,Qc(G,X),f.current.lanes=V,np(f,V,R),Xs(f,R),f},n.createPortal=function(f,C,G){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:R==null?null:""+R,children:f,containerInfo:C,implementation:G}},n.createRoleSelector=function(f){return{$$typeof:zy,value:f}},n.createTestNameSelector=function(f){return{$$typeof:jy,value:f}},n.createTextSelector=function(f){return{$$typeof:Py,value:f}},n.deferredUpdates=function(f){var C=kn,G=ji.transition;try{return ji.transition=null,kn=16,f()}finally{kn=C,ji.transition=G}},n.discreteUpdates=function(f,C,G,R,V){var X=kn,ne=ji.transition;try{return ji.transition=null,kn=1,f(C,G,R,V)}finally{kn=X,ji.transition=ne,wn===0&&Xh()}},n.findAllNodes=m1,n.findBoundingRects=function(f,C){if(!mt)throw Error(o(363));C=m1(f,C),f=[];for(var G=0;G<C.length;G++)f.push(ft(C[G]));for(C=f.length-1;0<C;C--){G=f[C];for(var R=G.x,V=R+G.width,X=G.y,ne=X+G.height,Ie=C-1;0<=Ie;Ie--)if(C!==Ie){var Te=f[Ie],dt=Te.x,Ft=dt+Te.width,un=Te.y,Ut=un+Te.height;if(R>=dt&&X>=un&&V<=Ft&&ne<=Ut){f.splice(C,1);break}else if(R!==dt||G.width!==Te.width||Ut<X||un>ne){if(!(X!==un||G.height!==Te.height||Ft<R||dt>V)){dt>R&&(Te.width+=dt-R,Te.x=R),Ft<V&&(Te.width=V-dt),f.splice(C,1);break}}else{un>X&&(Te.height+=un-X,Te.y=X),Ut<ne&&(Te.height=ne-un),f.splice(C,1);break}}}return f},n.findHostInstance=XX,n.findHostInstanceWithNoPortals=function(f){return f=F(f),f=f!==null?K(f):null,f===null?null:f.stateNode},n.findHostInstanceWithWarning=function(f){return XX(f)},n.flushControlled=function(f){var C=wn;wn|=1;var G=ji.transition,R=kn;try{ji.transition=null,kn=1,f()}finally{kn=R,ji.transition=G,wn=C,wn===0&&(Xh(),ol())}},n.flushPassiveEffects=_u,n.flushSync=BX,n.focusWithin=function(f,C){if(!mt)throw Error(o(363));for(f=f1(f),C=xX(f,C),C=Array.from(C),f=0;f<C.length;){var G=C[f++];if(!L(G)){if(G.tag===5&&Ve(G.stateNode))return!0;for(G=G.child;G!==null;)C.push(G),G=G.sibling}}return!1},n.getCurrentUpdatePriority=function(){return kn},n.getFindAllNodesFailureDescription=function(f,C){if(!mt)throw Error(o(363));var G=0,R=[];f=[f1(f),0];for(var V=0;V<f.length;){var X=f[V++],ne=f[V++],Ie=C[ne];if((X.tag!==5||!L(X))&&(C1(X,Ie)&&(R.push(p1(Ie)),ne++,ne>G&&(G=ne)),ne<C.length))for(X=X.child;X!==null;)f.push(X,ne),X=X.sibling}if(G<C.length){for(f=[];G<C.length;G++)f.push(p1(C[G]));return`findAllNodes was able to match part of the selector:
  `+(R.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},n.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return j(f.child.stateNode);default:return f.child.stateNode}},n.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:vie,findFiberByHostInstance:f.findFiberByHostInstance||xie,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var C=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(C.isDisabled||!C.supportsFiber)f=!0;else{try{fy=C.inject(f),rl=C}catch{}f=!!C.checkDCE}}return f},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(f,C,G,R){if(!mt)throw Error(o(363));f=m1(f,C);var V=Ke(f,G,R).disconnect;return{disconnect:function(){V()}}},n.registerMutableSourceForHydration=function(f,C){var G=C._getVersion;G=G(C._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[C,G]:f.mutableSourceEagerHydrationData.push(C,G)},n.runWithPriority=function(f,C){var G=kn;try{return kn=f,C()}finally{kn=G}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(f,C,G,R){var V=C.current,X=cs(),ne=eg(V);return G=TX(G),C.context===null?C.context=G:C.pendingContext=G,C=ql(X,ne),C.payload={element:f},R=R===void 0?null:R,R!==null&&(C.callback=R),Qc(V,C),f=Xo(V,ne,X),f!==null&&yy(f,V,ne),ne},n};ute.exports=rOe;var sOe=ute.exports;const oOe=Pn(sOe);var dte={exports:{}},hte={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,E){var P=_.length;_.push(E);e:for(;0<P;){var q=P-1>>>1,re=_[q];if(0<r(re,E))_[q]=E,_[P]=re,P=q;else break e}}function n(_){return _.length===0?null:_[0]}function i(_){if(_.length===0)return null;var E=_[0],P=_.pop();if(P!==E){_[0]=P;e:for(var q=0,re=_.length,de=re>>>1;q<de;){var Re=2*(q+1)-1,Pe=_[Re],ae=Re+1,he=_[ae];if(0>r(Pe,P))ae<re&&0>r(he,Pe)?(_[q]=he,_[ae]=P,q=ae):(_[q]=Pe,_[Re]=P,q=Re);else if(ae<re&&0>r(he,P))_[q]=he,_[ae]=P,q=ae;else break e}}return E}function r(_,E){var P=_.sortIndex-E.sortIndex;return P!==0?P:_.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,I=!1,p=!1,y=!1,A=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(_){for(var E=n(c);E!==null;){if(E.callback===null)i(c);else if(E.startTime<=_)i(c),E.sortIndex=E.expirationTime,e(l,E);else break;E=n(c)}}function w(_){if(y=!1,v(_),!p)if(n(l)!==null)p=!0,j(x);else{var E=n(c);E!==null&&O(w,E.startTime-_)}}function x(_,E){p=!1,y&&(y=!1,m(N),N=-1),I=!0;var P=h;try{for(v(E),d=n(l);d!==null&&(!(d.expirationTime>E)||_&&!F());){var q=d.callback;if(typeof q=="function"){d.callback=null,h=d.priorityLevel;var re=q(d.expirationTime<=E);E=t.unstable_now(),typeof re=="function"?d.callback=re:d===n(l)&&i(l),v(E)}else i(l);d=n(l)}if(d!==null)var de=!0;else{var Re=n(c);Re!==null&&O(w,Re.startTime-E),de=!1}return de}finally{d=null,h=P,I=!1}}var B=!1,Z=null,N=-1,W=5,M=-1;function F(){return!(t.unstable_now()-M<W)}function T(){if(Z!==null){var _=t.unstable_now();M=_;var E=!0;try{E=Z(!0,_)}finally{E?H():(B=!1,Z=null)}}else B=!1}var H;if(typeof b=="function")H=function(){b(T)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,z=K.port2;K.port1.onmessage=T,H=function(){z.postMessage(null)}}else H=function(){A(T,0)};function j(_){Z=_,B||(B=!0,H())}function O(_,E){N=A(function(){_(t.unstable_now())},E)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){p||I||(p=!0,j(x))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var E=3;break;default:E=h}var P=h;h=E;try{return _()}finally{h=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,E){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var P=h;h=_;try{return E()}finally{h=P}},t.unstable_scheduleCallback=function(_,E,P){var q=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?q+P:q):P=q,_){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=P+re,_={id:u++,callback:E,priorityLevel:_,startTime:P,expirationTime:re,sortIndex:-1},P>q?(_.sortIndex=P,e(c,_),n(l)===null&&_===n(c)&&(y?(m(N),N=-1):y=!0,O(w,P-q))):(_.sortIndex=re,e(l,_),p||I||(p=!0,j(x))),_},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(_){var E=h;return function(){var P=h;h=E;try{return _.apply(this,arguments)}finally{h=P}}}})(hte);dte.exports=hte;var Wz=dte.exports;const aOe=t=>typeof t=="object"&&typeof t.then=="function",Gd=[];function Ite(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function fte(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of Gd)if(Ite(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=Gd.indexOf(r);s!==-1&&Gd.splice(s,1)},promise:(aOe(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(Gd.push(r),!n)throw r.promise}const lOe=(t,e,n)=>fte(t,e,!1,n),cOe=(t,e,n)=>void fte(t,e,!0,n),gOe=t=>{if(t===void 0||t.length===0)Gd.splice(0,Gd.length);else{const e=Gd.find(n=>Ite(t,n.keys,n.equal));e&&e.remove()}},k_={},H_=t=>void Object.assign(k_,t);function uOe(t,e){function n(u,{args:d=[],attach:h,...I},p){let y=`${u[0].toUpperCase()}${u.slice(1)}`,A;if(u==="primitive"){if(I.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const m=I.object;A=II(m,{type:u,root:p,attach:h,primitive:!0})}else{const m=k_[y];if(!m)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");A=II(new m(...d),{type:u,root:p,attach:h,memoizedProps:{args:d}})}return A.__r3f.attach===void 0&&(A instanceof gn?A.__r3f.attach="geometry":A instanceof Yr&&(A.__r3f.attach="material")),y!=="inject"&&JR(A,I),A}function i(u,d){let h=!1;if(d){var I,p;(I=d.__r3f)!=null&&I.attach?UR(u,d,d.__r3f.attach):d.isObject3D&&u.isObject3D&&(u.add(d),h=!0),h||(p=u.__r3f)==null||p.objects.push(d),d.__r3f||II(d,{}),d.__r3f.parent=u,L3(d),fI(d)}}function r(u,d,h){let I=!1;if(d){var p,y;if((p=d.__r3f)!=null&&p.attach)UR(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){d.parent=u,d.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:d});const A=u.children.filter(b=>b!==d),m=A.indexOf(h);u.children=[...A.slice(0,m),d,...A.slice(m)],I=!0}I||(y=u.__r3f)==null||y.objects.push(d),d.__r3f||II(d,{}),d.__r3f.parent=u,L3(d),fI(d)}}function s(u,d,h=!1){u&&[...u].forEach(I=>o(d,I,h))}function o(u,d,h){if(d){var I,p,y;if(d.__r3f&&(d.__r3f.parent=null),(I=u.__r3f)!=null&&I.objects&&(u.__r3f.objects=u.__r3f.objects.filter(w=>w!==d)),(p=d.__r3f)!=null&&p.attach)Tz(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){var A;u.remove(d),(A=d.__r3f)!=null&&A.root&&AOe(Gx(d),d)}const b=(y=d.__r3f)==null?void 0:y.primitive,v=!b&&(h===void 0?d.dispose!==null:h);if(!b){var m;s((m=d.__r3f)==null?void 0:m.objects,d,v),s(d.children,d,v)}if(delete d.__r3f,v&&d.dispose&&d.type!=="Scene"){const w=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Wz.unstable_scheduleCallback(Wz.unstable_IdlePriority,w):w()}fI(u)}}function a(u,d,h,I){var p;const y=(p=u.__r3f)==null?void 0:p.parent;if(!y)return;const A=n(d,h,u.__r3f.root);if(u.children){for(const m of u.children)m.__r3f&&i(A,m);u.children=u.children.filter(m=>!m.__r3f)}u.__r3f.objects.forEach(m=>i(A,m)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(y,u),A.parent&&(A.__r3f.autoRemovedBeforeAppend=!0),i(y,A),A.raycast&&A.__r3f.eventCount&&Gx(A).getState().internal.interaction.push(A),[I,I.alternate].forEach(m=>{m!==null&&(m.stateNode=A,m.ref&&(typeof m.ref=="function"?m.ref(A):m.ref.current=A))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:oOe({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,d)=>{if(!d)return;const h=u.getState().scene;h.__r3f&&(h.__r3f.root=u,i(h,d))},removeChildFromContainer:(u,d)=>{d&&o(u.getState().scene,d)},insertInContainerBefore:(u,d,h)=>{if(!d||!h)return;const I=u.getState().scene;I.__r3f&&r(I,d,h)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var d;return!!((d=u==null?void 0:u.__r3f)!=null?d:{}).handlers},prepareUpdate(u,d,h,I){var p;if(((p=u==null?void 0:u.__r3f)!=null?p:{}).primitive&&I.object&&I.object!==u)return[!0];{const{args:A=[],children:m,...b}=I,{args:v=[],children:w,...x}=h;if(!Array.isArray(A))throw new Error("R3F: the args prop must be an array!");if(A.some((Z,N)=>Z!==v[N]))return[!0];const B=vte(u,b,x,!0);return B.changes.length?[!1,B]:null}},commitUpdate(u,[d,h],I,p,y,A){d?a(u,I,y,A):JR(u,h)},commitMount(u,d,h,I){var p;const y=(p=u.__r3f)!=null?p:{};u.raycast&&y.handlers&&y.eventCount&&Gx(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>II(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var d;const{attach:h,parent:I}=(d=u.__r3f)!=null?d:{};h&&I&&Tz(I,u,h),u.isObject3D&&(u.visible=!1),fI(u)},unhideInstance(u,d){var h;const{attach:I,parent:p}=(h=u.__r3f)!=null?h:{};I&&p&&UR(p,u,I),(u.isObject3D&&d.visible==null||d.visible)&&(u.visible=!0),fI(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():TI.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&gi.fun(performance.now)?performance.now:gi.fun(Date.now)?Date.now:()=>0,scheduleTimeout:gi.fun(setTimeout)?setTimeout:void 0,cancelTimeout:gi.fun(clearTimeout)?clearTimeout:void 0}),applyProps:JR}}var Mz,Vz;const DR=t=>"colorSpace"in t||"outputColorSpace"in t,Cte=()=>{var t;return(t=k_.ColorManagement)!=null?t:null},pte=t=>t&&t.isOrthographicCamera,dOe=t=>t&&t.hasOwnProperty("current"),dy=typeof window<"u"&&((Mz=window.document)!=null&&Mz.createElement||((Vz=window.navigator)==null?void 0:Vz.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function mte(t){const e=S.useRef(t);return dy(()=>void(e.current=t),[t]),e}function hOe({set:t}){return dy(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class Ate extends S.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Ate.getDerivedStateFromError=()=>({error:!0});const yte="__default",Fz=new Map,IOe=t=>t&&!!t.memoized&&!!t.changes;function bte(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const $p=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};function Gx(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const gi={obj:t=>t===Object(t)&&!gi.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(gi.str(t)||gi.num(t)||gi.boo(t))return t===e;const s=gi.obj(t);if(s&&i==="reference")return t===e;const o=gi.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!gi.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(gi.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function fOe(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function COe(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function II(t,e){const n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function K3(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}const _z=/-\d+$/;function UR(t,e,n){if(gi.str(n)){if(_z.test(n)){const s=n.replace(_z,""),{target:o,key:a}=K3(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=K3(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function Tz(t,e,n){var i,r;if(gi.str(n)){const{target:s,key:o}=K3(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function vte(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},c=!1){const u=t.__r3f,d=Object.entries(r),h=[];if(c){const p=Object.keys(l);for(let y=0;y<p.length;y++)r.hasOwnProperty(p[y])||d.unshift([p[y],yte+"remove"])}d.forEach(([p,y])=>{var A;if((A=t.__r3f)!=null&&A.primitive&&p==="object"||gi.equ(y,l[p]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(p))return h.push([p,y,!0,[]]);let m=[];p.includes("-")&&(m=p.split("-")),h.push([p,y,!1,m]);for(const b in r){const v=r[b];b.startsWith(`${p}-`)&&h.push([b,v,!1,b.split("-")])}});const I={...r};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(I.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(I.attach=u.memoizedProps.attach),{memoized:I,changes:h}}const pOe=typeof process<"u"&&!1;function JR(t,e){var n;const i=t.__r3f,r=i==null?void 0:i.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=IOe(e)?e:vte(t,e),l=i==null?void 0:i.eventCount;t.__r3f&&(t.__r3f.memoizedProps=o);for(let u=0;u<a.length;u++){let[d,h,I,p]=a[u];if(DR(t)){const b="srgb",v="srgb-linear";d==="encoding"?(d="colorSpace",h=h===3001?b:v):d==="outputEncoding"&&(d="outputColorSpace",h=h===3001?b:v)}let y=t,A=y[d];if(p.length&&(A=p.reduce((m,b)=>m[b],t),!(A&&A.set))){const[m,...b]=p.reverse();y=b.reverse().reduce((v,w)=>v[w],t),d=m}if(h===yte+"remove")if(y.constructor){let m=Fz.get(y.constructor);m||(m=new y.constructor,Fz.set(y.constructor,m)),h=m[d]}else h=0;if(I&&i)h?i.handlers[d]=h:delete i.handlers[d],i.eventCount=Object.keys(i.handlers).length;else if(A&&A.set&&(A.copy||A instanceof Yd)){if(Array.isArray(h))A.fromArray?A.fromArray(h):A.set(...h);else if(A.copy&&h&&h.constructor&&(pOe?A.constructor.name===h.constructor.name:A.constructor===h.constructor))A.copy(h);else if(h!==void 0){const m=A instanceof wt;!m&&A.setScalar?A.setScalar(h):A instanceof Yd&&h instanceof Yd?A.mask=h.mask:A.set(h),!Cte()&&s&&!s.linear&&m&&A.convertSRGBToLinear()}}else if(y[d]=h,y[d]instanceof $n&&y[d].format===Ki&&y[d].type===Ss&&s){const m=y[d];DR(m)&&DR(s.gl)?m.colorSpace=s.gl.outputColorSpace:m.encoding=s.gl.outputEncoding}fI(t)}if(i&&i.parent&&t.raycast&&l!==i.eventCount){const u=Gx(t).getState().internal,d=u.interaction.indexOf(t);d>-1&&u.interaction.splice(d,1),i.eventCount&&u.interaction.push(t)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(n=t.__r3f)!=null&&n.parent&&L3(t),t}function fI(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function L3(t){t.onUpdate==null||t.onUpdate(t)}function xte(t,e){t.manual||(pte(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function Yv(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function mOe(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return TI.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return TI.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return TI.ContinuousEventPriority;default:return TI.DefaultEventPriority}}function wte(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function AOe(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{wte(n.capturedMap,e,i,r)})}function yOe(t){function e(l){const{internal:c}=t.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function i(l,c){const u=t.getState(),d=new Set,h=[],I=c?c(u.internal.interaction):u.internal.interaction;for(let m=0;m<I.length;m++){const b=$p(I[m]);b&&(b.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(m){const b=$p(m);if(!b||!b.events.enabled||b.raycaster.camera===null)return[];if(b.raycaster.camera===void 0){var v;b.events.compute==null||b.events.compute(l,b,(v=b.previousRoot)==null?void 0:v.getState()),b.raycaster.camera===void 0&&(b.raycaster.camera=null)}return b.raycaster.camera?b.raycaster.intersectObject(m,!0):[]}let y=I.flatMap(p).sort((m,b)=>{const v=$p(m.object),w=$p(b.object);return!v||!w?m.distance-b.distance:w.events.priority-v.events.priority||m.distance-b.distance}).filter(m=>{const b=Yv(m);return d.has(b)?!1:(d.add(b),!0)});u.events.filter&&(y=u.events.filter(y,u));for(const m of y){let b=m.object;for(;b;){var A;(A=b.__r3f)!=null&&A.eventCount&&h.push({...m,eventObject:b}),b=b.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let m of u.internal.capturedMap.get(l.pointerId).values())d.has(Yv(m.intersection))||h.push(m.intersection);return h}function r(l,c,u,d){const h=t.getState();if(l.length){const I={stopped:!1};for(const p of l){const y=$p(p.object)||h,{raycaster:A,pointer:m,camera:b,internal:v}=y,w=new J(m.x,m.y,0).unproject(b),x=M=>{var F,T;return(F=(T=v.capturedMap.get(M))==null?void 0:T.has(p.eventObject))!=null?F:!1},B=M=>{const F={intersection:p,target:c.target};v.capturedMap.has(M)?v.capturedMap.get(M).set(p.eventObject,F):v.capturedMap.set(M,new Map([[p.eventObject,F]])),c.target.setPointerCapture(M)},Z=M=>{const F=v.capturedMap.get(M);F&&wte(v.capturedMap,p.eventObject,F,M)};let N={};for(let M in c){let F=c[M];typeof F!="function"&&(N[M]=F)}let W={...p,...N,pointer:m,intersections:l,stopped:I.stopped,delta:u,unprojectedPoint:w,ray:A.ray,camera:b,stopPropagation(){const M="pointerId"in c&&v.capturedMap.get(c.pointerId);if((!M||M.has(p.eventObject))&&(W.stopped=I.stopped=!0,v.hovered.size&&Array.from(v.hovered.values()).find(F=>F.eventObject===p.eventObject))){const F=l.slice(0,l.indexOf(p));s([...F,p])}},target:{hasPointerCapture:x,setPointerCapture:B,releasePointerCapture:Z},currentTarget:{hasPointerCapture:x,setPointerCapture:B,releasePointerCapture:Z},nativeEvent:c};if(d(W),I.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const h=u.eventObject.__r3f,I=h==null?void 0:h.handlers;if(c.hovered.delete(Yv(u)),h!=null&&h.eventCount){const p={...u,intersections:l};I.onPointerOut==null||I.onPointerOut(p),I.onPointerLeave==null||I.onPointerLeave(p)}}}function o(l,c){for(let u=0;u<c.length;u++){const d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=t.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:d,internal:h}=t.getState();h.lastEvent.current=u;const I=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",A=i(u,I?n:void 0),m=p?e(u):0;l==="onPointerDown"&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=A.map(v=>v.eventObject)),p&&!A.length&&m<=2&&(o(u,h.interaction),d&&d(u)),I&&s(A);function b(v){const w=v.eventObject,x=w.__r3f,B=x==null?void 0:x.handlers;if(x!=null&&x.eventCount)if(I){if(B.onPointerOver||B.onPointerEnter||B.onPointerOut||B.onPointerLeave){const Z=Yv(v),N=h.hovered.get(Z);N?N.stopped&&v.stopPropagation():(h.hovered.set(Z,v),B.onPointerOver==null||B.onPointerOver(v),B.onPointerEnter==null||B.onPointerEnter(v))}B.onPointerMove==null||B.onPointerMove(v)}else{const Z=B[l];Z?(!p||h.initialHits.includes(w))&&(o(u,h.interaction.filter(N=>!h.initialHits.includes(N))),Z(v)):p&&h.initialHits.includes(w)&&o(u,h.interaction.filter(N=>!h.initialHits.includes(N)))}}r(A,u,m,b)}}return{handlePointer:a}}const bOe=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],Gte=t=>!!(t!=null&&t.render),K_=S.createContext(null),vOe=(t,e)=>{const n=gte((a,l)=>{const c=new J,u=new J,d=new J;function h(m=l().camera,b=u,v=l().size){const{width:w,height:x,top:B,left:Z}=v,N=w/x;b instanceof J?d.copy(b):d.set(...b);const W=m.getWorldPosition(c).distanceTo(d);if(pte(m))return{width:w/m.zoom,height:x/m.zoom,top:B,left:Z,factor:1,distance:W,aspect:N};{const M=m.fov*Math.PI/180,F=2*Math.tan(M/2)*W,T=F*(w/x);return{width:T,height:F,top:B,left:Z,factor:w/T,distance:W,aspect:N}}}let I;const p=m=>a(b=>({performance:{...b.performance,current:m}})),y=new He;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(m=1)=>t(l(),m),advance:(m,b)=>e(m,b,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new V_,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const m=l();I&&clearTimeout(I),m.performance.current!==m.performance.min&&p(m.performance.min),I=setTimeout(()=>p(l().performance.max),m.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:m=>a(b=>({...b,events:{...b.events,...m}})),setSize:(m,b,v,w,x)=>{const B=l().camera,Z={width:m,height:b,top:w||0,left:x||0,updateStyle:v};a(N=>({size:Z,viewport:{...N.viewport,...h(B,u,Z)}}))},setDpr:m=>a(b=>{const v=bte(m);return{viewport:{...b.viewport,dpr:v,initialDpr:b.viewport.initialDpr||v}}}),setFrameloop:(m="always")=>{const b=l().clock;b.stop(),b.elapsedTime=0,m!=="never"&&(b.start(),b.elapsedTime=0),a(()=>({frameloop:m}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:S.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(m,b,v)=>{const w=l().internal;return w.priority=w.priority+(b>0?1:0),w.subscribers.push({ref:m,priority:b,store:v}),w.subscribers=w.subscribers.sort((x,B)=>x.priority-B.priority),()=>{const x=l().internal;x!=null&&x.subscribers&&(x.priority=x.priority-(b>0?1:0),x.subscribers=x.subscribers.filter(B=>B.ref!==m))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:d}=n.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==s){var h;r=l,s=c.dpr,xte(a,l),u.setPixelRatio(c.dpr);const I=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,I)}a!==o&&(o=a,d(I=>({viewport:{...I.viewport,...I.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};let kv,xOe=new Set,wOe=new Set,GOe=new Set;function QR(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function em(t,e){switch(t){case"before":return QR(xOe,e);case"after":return QR(wOe,e);case"tail":return QR(GOe,e)}}let qR,$R;function eN(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),qR=e.internal.subscribers,kv=0;kv<qR.length;kv++)$R=qR[kv],$R.ref.current($R.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function BOe(t){let e=!1,n=!1,i,r,s;function o(c){r=requestAnimationFrame(o),e=!0,i=0,em("before",c),n=!0;for(const d of t.values()){var u;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(i+=eN(c,s))}if(n=!1,em("after",c),i===0)return em("tail",c),e=!1,cancelAnimationFrame(r)}function a(c,u=1){var d;if(!c)return t.forEach(h=>a(h.store.getState(),u));(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):n?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,d,h){if(u&&em("before",c),d)eN(c,d,h);else for(const I of t.values())eN(c,I.store.getState());u&&em("after",c)}return{loop:o,invalidate:a,advance:l}}function L_(){const t=S.useContext(K_);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Fr(t=n=>n,e){return L_()(t,e)}function Fs(t,e=0){const n=L_(),i=n.getState().internal.subscribe,r=mte(t);return dy(()=>i(r,e,n),[e,i,n]),null}const Xz=new WeakMap;function Bte(t,e){return function(n,...i){let r=Xz.get(n);return r||(r=new n,Xz.set(n,r)),t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,fOe(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function a2(t,e,n,i){const r=Array.isArray(e)?e:[e],s=lOe(Bte(n,i),[t,...r],{equal:gi.equ});return Array.isArray(e)?s:s[0]}a2.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return cOe(Bte(n),[t,...i])};a2.clear=function(t,e){const n=Array.isArray(e)?e:[e];return gOe([t,...n])};const bC=new Map,{invalidate:Ez,advance:Yz}=BOe(bC),{reconciler:p0,applyProps:bg}=uOe(bC,mOe),hI={objects:"shallow",strict:!1},SOe=(t,e)=>{const n=typeof t=="function"?t(e):t;return Gte(n)?n:new Y_({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function ZOe(t,e){const n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=n}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:r,top:s,left:o}=t.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function ROe(t){const e=bC.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||vOe(Ez,Yz),o=n||p0.createContainer(s,TI.ConcurrentRoot,null,!1,null,"",r,null);e||bC.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:d,size:h,scene:I,events:p,onCreated:y,shadows:A=!1,linear:m=!1,flat:b=!1,legacy:v=!1,orthographic:w=!1,frameloop:x="always",dpr:B=[1,2],performance:Z,raycaster:N,camera:W,onPointerMissed:M}=u,F=s.getState(),T=F.gl;F.gl||F.set({gl:T=SOe(d,t)});let H=F.raycaster;H||F.set({raycaster:H=new X_});const{params:K,...z}=N||{};if(gi.equ(z,H,hI)||bg(H,{...z}),gi.equ(K,H.params,hI)||bg(H,{params:{...H.params,...K}}),!F.camera||F.camera===c&&!gi.equ(c,W,hI)){c=W;const P=W instanceof iy,q=P?W:w?new Ua(0,0,0,0,.1,1e3):new Wi(75,0,.1,1e3);P||(q.position.z=5,W&&(bg(q,W),("aspect"in W||"left"in W||"right"in W||"bottom"in W||"top"in W)&&(q.manual=!0,q.updateProjectionMatrix())),!F.camera&&!(W!=null&&W.rotation)&&q.lookAt(0,0,0)),F.set({camera:q}),H.camera=q}if(!F.scene){let P;I instanceof gu?P=I:(P=new gu,I&&bg(P,I)),F.set({scene:II(P)})}if(!F.xr){var j;const P=(de,Re)=>{const Pe=s.getState();Pe.frameloop!=="never"&&Yz(de,!0,Pe,Re)},q=()=>{const de=s.getState();de.gl.xr.enabled=de.gl.xr.isPresenting,de.gl.xr.setAnimationLoop(de.gl.xr.isPresenting?P:null),de.gl.xr.isPresenting||Ez(de)},re={connect(){const de=s.getState().gl;de.xr.addEventListener("sessionstart",q),de.xr.addEventListener("sessionend",q)},disconnect(){const de=s.getState().gl;de.xr.removeEventListener("sessionstart",q),de.xr.removeEventListener("sessionend",q)}};typeof((j=T.xr)==null?void 0:j.addEventListener)=="function"&&re.connect(),F.set({xr:re})}if(T.shadowMap){const P=T.shadowMap.enabled,q=T.shadowMap.type;if(T.shadowMap.enabled=!!A,gi.boo(A))T.shadowMap.type=Km;else if(gi.str(A)){var O;const re={basic:f$,percentage:OB,soft:Km,variance:Na};T.shadowMap.type=(O=re[A])!=null?O:Km}else gi.obj(A)&&Object.assign(T.shadowMap,A);(P!==T.shadowMap.enabled||q!==T.shadowMap.type)&&(T.shadowMap.needsUpdate=!0)}const _=Cte();_&&("enabled"in _?_.enabled=!v:"legacyMode"in _&&(_.legacyMode=v)),l||bg(T,{outputEncoding:m?3e3:3001,toneMapping:b?Tl:qF}),F.legacy!==v&&F.set(()=>({legacy:v})),F.linear!==m&&F.set(()=>({linear:m})),F.flat!==b&&F.set(()=>({flat:b})),d&&!gi.fun(d)&&!Gte(d)&&!gi.equ(d,T,hI)&&bg(T,d),p&&!F.events.handlers&&F.set({events:p(s)});const E=ZOe(t,h);return gi.equ(E,F.size,hI)||F.setSize(E.width,E.height,E.updateStyle,E.top,E.left),B&&F.viewport.dpr!==bte(B)&&F.setDpr(B),F.frameloop!==x&&F.setFrameloop(x),F.onPointerMissed||F.set({onPointerMissed:M}),Z&&!gi.equ(Z,F.performance,hI)&&F.set(P=>({performance:{...P.performance,...Z}})),a=y,l=!0,this},render(u){return l||this.configure(),p0.updateContainer(g.jsx(NOe,{store:s,children:u,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){Ste(t)}}}function NOe({store:t,children:e,onCreated:n,rootElement:i}){return dy(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),g.jsx(K_.Provider,{value:t,children:e})}function Ste(t,e){const n=bC.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),p0.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),COe(r),bC.delete(t)}catch{}},500)})}}function WOe(t,e,n){return g.jsx(MOe,{children:t,container:e,state:n},e.uuid)}function MOe({state:t={},children:e,container:n}){const{events:i,size:r,...s}=t,o=L_(),[a]=S.useState(()=>new X_),[l]=S.useState(()=>new He),c=S.useCallback((d,h)=>{const I={...d};Object.keys(d).forEach(y=>{(bOe.includes(y)||d[y]!==h[y]&&h[y])&&delete I[y]});let p;if(h&&r){const y=h.camera;p=d.viewport.getCurrentViewport(y,new J,r),y!==d.camera&&xte(y,r)}return{...I,scene:n,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...d.events,...h==null?void 0:h.events,...i},size:{...d.size,...r},viewport:{...d.viewport,...p},...s}},[t]),[u]=S.useState(()=>{const d=o.getState();return gte((I,p)=>({...d,scene:n,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...d.events,...i},size:{...d.size,...r},...s,set:I,get:p,setEvents:y=>I(A=>({...A,events:{...A.events,...y}}))}))});return S.useEffect(()=>{const d=o.subscribe(h=>u.setState(I=>c(h,I)));return()=>{d()}},[c]),S.useEffect(()=>{u.setState(d=>c(o.getState(),d))},[c]),S.useEffect(()=>()=>{u.destroy()},[]),g.jsx(g.Fragment,{children:p0.createPortal(g.jsx(K_.Provider,{value:u,children:e}),u,null)})}p0.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:S.version});function kz(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function VOe({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=S.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=S.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,c=t?typeof t=="number"?t:t.resize:null,u=S.useRef(!1);S.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,h,I]=S.useMemo(()=>{const m=()=>{if(!a.current.element)return;const{left:b,top:v,width:w,height:x,bottom:B,right:Z,x:N,y:W}=a.current.element.getBoundingClientRect(),M={left:b,top:v,width:w,height:x,bottom:B,right:Z,x:N,y:W};a.current.element instanceof HTMLElement&&i&&(M.height=a.current.element.offsetHeight,M.width=a.current.element.offsetWidth),Object.freeze(M),u.current&&!XOe(a.current.lastBounds,M)&&o(a.current.lastBounds=M)};return[m,c?kz(m,c):m,l?kz(m,l):m]},[o,i,l,c]);function p(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(m=>m.removeEventListener("scroll",I,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function y(){a.current.element&&(a.current.resizeObserver=new r(I),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(m=>m.addEventListener("scroll",I,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{I()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const A=m=>{!m||m===a.current.element||(p(),a.current.element=m,a.current.scrollContainers=Zte(m),y())};return _Oe(I,!!e),FOe(h),S.useEffect(()=>{p(),y()},[e,I,h]),S.useEffect(()=>p,[]),[A,s,d]}function FOe(t){S.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function _Oe(t,e){S.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function Zte(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...Zte(t.parentElement)]}const TOe=["x","y","top","bottom","left","right","width","height"],XOe=(t,e)=>TOe.every(n=>t[n]===e[n]);var EOe=Object.defineProperty,YOe=Object.defineProperties,kOe=Object.getOwnPropertyDescriptors,Hz=Object.getOwnPropertySymbols,HOe=Object.prototype.hasOwnProperty,KOe=Object.prototype.propertyIsEnumerable,Kz=(t,e,n)=>e in t?EOe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lz=(t,e)=>{for(var n in e||(e={}))HOe.call(e,n)&&Kz(t,n,e[n]);if(Hz)for(var n of Hz(e))KOe.call(e,n)&&Kz(t,n,e[n]);return t},LOe=(t,e)=>YOe(t,kOe(e)),zz,jz;typeof window<"u"&&((zz=window.document)!=null&&zz.createElement||((jz=window.navigator)==null?void 0:jz.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function Rte(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=t.child;for(;i;){const r=Rte(i,e,n);if(r)return r;i=i.sibling}}function Nte(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const Pz=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=Pz;return}return Pz.apply(this,arguments)};const z_=Nte(S.createContext(null));class Wte extends S.Component{render(){return S.createElement(z_.Provider,{value:this._reactInternals},this.props.children)}}function zOe(){const t=S.useContext(z_);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=S.useId();return S.useMemo(()=>{for(const i of[t,t==null?void 0:t.alternate]){if(!i)continue;const r=Rte(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function jOe(){const t=zOe(),[e]=S.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const r=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;r&&r!==z_&&!e.has(r)&&e.set(r,S.useContext(Nte(r)))}n=n.return}return e}function POe(){const t=jOe();return S.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>S.createElement(e,null,S.createElement(n.Provider,LOe(Lz({},i),{value:t.get(n)}))),e=>S.createElement(Wte,Lz({},e))),[t])}const tN={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function OOe(t){const{handlePointer:e}=yOe(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(tN).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,c]=tN[o];n.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=tN[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}const DOe=S.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=OOe,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:h,orthographic:I,frameloop:p,dpr:y,performance:A,raycaster:m,camera:b,scene:v,onPointerMissed:w,onCreated:x,...B},Z){S.useMemo(()=>H_($Pe),[]);const N=POe(),[W,M]=VOe({scroll:!0,debounce:{scroll:50,resize:0},...i}),F=S.useRef(null),T=S.useRef(null);S.useImperativeHandle(Z,()=>F.current);const H=mte(w),[K,z]=S.useState(!1),[j,O]=S.useState(!1);if(K)throw K;if(j)throw j;const _=S.useRef(null);dy(()=>{const P=F.current;M.width>0&&M.height>0&&P&&(_.current||(_.current=ROe(P)),_.current.configure({gl:s,events:o,shadows:c,linear:u,flat:d,legacy:h,orthographic:I,frameloop:p,dpr:y,performance:A,raycaster:m,camera:b,scene:v,size:M,onPointerMissed:(...q)=>H.current==null?void 0:H.current(...q),onCreated:q=>{q.events.connect==null||q.events.connect(a?dOe(a)?a.current:a:T.current),l&&q.setEvents({compute:(re,de)=>{const Re=re[l+"X"],Pe=re[l+"Y"];de.pointer.set(Re/de.size.width*2-1,-(Pe/de.size.height)*2+1),de.raycaster.setFromCamera(de.pointer,de.camera)}}),x==null||x(q)}}),_.current.render(g.jsx(N,{children:g.jsx(Ate,{set:O,children:g.jsx(S.Suspense,{fallback:g.jsx(hOe,{set:z}),children:e})})})))}),S.useEffect(()=>{const P=F.current;if(P)return()=>Ste(P)},[]);const E=a?"none":"auto";return g.jsx("div",{ref:T,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:E,...r},...B,children:g.jsx("div",{ref:W,style:{width:"100%",height:"100%"},children:g.jsx("canvas",{ref:F,style:{display:"block"},children:n})})})}),UOe=S.forwardRef(function(e,n){return g.jsx(Wte,{children:g.jsx(DOe,{...e,ref:n})})}),hy=new J,j_=new J,JOe=new J,Oz=new He;function QOe(t,e,n){const i=hy.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}function qOe(t,e){const n=hy.setFromMatrixPosition(t.matrixWorld),i=j_.setFromMatrixPosition(e.matrixWorld),r=n.sub(i),s=e.getWorldDirection(JOe);return r.angleTo(s)>Math.PI/2}function $Oe(t,e,n,i){const r=hy.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),Oz.set(s.x,s.y),n.setFromCamera(Oz,e);const o=n.intersectObjects(i,!0);if(o.length){const a=o[0].distance;return r.distanceTo(n.ray.origin)<a}return!0}function eDe(t,e){if(e instanceof Ua)return e.zoom;if(e instanceof Wi){const n=hy.setFromMatrixPosition(t.matrixWorld),i=j_.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function tDe(t,e,n){if(e instanceof Wi||e instanceof Ua){const i=hy.setFromMatrixPosition(t.matrixWorld),r=j_.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(e.far-e.near),a=n[1]-o*e.far;return Math.round(o*s+a)}}const z3=t=>Math.abs(t)<1e-10?0:t;function Mte(t,e,n=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=z3(e[r]*t.elements[r])+(r!==15?",":")");return n+i}const nDe=(t=>e=>Mte(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),iDe=(t=>(e,n)=>Mte(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function rDe(t){return t&&typeof t=="object"&&"current"in t}const P_=S.forwardRef(({children:t,eps:e=.001,style:n,className:i,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:d,onOcclude:h,castShadow:I,receiveShadow:p,material:y,geometry:A,zIndexRange:m=[16777271,0],calculatePosition:b=QOe,as:v="div",wrapperClass:w,pointerEvents:x="auto",...B},Z)=>{const{gl:N,camera:W,scene:M,size:F,raycaster:T,events:H,viewport:K}=Fr(),[z]=S.useState(()=>document.createElement(v)),j=S.useRef(),O=S.useRef(null),_=S.useRef(0),E=S.useRef([0,0]),P=S.useRef(null),q=S.useRef(null),re=(a==null?void 0:a.current)||H.connected||N.domElement.parentNode,de=S.useRef(null),Re=S.useRef(!1),Pe=S.useMemo(()=>d&&d!=="blending"||Array.isArray(d)&&d.length&&rDe(d[0]),[d]);S.useLayoutEffect(()=>{const xe=N.domElement;d&&d==="blending"?(xe.style.zIndex=`${Math.floor(m[0]/2)}`,xe.style.position="absolute",xe.style.pointerEvents="none"):(xe.style.zIndex=null,xe.style.position=null,xe.style.pointerEvents=null)},[d]),S.useLayoutEffect(()=>{if(O.current){const xe=j.current=UV(z);if(M.updateMatrixWorld(),u)z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Ge=b(O.current,W,F);z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Ge[0]}px,${Ge[1]}px,0);transform-origin:0 0;`}return re&&(r?re.prepend(z):re.appendChild(z)),()=>{re&&re.removeChild(z),xe.unmount()}}},[re,u]),S.useLayoutEffect(()=>{w&&(z.className=w)},[w]);const ae=S.useMemo(()=>u?{position:"absolute",top:0,left:0,width:F.width,height:F.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-F.height/2,left:-F.width/2,width:F.width,height:F.height},...n},[n,s,o,F,u]),he=S.useMemo(()=>({position:"absolute",pointerEvents:x}),[x]);S.useLayoutEffect(()=>{if(Re.current=!1,u){var xe;(xe=j.current)==null||xe.render(S.createElement("div",{ref:P,style:ae},S.createElement("div",{ref:q,style:he},S.createElement("div",{ref:Z,className:i,style:n,children:t}))))}else{var Ge;(Ge=j.current)==null||Ge.render(S.createElement("div",{ref:Z,style:ae,className:i,children:t}))}});const Me=S.useRef(!0);Fs(xe=>{if(O.current){W.updateMatrixWorld(),O.current.updateWorldMatrix(!0,!1);const Ge=u?E.current:b(O.current,W,F);if(u||Math.abs(_.current-W.zoom)>e||Math.abs(E.current[0]-Ge[0])>e||Math.abs(E.current[1]-Ge[1])>e){const pe=qOe(O.current,W);let Oe=!1;Pe&&(Array.isArray(d)?Oe=d.map(Xe=>Xe.current):d!=="blending"&&(Oe=[M]));const ve=Me.current;if(Oe){const Xe=$Oe(O.current,W,T,Oe);Me.current=Xe&&!pe}else Me.current=!pe;ve!==Me.current&&(h?h(!Me.current):z.style.display=Me.current?"block":"none");const U=Math.floor(m[0]/2),We=d?Pe?[m[0],U]:[U-1,0]:m;if(z.style.zIndex=`${tDe(O.current,W,We)}`,u){const[Xe,Qe]=[F.width/2,F.height/2],Le=W.projectionMatrix.elements[5]*Qe,{isOrthographicCamera:mt,top:ot,left:ft,bottom:Q,right:L}=W,Ce=nDe(W.matrixWorldInverse),Ve=mt?`scale(${Le})translate(${z3(-(L+ft)/2)}px,${z3((ot+Q)/2)}px)`:`translateZ(${Le}px)`;let Ke=O.current.matrixWorld;c&&(Ke=W.matrixWorldInverse.clone().transpose().copyPosition(Ke).scale(O.current.scale),Ke.elements[3]=Ke.elements[7]=Ke.elements[11]=0,Ke.elements[15]=1),z.style.width=F.width+"px",z.style.height=F.height+"px",z.style.perspective=mt?"":`${Le}px`,P.current&&q.current&&(P.current.style.transform=`${Ve}${Ce}translate(${Xe}px,${Qe}px)`,q.current.style.transform=iDe(Ke,1/((l||10)/400)))}else{const Xe=l===void 0?1:eDe(O.current,W)*l;z.style.transform=`translate3d(${Ge[0]}px,${Ge[1]}px,0) scale(${Xe})`}E.current=Ge,_.current=W.zoom}}if(!Pe&&de.current&&!Re.current)if(u){if(P.current){const Ge=P.current.children[0];if(Ge!=null&&Ge.clientWidth&&Ge!=null&&Ge.clientHeight){const{isOrthographicCamera:pe}=W;if(pe||A)B.scale&&(Array.isArray(B.scale)?B.scale instanceof J?de.current.scale.copy(B.scale.clone().divideScalar(1)):de.current.scale.set(1/B.scale[0],1/B.scale[1],1/B.scale[2]):de.current.scale.setScalar(1/B.scale));else{const Oe=(l||10)/400,ve=Ge.clientWidth*Oe,U=Ge.clientHeight*Oe;de.current.scale.set(ve,U,1)}Re.current=!0}}}else{const Ge=z.children[0];if(Ge!=null&&Ge.clientWidth&&Ge!=null&&Ge.clientHeight){const pe=1/K.factor,Oe=Ge.clientWidth*pe,ve=Ge.clientHeight*pe;de.current.scale.set(Oe,ve,1),Re.current=!0}de.current.lookAt(xe.camera.position)}});const be=S.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return S.createElement("group",kf({},B,{ref:O}),d&&!Pe&&S.createElement("mesh",{castShadow:I,receiveShadow:p,ref:de},A||S.createElement("planeGeometry",null),y||S.createElement("shaderMaterial",{side:rs,vertexShader:be.vertexShader,fragmentShader:be.fragmentShader})))}),Vte=parseInt(mh.replace(/\D+/g,""));var Qo=Uint8Array,Hg=Uint16Array,j3=Uint32Array,Fte=new Qo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_te=new Qo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sDe=new Qo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tte=function(t,e){for(var n=new Hg(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new j3(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},Xte=Tte(Fte,2),Ete=Xte[0],oDe=Xte[1];Ete[28]=258,oDe[258]=28;var aDe=Tte(_te,0),lDe=aDe[0],P3=new Hg(32768);for(var bi=0;bi<32768;++bi){var Ig=(bi&43690)>>>1|(bi&21845)<<1;Ig=(Ig&52428)>>>2|(Ig&13107)<<2,Ig=(Ig&61680)>>>4|(Ig&3855)<<4,P3[bi]=((Ig&65280)>>>8|(Ig&255)<<8)>>>1}var Jm=function(t,e,n){for(var i=t.length,r=0,s=new Hg(e);r<i;++r)++s[t[r]-1];var o=new Hg(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(n){a=new Hg(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],d=o[t[r]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)a[P3[d]>>>l]=c}else for(a=new Hg(i),r=0;r<i;++r)t[r]&&(a[r]=P3[o[t[r]-1]++]>>>15-t[r]);return a},Iy=new Qo(288);for(var bi=0;bi<144;++bi)Iy[bi]=8;for(var bi=144;bi<256;++bi)Iy[bi]=9;for(var bi=256;bi<280;++bi)Iy[bi]=7;for(var bi=280;bi<288;++bi)Iy[bi]=8;var Yte=new Qo(32);for(var bi=0;bi<32;++bi)Yte[bi]=5;var cDe=Jm(Iy,9,1),gDe=Jm(Yte,5,1),nN=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},wa=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},iN=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},uDe=function(t){return(t/8|0)+(t&7&&1)},dDe=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof Hg?Hg:t instanceof j3?j3:Qo)(n-e);return i.set(t.subarray(e,n)),i},hDe=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Qo(0);var r=!e||n,s=!n||n.i;n||(n={}),e||(e=new Qo(i*3));var o=function(ae){var he=e.length;if(ae>he){var Me=new Qo(Math.max(he*2,ae));Me.set(e),e=Me}},a=n.f||0,l=n.p||0,c=n.b||0,u=n.l,d=n.d,h=n.m,I=n.n,p=i*8;do{if(!u){n.f=a=wa(t,l,1);var y=wa(t,l+1,3);if(l+=3,y)if(y==1)u=cDe,d=gDe,h=9,I=5;else if(y==2){var v=wa(t,l,31)+257,w=wa(t,l+10,15)+4,x=v+wa(t,l+5,31)+1;l+=14;for(var B=new Qo(x),Z=new Qo(19),N=0;N<w;++N)Z[sDe[N]]=wa(t,l+N*3,7);l+=w*3;for(var W=nN(Z),M=(1<<W)-1,F=Jm(Z,W,1),N=0;N<x;){var T=F[wa(t,l,M)];l+=T&15;var A=T>>>4;if(A<16)B[N++]=A;else{var H=0,K=0;for(A==16?(K=3+wa(t,l,3),l+=2,H=B[N-1]):A==17?(K=3+wa(t,l,7),l+=3):A==18&&(K=11+wa(t,l,127),l+=7);K--;)B[N++]=H}}var z=B.subarray(0,v),j=B.subarray(v);h=nN(z),I=nN(j),u=Jm(z,h,1),d=Jm(j,I,1)}else throw"invalid block type";else{var A=uDe(l)+4,m=t[A-4]|t[A-3]<<8,b=A+m;if(b>i){if(s)throw"unexpected EOF";break}r&&o(c+m),e.set(t.subarray(A,b),c),n.b=c+=m,n.p=l=b*8;continue}if(l>p){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var O=(1<<h)-1,_=(1<<I)-1,E=l;;E=l){var H=u[iN(t,l)&O],P=H>>>4;if(l+=H&15,l>p){if(s)throw"unexpected EOF";break}if(!H)throw"invalid length/literal";if(P<256)e[c++]=P;else if(P==256){E=l,u=null;break}else{var q=P-254;if(P>264){var N=P-257,re=Fte[N];q=wa(t,l,(1<<re)-1)+Ete[N],l+=re}var de=d[iN(t,l)&_],Re=de>>>4;if(!de)throw"invalid distance";l+=de&15;var j=lDe[Re];if(Re>3){var re=_te[Re];j+=iN(t,l)&(1<<re)-1,l+=re}if(l>p){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var Pe=c+q;c<Pe;c+=4)e[c]=e[c-j],e[c+1]=e[c+1-j],e[c+2]=e[c+2-j],e[c+3]=e[c+3-j];c=Pe}}n.l=u,n.p=E,n.b=c,u&&(a=1,n.m=h,n.d=d,n.n=I)}while(!a);return c==e.length?e:dDe(e,0,c)},IDe=new Qo(0),fDe=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Hv(t,e){return hDe((fDe(t),t.subarray(2,-4)),e)}var CDe=typeof TextDecoder<"u"&&new TextDecoder,pDe=0;try{CDe.decode(IDe,{stream:!0}),pDe=1}catch{}const mDe=t=>t&&t.isCubeTexture;class ADe extends Li{constructor(e,n){var i,r;const s=mDe(e),a=((r=s?(i=e.image[0])==null?void 0:i.width:e.image.width)!=null?r:1024)/4,l=Math.floor(Math.log2(a)),c=Math.pow(2,l),u=3*Math.max(c,16*7),d=4*c,h=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${l}.0`],I=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,p=h.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Vte>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,y={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},A=new ay(1,16),m=new as({uniforms:y,fragmentShader:p,vertexShader:I,side:rs});super(A,m)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var yDe=Object.defineProperty,bDe=(t,e,n)=>e in t?yDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vDe=(t,e,n)=>(bDe(t,e+"",n),n);class xDe{constructor(){vDe(this,"_listeners")}addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var wDe=Object.defineProperty,GDe=(t,e,n)=>e in t?wDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jt=(t,e,n)=>(GDe(t,typeof e!="symbol"?e+"":e,n),n);const Kv=new Ah,Dz=new Cc,BDe=Math.cos(70*(Math.PI/180)),Uz=(t,e)=>(t%e+e)%e;let SDe=class extends xDe{constructor(e,n){super(),Jt(this,"object"),Jt(this,"domElement"),Jt(this,"enabled",!0),Jt(this,"target",new J),Jt(this,"minDistance",0),Jt(this,"maxDistance",1/0),Jt(this,"minZoom",0),Jt(this,"maxZoom",1/0),Jt(this,"minPolarAngle",0),Jt(this,"maxPolarAngle",Math.PI),Jt(this,"minAzimuthAngle",-1/0),Jt(this,"maxAzimuthAngle",1/0),Jt(this,"enableDamping",!1),Jt(this,"dampingFactor",.05),Jt(this,"enableZoom",!0),Jt(this,"zoomSpeed",1),Jt(this,"enableRotate",!0),Jt(this,"rotateSpeed",1),Jt(this,"enablePan",!0),Jt(this,"panSpeed",1),Jt(this,"screenSpacePanning",!0),Jt(this,"keyPanSpeed",7),Jt(this,"zoomToCursor",!1),Jt(this,"autoRotate",!1),Jt(this,"autoRotateSpeed",2),Jt(this,"reverseOrbit",!1),Jt(this,"reverseHorizontalOrbit",!1),Jt(this,"reverseVerticalOrbit",!1),Jt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Jt(this,"mouseButtons",{LEFT:sd.ROTATE,MIDDLE:sd.DOLLY,RIGHT:sd.PAN}),Jt(this,"touches",{ONE:od.ROTATE,TWO:od.DOLLY_PAN}),Jt(this,"target0"),Jt(this,"position0"),Jt(this,"zoom0"),Jt(this,"_domElementKeyEvents",null),Jt(this,"getPolarAngle"),Jt(this,"getAzimuthalAngle"),Jt(this,"setPolarAngle"),Jt(this,"setAzimuthalAngle"),Jt(this,"getDistance"),Jt(this,"getZoomScale"),Jt(this,"listenToKeyEvents"),Jt(this,"stopListenToKeyEvents"),Jt(this,"saveState"),Jt(this,"reset"),Jt(this,"update"),Jt(this,"connect"),Jt(this,"dispose"),Jt(this,"dollyIn"),Jt(this,"dollyOut"),Jt(this,"getScale"),Jt(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=le=>{let Ae=Uz(le,2*Math.PI),De=u.phi;De<0&&(De+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let se=Math.abs(Ae-De);2*Math.PI-se<se&&(Ae<De?Ae+=2*Math.PI:De+=2*Math.PI),d.phi=Ae-De,i.update()},this.setAzimuthalAngle=le=>{let Ae=Uz(le,2*Math.PI),De=u.theta;De<0&&(De+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let se=Math.abs(Ae-De);2*Math.PI-se<se&&(Ae<De?Ae+=2*Math.PI:De+=2*Math.PI),d.theta=Ae-De,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=le=>{le.addEventListener("keydown",Ze),this._domElementKeyEvents=le},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ze),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const le=new J,Ae=new J(0,1,0),De=new Zr().setFromUnitVectors(e.up,Ae),se=De.clone().invert(),ye=new J,it=new Zr,ct=2*Math.PI;return function(){const ze=i.object.position;De.setFromUnitVectors(e.up,Ae),se.copy(De).invert(),le.copy(ze).sub(i.target),le.applyQuaternion(De),u.setFromVector3(le),i.autoRotate&&l===a.NONE&&K(T()),i.enableDamping?(u.theta+=d.theta*i.dampingFactor,u.phi+=d.phi*i.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let yt=i.minAzimuthAngle,Kt=i.maxAzimuthAngle;isFinite(yt)&&isFinite(Kt)&&(yt<-Math.PI?yt+=ct:yt>Math.PI&&(yt-=ct),Kt<-Math.PI?Kt+=ct:Kt>Math.PI&&(Kt-=ct),yt<=Kt?u.theta=Math.max(yt,Math.min(Kt,u.theta)):u.theta=u.theta>(yt+Kt)/2?Math.max(yt,u.theta):Math.min(Kt,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(I,i.dampingFactor):i.target.add(I),i.zoomToCursor&&W||i.object.isOrthographicCamera?u.radius=de(u.radius):u.radius=de(u.radius*h),le.setFromSpherical(u),le.applyQuaternion(se),ze.copy(i.target).add(le),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,I.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),I.set(0,0,0));let Rn=!1;if(i.zoomToCursor&&W){let xn=null;if(i.object instanceof Wi&&i.object.isPerspectiveCamera){const zi=le.length();xn=de(zi*h);const Di=zi-xn;i.object.position.addScaledVector(Z,Di),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const zi=new J(N.x,N.y,0);zi.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix(),Rn=!0;const Di=new J(N.x,N.y,0);Di.unproject(i.object),i.object.position.sub(Di).add(zi),i.object.updateMatrixWorld(),xn=le.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;xn!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(xn).add(i.object.position):(Kv.origin.copy(i.object.position),Kv.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Kv.direction))<BDe?e.lookAt(i.target):(Dz.setFromNormalAndCoplanarPoint(i.object.up,i.target),Kv.intersectPlane(Dz,i.target))))}else i.object instanceof Ua&&i.object.isOrthographicCamera&&(Rn=h!==1,Rn&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix()));return h=1,W=!1,Rn||ye.distanceToSquared(i.object.position)>c||8*(1-it.dot(i.object.quaternion))>c?(i.dispatchEvent(r),ye.copy(i.object.position),it.copy(i.object.quaternion),Rn=!1,!0):!1}})(),this.connect=le=>{i.domElement=le,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",kt),i.domElement.addEventListener("pointerdown",ft),i.domElement.addEventListener("pointercancel",L),i.domElement.addEventListener("wheel",Ke)},this.dispose=()=>{var le,Ae,De,se,ye,it;i.domElement&&(i.domElement.style.touchAction="auto"),(le=i.domElement)==null||le.removeEventListener("contextmenu",kt),(Ae=i.domElement)==null||Ae.removeEventListener("pointerdown",ft),(De=i.domElement)==null||De.removeEventListener("pointercancel",L),(se=i.domElement)==null||se.removeEventListener("wheel",Ke),(ye=i.domElement)==null||ye.ownerDocument.removeEventListener("pointermove",Q),(it=i.domElement)==null||it.ownerDocument.removeEventListener("pointerup",L),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Ze)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new E3,d=new E3;let h=1;const I=new J,p=new He,y=new He,A=new He,m=new He,b=new He,v=new He,w=new He,x=new He,B=new He,Z=new J,N=new He;let W=!1;const M=[],F={};function T(){return 2*Math.PI/60/60*i.autoRotateSpeed}function H(){return Math.pow(.95,i.zoomSpeed)}function K(le){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=le:d.theta-=le}function z(le){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=le:d.phi-=le}const j=(()=>{const le=new J;return function(De,se){le.setFromMatrixColumn(se,0),le.multiplyScalar(-De),I.add(le)}})(),O=(()=>{const le=new J;return function(De,se){i.screenSpacePanning===!0?le.setFromMatrixColumn(se,1):(le.setFromMatrixColumn(se,0),le.crossVectors(i.object.up,le)),le.multiplyScalar(De),I.add(le)}})(),_=(()=>{const le=new J;return function(De,se){const ye=i.domElement;if(ye&&i.object instanceof Wi&&i.object.isPerspectiveCamera){const it=i.object.position;le.copy(it).sub(i.target);let ct=le.length();ct*=Math.tan(i.object.fov/2*Math.PI/180),j(2*De*ct/ye.clientHeight,i.object.matrix),O(2*se*ct/ye.clientHeight,i.object.matrix)}else ye&&i.object instanceof Ua&&i.object.isOrthographicCamera?(j(De*(i.object.right-i.object.left)/i.object.zoom/ye.clientWidth,i.object.matrix),O(se*(i.object.top-i.object.bottom)/i.object.zoom/ye.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function E(le){i.object instanceof Wi&&i.object.isPerspectiveCamera||i.object instanceof Ua&&i.object.isOrthographicCamera?h=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function P(le){E(h/le)}function q(le){E(h*le)}function re(le){if(!i.zoomToCursor||!i.domElement)return;W=!0;const Ae=i.domElement.getBoundingClientRect(),De=le.clientX-Ae.left,se=le.clientY-Ae.top,ye=Ae.width,it=Ae.height;N.x=De/ye*2-1,N.y=-(se/it)*2+1,Z.set(N.x,N.y,1).unproject(i.object).sub(i.object.position).normalize()}function de(le){return Math.max(i.minDistance,Math.min(i.maxDistance,le))}function Re(le){p.set(le.clientX,le.clientY)}function Pe(le){re(le),w.set(le.clientX,le.clientY)}function ae(le){m.set(le.clientX,le.clientY)}function he(le){y.set(le.clientX,le.clientY),A.subVectors(y,p).multiplyScalar(i.rotateSpeed);const Ae=i.domElement;Ae&&(K(2*Math.PI*A.x/Ae.clientHeight),z(2*Math.PI*A.y/Ae.clientHeight)),p.copy(y),i.update()}function Me(le){x.set(le.clientX,le.clientY),B.subVectors(x,w),B.y>0?P(H()):B.y<0&&q(H()),w.copy(x),i.update()}function be(le){b.set(le.clientX,le.clientY),v.subVectors(b,m).multiplyScalar(i.panSpeed),_(v.x,v.y),m.copy(b),i.update()}function xe(le){re(le),le.deltaY<0?q(H()):le.deltaY>0&&P(H()),i.update()}function Ge(le){let Ae=!1;switch(le.code){case i.keys.UP:_(0,i.keyPanSpeed),Ae=!0;break;case i.keys.BOTTOM:_(0,-i.keyPanSpeed),Ae=!0;break;case i.keys.LEFT:_(i.keyPanSpeed,0),Ae=!0;break;case i.keys.RIGHT:_(-i.keyPanSpeed,0),Ae=!0;break}Ae&&(le.preventDefault(),i.update())}function pe(){if(M.length==1)p.set(M[0].pageX,M[0].pageY);else{const le=.5*(M[0].pageX+M[1].pageX),Ae=.5*(M[0].pageY+M[1].pageY);p.set(le,Ae)}}function Oe(){if(M.length==1)m.set(M[0].pageX,M[0].pageY);else{const le=.5*(M[0].pageX+M[1].pageX),Ae=.5*(M[0].pageY+M[1].pageY);m.set(le,Ae)}}function ve(){const le=M[0].pageX-M[1].pageX,Ae=M[0].pageY-M[1].pageY,De=Math.sqrt(le*le+Ae*Ae);w.set(0,De)}function U(){i.enableZoom&&ve(),i.enablePan&&Oe()}function We(){i.enableZoom&&ve(),i.enableRotate&&pe()}function Xe(le){if(M.length==1)y.set(le.pageX,le.pageY);else{const De=Pt(le),se=.5*(le.pageX+De.x),ye=.5*(le.pageY+De.y);y.set(se,ye)}A.subVectors(y,p).multiplyScalar(i.rotateSpeed);const Ae=i.domElement;Ae&&(K(2*Math.PI*A.x/Ae.clientHeight),z(2*Math.PI*A.y/Ae.clientHeight)),p.copy(y)}function Qe(le){if(M.length==1)b.set(le.pageX,le.pageY);else{const Ae=Pt(le),De=.5*(le.pageX+Ae.x),se=.5*(le.pageY+Ae.y);b.set(De,se)}v.subVectors(b,m).multiplyScalar(i.panSpeed),_(v.x,v.y),m.copy(b)}function Le(le){const Ae=Pt(le),De=le.pageX-Ae.x,se=le.pageY-Ae.y,ye=Math.sqrt(De*De+se*se);x.set(0,ye),B.set(0,Math.pow(x.y/w.y,i.zoomSpeed)),P(B.y),w.copy(x)}function mt(le){i.enableZoom&&Le(le),i.enablePan&&Qe(le)}function ot(le){i.enableZoom&&Le(le),i.enableRotate&&Xe(le)}function ft(le){var Ae,De;i.enabled!==!1&&(M.length===0&&((Ae=i.domElement)==null||Ae.ownerDocument.addEventListener("pointermove",Q),(De=i.domElement)==null||De.ownerDocument.addEventListener("pointerup",L)),Nt(le),le.pointerType==="touch"?Rt(le):Ce(le))}function Q(le){i.enabled!==!1&&(le.pointerType==="touch"?pt(le):Ve(le))}function L(le){var Ae,De,se;Ue(le),M.length===0&&((Ae=i.domElement)==null||Ae.releasePointerCapture(le.pointerId),(De=i.domElement)==null||De.ownerDocument.removeEventListener("pointermove",Q),(se=i.domElement)==null||se.ownerDocument.removeEventListener("pointerup",L)),i.dispatchEvent(o),l=a.NONE}function Ce(le){let Ae;switch(le.button){case 0:Ae=i.mouseButtons.LEFT;break;case 1:Ae=i.mouseButtons.MIDDLE;break;case 2:Ae=i.mouseButtons.RIGHT;break;default:Ae=-1}switch(Ae){case sd.DOLLY:if(i.enableZoom===!1)return;Pe(le),l=a.DOLLY;break;case sd.ROTATE:if(le.ctrlKey||le.metaKey||le.shiftKey){if(i.enablePan===!1)return;ae(le),l=a.PAN}else{if(i.enableRotate===!1)return;Re(le),l=a.ROTATE}break;case sd.PAN:if(le.ctrlKey||le.metaKey||le.shiftKey){if(i.enableRotate===!1)return;Re(le),l=a.ROTATE}else{if(i.enablePan===!1)return;ae(le),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Ve(le){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;he(le);break;case a.DOLLY:if(i.enableZoom===!1)return;Me(le);break;case a.PAN:if(i.enablePan===!1)return;be(le);break}}function Ke(le){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(le.preventDefault(),i.dispatchEvent(s),xe(le),i.dispatchEvent(o))}function Ze(le){i.enabled===!1||i.enablePan===!1||Ge(le)}function Rt(le){switch(qe(le),M.length){case 1:switch(i.touches.ONE){case od.ROTATE:if(i.enableRotate===!1)return;pe(),l=a.TOUCH_ROTATE;break;case od.PAN:if(i.enablePan===!1)return;Oe(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case od.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;U(),l=a.TOUCH_DOLLY_PAN;break;case od.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;We(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function pt(le){switch(qe(le),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;Xe(le),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;Qe(le),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;mt(le),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ot(le),i.update();break;default:l=a.NONE}}function kt(le){i.enabled!==!1&&le.preventDefault()}function Nt(le){M.push(le)}function Ue(le){delete F[le.pointerId];for(let Ae=0;Ae<M.length;Ae++)if(M[Ae].pointerId==le.pointerId){M.splice(Ae,1);return}}function qe(le){let Ae=F[le.pointerId];Ae===void 0&&(Ae=new He,F[le.pointerId]=Ae),Ae.set(le.pageX,le.pageY)}function Pt(le){const Ae=le.pointerId===M[0].pointerId?M[1]:M[0];return F[Ae.pointerId]}this.dollyIn=(le=H())=>{q(le),i.update()},this.dollyOut=(le=H())=>{P(le),i.update()},this.getScale=()=>h,this.setScale=le=>{E(le),i.update()},this.getZoomScale=()=>H(),n!==void 0&&this.connect(n),this.update()}};class ZDe extends N_{constructor(e){super(e),this.type=hr}parse(e){const o=function(N,W){switch(N){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(W||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(W||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(W||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(W||""))}},u=`
`,d=function(N,W,M){W=W||1024;let T=N.pos,H=-1,K=0,z="",j=String.fromCharCode.apply(null,new Uint16Array(N.subarray(T,T+128)));for(;0>(H=j.indexOf(u))&&K<W&&T<N.byteLength;)z+=j,K+=j.length,T+=128,j+=String.fromCharCode.apply(null,new Uint16Array(N.subarray(T,T+128)));return-1<H?(N.pos+=K+H+1,z+j.slice(0,H)):!1},h=function(N){const W=/^#\?(\S+)/,M=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,F=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,T=/^\s*FORMAT=(\S+)\s*$/,H=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,K={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let z,j;for((N.pos>=N.byteLength||!(z=d(N)))&&o(1,"no header found"),(j=z.match(W))||o(3,"bad initial token"),K.valid|=1,K.programtype=j[1],K.string+=z+`
`;z=d(N),z!==!1;){if(K.string+=z+`
`,z.charAt(0)==="#"){K.comments+=z+`
`;continue}if((j=z.match(M))&&(K.gamma=parseFloat(j[1])),(j=z.match(F))&&(K.exposure=parseFloat(j[1])),(j=z.match(T))&&(K.valid|=2,K.format=j[1]),(j=z.match(H))&&(K.valid|=4,K.height=parseInt(j[1],10),K.width=parseInt(j[2],10)),K.valid&2&&K.valid&4)break}return K.valid&2||o(3,"missing format specifier"),K.valid&4||o(3,"missing image size specifier"),K},I=function(N,W,M){const F=W;if(F<8||F>32767||N[0]!==2||N[1]!==2||N[2]&128)return new Uint8Array(N);F!==(N[2]<<8|N[3])&&o(3,"wrong scanline width");const T=new Uint8Array(4*W*M);T.length||o(4,"unable to allocate buffer space");let H=0,K=0;const z=4*F,j=new Uint8Array(4),O=new Uint8Array(z);let _=M;for(;_>0&&K<N.byteLength;){K+4>N.byteLength&&o(1),j[0]=N[K++],j[1]=N[K++],j[2]=N[K++],j[3]=N[K++],(j[0]!=2||j[1]!=2||(j[2]<<8|j[3])!=F)&&o(3,"bad rgbe scanline format");let E=0,P;for(;E<z&&K<N.byteLength;){P=N[K++];const re=P>128;if(re&&(P-=128),(P===0||E+P>z)&&o(3,"bad scanline data"),re){const de=N[K++];for(let Re=0;Re<P;Re++)O[E++]=de}else O.set(N.subarray(K,K+P),E),E+=P,K+=P}const q=F;for(let re=0;re<q;re++){let de=0;T[H]=O[re+de],de+=F,T[H+1]=O[re+de],de+=F,T[H+2]=O[re+de],de+=F,T[H+3]=O[re+de],H+=4}_--}return T},p=function(N,W,M,F){const T=N[W+3],H=Math.pow(2,T-128)/255;M[F+0]=N[W+0]*H,M[F+1]=N[W+1]*H,M[F+2]=N[W+2]*H,M[F+3]=1},y=function(N,W,M,F){const T=N[W+3],H=Math.pow(2,T-128)/255;M[F+0]=xd.toHalfFloat(Math.min(N[W+0]*H,65504)),M[F+1]=xd.toHalfFloat(Math.min(N[W+1]*H,65504)),M[F+2]=xd.toHalfFloat(Math.min(N[W+2]*H,65504)),M[F+3]=xd.toHalfFloat(1)},A=new Uint8Array(e);A.pos=0;const m=h(A),b=m.width,v=m.height,w=I(A.subarray(A.pos),b,v);let x,B,Z;switch(this.type){case Fi:Z=w.length/4;const N=new Float32Array(Z*4);for(let M=0;M<Z;M++)p(w,M*4,N,M*4);x=N,B=Fi;break;case hr:Z=w.length/4;const W=new Uint16Array(Z*4);for(let M=0;M<Z;M++)y(w,M*4,W,M*4);x=W,B=hr;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:b,height:v,data:x,header:m.string,gamma:m.gamma,exposure:m.exposure,type:B}}setDataType(e){return this.type=e,this}load(e,n,i,r){function s(o,a){switch(o.type){case Fi:case hr:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=Ln,o.magFilter=Ln,o.generateMipmaps=!1,o.flipY=!0;break}n&&n(o,a)}return super.load(e,s,i,r)}}const tm=Vte>=152;class RDe extends N_{constructor(e){super(e),this.type=hr}parse(e){const W=Math.pow(2.7182818,2.2);function M(Y,D){for(var ge=0,Be=0;Be<65536;++Be)(Be==0||Y[Be>>3]&1<<(Be&7))&&(D[ge++]=Be);for(var Fe=ge-1;ge<65536;)D[ge++]=0;return Fe}function F(Y){for(var D=0;D<16384;D++)Y[D]={},Y[D].len=0,Y[D].lit=0,Y[D].p=null}const T={l:0,c:0,lc:0};function H(Y,D,ge,Be,Fe){for(;ge<Y;)D=D<<8|Pt(Be,Fe),ge+=8;ge-=Y,T.l=D>>ge&(1<<Y)-1,T.c=D,T.lc=ge}const K=new Array(59);function z(Y){for(var D=0;D<=58;++D)K[D]=0;for(var D=0;D<65537;++D)K[Y[D]]+=1;for(var ge=0,D=58;D>0;--D){var Be=ge+K[D]>>1;K[D]=ge,ge=Be}for(var D=0;D<65537;++D){var Fe=Y[D];Fe>0&&(Y[D]=Fe|K[Fe]++<<6)}}function j(Y,D,ge,Be,Fe,_e,gt){for(var et=ge,Ct=0,k=0;Fe<=_e;Fe++){if(et.value-ge.value>Be)return!1;H(6,Ct,k,Y,et);var ie=T.l;if(Ct=T.c,k=T.lc,gt[Fe]=ie,ie==63){if(et.value-ge.value>Be)throw"Something wrong with hufUnpackEncTable";H(8,Ct,k,Y,et);var ce=T.l+6;if(Ct=T.c,k=T.lc,Fe+ce>_e+1)throw"Something wrong with hufUnpackEncTable";for(;ce--;)gt[Fe++]=0;Fe--}else if(ie>=59){var ce=ie-59+2;if(Fe+ce>_e+1)throw"Something wrong with hufUnpackEncTable";for(;ce--;)gt[Fe++]=0;Fe--}}z(gt)}function O(Y){return Y&63}function _(Y){return Y>>6}function E(Y,D,ge,Be){for(;D<=ge;D++){var Fe=_(Y[D]),_e=O(Y[D]);if(Fe>>_e)throw"Invalid table entry";if(_e>14){var gt=Be[Fe>>_e-14];if(gt.len)throw"Invalid table entry";if(gt.lit++,gt.p){var et=gt.p;gt.p=new Array(gt.lit);for(var Ct=0;Ct<gt.lit-1;++Ct)gt.p[Ct]=et[Ct]}else gt.p=new Array(1);gt.p[gt.lit-1]=D}else if(_e)for(var k=0,Ct=1<<14-_e;Ct>0;Ct--){var gt=Be[(Fe<<14-_e)+k];if(gt.len||gt.p)throw"Invalid table entry";gt.len=_e,gt.lit=D,k++}}return!0}const P={c:0,lc:0};function q(Y,D,ge,Be){Y=Y<<8|Pt(ge,Be),D+=8,P.c=Y,P.lc=D}const re={c:0,lc:0};function de(Y,D,ge,Be,Fe,_e,gt,et,Ct,k){if(Y==D){Be<8&&(q(ge,Be,Fe,gt),ge=P.c,Be=P.lc),Be-=8;var ie=ge>>Be,ie=new Uint8Array([ie])[0];if(Ct.value+ie>k)return!1;for(var ce=et[Ct.value-1];ie-- >0;)et[Ct.value++]=ce}else if(Ct.value<k)et[Ct.value++]=Y;else return!1;re.c=ge,re.lc=Be}function Re(Y){return Y&65535}function Pe(Y){var D=Re(Y);return D>32767?D-65536:D}const ae={a:0,b:0};function he(Y,D){var ge=Pe(Y),Be=Pe(D),Fe=Be,_e=ge+(Fe&1)+(Fe>>1),gt=_e,et=_e-Fe;ae.a=gt,ae.b=et}function Me(Y,D){var ge=Re(Y),Be=Re(D),Fe=ge-(Be>>1)&65535,_e=Be+Fe-32768&65535;ae.a=_e,ae.b=Fe}function be(Y,D,ge,Be,Fe,_e,gt){for(var et=gt<16384,Ct=ge>Fe?Fe:ge,k=1,ie;k<=Ct;)k<<=1;for(k>>=1,ie=k,k>>=1;k>=1;){for(var ce=0,me=ce+_e*(Fe-ie),oe=_e*k,Se=_e*ie,je=Be*k,Je=Be*ie,$e,It,at,st;ce<=me;ce+=Se){for(var Gt=ce,Dt=ce+Be*(ge-ie);Gt<=Dt;Gt+=Je){var Tt=Gt+je,rn=Gt+oe,cn=rn+je;et?(he(Y[Gt+D],Y[rn+D]),$e=ae.a,at=ae.b,he(Y[Tt+D],Y[cn+D]),It=ae.a,st=ae.b,he($e,It),Y[Gt+D]=ae.a,Y[Tt+D]=ae.b,he(at,st),Y[rn+D]=ae.a,Y[cn+D]=ae.b):(Me(Y[Gt+D],Y[rn+D]),$e=ae.a,at=ae.b,Me(Y[Tt+D],Y[cn+D]),It=ae.a,st=ae.b,Me($e,It),Y[Gt+D]=ae.a,Y[Tt+D]=ae.b,Me(at,st),Y[rn+D]=ae.a,Y[cn+D]=ae.b)}if(ge&k){var rn=Gt+oe;et?he(Y[Gt+D],Y[rn+D]):Me(Y[Gt+D],Y[rn+D]),$e=ae.a,Y[rn+D]=ae.b,Y[Gt+D]=$e}}if(Fe&k)for(var Gt=ce,Dt=ce+Be*(ge-ie);Gt<=Dt;Gt+=Je){var Tt=Gt+je;et?he(Y[Gt+D],Y[Tt+D]):Me(Y[Gt+D],Y[Tt+D]),$e=ae.a,Y[Tt+D]=ae.b,Y[Gt+D]=$e}ie=k,k>>=1}return ce}function xe(Y,D,ge,Be,Fe,_e,gt,et,Ct,k){for(var ie=0,ce=0,me=et,oe=Math.trunc(Fe.value+(_e+7)/8);Fe.value<oe;)for(q(ie,ce,ge,Fe),ie=P.c,ce=P.lc;ce>=14;){var Se=ie>>ce-14&16383,je=D[Se];if(je.len)ce-=je.len,de(je.lit,gt,ie,ce,ge,Be,Fe,Ct,k,me),ie=re.c,ce=re.lc;else{if(!je.p)throw"hufDecode issues";var Je;for(Je=0;Je<je.lit;Je++){for(var $e=O(Y[je.p[Je]]);ce<$e&&Fe.value<oe;)q(ie,ce,ge,Fe),ie=P.c,ce=P.lc;if(ce>=$e&&_(Y[je.p[Je]])==(ie>>ce-$e&(1<<$e)-1)){ce-=$e,de(je.p[Je],gt,ie,ce,ge,Be,Fe,Ct,k,me),ie=re.c,ce=re.lc;break}}if(Je==je.lit)throw"hufDecode issues"}}var It=8-_e&7;for(ie>>=It,ce-=It;ce>0;){var je=D[ie<<14-ce&16383];if(je.len)ce-=je.len,de(je.lit,gt,ie,ce,ge,Be,Fe,Ct,k,me),ie=re.c,ce=re.lc;else throw"hufDecode issues"}return!0}function Ge(Y,D,ge,Be,Fe,_e){var gt={value:0},et=ge.value,Ct=qe(D,ge),k=qe(D,ge);ge.value+=4;var ie=qe(D,ge);if(ge.value+=4,Ct<0||Ct>=65537||k<0||k>=65537)throw"Something wrong with HUF_ENCSIZE";var ce=new Array(65537),me=new Array(16384);F(me);var oe=Be-(ge.value-et);if(j(Y,D,ge,oe,Ct,k,ce),ie>8*(Be-(ge.value-et)))throw"Something wrong with hufUncompress";E(ce,Ct,k,me),xe(ce,me,Y,D,ge,ie,k,_e,Fe,gt)}function pe(Y,D,ge){for(var Be=0;Be<ge;++Be)D[Be]=Y[D[Be]]}function Oe(Y){for(var D=1;D<Y.length;D++){var ge=Y[D-1]+Y[D]-128;Y[D]=ge}}function ve(Y,D){for(var ge=0,Be=Math.floor((Y.length+1)/2),Fe=0,_e=Y.length-1;!(Fe>_e||(D[Fe++]=Y[ge++],Fe>_e));)D[Fe++]=Y[Be++]}function U(Y){for(var D=Y.byteLength,ge=new Array,Be=0,Fe=new DataView(Y);D>0;){var _e=Fe.getInt8(Be++);if(_e<0){var gt=-_e;D-=gt+1;for(var et=0;et<gt;et++)ge.push(Fe.getUint8(Be++))}else{var gt=_e;D-=2;for(var Ct=Fe.getUint8(Be++),et=0;et<gt+1;et++)ge.push(Ct)}}return ge}function We(Y,D,ge,Be,Fe,_e){var Tt=new DataView(_e.buffer),gt=ge[Y.idx[0]].width,et=ge[Y.idx[0]].height,Ct=3,k=Math.floor(gt/8),ie=Math.ceil(gt/8),ce=Math.ceil(et/8),me=gt-(ie-1)*8,oe=et-(ce-1)*8,Se={value:0},je=new Array(Ct),Je=new Array(Ct),$e=new Array(Ct),It=new Array(Ct),at=new Array(Ct);for(let Xt=0;Xt<Ct;++Xt)at[Xt]=D[Y.idx[Xt]],je[Xt]=Xt<1?0:je[Xt-1]+ie*ce,Je[Xt]=new Float32Array(64),$e[Xt]=new Uint16Array(64),It[Xt]=new Uint16Array(ie*64);for(let Xt=0;Xt<ce;++Xt){var st=8;Xt==ce-1&&(st=oe);var Gt=8;for(let Nn=0;Nn<ie;++Nn){Nn==ie-1&&(Gt=me);for(let an=0;an<Ct;++an)$e[an].fill(0),$e[an][0]=Fe[je[an]++],Xe(Se,Be,$e[an]),Qe($e[an],Je[an]),Le(Je[an]);mt(Je);for(let an=0;an<Ct;++an)ot(Je[an],It[an],Nn*64)}let Xn=0;for(let Nn=0;Nn<Ct;++Nn){const an=ge[Y.idx[Nn]].type;for(let On=8*Xt;On<8*Xt+st;++On){Xn=at[Nn][On];for(let En=0;En<k;++En){const Dn=En*64+(On&7)*8;Tt.setUint16(Xn+0*2*an,It[Nn][Dn+0],!0),Tt.setUint16(Xn+1*2*an,It[Nn][Dn+1],!0),Tt.setUint16(Xn+2*2*an,It[Nn][Dn+2],!0),Tt.setUint16(Xn+3*2*an,It[Nn][Dn+3],!0),Tt.setUint16(Xn+4*2*an,It[Nn][Dn+4],!0),Tt.setUint16(Xn+5*2*an,It[Nn][Dn+5],!0),Tt.setUint16(Xn+6*2*an,It[Nn][Dn+6],!0),Tt.setUint16(Xn+7*2*an,It[Nn][Dn+7],!0),Xn+=8*2*an}}if(k!=ie)for(let On=8*Xt;On<8*Xt+st;++On){const En=at[Nn][On]+8*k*2*an,Dn=k*64+(On&7)*8;for(let Si=0;Si<Gt;++Si)Tt.setUint16(En+Si*2*an,It[Nn][Dn+Si],!0)}}}for(var Dt=new Uint16Array(gt),Tt=new DataView(_e.buffer),rn=0;rn<Ct;++rn){ge[Y.idx[rn]].decoded=!0;var cn=ge[Y.idx[rn]].type;if(ge[rn].type==2)for(var Bt=0;Bt<et;++Bt){const Xt=at[rn][Bt];for(var Cn=0;Cn<gt;++Cn)Dt[Cn]=Tt.getUint16(Xt+Cn*2*cn,!0);for(var Cn=0;Cn<gt;++Cn)Tt.setFloat32(Xt+Cn*2*cn,ye(Dt[Cn]),!0)}}}function Xe(Y,D,ge){for(var Be,Fe=1;Fe<64;)Be=D[Y.value],Be==65280?Fe=64:Be>>8==255?Fe+=Be&255:(ge[Fe]=Be,Fe++),Y.value++}function Qe(Y,D){D[0]=ye(Y[0]),D[1]=ye(Y[1]),D[2]=ye(Y[5]),D[3]=ye(Y[6]),D[4]=ye(Y[14]),D[5]=ye(Y[15]),D[6]=ye(Y[27]),D[7]=ye(Y[28]),D[8]=ye(Y[2]),D[9]=ye(Y[4]),D[10]=ye(Y[7]),D[11]=ye(Y[13]),D[12]=ye(Y[16]),D[13]=ye(Y[26]),D[14]=ye(Y[29]),D[15]=ye(Y[42]),D[16]=ye(Y[3]),D[17]=ye(Y[8]),D[18]=ye(Y[12]),D[19]=ye(Y[17]),D[20]=ye(Y[25]),D[21]=ye(Y[30]),D[22]=ye(Y[41]),D[23]=ye(Y[43]),D[24]=ye(Y[9]),D[25]=ye(Y[11]),D[26]=ye(Y[18]),D[27]=ye(Y[24]),D[28]=ye(Y[31]),D[29]=ye(Y[40]),D[30]=ye(Y[44]),D[31]=ye(Y[53]),D[32]=ye(Y[10]),D[33]=ye(Y[19]),D[34]=ye(Y[23]),D[35]=ye(Y[32]),D[36]=ye(Y[39]),D[37]=ye(Y[45]),D[38]=ye(Y[52]),D[39]=ye(Y[54]),D[40]=ye(Y[20]),D[41]=ye(Y[22]),D[42]=ye(Y[33]),D[43]=ye(Y[38]),D[44]=ye(Y[46]),D[45]=ye(Y[51]),D[46]=ye(Y[55]),D[47]=ye(Y[60]),D[48]=ye(Y[21]),D[49]=ye(Y[34]),D[50]=ye(Y[37]),D[51]=ye(Y[47]),D[52]=ye(Y[50]),D[53]=ye(Y[56]),D[54]=ye(Y[59]),D[55]=ye(Y[61]),D[56]=ye(Y[35]),D[57]=ye(Y[36]),D[58]=ye(Y[48]),D[59]=ye(Y[49]),D[60]=ye(Y[57]),D[61]=ye(Y[58]),D[62]=ye(Y[62]),D[63]=ye(Y[63])}function Le(Y){const D=.5*Math.cos(.7853975),ge=.5*Math.cos(3.14159/16),Be=.5*Math.cos(3.14159/8),Fe=.5*Math.cos(3*3.14159/16),_e=.5*Math.cos(5*3.14159/16),gt=.5*Math.cos(3*3.14159/8),et=.5*Math.cos(7*3.14159/16);for(var Ct=new Array(4),k=new Array(4),ie=new Array(4),ce=new Array(4),me=0;me<8;++me){var oe=me*8;Ct[0]=Be*Y[oe+2],Ct[1]=gt*Y[oe+2],Ct[2]=Be*Y[oe+6],Ct[3]=gt*Y[oe+6],k[0]=ge*Y[oe+1]+Fe*Y[oe+3]+_e*Y[oe+5]+et*Y[oe+7],k[1]=Fe*Y[oe+1]-et*Y[oe+3]-ge*Y[oe+5]-_e*Y[oe+7],k[2]=_e*Y[oe+1]-ge*Y[oe+3]+et*Y[oe+5]+Fe*Y[oe+7],k[3]=et*Y[oe+1]-_e*Y[oe+3]+Fe*Y[oe+5]-ge*Y[oe+7],ie[0]=D*(Y[oe+0]+Y[oe+4]),ie[3]=D*(Y[oe+0]-Y[oe+4]),ie[1]=Ct[0]+Ct[3],ie[2]=Ct[1]-Ct[2],ce[0]=ie[0]+ie[1],ce[1]=ie[3]+ie[2],ce[2]=ie[3]-ie[2],ce[3]=ie[0]-ie[1],Y[oe+0]=ce[0]+k[0],Y[oe+1]=ce[1]+k[1],Y[oe+2]=ce[2]+k[2],Y[oe+3]=ce[3]+k[3],Y[oe+4]=ce[3]-k[3],Y[oe+5]=ce[2]-k[2],Y[oe+6]=ce[1]-k[1],Y[oe+7]=ce[0]-k[0]}for(var Se=0;Se<8;++Se)Ct[0]=Be*Y[16+Se],Ct[1]=gt*Y[16+Se],Ct[2]=Be*Y[48+Se],Ct[3]=gt*Y[48+Se],k[0]=ge*Y[8+Se]+Fe*Y[24+Se]+_e*Y[40+Se]+et*Y[56+Se],k[1]=Fe*Y[8+Se]-et*Y[24+Se]-ge*Y[40+Se]-_e*Y[56+Se],k[2]=_e*Y[8+Se]-ge*Y[24+Se]+et*Y[40+Se]+Fe*Y[56+Se],k[3]=et*Y[8+Se]-_e*Y[24+Se]+Fe*Y[40+Se]-ge*Y[56+Se],ie[0]=D*(Y[Se]+Y[32+Se]),ie[3]=D*(Y[Se]-Y[32+Se]),ie[1]=Ct[0]+Ct[3],ie[2]=Ct[1]-Ct[2],ce[0]=ie[0]+ie[1],ce[1]=ie[3]+ie[2],ce[2]=ie[3]-ie[2],ce[3]=ie[0]-ie[1],Y[0+Se]=ce[0]+k[0],Y[8+Se]=ce[1]+k[1],Y[16+Se]=ce[2]+k[2],Y[24+Se]=ce[3]+k[3],Y[32+Se]=ce[3]-k[3],Y[40+Se]=ce[2]-k[2],Y[48+Se]=ce[1]-k[1],Y[56+Se]=ce[0]-k[0]}function mt(Y){for(var D=0;D<64;++D){var ge=Y[0][D],Be=Y[1][D],Fe=Y[2][D];Y[0][D]=ge+1.5747*Fe,Y[1][D]=ge-.1873*Be-.4682*Fe,Y[2][D]=ge+1.8556*Be}}function ot(Y,D,ge){for(var Be=0;Be<64;++Be)D[ge+Be]=xd.toHalfFloat(ft(Y[Be]))}function ft(Y){return Y<=1?Math.sign(Y)*Math.pow(Math.abs(Y),2.2):Math.sign(Y)*Math.pow(W,Math.abs(Y)-1)}function Q(Y){return new DataView(Y.array.buffer,Y.offset.value,Y.size)}function L(Y){var D=Y.viewer.buffer.slice(Y.offset.value,Y.offset.value+Y.size),ge=new Uint8Array(U(D)),Be=new Uint8Array(ge.length);return Oe(ge),ve(ge,Be),new DataView(Be.buffer)}function Ce(Y){var D=Y.array.slice(Y.offset.value,Y.offset.value+Y.size),ge=Hv(D),Be=new Uint8Array(ge.length);return Oe(ge),ve(ge,Be),new DataView(Be.buffer)}function Ve(Y){for(var D=Y.viewer,ge={value:Y.offset.value},Be=new Uint16Array(Y.width*Y.scanlineBlockSize*(Y.channels*Y.type)),Fe=new Uint8Array(8192),_e=0,gt=new Array(Y.channels),et=0;et<Y.channels;et++)gt[et]={},gt[et].start=_e,gt[et].end=gt[et].start,gt[et].nx=Y.width,gt[et].ny=Y.lines,gt[et].size=Y.type,_e+=gt[et].nx*gt[et].ny*gt[et].size;var Ct=it(D,ge),k=it(D,ge);if(k>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Ct<=k)for(var et=0;et<k-Ct+1;et++)Fe[et+Ct]=le(D,ge);var ie=new Uint16Array(65536),ce=M(Fe,ie),me=qe(D,ge);Ge(Y.array,D,ge,me,Be,_e);for(var et=0;et<Y.channels;++et)for(var oe=gt[et],Se=0;Se<gt[et].size;++Se)be(Be,oe.start+Se,oe.nx,oe.size,oe.ny,oe.nx*oe.size,ce);pe(ie,Be,_e);for(var je=0,Je=new Uint8Array(Be.buffer.byteLength),$e=0;$e<Y.lines;$e++)for(var It=0;It<Y.channels;It++){var oe=gt[It],at=oe.nx*oe.size,st=new Uint8Array(Be.buffer,oe.end*2,at*2);Je.set(st,je),je+=at*2,oe.end+=at}return new DataView(Je.buffer)}function Ke(Y){var D=Y.array.slice(Y.offset.value,Y.offset.value+Y.size),ge=Hv(D);const Be=Y.lines*Y.channels*Y.width,Fe=Y.type==1?new Uint16Array(Be):new Uint32Array(Be);let _e=0,gt=0;const et=new Array(4);for(let Ct=0;Ct<Y.lines;Ct++)for(let k=0;k<Y.channels;k++){let ie=0;switch(Y.type){case 1:et[0]=_e,et[1]=et[0]+Y.width,_e=et[1]+Y.width;for(let ce=0;ce<Y.width;++ce){const me=ge[et[0]++]<<8|ge[et[1]++];ie+=me,Fe[gt]=ie,gt++}break;case 2:et[0]=_e,et[1]=et[0]+Y.width,et[2]=et[1]+Y.width,_e=et[2]+Y.width;for(let ce=0;ce<Y.width;++ce){const me=ge[et[0]++]<<24|ge[et[1]++]<<16|ge[et[2]++]<<8;ie+=me,Fe[gt]=ie,gt++}break}}return new DataView(Fe.buffer)}function Ze(Y){var D=Y.viewer,ge={value:Y.offset.value},Be=new Uint8Array(Y.width*Y.lines*(Y.channels*Y.type*2)),Fe={version:Ae(D,ge),unknownUncompressedSize:Ae(D,ge),unknownCompressedSize:Ae(D,ge),acCompressedSize:Ae(D,ge),dcCompressedSize:Ae(D,ge),rleCompressedSize:Ae(D,ge),rleUncompressedSize:Ae(D,ge),rleRawSize:Ae(D,ge),totalAcUncompressedCount:Ae(D,ge),totalDcUncompressedCount:Ae(D,ge),acCompression:Ae(D,ge)};if(Fe.version<2)throw"EXRLoader.parse: "+_s.compression+" version "+Fe.version+" is unsupported";for(var _e=new Array,gt=it(D,ge)-2;gt>0;){var et=Rt(D.buffer,ge),Ct=le(D,ge),k=Ct>>2&3,ie=(Ct>>4)-1,ce=new Int8Array([ie])[0],me=le(D,ge);_e.push({name:et,index:ce,type:me,compression:k}),gt-=et.length+3}for(var oe=_s.channels,Se=new Array(Y.channels),je=0;je<Y.channels;++je){var Je=Se[je]={},$e=oe[je];Je.name=$e.name,Je.compression=0,Je.decoded=!1,Je.type=$e.pixelType,Je.pLinear=$e.pLinear,Je.width=Y.width,Je.height=Y.lines}for(var It={idx:new Array(3)},at=0;at<Y.channels;++at)for(var Je=Se[at],je=0;je<_e.length;++je){var st=_e[je];Je.name==st.name&&(Je.compression=st.compression,st.index>=0&&(It.idx[st.index]=at),Je.offset=at)}if(Fe.acCompressedSize>0)switch(Fe.acCompression){case 0:var Tt=new Uint16Array(Fe.totalAcUncompressedCount);Ge(Y.array,D,ge,Fe.acCompressedSize,Tt,Fe.totalAcUncompressedCount);break;case 1:var Gt=Y.array.slice(ge.value,ge.value+Fe.totalAcUncompressedCount),Dt=Hv(Gt),Tt=new Uint16Array(Dt.buffer);ge.value+=Fe.totalAcUncompressedCount;break}if(Fe.dcCompressedSize>0){var rn={array:Y.array,offset:ge,size:Fe.dcCompressedSize},cn=new Uint16Array(Ce(rn).buffer);ge.value+=Fe.dcCompressedSize}if(Fe.rleRawSize>0){var Gt=Y.array.slice(ge.value,ge.value+Fe.rleCompressedSize),Dt=Hv(Gt),Bt=U(Dt.buffer);ge.value+=Fe.rleCompressedSize}for(var Cn=0,Xt=new Array(Se.length),je=0;je<Xt.length;++je)Xt[je]=new Array;for(var Xn=0;Xn<Y.lines;++Xn)for(var Nn=0;Nn<Se.length;++Nn)Xt[Nn].push(Cn),Cn+=Se[Nn].width*Y.type*2;We(It,Xt,Se,Tt,cn,Be);for(var je=0;je<Se.length;++je){var Je=Se[je];if(!Je.decoded)switch(Je.compression){case 2:for(var an=0,On=0,Xn=0;Xn<Y.lines;++Xn){for(var En=Xt[je][an],Dn=0;Dn<Je.width;++Dn){for(var Si=0;Si<2*Je.type;++Si)Be[En++]=Bt[On+Si*Je.width*Je.height];On++}an++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Be.buffer)}function Rt(Y,D){for(var ge=new Uint8Array(Y),Be=0;ge[D.value+Be]!=0;)Be+=1;var Fe=new TextDecoder().decode(ge.slice(D.value,D.value+Be));return D.value=D.value+Be+1,Fe}function pt(Y,D,ge){var Be=new TextDecoder().decode(new Uint8Array(Y).slice(D.value,D.value+ge));return D.value=D.value+ge,Be}function kt(Y,D){var ge=Ue(Y,D),Be=qe(Y,D);return[ge,Be]}function Nt(Y,D){var ge=qe(Y,D),Be=qe(Y,D);return[ge,Be]}function Ue(Y,D){var ge=Y.getInt32(D.value,!0);return D.value=D.value+4,ge}function qe(Y,D){var ge=Y.getUint32(D.value,!0);return D.value=D.value+4,ge}function Pt(Y,D){var ge=Y[D.value];return D.value=D.value+1,ge}function le(Y,D){var ge=Y.getUint8(D.value);return D.value=D.value+1,ge}const Ae=function(Y,D){let ge;return"getBigInt64"in DataView.prototype?ge=Number(Y.getBigInt64(D.value,!0)):ge=Y.getUint32(D.value+4,!0)+Number(Y.getUint32(D.value,!0)<<32),D.value+=8,ge};function De(Y,D){var ge=Y.getFloat32(D.value,!0);return D.value+=4,ge}function se(Y,D){return xd.toHalfFloat(De(Y,D))}function ye(Y){var D=(Y&31744)>>10,ge=Y&1023;return(Y>>15?-1:1)*(D?D===31?ge?NaN:1/0:Math.pow(2,D-15)*(1+ge/1024):6103515625e-14*(ge/1024))}function it(Y,D){var ge=Y.getUint16(D.value,!0);return D.value+=2,ge}function ct(Y,D){return ye(it(Y,D))}function rt(Y,D,ge,Be){for(var Fe=ge.value,_e=[];ge.value<Fe+Be-1;){var gt=Rt(D,ge),et=Ue(Y,ge),Ct=le(Y,ge);ge.value+=3;var k=Ue(Y,ge),ie=Ue(Y,ge);_e.push({name:gt,pixelType:et,pLinear:Ct,xSampling:k,ySampling:ie})}return ge.value+=1,_e}function ze(Y,D){var ge=De(Y,D),Be=De(Y,D),Fe=De(Y,D),_e=De(Y,D),gt=De(Y,D),et=De(Y,D),Ct=De(Y,D),k=De(Y,D);return{redX:ge,redY:Be,greenX:Fe,greenY:_e,blueX:gt,blueY:et,whiteX:Ct,whiteY:k}}function yt(Y,D){var ge=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Be=le(Y,D);return ge[Be]}function Kt(Y,D){var ge=qe(Y,D),Be=qe(Y,D),Fe=qe(Y,D),_e=qe(Y,D);return{xMin:ge,yMin:Be,xMax:Fe,yMax:_e}}function Rn(Y,D){var ge=["INCREASING_Y"],Be=le(Y,D);return ge[Be]}function xn(Y,D){var ge=De(Y,D),Be=De(Y,D);return[ge,Be]}function zi(Y,D){var ge=De(Y,D),Be=De(Y,D),Fe=De(Y,D);return[ge,Be,Fe]}function Di(Y,D,ge,Be,Fe){if(Be==="string"||Be==="stringvector"||Be==="iccProfile")return pt(D,ge,Fe);if(Be==="chlist")return rt(Y,D,ge,Fe);if(Be==="chromaticities")return ze(Y,ge);if(Be==="compression")return yt(Y,ge);if(Be==="box2i")return Kt(Y,ge);if(Be==="lineOrder")return Rn(Y,ge);if(Be==="float")return De(Y,ge);if(Be==="v2f")return xn(Y,ge);if(Be==="v3f")return zi(Y,ge);if(Be==="int")return Ue(Y,ge);if(Be==="rational")return kt(Y,ge);if(Be==="timecode")return Nt(Y,ge);if(Be==="preview")return ge.value+=Fe,"skipped";ge.value+=Fe}function tp(Y,D,ge){const Be={};if(Y.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Be.version=Y.getUint8(4);const Fe=Y.getUint8(5);Be.spec={singleTile:!!(Fe&2),longName:!!(Fe&4),deepFormat:!!(Fe&8),multiPart:!!(Fe&16)},ge.value=8;for(var _e=!0;_e;){var gt=Rt(D,ge);if(gt==0)_e=!1;else{var et=Rt(D,ge),Ct=qe(Y,ge),k=Di(Y,D,ge,et,Ct);k===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${et}'.`):Be[gt]=k}}if(Fe&-5)throw console.error("EXRHeader:",Be),"THREE.EXRLoader: provided file is currently unsupported.";return Be}function wh(Y,D,ge,Be,Fe){const _e={size:0,viewer:D,array:ge,offset:Be,width:Y.dataWindow.xMax-Y.dataWindow.xMin+1,height:Y.dataWindow.yMax-Y.dataWindow.yMin+1,channels:Y.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:Y.channels[0].pixelType,uncompress:null,getter:null,format:null,[tm?"colorSpace":"encoding"]:null};switch(Y.compression){case"NO_COMPRESSION":_e.lines=1,_e.uncompress=Q;break;case"RLE_COMPRESSION":_e.lines=1,_e.uncompress=L;break;case"ZIPS_COMPRESSION":_e.lines=1,_e.uncompress=Ce;break;case"ZIP_COMPRESSION":_e.lines=16,_e.uncompress=Ce;break;case"PIZ_COMPRESSION":_e.lines=32,_e.uncompress=Ve;break;case"PXR24_COMPRESSION":_e.lines=16,_e.uncompress=Ke;break;case"DWAA_COMPRESSION":_e.lines=32,_e.uncompress=Ze;break;case"DWAB_COMPRESSION":_e.lines=256,_e.uncompress=Ze;break;default:throw"EXRLoader.parse: "+Y.compression+" is unsupported"}if(_e.scanlineBlockSize=_e.lines,_e.type==1)switch(Fe){case Fi:_e.getter=ct,_e.inputSize=2;break;case hr:_e.getter=it,_e.inputSize=2;break}else if(_e.type==2)switch(Fe){case Fi:_e.getter=De,_e.inputSize=4;break;case hr:_e.getter=se,_e.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+_e.type+" for "+Y.compression+".";_e.blockCount=(Y.dataWindow.yMax+1)/_e.scanlineBlockSize;for(var gt=0;gt<_e.blockCount;gt++)Ae(D,Be);_e.outputChannels=_e.channels==3?4:_e.channels;const et=_e.width*_e.height*_e.outputChannels;switch(Fe){case Fi:_e.byteArray=new Float32Array(et),_e.channels<_e.outputChannels&&_e.byteArray.fill(1,0,et);break;case hr:_e.byteArray=new Uint16Array(et),_e.channels<_e.outputChannels&&_e.byteArray.fill(15360,0,et);break;default:console.error("THREE.EXRLoader: unsupported type: ",Fe);break}return _e.bytesPerLine=_e.width*_e.inputSize*_e.channels,_e.outputChannels==4?_e.format=Ki:_e.format=ty,tm?_e.colorSpace="srgb-linear":_e.encoding=3e3,_e}const il=new DataView(e),ro=new Uint8Array(e),Ca={value:0},_s=tp(il,e,Ca),yn=wh(_s,il,ro,Ca,this.type),Ul={value:0},Gh={R:0,G:1,B:2,A:3,Y:0};for(let Y=0;Y<yn.height/yn.scanlineBlockSize;Y++){const D=qe(il,Ca);yn.size=qe(il,Ca),yn.lines=D+yn.scanlineBlockSize>yn.height?yn.height-D:yn.scanlineBlockSize;const Be=yn.size<yn.lines*yn.bytesPerLine?yn.uncompress(yn):Q(yn);Ca.value+=yn.size;for(let Fe=0;Fe<yn.scanlineBlockSize;Fe++){const _e=Fe+Y*yn.scanlineBlockSize;if(_e>=yn.height)break;for(let gt=0;gt<yn.channels;gt++){const et=Gh[_s.channels[gt].name];for(let Ct=0;Ct<yn.width;Ct++){Ul.value=(Fe*(yn.channels*yn.width)+gt*yn.width+Ct)*yn.inputSize;const k=(yn.height-1-_e)*(yn.width*yn.outputChannels)+Ct*yn.outputChannels+et;yn.byteArray[k]=yn.getter(Be,Ul)}}}}return{header:_s,width:yn.width,height:yn.height,data:yn.byteArray,format:yn.format,[tm?"colorSpace":"encoding"]:yn[tm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,i,r){function s(o,a){tm?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=Ln,o.magFilter=Ln,o.generateMipmaps=!1,o.flipY=!1,n&&n(o,a)}return super.load(e,s,i,r)}}function NDe(t,e,n,i){const r=class extends as{constructor(o={}){const a=Object.entries(t);super({uniforms:a.reduce((l,[c,u])=>{const d=g_.clone({[c]:{value:u}});return{...l,...d}},{}),vertexShader:e,fragmentShader:n}),this.key="",a.forEach(([l])=>Object.defineProperty(this,l,{get:()=>this.uniforms[l].value,set:c=>this.uniforms[l].value=c})),Object.assign(this,o)}};return r.key=pC.generateUUID(),r}const WDe=()=>parseInt(mh.replace(/\D+/g,"")),MDe=WDe(),VDe=S.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const d=Fr(B=>B.invalidate),h=Fr(B=>B.camera),I=Fr(B=>B.gl),p=Fr(B=>B.events),y=Fr(B=>B.setEvents),A=Fr(B=>B.set),m=Fr(B=>B.get),b=Fr(B=>B.performance),v=e||h,w=i||p.connected||I.domElement,x=S.useMemo(()=>new SDe(v),[v]);return Fs(()=>{x.enabled&&x.update()},-1),S.useEffect(()=>(s&&x.connect(s===!0?w:s),x.connect(w),()=>void x.dispose()),[s,w,n,x,d]),S.useEffect(()=>{const B=W=>{d(),n&&b.regress(),o&&o(W)},Z=W=>{a&&a(W)},N=W=>{l&&l(W)};return x.addEventListener("change",B),x.addEventListener("start",Z),x.addEventListener("end",N),()=>{x.removeEventListener("start",Z),x.removeEventListener("end",N),x.removeEventListener("change",B)}},[o,a,l,x,d,y]),S.useEffect(()=>{if(t){const B=m().controls;return A({controls:x}),()=>A({controls:B})}},[t,x]),S.createElement("primitive",kf({ref:u,object:x,enableDamping:r},c))}),FDe=3e3,_De=3001,kte=(t,e,n)=>{let i;switch(t){case Ss:i=new Uint8ClampedArray(e*n*4);break;case hr:i=new Uint16Array(e*n*4);break;case Hl:i=new Uint32Array(e*n*4);break;case UB:i=new Int8Array(e*n*4);break;case JB:i=new Int16Array(e*n*4);break;case ey:i=new Int32Array(e*n*4);break;case Fi:i=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return i};let Lv;const TDe=(t,e,n,i)=>{if(Lv!==void 0)return Lv;const r=new ga(1,1,i);e.setRenderTarget(r);const s=new Li(new Bu,new Uc({color:16777215}));e.render(s,n),e.setRenderTarget(null);const o=kte(t,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,o),r.dispose(),s.geometry.dispose(),s.material.dispose(),Lv=o[0]!==0,Lv};class O_{constructor(e){wi(this,"_renderer");wi(this,"_rendererIsDisposable",!1);wi(this,"_material");wi(this,"_scene");wi(this,"_camera");wi(this,"_quad");wi(this,"_renderTarget");wi(this,"_width");wi(this,"_height");wi(this,"_type");wi(this,"_colorSpace");wi(this,"_supportsReadPixels",!0);wi(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var i,r,s,o,a,l,c,u,d,h,I,p,y,A,m,b;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const n={format:Ki,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((i=e.renderTargetOptions)==null?void 0:i.anisotropy)!==void 0?(r=e.renderTargetOptions)==null?void 0:r.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)==null?void 0:a.magFilter)!==void 0?(l=e.renderTargetOptions)==null?void 0:l.magFilter:Ln,minFilter:((c=e.renderTargetOptions)==null?void 0:c.minFilter)!==void 0?(u=e.renderTargetOptions)==null?void 0:u.minFilter:Ln,samples:((d=e.renderTargetOptions)==null?void 0:d.samples)!==void 0?(h=e.renderTargetOptions)==null?void 0:h.samples:void 0,wrapS:((I=e.renderTargetOptions)==null?void 0:I.wrapS)!==void 0?(p=e.renderTargetOptions)==null?void 0:p.wrapS:Vi,wrapT:((y=e.renderTargetOptions)==null?void 0:y.wrapT)!==void 0?(A=e.renderTargetOptions)==null?void 0:A.wrapT:Vi};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=O_.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new gu,this._camera=new Ua,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!TDe(this._type,this._renderer,this._camera,n)){let v;switch(this._type){case hr:v=this._renderer.extensions.has("EXT_color_buffer_float")?Fi:void 0;break}v!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Fi}`),this._type=v):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Li(new Bu,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ga(this.width,this.height,n),this._renderTarget.texture.mapping=((m=e.renderTargetOptions)==null?void 0:m.mapping)!==void 0?(b=e.renderTargetOptions)==null?void 0:b.mapping:au}static instantiateRenderer(){const e=new Y_;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=kte(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new sa(this.toArray(),this.width,this.height,Ki,this._type,(e==null?void 0:e.mapping)||au,(e==null?void 0:e.wrapS)||Vi,(e==null?void 0:e.wrapT)||Vi,(e==null?void 0:e.magFilter)||Ln,(e==null?void 0:e.minFilter)||Ln,(e==null?void 0:e.anisotropy)||1,Kl);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof as&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof $n&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof $n&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class Hte extends Error{}class Kte extends Error{}const nm=(t,e,n)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(t);if(i)return i[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(t);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${e} in gainmap metadata`)},XDe=t=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(t):e=t.toString();let n=e.indexOf("<x:xmpmeta");for(;n!==-1;){const i=e.indexOf("x:xmpmeta>",n),r=e.slice(n,i+10);try{const s=nm(r,"hdrgm:GainMapMin","0"),o=nm(r,"hdrgm:GainMapMax"),a=nm(r,"hdrgm:Gamma","1"),l=nm(r,"hdrgm:OffsetSDR","0.015625"),c=nm(r,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),d=u?u[1]:"0",h=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!h)throw new Error("Incomplete gainmap metadata");const I=h[1];return{gainMapMin:Array.isArray(s)?s.map(p=>parseFloat(p)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(p=>parseFloat(p)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(p=>parseFloat(p)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(l)?l.map(p=>parseFloat(p)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(p=>parseFloat(p)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(d),hdrCapacityMax:parseFloat(I)}}catch{}n=e.indexOf("<x:xmpmeta",i)}};class EDe{constructor(e){wi(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,i)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){i(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,l=0,c;for(;a<o;){if(++l>250){i(new Error(`Found no marker after ${l} loops `));return}if(s.getUint8(a)!==255){i(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(c=s.getUint8(a+1),r&&console.log(`Marker: ${c.toString(16)}`),c===226){r&&console.log("Found APP2 marker (0xffe2)");const u=a+4;if(s.getUint32(u)===1297106432){const d=u+4;let h;if(s.getUint16(d)===18761)h=!1;else if(s.getUint16(d)===19789)h=!0;else{i(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(d+2,!h)!==42){i(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const I=s.getUint32(d+4,!h);if(I<8){i(new Error("Not valid TIFF data! (First offset less than 8)"));return}const p=d+I,y=s.getUint16(p,!h),A=p+2;let m=0;for(let x=A;x<A+12*y;x+=12)s.getUint16(x,!h)===45057&&(m=s.getUint32(x+8,!h));const v=p+2+y*12+4,w=[];for(let x=v;x<v+m*16;x+=16){const B={MPType:s.getUint32(x,!h),size:s.getUint32(x+4,!h),dataOffset:s.getUint32(x+8,!h),dependantImages:s.getUint32(x+12,!h),start:-1,end:-1,isFII:!1};B.dataOffset?(B.start=d+B.dataOffset,B.isFII=!1):(B.start=0,B.isFII=!0),B.end=B.start+B.size,w.push(B)}if(this.options.extractNonFII&&w.length){const x=new Blob([s]),B=[];for(const Z of w){if(Z.isFII&&!this.options.extractFII)continue;const N=x.slice(Z.start,Z.end+1,"image/jpeg");B.push(N)}n(B)}}}a+=2+s.getUint16(a+2)}})}}const YDe=async t=>{const e=XDe(t);if(!e)throw new Kte("Gain map XMP metadata not found");const i=await new EDe({extractFII:!0,extractNonFII:!0}).extract(t);if(i.length!==2)throw new Hte("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},Jz=t=>new Promise((e,n)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=r=>{n(r)},i.src=URL.createObjectURL(t)});class kDe extends Vs{constructor(n,i){super(i);wi(this,"_renderer");wi(this,"_renderTargetOptions");wi(this,"_internalLoadingManager");wi(this,"_config");this._config=n,n.renderer&&(this._renderer=n.renderer),this._internalLoadingManager=new vS}setRenderer(n){return this._renderer=n,this}setRenderTargetOptions(n){return this._renderTargetOptions=n,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const n=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new $n,sdr:new $n});return this._config.createQuadRenderer({width:16,height:16,type:hr,colorSpace:Kl,material:n,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(n,i,r){const s=i?new Blob([i],{type:"image/jpeg"}):void 0,o=new Blob([n],{type:"image/jpeg"});let a,l,c=!1;if(typeof createImageBitmap>"u"){const u=await Promise.all([s?Jz(s):Promise.resolve(void 0),Jz(o)]);l=u[0],a=u[1],c=r==="flipY"}else{const u=await Promise.all([s?createImageBitmap(s,{imageOrientation:r||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:r||"flipY"})]);l=u[0],a=u[1]}return{sdrImage:a,gainMapImage:l,needsFlip:c}}createTextures(n,i,r){const s=new $n(i||new ImageData(2,2),au,Vi,Vi,Ln,R3,Ki,Ss,1,Kl);s.flipY=r,s.needsUpdate=!0;const o=new $n(n,au,Vi,Vi,Ln,R3,Ki,Ss,1,ts);return o.flipY=r,o.needsUpdate=!0,{gainMap:s,sdr:o}}updateQuadRenderer(n,i,r,s,o){n.width=i.width,n.height=i.height,n.material.gainMap=r,n.material.sdr=s,n.material.gainMapMin=o.gainMapMin,n.material.gainMapMax=o.gainMapMax,n.material.offsetHdr=o.offsetHdr,n.material.offsetSdr=o.offsetSdr,n.material.gamma=o.gamma,n.material.hdrCapacityMin=o.hdrCapacityMin,n.material.hdrCapacityMax=o.hdrCapacityMax,n.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),n.material.needsUpdate=!0}}const HDe=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,KDe=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class LDe extends as{constructor({gamma:n,offsetHdr:i,offsetSdr:r,gainMapMin:s,gainMapMax:o,maxDisplayBoost:a,hdrCapacityMin:l,hdrCapacityMax:c,sdr:u,gainMap:d}){super({name:"GainMapDecoderMaterial",vertexShader:HDe,fragmentShader:KDe,uniforms:{sdr:{value:u},gainMap:{value:d},gamma:{value:new J(1/n[0],1/n[1],1/n[2])},offsetHdr:{value:new J().fromArray(i)},offsetSdr:{value:new J().fromArray(r)},gainMapMin:{value:new J().fromArray(s)},gainMapMax:{value:new J().fromArray(o)},weightFactor:{value:(Math.log2(a)-l)/(c-l)}},blending:Da,depthTest:!1,depthWrite:!1});wi(this,"_maxDisplayBoost");wi(this,"_hdrCapacityMin");wi(this,"_hdrCapacityMax");this._maxDisplayBoost=a,this._hdrCapacityMin=l,this._hdrCapacityMax=c,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(n){this.uniforms.sdr.value=n}get gainMap(){return this.uniforms.gainMap.value}set gainMap(n){this.uniforms.gainMap.value=n}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(n){this.uniforms.offsetHdr.value.fromArray(n)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(n){this.uniforms.offsetSdr.value.fromArray(n)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(n){this.uniforms.gainMapMin.value.fromArray(n)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(n){this.uniforms.gainMapMax.value.fromArray(n)}get gamma(){const n=this.uniforms.gamma.value;return[1/n.x,1/n.y,1/n.z]}set gamma(n){const i=this.uniforms.gamma.value;i.x=1/n[0],i.y=1/n[1],i.z=1/n[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(n){this._hdrCapacityMin=n,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(n){this._hdrCapacityMax=n,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(n){this._maxDisplayBoost=Math.max(1,Math.min(65504,n)),this.calculateWeight()}calculateWeight(){const n=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,n))}}class Lte extends kDe{constructor(e,n){super({renderer:e,createMaterial:i=>new LDe(i),createQuadRenderer:i=>new O_(i)},n)}async render(e,n,i,r){const{sdrImage:s,gainMapImage:o,needsFlip:a}=await this.processImages(i,r,"flipY"),{gainMap:l,sdr:c}=this.createTextures(s,o,a);this.updateQuadRenderer(e,s,l,c,n),e.render()}}class zDe extends Lte{load([e,n,i],r,s,o){const a=this.prepareQuadRenderer();let l,c,u;const d=async()=>{if(l&&c&&u){try{await this.render(a,u,l,c)}catch(W){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(i),typeof o=="function"&&o(W),a.disposeOnDemandRenderer();return}typeof r=="function"&&r(a),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(i),a.disposeOnDemandRenderer()}};let h=!0,I=0,p=0,y=!0,A=0,m=0,b=!0,v=0,w=0;const x=()=>{if(typeof s=="function"){const W=I+A+v,M=p+m+w,F=h&&y&&b;s(new ProgressEvent("progress",{lengthComputable:F,loaded:M,total:W}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(i);const B=new Bo(this._internalLoadingManager);B.setResponseType("arraybuffer"),B.setRequestHeader(this.requestHeader),B.setPath(this.path),B.setWithCredentials(this.withCredentials),B.load(e,async W=>{if(typeof W=="string")throw new Error("Invalid sdr buffer");l=W,await d()},W=>{h=W.lengthComputable,p=W.loaded,I=W.total,x()},W=>{this.manager.itemError(e),typeof o=="function"&&o(W)});const Z=new Bo(this._internalLoadingManager);Z.setResponseType("arraybuffer"),Z.setRequestHeader(this.requestHeader),Z.setPath(this.path),Z.setWithCredentials(this.withCredentials),Z.load(n,async W=>{if(typeof W=="string")throw new Error("Invalid gainmap buffer");c=W,await d()},W=>{y=W.lengthComputable,m=W.loaded,A=W.total,x()},W=>{this.manager.itemError(n),typeof o=="function"&&o(W)});const N=new Bo(this._internalLoadingManager);return N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(i,async W=>{if(typeof W!="string")throw new Error("Invalid metadata string");u=JSON.parse(W),await d()},W=>{b=W.lengthComputable,w=W.loaded,v=W.total,x()},W=>{this.manager.itemError(i),typeof o=="function"&&o(W)}),a}}class jDe extends Lte{load(e,n,i,r){const s=this.prepareQuadRenderer(),o=new Bo(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(a);let c,u,d;try{const h=await YDe(l);c=h.sdr,u=h.gainMap,d=h.metadata}catch(h){if(h instanceof Kte||h instanceof Hte)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw h}try{await this.render(s,d,c.buffer,u==null?void 0:u.buffer)}catch(h){this.manager.itemError(e),typeof r=="function"&&r(h),s.disposeOnDemandRenderer();return}typeof n=="function"&&n(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},i,a=>{this.manager.itemError(e),typeof r=="function"&&r(a)}),s}}const rN={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},PDe="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",zv=t=>Array.isArray(t);function zte({files:t=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:e="",preset:n=void 0,encoding:i=void 0,extensions:r}={}){var s;let o=null,a=!1;if(n){if(!(n in rN))throw new Error("Preset must be one of: "+Object.keys(rN).join(", "));t=rN[n],e=PDe}const l=zv(t)&&t.length===6,c=zv(t)&&t.length===3&&t.some(A=>A.endsWith("json")),u=zv(t)?t[0]:t;a=zv(t);const d=l?"cube":c?"webp":u.startsWith("data:application/exr")?"exr":u.startsWith("data:application/hdr")?"hdr":u.startsWith("data:image/jpeg")?"jpg":(s=u.split(".").pop())==null||(s=s.split("?"))==null||(s=s.shift())==null?void 0:s.toLowerCase();if(o=d==="cube"?Hee:d==="hdr"?ZDe:d==="exr"?RDe:d==="jpg"||d==="jpeg"?jDe:d==="webp"?zDe:null,!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);const h=Fr(A=>A.gl);S.useLayoutEffect(()=>{if(d!=="webp"&&d!=="jpg"&&d!=="jpeg")return;function A(){a2.clear(o,a?[t]:t)}h.domElement.addEventListener("webglcontextlost",A,{once:!0})},[t,h.domElement]);const I=a2(o,a?[t]:t,A=>{(d==="webp"||d==="jpg"||d==="jpeg")&&A.setRenderer(h),A.setPath==null||A.setPath(e),r&&r(A)});let p=a?I[0]:I;if(d==="jpg"||d==="jpeg"||d==="webp"){var y;p=(y=p.renderTarget)==null?void 0:y.texture}return p.mapping=l?kl:oC,"colorSpace"in p?p.colorSpace=i??l?"srgb":"srgb-linear":p.encoding=i??l?_De:FDe,p}const ODe=t=>t.current&&t.current.isScene,DDe=t=>ODe(t)?t.current:t;function D_(t,e,n,i,r={}){var s,o,a,l,c;r={backgroundBlurriness:(s=r.blur)!==null&&s!==void 0?s:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const u=DDe(e||n),d=u.background,h=u.environment,I={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:(o=(a=u.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&o!==void 0?o:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:(l=(c=u.environmentRotation)==null||c.clone==null?void 0:c.clone())!==null&&l!==void 0?l:[0,0,0]};return t!=="only"&&(u.environment=i),t&&(u.background=i),bg(u,r),()=>{t!=="only"&&(u.environment=h),t&&(u.background=d),bg(u,I)}}function U_({scene:t,background:e=!1,map:n,...i}){const r=Fr(s=>s.scene);return S.useLayoutEffect(()=>{if(n)return D_(e,t,r,n,i)}),null}function jte({background:t=!1,scene:e,blur:n,backgroundBlurriness:i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...l}){const c=zte(l),u=Fr(d=>d.scene);return S.useLayoutEffect(()=>D_(t,e,u,c,{blur:n,backgroundBlurriness:i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),null}function UDe({children:t,near:e=1,far:n=1e3,resolution:i=256,frames:r=1,map:s,background:o=!1,blur:a,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:d,environmentRotation:h,scene:I,files:p,path:y,preset:A=void 0,extensions:m}){const b=Fr(N=>N.gl),v=Fr(N=>N.scene),w=S.useRef(null),[x]=S.useState(()=>new gu),B=S.useMemo(()=>{const N=new u_(i);return N.texture.type=hr,N},[i]);S.useLayoutEffect(()=>(r===1&&w.current.update(b,x),D_(o,I,v,B.texture,{blur:a,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:d,environmentRotation:h})),[t,x,B.texture,I,v,o,r,b]);let Z=1;return Fs(()=>{(r===1/0||Z<r)&&(w.current.update(b,x),Z++)}),S.createElement(S.Fragment,null,WOe(S.createElement(S.Fragment,null,t,S.createElement("cubeCamera",{ref:w,args:[e,n,B]}),p||A?S.createElement(jte,{background:!0,files:p,preset:A,path:y,extensions:m}):s?S.createElement(U_,{background:!0,map:s,extensions:m}):null),x))}function JDe(t){var e,n,i,r;const s=zte(t),o=t.map||s;S.useMemo(()=>H_({GroundProjectedEnvImpl:ADe}),[]);const a=S.useMemo(()=>[o],[o]),l=(e=t.ground)==null?void 0:e.height,c=(n=t.ground)==null?void 0:n.radius,u=(i=(r=t.ground)==null?void 0:r.scale)!==null&&i!==void 0?i:1e3;return S.createElement(S.Fragment,null,S.createElement(U_,kf({},t,{map:o})),S.createElement("groundProjectedEnvImpl",{args:a,scale:u,height:l,radius:c}))}function QDe(t){return t.ground?S.createElement(JDe,t):t.map?S.createElement(U_,t):t.children?S.createElement(UDe,t):S.createElement(jte,t)}const qDe=NDe({time:0,pixelRatio:1},` uniform float pixelRatio;
    uniform float time;
    attribute float size;  
    attribute float speed;  
    attribute float opacity;
    attribute vec3 noise;
    attribute vec3 color;
    varying vec3 vColor;
    varying float vOpacity;
    void main() {
      vec4 modelPosition = modelMatrix * vec4(position, 1.0);
      modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
      modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
      modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
      vec4 viewPosition = viewMatrix * modelPosition;
      vec4 projectionPostion = projectionMatrix * viewPosition;
      gl_Position = projectionPostion;
      gl_PointSize = size * 25. * pixelRatio;
      gl_PointSize *= (1.0 / - viewPosition.z);
      vColor = color;
      vOpacity = opacity;
    }`,` varying vec3 vColor;
    varying float vOpacity;
    void main() {
      float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
      float strength = 0.05 / distanceToCenter - 0.1;
      gl_FragColor = vec4(vColor, strength * vOpacity);
      #include <tonemapping_fragment>
      #include <${MDe>=154?"colorspace_fragment":"encodings_fragment"}>
    }`),Pte=t=>t&&t.constructor===Float32Array,$De=t=>[t.r,t.g,t.b],Ote=t=>t instanceof He||t instanceof J||t instanceof _n,Dte=t=>Array.isArray(t)?t:Ote(t)?t.toArray():[t,t,t];function im(t,e,n){return S.useMemo(()=>{if(e!==void 0){if(Pte(e))return e;if(e instanceof wt){const i=Array.from({length:t*3},()=>$De(e)).flat();return Float32Array.from(i)}else if(Ote(e)||Array.isArray(e)){const i=Array.from({length:t*3},()=>Dte(e)).flat();return Float32Array.from(i)}return Float32Array.from({length:t},()=>e)}return Float32Array.from({length:t},n)},[e])}const sN=S.forwardRef(({noise:t=1,count:e=100,speed:n=1,opacity:i=1,scale:r=1,size:s,color:o,children:a,...l},c)=>{S.useMemo(()=>H_({SparklesImplMaterial:qDe}),[]);const u=S.useRef(null),d=Fr(v=>v.viewport.dpr),h=Dte(r),I=S.useMemo(()=>Float32Array.from(Array.from({length:e},()=>h.map(pC.randFloatSpread)).flat()),[e,...h]),p=im(e,s,Math.random),y=im(e,i),A=im(e,n),m=im(e*3,t),b=im(o===void 0?e*3:e,Pte(o)?o:new wt(o),()=>1);return Fs(v=>{u.current&&u.current.material&&(u.current.material.time=v.clock.elapsedTime)}),S.useImperativeHandle(c,()=>u.current,[]),S.createElement("points",kf({key:`particle-${e}-${JSON.stringify(r)}`},l,{ref:u}),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[I,3]}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[p,1]}),S.createElement("bufferAttribute",{attach:"attributes-opacity",args:[y,1]}),S.createElement("bufferAttribute",{attach:"attributes-speed",args:[A,1]}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[b,3]}),S.createElement("bufferAttribute",{attach:"attributes-noise",args:[m,3]})),a||S.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:d,depthWrite:!1}))}),Qz={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class l2{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(e){return new gUe(e)}),this.register(function(e){return new uUe(e)}),this.register(function(e){return new fUe(e)}),this.register(function(e){return new CUe(e)}),this.register(function(e){return new pUe(e)}),this.register(function(e){return new mUe(e)}),this.register(function(e){return new dUe(e)}),this.register(function(e){return new hUe(e)}),this.register(function(e){return new IUe(e)}),this.register(function(e){return new AUe(e)}),this.register(function(e){return new yUe(e)}),this.register(function(e){return new bUe(e)}),this.register(function(e){return new vUe(e)}),this.register(function(e){return new xUe(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,n,i,r){const s=new cUe,o=[];for(let a=0,l=this.pluginCallbacks.length;a<l;a++)o.push(this.pluginCallbacks[a](s));s.setPlugins(o),s.setTextureUtils(this.textureUtils),s.writeAsync(e,n,r).catch(i)}parseAsync(e,n){const i=this;return new Promise(function(r,s){i.parse(e,r,s,n)})}}const Bn={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},oN="KHR_mesh_quantization",bo={};bo[Sr]=Bn.NEAREST;bo[DB]=Bn.NEAREST_MIPMAP_NEAREST;bo[yd]=Bn.NEAREST_MIPMAP_LINEAR;bo[Ln]=Bn.LINEAR;bo[$I]=Bn.LINEAR_MIPMAP_NEAREST;bo[ka]=Bn.LINEAR_MIPMAP_LINEAR;bo[Vi]=Bn.CLAMP_TO_EDGE;bo[aC]=Bn.REPEAT;bo[lC]=Bn.MIRRORED_REPEAT;const qz={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},eUe=new wt,$z=12,tUe=1179937895,nUe=2,ej=8,iUe=1313821514,rUe=5130562;function ym(t,e){return t.length===e.length&&t.every(function(n,i){return n===e[i]})}function sUe(t){return new TextEncoder().encode(t).buffer}function oUe(t){return ym(t.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function aUe(t,e,n){const i={min:new Array(t.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(t.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+n;r++)for(let s=0;s<t.itemSize;s++){let o;t.itemSize>4?o=t.array[r*t.itemSize+s]:(s===0?o=t.getX(r):s===1?o=t.getY(r):s===2?o=t.getZ(r):s===3&&(o=t.getW(r)),t.normalized===!0&&(o=pC.normalize(o,t.array))),i.min[s]=Math.min(i.min[s],o),i.max[s]=Math.max(i.max[s],o)}return i}function Ute(t){return Math.ceil(t/4)*4}function aN(t,e=0){const n=Ute(t.byteLength);if(n!==t.byteLength){const i=new Uint8Array(n);if(i.set(new Uint8Array(t)),e!==0)for(let r=t.byteLength;r<n;r++)i[r]=e;return i.buffer}return t}function tj(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function lUe(t,e){if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){let n;return e==="image/jpeg"?n=.92:e==="image/webp"&&(n=.8),t.convertToBlob({type:e,quality:n})}else return new Promise(n=>t.toBlob(n,e))}class cUe{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+mh}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,n,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const r=this,s=r.buffers,o=r.json;i=r.options;const a=r.extensionsUsed,l=r.extensionsRequired,c=new Blob(s,{type:"application/octet-stream"}),u=Object.keys(a),d=Object.keys(l);if(u.length>0&&(o.extensionsUsed=u),d.length>0&&(o.extensionsRequired=d),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=c.size),i.binary===!0){const h=new FileReader;h.readAsArrayBuffer(c),h.onloadend=function(){const I=aN(h.result),p=new DataView(new ArrayBuffer(ej));p.setUint32(0,I.byteLength,!0),p.setUint32(4,rUe,!0);const y=aN(sUe(JSON.stringify(o)),32),A=new DataView(new ArrayBuffer(ej));A.setUint32(0,y.byteLength,!0),A.setUint32(4,iUe,!0);const m=new ArrayBuffer($z),b=new DataView(m);b.setUint32(0,tUe,!0),b.setUint32(4,nUe,!0);const v=$z+A.byteLength+y.byteLength+p.byteLength+I.byteLength;b.setUint32(8,v,!0);const w=new Blob([m,A,y,p,I],{type:"application/octet-stream"}),x=new FileReader;x.readAsArrayBuffer(w),x.onloadend=function(){n(x.result)}}}else if(o.buffers&&o.buffers.length>0){const h=new FileReader;h.readAsDataURL(c),h.onloadend=function(){const I=h.result;o.buffers[0].uri=I,n(o)}}else n(o)}serializeUserData(e,n){if(Object.keys(e.userData).length===0)return;const i=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&s.gltfExtensions){n.extensions===void 0&&(n.extensions={});for(const o in s.gltfExtensions)n.extensions[o]=s.gltfExtensions[o],r[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(n.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,n=!1){if(this.uids.has(e)===!1){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(n)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new J;for(let r=0,s=e.count;r<s;r++)if(Math.abs(i.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const n=this.cache;if(n.attributesNormalized.has(e))return n.attributesNormalized.get(e);const i=e.clone(),r=new J;for(let s=0,o=i.count;s<o;s++)r.fromBufferAttribute(i,s),r.x===0&&r.y===0&&r.z===0?r.setX(1):r.normalize(),i.setXYZ(s,r.x,r.y,r.z);return n.attributesNormalized.set(e,i),i}applyTextureTransform(e,n){let i=!1;const r={};(n.offset.x!==0||n.offset.y!==0)&&(r.offset=n.offset.toArray(),i=!0),n.rotation!==0&&(r.rotation=n.rotation,i=!0),(n.repeat.x!==1||n.repeat.y!==1)&&(r.scale=n.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,n){if(e===n)return e;function i(I){return I.colorSpace===ts?function(y){return y<.04045?y*.0773993808:Math.pow(y*.9478672986+.0521327014,2.4)}:function(y){return y}}e instanceof kd&&(e=await this.decompressTextureAsync(e)),n instanceof kd&&(n=await this.decompressTextureAsync(n));const r=e?e.image:null,s=n?n.image:null,o=Math.max(r?r.width:0,s?s.width:0),a=Math.max(r?r.height:0,s?s.height:0),l=tj();l.width=o,l.height=a;const c=l.getContext("2d",{willReadFrequently:!0});c.fillStyle="#00ffff",c.fillRect(0,0,o,a);const u=c.getImageData(0,0,o,a);if(r){c.drawImage(r,0,0,o,a);const I=i(e),p=c.getImageData(0,0,o,a).data;for(let y=2;y<p.length;y+=4)u.data[y]=I(p[y]/256)*256}if(s){c.drawImage(s,0,0,o,a);const I=i(n),p=c.getImageData(0,0,o,a).data;for(let y=1;y<p.length;y+=4)u.data[y]=I(p[y]/256)*256}c.putImageData(u,0,0);const h=(e||n).clone();return h.source=new Gc(l),h.colorSpace=Gl,h.channel=(e||n).channel,e&&n&&e.channel!==n.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),h}async decompressTextureAsync(e,n=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,n)}processBuffer(e){const n=this.json,i=this.buffers;return n.buffers||(n.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,n,i,r,s){const o=this.json;o.bufferViews||(o.bufferViews=[]);let a;switch(n){case Bn.BYTE:case Bn.UNSIGNED_BYTE:a=1;break;case Bn.SHORT:case Bn.UNSIGNED_SHORT:a=2;break;default:a=4}let l=e.itemSize*a;s===Bn.ARRAY_BUFFER&&(l=Math.ceil(l/4)*4);const c=Ute(r*l),u=new DataView(new ArrayBuffer(c));let d=0;for(let p=i;p<i+r;p++){for(let y=0;y<e.itemSize;y++){let A;e.itemSize>4?A=e.array[p*e.itemSize+y]:(y===0?A=e.getX(p):y===1?A=e.getY(p):y===2?A=e.getZ(p):y===3&&(A=e.getW(p)),e.normalized===!0&&(A=pC.normalize(A,e.array))),n===Bn.FLOAT?u.setFloat32(d,A,!0):n===Bn.INT?u.setInt32(d,A,!0):n===Bn.UNSIGNED_INT?u.setUint32(d,A,!0):n===Bn.SHORT?u.setInt16(d,A,!0):n===Bn.UNSIGNED_SHORT?u.setUint16(d,A,!0):n===Bn.BYTE?u.setInt8(d,A):n===Bn.UNSIGNED_BYTE&&u.setUint8(d,A),d+=a}d%l!==0&&(d+=l-d%l)}const h={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:c};return s!==void 0&&(h.target=s),s===Bn.ARRAY_BUFFER&&(h.byteStride=l),this.byteOffset+=c,o.bufferViews.push(h),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const n=this,i=n.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(r){const s=new FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){const o=aN(s.result),a={buffer:n.processBuffer(o),byteOffset:n.byteOffset,byteLength:o.byteLength};n.byteOffset+=o.byteLength,r(i.bufferViews.push(a)-1)}})}processAccessor(e,n,i,r){const s=this.json,o={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=Bn.FLOAT;else if(e.array.constructor===Int32Array)a=Bn.INT;else if(e.array.constructor===Uint32Array)a=Bn.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=Bn.SHORT;else if(e.array.constructor===Uint16Array)a=Bn.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=Bn.BYTE;else if(e.array.constructor===Uint8Array)a=Bn.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(i===void 0&&(i=0),(r===void 0||r===1/0)&&(r=e.count),r===0)return null;const l=aUe(e,i,r);let c;n!==void 0&&(c=e===n.index?Bn.ELEMENT_ARRAY_BUFFER:Bn.ARRAY_BUFFER);const u=this.processBufferView(e,a,i,r,c),d={bufferView:u.id,byteOffset:u.byteOffset,componentType:a,count:r,max:l.max,min:l.min,type:o[e.itemSize]};return e.normalized===!0&&(d.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(d)-1}processImage(e,n,i,r="image/png"){if(e!==null){const s=this,o=s.cache,a=s.json,l=s.options,c=s.pending;o.images.has(e)||o.images.set(e,{});const u=o.images.get(e),d=r+":flipY/"+i.toString();if(u[d]!==void 0)return u[d];a.images||(a.images=[]);const h={mimeType:r},I=tj();I.width=Math.min(e.width,l.maxTextureSize),I.height=Math.min(e.height,l.maxTextureSize);const p=I.getContext("2d",{willReadFrequently:!0});if(i===!0&&(p.translate(0,I.height),p.scale(1,-1)),e.data!==void 0){n!==Ki&&console.error("GLTFExporter: Only RGBAFormat is supported.",n),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const A=new Uint8ClampedArray(e.height*e.width*4);for(let m=0;m<A.length;m+=4)A[m+0]=e.data[m+0],A[m+1]=e.data[m+1],A[m+2]=e.data[m+2],A[m+3]=e.data[m+3];p.putImageData(new ImageData(A,e.width,e.height),0,0)}else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)p.drawImage(e,0,0,I.width,I.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");l.binary===!0?c.push(lUe(I,r).then(A=>s.processBufferViewImage(A)).then(A=>{h.bufferView=A})):h.uri=o_.getDataURL(I,r);const y=a.images.push(h)-1;return u[d]=y,y}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const n=this.json;n.samplers||(n.samplers=[]);const i={magFilter:bo[e.magFilter],minFilter:bo[e.minFilter],wrapS:bo[e.wrapS],wrapT:bo[e.wrapT]};return n.samplers.push(i)-1}async processTextureAsync(e){const i=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof kd&&(e=await this.decompressTextureAsync(e,i.maxTextureSize));let o=e.userData.mimeType;o==="image/webp"&&(o="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(a.name=e.name),await this._invokeAllAsync(async function(c){c.writeTexture&&await c.writeTexture(e,a)});const l=s.textures.push(a)-1;return r.textures.set(e,l),l}async processMaterialAsync(e){const n=this.cache,i=this.json;if(n.materials.has(e))return n.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const r={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(ym(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=0,r.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const a=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),l={index:await this.processTextureAsync(a),texCoord:a.channel};this.applyTextureTransform(l,a),r.pbrMetallicRoughness.metallicRoughnessTexture=l}if(e.map){const a={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(a,e.map),r.pbrMetallicRoughness.baseColorTexture=a}if(e.emissive){const a=e.emissive;if(Math.max(a.r,a.g,a.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const c={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(c,e.emissiveMap),r.emissiveTexture=c}}if(e.normalMap){const a={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(a.scale=e.normalScale.x),this.applyTextureTransform(a,e.normalMap),r.normalTexture=a}if(e.aoMap){const a={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(a.strength=e.aoMapIntensity),this.applyTextureTransform(a,e.aoMap),r.occlusionTexture=a}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===rs&&(r.doubleSided=!0),e.name!==""&&(r.name=e.name),this.serializeUserData(e,r),await this._invokeAllAsync(async function(a){a.writeMaterialAsync&&await a.writeMaterialAsync(e,r)});const o=i.materials.push(r)-1;return n.materials.set(e,o),o}async processMeshAsync(e){const n=this.cache,i=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let w=0,x=e.material.length;w<x;w++)r.push(e.material[w].uuid);else r.push(e.material.uuid);const s=r.join(":");if(n.meshes.has(s))return n.meshes.get(s);const o=e.geometry;let a;e.isLineSegments?a=Bn.LINES:e.isLineLoop?a=Bn.LINE_LOOP:e.isLine?a=Bn.LINE_STRIP:e.isPoints?a=Bn.POINTS:a=e.material.wireframe?Bn.LINES:Bn.TRIANGLES;const l={},c={},u=[],d=[],h={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},I=o.getAttribute("normal");I!==void 0&&!this.isNormalizedNormalAttribute(I)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(I)));let p=null;for(let w in o.attributes){if(w.slice(0,5)==="morph")continue;const x=o.attributes[w];if(w=h[w]||w.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(w)||(w="_"+w),n.attributes.has(this.getUID(x))){c[w]=n.attributes.get(this.getUID(x));continue}p=null;const Z=x.array;w==="JOINTS_0"&&!(Z instanceof Uint16Array)&&!(Z instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),p=new Wn(new Uint16Array(Z),x.itemSize,x.normalized)):(Z instanceof Uint32Array||Z instanceof Int32Array)&&!w.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${w}" converted to type FLOAT.`),p=l2.Utils.toFloat32BufferAttribute(x));const N=this.processAccessor(p||x,o);N!==null&&(w.startsWith("_")||this.detectMeshQuantization(w,x),c[w]=N,n.attributes.set(this.getUID(x),N))}if(I!==void 0&&o.setAttribute("normal",I),Object.keys(c).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const w=[],x=[],B={};if(e.morphTargetDictionary!==void 0)for(const Z in e.morphTargetDictionary)B[e.morphTargetDictionary[Z]]=Z;for(let Z=0;Z<e.morphTargetInfluences.length;++Z){const N={};let W=!1;for(const M in o.morphAttributes){if(M!=="position"&&M!=="normal"){W||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),W=!0);continue}const F=o.morphAttributes[M][Z],T=M.toUpperCase(),H=o.attributes[M];if(n.attributes.has(this.getUID(F,!0))){N[T]=n.attributes.get(this.getUID(F,!0));continue}const K=F.clone();if(!o.morphTargetsRelative)for(let z=0,j=F.count;z<j;z++)for(let O=0;O<F.itemSize;O++)O===0&&K.setX(z,F.getX(z)-H.getX(z)),O===1&&K.setY(z,F.getY(z)-H.getY(z)),O===2&&K.setZ(z,F.getZ(z)-H.getZ(z)),O===3&&K.setW(z,F.getW(z)-H.getW(z));N[T]=this.processAccessor(K,o),n.attributes.set(this.getUID(H,!0),N[T])}d.push(N),w.push(e.morphTargetInfluences[Z]),e.morphTargetDictionary!==void 0&&x.push(B[Z])}l.weights=w,x.length>0&&(l.extras={},l.extras.targetNames=x)}const y=Array.isArray(e.material);if(y&&o.groups.length===0)return null;let A=!1;if(y&&o.index===null){const w=[];for(let x=0,B=o.attributes.position.count;x<B;x++)w[x]=x;o.setIndex(w),A=!0}const m=y?e.material:[e.material],b=y?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let w=0,x=b.length;w<x;w++){const B={mode:a,attributes:c};if(this.serializeUserData(o,B),d.length>0&&(B.targets=d),o.index!==null){let N=this.getUID(o.index);(b[w].start!==void 0||b[w].count!==void 0)&&(N+=":"+b[w].start+":"+b[w].count),n.attributes.has(N)?B.indices=n.attributes.get(N):(B.indices=this.processAccessor(o.index,o,b[w].start,b[w].count),n.attributes.set(N,B.indices)),B.indices===null&&delete B.indices}const Z=await this.processMaterialAsync(m[b[w].materialIndex]);Z!==null&&(B.material=Z),u.push(B)}A===!0&&o.setIndex(null),l.primitives=u,i.meshes||(i.meshes=[]),await this._invokeAllAsync(function(w){w.writeMesh&&w.writeMesh(e,l)});const v=i.meshes.push(l)-1;return n.meshes.set(s,v),v}detectMeshQuantization(e,n){if(this.extensionsUsed[oN])return;let i;switch(n.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}n.normalized&&(i+=" normalized");const r=e.split("_",1)[0];Qz[r]&&Qz[r].includes(i)&&(this.extensionsUsed[oN]=!0,this.extensionsRequired[oN]=!0)}processCamera(e){const n=this.json;n.cameras||(n.cameras=[]);const i=e.isOrthographicCamera,r={type:i?"orthographic":"perspective"};return i?r.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:pC.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(r.name=e.type),n.cameras.push(r)-1}processAnimation(e,n){const i=this.json,r=this.nodeMap;i.animations||(i.animations=[]),e=l2.Utils.mergeMorphTargetTracks(e.clone(),n);const s=e.tracks,o=[],a=[];for(let c=0;c<s.length;++c){const u=s[c],d=Sn.parseTrackName(u.name);let h=Sn.findNode(n,d.nodeName);const I=qz[d.propertyName];if(d.objectName==="bones"&&(h.isSkinnedMesh===!0?h=h.skeleton.getBoneByName(d.objectIndex):h=void 0),!h||!I){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name);continue}const p=1;let y=u.values.length/u.times.length;I===qz.morphTargetInfluences&&(y/=h.morphTargetInfluences.length);let A;u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(A="CUBICSPLINE",y/=3):u.getInterpolation()===hC?A="STEP":A="LINEAR",a.push({input:this.processAccessor(new Wn(u.times,p)),output:this.processAccessor(new Wn(u.values,y)),interpolation:A}),o.push({sampler:a.length-1,target:{node:r.get(h),path:I}})}const l={name:e.name||"clip_"+i.animations.length,samplers:a,channels:o};return this.serializeUserData(e,l),i.animations.push(l),i.animations.length-1}processSkin(e){const n=this.json,i=this.nodeMap,r=n.nodes[i.get(e)],s=e.skeleton;if(s===void 0)return null;const o=e.skeleton.bones[0];if(o===void 0)return null;const a=[],l=new Float32Array(s.bones.length*16),c=new Qt;for(let d=0;d<s.bones.length;++d)a.push(i.get(s.bones[d])),c.copy(s.boneInverses[d]),c.multiply(e.bindMatrix).toArray(l,d*16);return n.skins===void 0&&(n.skins=[]),n.skins.push({inverseBindMatrices:this.processAccessor(new Wn(l,16)),joints:a,skeleton:i.get(o)}),r.skin=n.skins.length-1}async processNodeAsync(e){const n=this.json,i=this.options,r=this.nodeMap;n.nodes||(n.nodes=[]);const s={};if(i.trs){const a=e.quaternion.toArray(),l=e.position.toArray(),c=e.scale.toArray();ym(a,[0,0,0,1])||(s.rotation=a),ym(l,[0,0,0])||(s.translation=l),ym(c,[1,1,1])||(s.scale=c)}else e.matrixAutoUpdate&&e.updateMatrix(),oUe(e.matrix)===!1&&(s.matrix=e.matrix.elements);if(e.name!==""&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const a=await this.processMeshAsync(e);a!==null&&(s.mesh=a)}else e.isCamera&&(s.camera=this.processCamera(e));e.isSkinnedMesh&&this.skins.push(e);const o=n.nodes.push(s)-1;if(r.set(e,o),e.children.length>0){const a=[];for(let l=0,c=e.children.length;l<c;l++){const u=e.children[l];if(u.visible||i.onlyVisible===!1){const d=await this.processNodeAsync(u);d!==null&&a.push(d)}}a.length>0&&(s.children=a)}return await this._invokeAllAsync(function(a){a.writeNode&&a.writeNode(e,s)}),o}async processSceneAsync(e){const n=this.json,i=this.options;n.scenes||(n.scenes=[],n.scene=0);const r={};e.name!==""&&(r.name=e.name),n.scenes.push(r);const s=[];for(let o=0,a=e.children.length;o<a;o++){const l=e.children[o];if(l.visible||i.onlyVisible===!1){const c=await this.processNodeAsync(l);c!==null&&s.push(c)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}async processObjectsAsync(e){const n=new gu;n.name="AuxScene";for(let i=0;i<e.length;i++)n.children.push(e[i]);await this.processSceneAsync(n)}async processInputAsync(e){const n=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync(function(r){r.beforeParse&&r.beforeParse(e)});const i=[];for(let r=0;r<e.length;r++)e[r]instanceof gu?await this.processSceneAsync(e[r]):i.push(e[r]);i.length>0&&await this.processObjectsAsync(i);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<n.animations.length;++r)this.processAnimation(n.animations[r],e[0]);await this._invokeAllAsync(function(r){r.afterParse&&r.afterParse(e)})}async _invokeAllAsync(e){for(let n=0,i=this.plugins.length;n<i;n++)await e(this.plugins[n])}}class gUe{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,n){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const i=this.writer,r=i.json,s=i.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(1-e.penumbra)*e.angle,o.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const a=r.extensions[this.name].lights;a.push(o),n.extensions=n.extensions||{},n.extensions[this.name]={light:a.length-1}}}class uUe{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,n){if(!e.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;n.extensions=n.extensions||{},n.extensions[this.name]={},r[this.name]=!0,n.pbrMetallicRoughness.metallicFactor=0,n.pbrMetallicRoughness.roughnessFactor=.9}}class dUe{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.clearcoat===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const o={index:await i.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(o,e.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const o={index:await i.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(o,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(e.clearcoatNormalMap){const o={index:await i.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};e.clearcoatNormalScale.x!==1&&(o.scale=e.clearcoatNormalScale.x),i.applyTextureTransform(o,e.clearcoatNormalMap),s.clearcoatNormalTexture=o}n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class hUe{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.dispersion===0)return;const r=this.writer.extensionsUsed,s={};s.dispersion=e.dispersion,n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class IUe{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.iridescence===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const o={index:await i.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(o,e.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const o={index:await i.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(o,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class fUe{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const o={index:await i.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(o,e.transmissionMap),s.transmissionTexture=o}n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class CUe{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const o={index:await i.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(o,e.thicknessMap),s.thicknessTexture=o}e.attenuationDistance!==1/0&&(s.attenuationDistance=e.attenuationDistance),s.attenuationColor=e.attenuationColor.toArray(),n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class pUe{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.ior===1.5)return;const r=this.writer.extensionsUsed,s={};s.ior=e.ior,n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class mUe{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.specularIntensity===1&&e.specularColor.equals(eUe)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.specularIntensityMap){const o={index:await i.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(o,e.specularIntensityMap),s.specularTexture=o}if(e.specularColorMap){const o={index:await i.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(o,e.specularColorMap),s.specularColorTexture=o}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class AUe{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.sheen==0)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.sheenRoughnessMap){const o={index:await i.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(o,e.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(e.sheenColorMap){const o={index:await i.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(o,e.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class yUe{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,n){if(!e.isMeshPhysicalMaterial||e.anisotropy==0)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.anisotropyMap){const o={index:await i.processTextureAsync(e.anisotropyMap)};i.applyTextureTransform(o,e.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class bUe{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,n){if(!e.isMeshStandardMaterial||e.emissiveIntensity===1)return;const r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class vUe{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,n){if(!e.isMeshStandardMaterial||e.bumpScale===1&&!e.bumpMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.bumpMap){const o={index:await i.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(o,e.bumpMap),s.bumpTexture=o}s.bumpFactor=e.bumpScale,n.extensions=n.extensions||{},n.extensions[this.name]=s,r[this.name]=!0}}class xUe{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,n){if(!e.isInstancedMesh)return;const i=this.writer,r=e,s=new Float32Array(r.count*3),o=new Float32Array(r.count*4),a=new Float32Array(r.count*3),l=new Qt,c=new J,u=new Zr,d=new J;for(let I=0;I<r.count;I++)r.getMatrixAt(I,l),l.decompose(c,u,d),c.toArray(s,I*3),u.toArray(o,I*4),d.toArray(a,I*3);const h={TRANSLATION:i.processAccessor(new Wn(s,3)),ROTATION:i.processAccessor(new Wn(o,4)),SCALE:i.processAccessor(new Wn(a,3))};r.instanceColor&&(h._COLOR_0=i.processAccessor(r.instanceColor)),n.extensions=n.extensions||{},n.extensions[this.name]={attributes:h},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}l2.Utils={insertKeyframe:function(t,e){const i=t.getValueSize(),r=new t.TimeBufferType(t.times.length+1),s=new t.ValueBufferType(t.values.length+i),o=t.createInterpolant(new t.ValueBufferType(i));let a;if(t.times.length===0){r[0]=e;for(let l=0;l<i;l++)s[l]=0;a=0}else if(e<t.times[0]){if(Math.abs(t.times[0]-e)<.001)return 0;r[0]=e,r.set(t.times,1),s.set(o.evaluate(e),0),s.set(t.values,i),a=0}else if(e>t.times[t.times.length-1]){if(Math.abs(t.times[t.times.length-1]-e)<.001)return t.times.length-1;r[r.length-1]=e,r.set(t.times,0),s.set(t.values,0),s.set(o.evaluate(e),t.values.length),a=r.length-1}else for(let l=0;l<t.times.length;l++){if(Math.abs(t.times[l]-e)<.001)return l;if(t.times[l]<e&&t.times[l+1]>e){r.set(t.times.slice(0,l+1),0),r[l+1]=e,r.set(t.times.slice(l+1),l+2),s.set(t.values.slice(0,(l+1)*i),0),s.set(o.evaluate(e),(l+1)*i),s.set(t.values.slice((l+1)*i),(l+2)*i),a=l+1;break}}return t.times=r,t.values=s,a},mergeMorphTargetTracks:function(t,e){const n=[],i={},r=t.tracks;for(let s=0;s<r.length;++s){let o=r[s];const a=Sn.parseTrackName(o.name),l=Sn.findNode(e,a.nodeName);if(a.propertyName!=="morphTargetInfluences"||a.propertyIndex===void 0){n.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(r0)}const c=l.morphTargetInfluences.length,u=l.morphTargetDictionary[a.propertyIndex];if(u===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let d;if(i[l.uuid]===void 0){d=o.clone();const I=new d.ValueBufferType(c*d.times.length);for(let p=0;p<d.times.length;p++)I[p*c+u]=d.values[p];d.name=(a.nodeName||"")+".morphTargetInfluences",d.values=I,i[l.uuid]=d,n.push(d);continue}const h=o.createInterpolant(new o.ValueBufferType(1));d=i[l.uuid];for(let I=0;I<d.times.length;I++)d.values[I*c+u]=h.evaluate(d.times[I]);for(let I=0;I<o.times.length;I++){const p=this.insertKeyframe(d,o.times[I]);d.values[p*c+u]=o.values[I]}}return t.tracks=n,t},toFloat32BufferAttribute:function(t){const e=new Wn(new Float32Array(t.count*t.itemSize),t.itemSize,!1);if(!t.normalized&&!t.isInterleavedBufferAttribute)return e.array.set(t.array),e;for(let n=0,i=t.count;n<i;n++)for(let r=0;r<t.itemSize;r++)e.setComponent(n,r,t.getComponent(n,r));return e}};var J_={exports:{}},tf=typeof Reflect=="object"?Reflect:null,nj=tf&&typeof tf.apply=="function"?tf.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},Bx;tf&&typeof tf.ownKeys=="function"?Bx=tf.ownKeys:Object.getOwnPropertySymbols?Bx=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Bx=function(e){return Object.getOwnPropertyNames(e)};function wUe(t){console&&console.warn&&console.warn(t)}var Jte=Number.isNaN||function(e){return e!==e};function si(){si.init.call(this)}J_.exports=si;J_.exports.once=ZUe;si.EventEmitter=si;si.prototype._events=void 0;si.prototype._eventsCount=0;si.prototype._maxListeners=void 0;var ij=10;function BS(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(si,"defaultMaxListeners",{enumerable:!0,get:function(){return ij},set:function(t){if(typeof t!="number"||t<0||Jte(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ij=t}});si.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};si.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Jte(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Qte(t){return t._maxListeners===void 0?si.defaultMaxListeners:t._maxListeners}si.prototype.getMaxListeners=function(){return Qte(this)};si.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")nj(l,this,n);else for(var c=l.length,u=nne(l,c),i=0;i<c;++i)nj(u[i],this,n);return!0};function qte(t,e,n,i){var r,s,o;if(BS(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=Qte(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,wUe(a)}return t}si.prototype.addListener=function(e,n){return qte(this,e,n,!1)};si.prototype.on=si.prototype.addListener;si.prototype.prependListener=function(e,n){return qte(this,e,n,!0)};function GUe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function $te(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=GUe.bind(i);return r.listener=n,i.wrapFn=r,r}si.prototype.once=function(e,n){return BS(n),this.on(e,$te(this,e,n)),this};si.prototype.prependOnceListener=function(e,n){return BS(n),this.prependListener(e,$te(this,e,n)),this};si.prototype.removeListener=function(e,n){var i,r,s,o,a;if(BS(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():BUe(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};si.prototype.off=si.prototype.removeListener;si.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function ene(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?SUe(r):nne(r,r.length)}si.prototype.listeners=function(e){return ene(this,e,!0)};si.prototype.rawListeners=function(e){return ene(this,e,!1)};si.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):tne.call(t,e)};si.prototype.listenerCount=tne;function tne(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}si.prototype.eventNames=function(){return this._eventsCount>0?Bx(this._events):[]};function nne(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function BUe(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function SUe(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function ZUe(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}ine(t,e,s,{once:!0}),e!=="error"&&RUe(t,r,{once:!0})})}function RUe(t,e,n){typeof t.on=="function"&&ine(t,"error",e,n)}function ine(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var NUe=J_.exports;function WUe(t,e){var n=atob(t);return n}function MUe(t,e,n){var i=WUe(t),r=i.indexOf(`
`,10)+1,s=i.substring(r)+"",o=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(o)}function VUe(t,e,n){var i;return function(s){return i=i||MUe(t),new Worker(i,s)}}var FUe=VUe("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KCiAgLyoqCiAgICogQSAzeDMgbWF0cml4LgogICAqIEF1dGhvcmVkIGJ5IHtAbGluayBodHRwOi8vZ2l0aHViLmNvbS9zY2h0ZXBwZS8gc2NodGVwcGV9CiAgICovCiAgY2xhc3MgTWF0MyB7CiAgICAvKioKICAgICAqIEEgdmVjdG9yIG9mIGxlbmd0aCA5LCBjb250YWluaW5nIGFsbCBtYXRyaXggZWxlbWVudHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBlbGVtZW50cyBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihlbGVtZW50cykgewogICAgICBpZiAoZWxlbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIGVsZW1lbnRzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgdGhlIG1hdHJpeCB0byBpZGVudGl0eQogICAgICogQHRvZG8gU2hvdWxkIHBlcmhhcHMgYmUgcmVuYW1lZCB0byBgc2V0SWRlbnRpdHkoKWAgdG8gYmUgbW9yZSBjbGVhci4KICAgICAqIEB0b2RvIENyZWF0ZSBhbm90aGVyIGZ1bmN0aW9uIHRoYXQgaW1tZWRpYXRlbHkgY3JlYXRlcyBhbiBpZGVudGl0eSBtYXRyaXggZWcuIGBleWUoKWAKICAgICAqLwoKCiAgICBpZGVudGl0eSgpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSAxOwogICAgICBlWzFdID0gMDsKICAgICAgZVsyXSA9IDA7CiAgICAgIGVbM10gPSAwOwogICAgICBlWzRdID0gMTsKICAgICAgZVs1XSA9IDA7CiAgICAgIGVbNl0gPSAwOwogICAgICBlWzddID0gMDsKICAgICAgZVs4XSA9IDE7CiAgICB9CiAgICAvKioKICAgICAqIFNldCBhbGwgZWxlbWVudHMgdG8gemVybwogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMDsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDA7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMgZnJvbSBhIFZlYzMKICAgICAqLwoKCiAgICBzZXRUcmFjZSh2ZWN0b3IpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSB2ZWN0b3IueDsKICAgICAgZVs0XSA9IHZlY3Rvci55OwogICAgICBlWzhdID0gdmVjdG9yLno7CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgdGhlIG1hdHJpeCBkaWFnb25hbCBlbGVtZW50cwogICAgICovCgoKICAgIGdldFRyYWNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGFyZ2V0LnggPSBlWzBdOwogICAgICB0YXJnZXQueSA9IGVbNF07CiAgICAgIHRhcmdldC56ID0gZVs4XTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LVZlY3RvciBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIHYgVGhlIHZlY3RvciB0byBtdWx0aXBseSB3aXRoCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLCB0YXJnZXQgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgTWF0MygpOwogICAgICB9CgogICAgICBjb25zdCBBID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgQiA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgVCA9IHRhcmdldC5lbGVtZW50czsKICAgICAgY29uc3QgYTExID0gQVswXSwKICAgICAgICAgICAgYTEyID0gQVsxXSwKICAgICAgICAgICAgYTEzID0gQVsyXSwKICAgICAgICAgICAgYTIxID0gQVszXSwKICAgICAgICAgICAgYTIyID0gQVs0XSwKICAgICAgICAgICAgYTIzID0gQVs1XSwKICAgICAgICAgICAgYTMxID0gQVs2XSwKICAgICAgICAgICAgYTMyID0gQVs3XSwKICAgICAgICAgICAgYTMzID0gQVs4XTsKICAgICAgY29uc3QgYjExID0gQlswXSwKICAgICAgICAgICAgYjEyID0gQlsxXSwKICAgICAgICAgICAgYjEzID0gQlsyXSwKICAgICAgICAgICAgYjIxID0gQlszXSwKICAgICAgICAgICAgYjIyID0gQls0XSwKICAgICAgICAgICAgYjIzID0gQls1XSwKICAgICAgICAgICAgYjMxID0gQls2XSwKICAgICAgICAgICAgYjMyID0gQls3XSwKICAgICAgICAgICAgYjMzID0gQls4XTsKICAgICAgVFswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMTsKICAgICAgVFsxXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgICAgVFsyXSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgVFszXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMTsKICAgICAgVFs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgICAgVFs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgVFs2XSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMTsKICAgICAgVFs3XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgICAgVFs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2NhbGUgZWFjaCBjb2x1bW4gb2YgdGhlIG1hdHJpeAogICAgICovCgoKICAgIHNjYWxlKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCB0ID0gdGFyZ2V0LmVsZW1lbnRzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDM7IGkrKykgewogICAgICAgIHRbMyAqIGkgKyAwXSA9IHZlY3Rvci54ICogZVszICogaSArIDBdOwogICAgICAgIHRbMyAqIGkgKyAxXSA9IHZlY3Rvci55ICogZVszICogaSArIDFdOwogICAgICAgIHRbMyAqIGkgKyAyXSA9IHZlY3Rvci56ICogZVszICogaSArIDJdOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSBBeD1iCiAgICAgKiBAcGFyYW0gYiBUaGUgcmlnaHQgaGFuZCBzaWRlCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBUYXJnZXQgdmVjdG9yIHRvIHNhdmUgaW4uCiAgICAgKiBAcmV0dXJuIFRoZSBzb2x1dGlvbiB4CiAgICAgKiBAdG9kbyBzaG91bGQgcmV1c2UgYXJyYXlzCiAgICAgKi8KCgogICAgc29sdmUoYiwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgYENvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyR7dGFyZ2V0LnRvU3RyaW5nKCl9XSwgYj1bJHtiLnRvU3RyaW5nKCl9XSwgQT1bJHt0aGlzLnRvU3RyaW5nKCl9XWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA2OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IHJldmVyc2VfZXFuczsKICAgICAgbGV0IGk7CiAgICAgIGxldCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGVxbnNbaSArIG5jICogal0gPSB0aGlzLmVsZW1lbnRzW2kgKyAzICogal07CiAgICAgICAgfQogICAgICB9CgogICAgICBlcW5zWzMgKyA2ICogMF0gPSAxOwogICAgICBlcW5zWzMgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzMgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMV0gPSAxOwogICAgICBlcW5zWzQgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMl0gPSAxOyAvLyBDb21wdXRlIHJpZ2h0IHVwcGVyIHRyaWFuZ3VsYXIgdmVyc2lvbiBvZiB0aGUgbWF0cml4IC0gR2F1c3MgZWxpbWluYXRpb24KCiAgICAgIGxldCBuID0gMzsKICAgICAgY29uc3QgayA9IG47CiAgICAgIGxldCBucDsKICAgICAgY29uc3Qga3AgPSBuYzsgLy8gbnVtIHJvd3MKCiAgICAgIGxldCBwOwoKICAgICAgZG8gewogICAgICAgIGkgPSBrIC0gbjsKCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gPT09IDApIHsKICAgICAgICAgIC8vIHRoZSBwaXZvdCBpcyBudWxsLCBzd2FwIGxpbmVzCiAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IGs7IGorKykgewogICAgICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBqXSAhPT0gMCkgewogICAgICAgICAgICAgIG5wID0ga3A7CgogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGkgKSA9IGxpbmUoIGkgKSArIGxpbmUoIGsgKQogICAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldICs9IGVxbnNbcCArIG5jICogal07CiAgICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBpXSAhPT0gMCkgewogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGsgKSA9IGxpbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaW5lKCBpICkKICAgICAgICAgICAgICBwID0ga3AgLSBucDsKICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gcCA8PSBpID8gMCA6IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IHdoaWxlICgtLW4pOyAvLyBlbGltaW5hdGUgdGhlIHVwcGVyIGxlZnQgdHJpYW5nbGUgb2YgdGhlIG1hdHJpeAoKCiAgICAgIGkgPSAyOwoKICAgICAgZG8gewogICAgICAgIGogPSBpIC0gMTsKCiAgICAgICAgZG8gewogICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gZXFuc1twICsgbmMgKiBqXSAtIGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgfSB3aGlsZSAoai0tKTsKICAgICAgfSB3aGlsZSAoLS1pKTsgLy8gb3BlcmF0aW9ucyBvbiB0aGUgZGlhZ29uYWwKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMSAvIGVxbnNbaSArIG5jICogaV07CiAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IG5jIC0gbnA7CiAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldID0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgIH0gd2hpbGUgKGktLSk7CgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gMjsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IGVxbnNbbnIgKyBqICsgbmMgKiBpXTsKCiAgICAgICAgICBpZiAoaXNOYU4ocCkgfHwgcCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgdGhyb3cgYENvdWxkIG5vdCByZXZlcnNlISBBPVske3RoaXMudG9TdHJpbmcoKX1dYDsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IE1hdDMoKTsKICAgICAgfQoKICAgICAgY29uc3QgTSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGxldCB0bXA7IC8vU2V0IGRpYWdvbmFscwoKICAgICAgVFswXSA9IE1bMF07CiAgICAgIFRbNF0gPSBNWzRdOwogICAgICBUWzhdID0gTVs4XTsKICAgICAgdG1wID0gTVsxXTsKICAgICAgVFsxXSA9IE1bM107CiAgICAgIFRbM10gPSB0bXA7CiAgICAgIHRtcCA9IE1bMl07CiAgICAgIFRbMl0gPSBNWzZdOwogICAgICBUWzZdID0gdG1wOwogICAgICB0bXAgPSBNWzVdOwogICAgICBUWzVdID0gTVs3XTsKICAgICAgVFs3XSA9IHRtcDsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgfQogIGNvbnN0IHJldmVyc2VfZXFucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCiAgLyoqCiAgICogMy1kaW1lbnNpb25hbCB2ZWN0b3IKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCB2ID0gbmV3IFZlYzMoMSwgMiwgMykKICAgKiAgICAgY29uc29sZS5sb2coJ3g9JyArIHYueCkgLy8geD0xCiAgICovCgogIGNsYXNzIFZlYzMgewogICAgY29uc3RydWN0b3IoeCwgeSwgeikgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDAuMDsKICAgICAgfQoKICAgICAgaWYgKHkgPT09IHZvaWQgMCkgewogICAgICAgIHkgPSAwLjA7CiAgICAgIH0KCiAgICAgIGlmICh6ID09PSB2b2lkIDApIHsKICAgICAgICB6ID0gMC4wOwogICAgICB9CgogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgY3Jvc3MgcHJvZHVjdAogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbi4KICAgICAqLwoKCiAgICBjcm9zcyh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB2eCA9IHZlY3Rvci54OwogICAgICBjb25zdCB2eSA9IHZlY3Rvci55OwogICAgICBjb25zdCB2eiA9IHZlY3Rvci56OwogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHkgKiB2eiAtIHogKiB2eTsKICAgICAgdGFyZ2V0LnkgPSB6ICogdnggLSB4ICogdno7CiAgICAgIHRhcmdldC56ID0geCAqIHZ5IC0geSAqIHZ4OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZlY3RvcnMnIDMgZWxlbWVudHMKICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeikgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogU2V0IGFsbCBjb21wb25lbnRzIG9mIHRoZSB2ZWN0b3IgdG8gemVyby4KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgYWRkaXRpb24KICAgICAqLwoKCiAgICB2YWRkKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICsgdGhpcy54OwogICAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKyB0aGlzLnk7CiAgICAgICAgdGFyZ2V0LnogPSB2ZWN0b3IueiArIHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55LCB0aGlzLnogKyB2ZWN0b3Iueik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIHN1YnRyYWN0aW9uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluLgogICAgICovCgoKICAgIHZzdWIodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdGhpcy54IC0gdmVjdG9yLng7CiAgICAgICAgdGFyZ2V0LnkgPSB0aGlzLnkgLSB2ZWN0b3IueTsKICAgICAgICB0YXJnZXQueiA9IHRoaXMueiAtIHZlY3Rvci56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggLSB2ZWN0b3IueCwgdGhpcy55IC0gdmVjdG9yLnksIHRoaXMueiAtIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNyb3NzIHByb2R1Y3QgbWF0cml4IGFfY3Jvc3MgZnJvbSBhIHZlY3Rvciwgc3VjaCB0aGF0IGEgeCBiID0gYV9jcm9zcyAqIGIgPSBjCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dzguY3MudW11LnNlL2t1cnNlci9UREJEMjQvVlQwNi9sZWN0dXJlcy9MZWN0dXJlNi5wZGYgVW1lw6UgVW5pdmVyc2l0eSBMZWN0dXJlfQogICAgICovCgoKICAgIGNyb3NzbWF0KCkgewogICAgICByZXR1cm4gbmV3IE1hdDMoWzAsIC10aGlzLnosIHRoaXMueSwgdGhpcy56LCAwLCAtdGhpcy54LCAtdGhpcy55LCB0aGlzLngsIDBdKTsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSB2ZWN0b3IuIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBpbiB0aGUgdmVjdG9yLgogICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgbm9ybSBvZiB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBuID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CgogICAgICBpZiAobiA+IDAuMCkgewogICAgICAgIGNvbnN0IGludk4gPSAxIC8gbjsKICAgICAgICB0aGlzLnggKj0gaW52TjsKICAgICAgICB0aGlzLnkgKj0gaW52TjsKICAgICAgICB0aGlzLnogKj0gaW52TjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB2ZXJzaW9uIG9mIHRoaXMgdmVjdG9yIHRoYXQgaXMgb2YgbGVuZ3RoIDEuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgdGhlIHVuaXQgdmVjdG9yCiAgICAgKi8KCgogICAgdW5pdCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHNjYWxhciAqIHg7CiAgICAgIHRhcmdldC55ID0gc2NhbGFyICogeTsKICAgICAgdGFyZ2V0LnogPSBzY2FsYXIgKiB6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgdmVjdG9yIHdpdGggYW4gb3RoZXIgdmVjdG9yLCBjb21wb25lbnQtd2lzZS4KICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHZlY3RvciB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bCh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICogdGhpcy54OwogICAgICB0YXJnZXQueSA9IHZlY3Rvci55ICogdGhpcy55OwogICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICogdGhpcy56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvciBhbmQgYWRkIGl0IHRvIHRoaXMgdmVjdG9yLiBTYXZlIHRoZSByZXN1bHQgaW4gInRhcmdldCIuICh0YXJnZXQgPSB0aGlzICsgdmVjdG9yICogc2NhbGFyKQogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBhZGRTY2FsZWRWZWN0b3Ioc2NhbGFyLCB2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnggPSAtdGhpcy54OwogICAgICB0YXJnZXQueSA9IC10aGlzLnk7CiAgICAgIHRhcmdldC56ID0gLXRoaXMuejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0d28gYXJ0aWZpY2lhbCB0YW5nZW50cyB0byB0aGUgdmVjdG9yCiAgICAgKiBAcGFyYW0gdDEgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBmaXJzdCB0YW5nZW50IGluCiAgICAgKiBAcGFyYW0gdDIgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBzZWNvbmQgdGFuZ2VudCBpbgogICAgICovCgoKICAgIHRhbmdlbnRzKHQxLCB0MikgewogICAgICBjb25zdCBub3JtID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChub3JtID4gMC4wKSB7CiAgICAgICAgY29uc3QgbiA9IFZlYzNfdGFuZ2VudHNfbjsKICAgICAgICBjb25zdCBpbm9ybSA9IDEgLyBub3JtOwogICAgICAgIG4uc2V0KHRoaXMueCAqIGlub3JtLCB0aGlzLnkgKiBpbm9ybSwgdGhpcy56ICogaW5vcm0pOwogICAgICAgIGNvbnN0IHJhbmRWZWMgPSBWZWMzX3RhbmdlbnRzX3JhbmRWZWM7CgogICAgICAgIGlmIChNYXRoLmFicyhuLngpIDwgMC45KSB7CiAgICAgICAgICByYW5kVmVjLnNldCgxLCAwLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByYW5kVmVjLnNldCgwLCAxLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0KCiAgICAgICAgbi5jcm9zcyh0MSwgdDIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBub3JtYWwgbGVuZ3RoIGlzIHplcm8sIG1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdDEuc2V0KDEsIDAsIDApOwogICAgICAgIHQyLnNldCgwLCAxLCAwKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhIG1vcmUgcmVhZGFibGUgZm9ybWF0CiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen1gOwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIGlmIChwcmVjaXNpb24gPT09IHZvaWQgMCkgewogICAgICAgIHByZWNpc2lvbiA9IDFlLTY7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnggLSB2ZWN0b3IueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55IC0gdmVjdG9yLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueiAtIHZlY3Rvci56KSA+IHByZWNpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGlzIGFsbW9zdCB6ZXJvCiAgICAgKi8KCgogICAgYWxtb3N0WmVybyhwcmVjaXNpb24pIHsKICAgICAgaWYgKHByZWNpc2lvbiA9PT0gdm9pZCAwKSB7CiAgICAgICAgcHJlY2lzaW9uID0gMWUtNjsKICAgICAgfQoKICAgICAgaWYgKE1hdGguYWJzKHRoaXMueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnopID4gcHJlY2lzaW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIHZlY3RvciBpcyBhbnRpLXBhcmFsbGVsIHRvIGFub3RoZXIgdmVjdG9yLgogICAgICogQHBhcmFtIHByZWNpc2lvbiBTZXQgdG8gemVybyBmb3IgZXhhY3QgY29tcGFyaXNvbnMKICAgICAqLwoKCiAgICBpc0FudGlwYXJhbGxlbFRvKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIHRoaXMubmVnYXRlKGFudGlwX25lZyk7CiAgICAgIHJldHVybiBhbnRpcF9uZWcuYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgdGhlIHZlY3RvcgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgICB9CgogIH0KICBWZWMzLlpFUk8gPSBuZXcgVmVjMygwLCAwLCAwKTsKICBWZWMzLlVOSVRfWCA9IG5ldyBWZWMzKDEsIDAsIDApOwogIFZlYzMuVU5JVF9ZID0gbmV3IFZlYzMoMCwgMSwgMCk7CiAgVmVjMy5VTklUX1ogPSBuZXcgVmVjMygwLCAwLCAxKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IFZlYzNfdGFuZ2VudHNfcmFuZFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYW50aXBfbmVnID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KICBjbGFzcyBBQUJCIHsKICAgIC8qKgogICAgICogVGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwcGVyQm91bmQgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG93ZXJCb3VuZCkgewogICAgICAgIHRoaXMubG93ZXJCb3VuZC5jb3B5KG9wdGlvbnMubG93ZXJCb3VuZCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnVwcGVyQm91bmQpIHsKICAgICAgICB0aGlzLnVwcGVyQm91bmQuY29weShvcHRpb25zLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgQUFCQiBib3VuZHMgZnJvbSBhIHNldCBvZiBwb2ludHMuCiAgICAgKiBAcGFyYW0gcG9pbnRzIEFuIGFycmF5IG9mIFZlYzMncy4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0CiAgICAgKi8KCgogICAgc2V0RnJvbVBvaW50cyhwb2ludHMsIHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBza2luU2l6ZSkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBxID0gcXVhdGVybmlvbjsgLy8gU2V0IHRvIHRoZSBmaXJzdCBwb2ludAoKICAgICAgbC5jb3B5KHBvaW50c1swXSk7CgogICAgICBpZiAocSkgewogICAgICAgIHEudm11bHQobCwgbCk7CiAgICAgIH0KCiAgICAgIHUuY29weShsKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IHAgPSBwb2ludHNbaV07CgogICAgICAgIGlmIChxKSB7CiAgICAgICAgICBxLnZtdWx0KHAsIHRtcCQxKTsKICAgICAgICAgIHAgPSB0bXAkMTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPiB1LngpIHsKICAgICAgICAgIHUueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPCBsLngpIHsKICAgICAgICAgIGwueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPCBsLnkpIHsKICAgICAgICAgIGwueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPiB1LnopIHsKICAgICAgICAgIHUueiA9IHAuejsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHAuejsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIG9mZnNldAoKCiAgICAgIGlmIChwb3NpdGlvbikgewogICAgICAgIHBvc2l0aW9uLnZhZGQobCwgbCk7CiAgICAgICAgcG9zaXRpb24udmFkZCh1LCB1KTsKICAgICAgfQoKICAgICAgaWYgKHNraW5TaXplKSB7CiAgICAgICAgbC54IC09IHNraW5TaXplOwogICAgICAgIGwueSAtPSBza2luU2l6ZTsKICAgICAgICBsLnogLT0gc2tpblNpemU7CiAgICAgICAgdS54ICs9IHNraW5TaXplOwogICAgICAgIHUueSArPSBza2luU2l6ZTsKICAgICAgICB1LnogKz0gc2tpblNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGJvdW5kcyBmcm9tIGFuIEFBQkIgdG8gdGhpcyBBQUJCCiAgICAgKiBAcGFyYW0gYWFiYiBTb3VyY2UgdG8gY29weSBmcm9tCiAgICAgKiBAcmV0dXJuIFRoZSB0aGlzIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eQogICAgICovCgoKICAgIGNvcHkoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQuY29weShhYWJiLmxvd2VyQm91bmQpOwogICAgICB0aGlzLnVwcGVyQm91bmQuY29weShhYWJiLnVwcGVyQm91bmQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgYW4gQUFCQgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEFBQkIoKS5jb3B5KHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBFeHRlbmQgdGhpcyBBQUJCIHNvIHRoYXQgaXQgY292ZXJzIHRoZSBnaXZlbiBBQUJCIHRvby4KICAgICAqLwoKCiAgICBleHRlbmQoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueCk7CiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC54KTsKICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueSwgYWFiYi5sb3dlckJvdW5kLnkpOwogICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC55LCBhYWJiLnVwcGVyQm91bmQueSk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC56ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnosIGFhYmIubG93ZXJCb3VuZC56KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnogPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueiwgYWFiYi51cHBlckJvdW5kLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgb3ZlcmxhcHMgdGhpcyBBQUJCLgogICAgICovCgoKICAgIG92ZXJsYXBzKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tfAogICAgICAvLyBsMSAgICAgICB1MQoKICAgICAgY29uc3Qgb3ZlcmxhcHNYID0gbDIueCA8PSB1MS54ICYmIHUxLnggPD0gdTIueCB8fCBsMS54IDw9IHUyLnggJiYgdTIueCA8PSB1MS54OwogICAgICBjb25zdCBvdmVybGFwc1kgPSBsMi55IDw9IHUxLnkgJiYgdTEueSA8PSB1Mi55IHx8IGwxLnkgPD0gdTIueSAmJiB1Mi55IDw9IHUxLnk7CiAgICAgIGNvbnN0IG92ZXJsYXBzWiA9IGwyLnogPD0gdTEueiAmJiB1MS56IDw9IHUyLnogfHwgbDEueiA8PSB1Mi56ICYmIHUyLnogPD0gdTEuejsKICAgICAgcmV0dXJuIG92ZXJsYXBzWCAmJiBvdmVybGFwc1kgJiYgb3ZlcmxhcHNaOwogICAgfSAvLyBNb3N0bHkgZm9yIGRlYnVnZ2luZwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIHJldHVybiAodS54IC0gbC54KSAqICh1LnkgLSBsLnkpICogKHUueiAtIGwueik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gQUFCQiBpcyBmdWxseSBjb250YWluZWQgaW4gdGhpcyBBQUJCLgogICAgICovCgoKICAgIGNvbnRhaW5zKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgICAgICAgIHUxCgogICAgICByZXR1cm4gbDEueCA8PSBsMi54ICYmIHUxLnggPj0gdTIueCAmJiBsMS55IDw9IGwyLnkgJiYgdTEueSA+PSB1Mi55ICYmIGwxLnogPD0gbDIueiAmJiB1MS56ID49IHUyLno7CiAgICB9CgogICAgZ2V0Q29ybmVycyhhLCBiLCBjLCBkLCBlLCBmLCBnLCBoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIGEuY29weShsKTsKICAgICAgYi5zZXQodS54LCBsLnksIGwueik7CiAgICAgIGMuc2V0KHUueCwgdS55LCBsLnopOwogICAgICBkLnNldChsLngsIHUueSwgdS56KTsKICAgICAgZS5zZXQodS54LCBsLnksIHUueik7CiAgICAgIGYuc2V0KGwueCwgdS55LCBsLnopOwogICAgICBnLnNldChsLngsIGwueSwgdS56KTsKICAgICAgaC5jb3B5KHUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gYW5vdGhlciBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvTG9jYWxGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb0xvY2FsKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gdGhlIGdsb2JhbCBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvV29ybGRGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb1dvcmxkKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgQUFCQiBpcyBoaXQgYnkgYSByYXkuCiAgICAgKi8KCgogICAgb3ZlcmxhcHNSYXkocmF5KSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgZnJvbQogICAgICB9ID0gcmF5OyAvLyBjb25zdCB0ID0gMAogICAgICAvLyByYXkuZGlyZWN0aW9uIGlzIHVuaXQgZGlyZWN0aW9uIHZlY3RvciBvZiByYXkKCiAgICAgIGNvbnN0IGRpckZyYWNYID0gMSAvIGRpcmVjdGlvbi54OwogICAgICBjb25zdCBkaXJGcmFjWSA9IDEgLyBkaXJlY3Rpb24ueTsKICAgICAgY29uc3QgZGlyRnJhY1ogPSAxIC8gZGlyZWN0aW9uLno7IC8vIHRoaXMubG93ZXJCb3VuZCBpcyB0aGUgY29ybmVyIG9mIEFBQkIgd2l0aCBtaW5pbWFsIGNvb3JkaW5hdGVzIC0gbGVmdCBib3R0b20sIHJ0IGlzIG1heGltYWwgY29ybmVyCgogICAgICBjb25zdCB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIGZyb20ueCkgKiBkaXJGcmFjWDsKICAgICAgY29uc3QgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQzID0gKHRoaXMubG93ZXJCb3VuZC55IC0gZnJvbS55KSAqIGRpckZyYWNZOwogICAgICBjb25zdCB0NCA9ICh0aGlzLnVwcGVyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDUgPSAodGhpcy5sb3dlckJvdW5kLnogLSBmcm9tLnopICogZGlyRnJhY1o7CiAgICAgIGNvbnN0IHQ2ID0gKHRoaXMudXBwZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOyAvLyBjb25zdCB0bWluID0gTWF0aC5tYXgoTWF0aC5tYXgoTWF0aC5taW4odDEsIHQyKSwgTWF0aC5taW4odDMsIHQ0KSkpOwogICAgICAvLyBjb25zdCB0bWF4ID0gTWF0aC5taW4oTWF0aC5taW4oTWF0aC5tYXgodDEsIHQyKSwgTWF0aC5tYXgodDMsIHQ0KSkpOwoKICAgICAgY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpLCBNYXRoLm1pbih0NSwgdDYpKTsKICAgICAgY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpLCBNYXRoLm1heCh0NSwgdDYpKTsgLy8gaWYgdG1heCA8IDAsIHJheSAobGluZSkgaXMgaW50ZXJzZWN0aW5nIEFBQkIsIGJ1dCB3aG9sZSBBQUJCIGlzIGJlaGluZyB1cwoKICAgICAgaWYgKHRtYXggPCAwKSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gaWYgdG1pbiA+IHRtYXgsIHJheSBkb2Vzbid0IGludGVyc2VjdCBBQUJCCgoKICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB9CiAgY29uc3QgdG1wJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRyYW5zZm9ybUludG9GcmFtZV9jb3JuZXJzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBDb2xsaXNpb24gIm1hdHJpeCIuCiAgICogSXQncyBhY3R1YWxseSBhIHRyaWFuZ3VsYXItc2hhcGVkIGFycmF5IG9mIHdoZXRoZXIgdHdvIGJvZGllcyBhcmUgdG91Y2hpbmcgdGhpcyBzdGVwLCBmb3IgcmVmZXJlbmNlIG5leHQgc3RlcAogICAqLwogIGNsYXNzIEFycmF5Q29sbGlzaW9uTWF0cml4IHsKICAgIC8qKgogICAgICogVGhlIG1hdHJpeCBzdG9yYWdlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3Igb2JqZWN0cyB0aGF0IGRpc3BhdGNoZXMgZXZlbnRzLgogICAqLwogIGNsYXNzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwogICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICAgIH0KCiAgICAgIGlmICghbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gIT09IHVuZGVmaW5lZCAmJiBsaXN0ZW5lcnNbdHlwZV0uaW5jbHVkZXMobGlzdGVuZXIpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgYW55IGV2ZW50IGxpc3RlbmVyIG9mIHRoZSBnaXZlbiB0eXBlIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzQW55RXZlbnRMaXN0ZW5lcih0eXBlKSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgICByZXR1cm4gbGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgogICAgICogQHJldHVybiBUaGUgc2VsZiBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4ID0gbGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogRW1pdCBhbiBldmVudC4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpc3RlbmVyQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBsaXN0ZW5lckFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgogIGNsYXNzIFF1YXRlcm5pb24gewogICAgY29uc3RydWN0b3IoeCwgeSwgeiwgdykgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh5ID09PSB2b2lkIDApIHsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgaWYgKHogPT09IHZvaWQgMCkgewogICAgICAgIHogPSAwOwogICAgICB9CgogICAgICBpZiAodyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHRoaXMudyA9IHc7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdG8gYSByZWFkYWJsZSBmb3JtYXQKICAgICAqIEByZXR1cm4gIngseSx6LHciCiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen0sJHt0aGlzLnd9YDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcykgewogICAgICBpZiAodGFyZ2V0QXhpcyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMubm9ybWFsaXplKCk7IC8vIGlmIHc+MSBhY29zIGFuZCBzcXJ0IHdpbGwgcHJvZHVjZSBlcnJvcnMsIHRoaXMgY2FudCBoYXBwZW4gaWYgcXVhdGVybmlvbiBpcyBub3JtYWxpc2VkCgogICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLmFjb3ModGhpcy53KTsKICAgICAgY29uc3QgcyA9IE1hdGguc3FydCgxIC0gdGhpcy53ICogdGhpcy53KTsgLy8gYXNzdW1pbmcgcXVhdGVybmlvbiBub3JtYWxpc2VkIHRoZW4gdyBpcyBsZXNzIHRoYW4gMSwgc28gdGVybSBhbHdheXMgcG9zaXRpdmUuCgogICAgICBpZiAocyA8IDAuMDAxKSB7CiAgICAgICAgLy8gdGVzdCB0byBhdm9pZCBkaXZpZGUgYnkgemVybywgcyBpcyBhbHdheXMgcG9zaXRpdmUgZHVlIHRvIHNxcnQKICAgICAgICAvLyBpZiBzIGNsb3NlIHRvIHplcm8gdGhlbiBkaXJlY3Rpb24gb2YgYXhpcyBub3QgaW1wb3J0YW50CiAgICAgICAgdGFyZ2V0QXhpcy54ID0gdGhpcy54OyAvLyBpZiBpdCBpcyBpbXBvcnRhbnQgdGhhdCBheGlzIGlzIG5vcm1hbGlzZWQgdGhlbiByZXBsYWNlIHdpdGggeD0xOyB5PXo9MDsKCiAgICAgICAgdGFyZ2V0QXhpcy55ID0gdGhpcy55OwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLnggLyBzOyAvLyBub3JtYWxpc2UgYXhpcwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnkgLyBzOwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMueiAvIHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0QXhpcywgYW5nbGVdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHF1YXRlcm5pb24gdmFsdWUgZ2l2ZW4gdHdvIHZlY3RvcnMuIFRoZSByZXN1bHRpbmcgcm90YXRpb24gd2lsbCBiZSB0aGUgbmVlZGVkIHJvdGF0aW9uIHRvIHJvdGF0ZSB1IHRvIHYuCiAgICAgKi8KCgogICAgc2V0RnJvbVZlY3RvcnModSwgdikgewogICAgICBpZiAodS5pc0FudGlwYXJhbGxlbFRvKHYpKSB7CiAgICAgICAgY29uc3QgdDEgPSBzZnZfdDE7CiAgICAgICAgY29uc3QgdDIgPSBzZnZfdDI7CiAgICAgICAgdS50YW5nZW50cyh0MSwgdDIpOwogICAgICAgIHRoaXMuc2V0RnJvbUF4aXNBbmdsZSh0MSwgTWF0aC5QSSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYSA9IHUuY3Jvc3Modik7CiAgICAgICAgdGhpcy54ID0gYS54OwogICAgICAgIHRoaXMueSA9IGEueTsKICAgICAgICB0aGlzLnogPSBhLno7CiAgICAgICAgdGhpcy53ID0gTWF0aC5zcXJ0KHUubGVuZ3RoKCkgKiogMiAqIHYubGVuZ3RoKCkgKiogMikgKyB1LmRvdCh2KTsKICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHF1YXRlcm5pb24gd2l0aCBhbiBvdGhlciBxdWF0ZXJuaW9uLgogICAgICovCgoKICAgIG11bHQocXVhdCwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCB3ID0gdGhpcy53OwogICAgICB0aGlzLmNvbmp1Z2F0ZSh0YXJnZXQpOwogICAgICBjb25zdCBpbm9ybTIgPSAxIC8gKHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3KTsKICAgICAgdGFyZ2V0LnggKj0gaW5vcm0yOwogICAgICB0YXJnZXQueSAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC56ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LncgKj0gaW5vcm0yOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHF1YXRlcm5pb24gY29uanVnYXRlCiAgICAgKi8KCgogICAgY29uanVnYXRlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IC10aGlzLng7CiAgICAgIHRhcmdldC55ID0gLXRoaXMueTsKICAgICAgdGFyZ2V0LnogPSAtdGhpcy56OwogICAgICB0YXJnZXQudyA9IHRoaXMudzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSBxdWF0ZXJuaW9uLiBOb3RlIHRoYXQgdGhpcyBjaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBsZXQgbCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwoKICAgICAgaWYgKGwgPT09IDApIHsKICAgICAgICB0aGlzLnggPSAwOwogICAgICAgIHRoaXMueSA9IDA7CiAgICAgICAgdGhpcy56ID0gMDsKICAgICAgICB0aGlzLncgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwgPSAxIC8gbDsKICAgICAgICB0aGlzLnggKj0gbDsKICAgICAgICB0aGlzLnkgKj0gbDsKICAgICAgICB0aGlzLnogKj0gbDsKICAgICAgICB0aGlzLncgKj0gbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEFwcHJveGltYXRpb24gb2YgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uLiBXb3JrcyBiZXN0IHdoZW4gcXVhdCBpcyBhbHJlYWR5IGFsbW9zdC1ub3JtYWxpemVkLgogICAgICogQGF1dGhvciB1bnBoYXNlZCwgaHR0cHM6Ly9naXRodWIuY29tL3VucGhhc2VkCiAgICAgKi8KCgogICAgbm9ybWFsaXplRmFzdCgpIHsKICAgICAgY29uc3QgZiA9ICgzLjAgLSAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KSkgLyAyLjA7CgogICAgICBpZiAoZiA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ICo9IGY7CiAgICAgICAgdGhpcy55ICo9IGY7CiAgICAgICAgdGhpcy56ICo9IGY7CiAgICAgICAgdGhpcy53ICo9IGY7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiBieSBhIHZlY3RvcgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIpIHsKICAgICAgaWYgKG9yZGVyID09PSB2b2lkIDApIHsKICAgICAgICBvcmRlciA9ICdZWlgnOwogICAgICB9CgogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdWxlciBvcmRlciAke29yZGVyfSBub3Qgc3VwcG9ydGVkIHlldC5gKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnkgPSBoZWFkaW5nOwogICAgICB0YXJnZXQueiA9IGF0dGl0dWRlOwogICAgICB0YXJnZXQueCA9IGJhbms7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIEV1bGVyIGFuZ2xlIHJlcHJlc2VudGF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBvcmRlciBUaGUgb3JkZXIgdG8gYXBwbHkgYW5nbGVzOiAnWFlaJyBvciAnWVhaJyBvciBhbnkgb3RoZXIgY29tYmluYXRpb24uCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLzIwNjk2LWZ1bmN0aW9uLXRvLWNvbnZlcnQtYmV0d2Vlbi1kY20tZXVsZXItYW5nbGVzLXF1YXRlcm5pb25zLWFuZC1ldWxlci12ZWN0b3JzIE1hdGhXb3Jrc30gcmVmZXJlbmNlCiAgICAgKi8KCgogICAgc2V0RnJvbUV1bGVyKHgsIHksIHosIG9yZGVyKSB7CiAgICAgIGlmIChvcmRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3JkZXIgPSAnWFlaJzsKICAgICAgfQoKICAgICAgY29uc3QgYzEgPSBNYXRoLmNvcyh4IC8gMik7CiAgICAgIGNvbnN0IGMyID0gTWF0aC5jb3MoeSAvIDIpOwogICAgICBjb25zdCBjMyA9IE1hdGguY29zKHogLyAyKTsKICAgICAgY29uc3QgczEgPSBNYXRoLnNpbih4IC8gMik7CiAgICAgIGNvbnN0IHMyID0gTWF0aC5zaW4oeSAvIDIpOwogICAgICBjb25zdCBzMyA9IE1hdGguc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWFonKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWlhZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWlgnKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWFpZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgUXVhdGVybmlvbih0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpOwogICAgfQogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHR3byBxdWF0CiAgICAgKgogICAgICogQHBhcmFtIHRvUXVhdCBzZWNvbmQgb3BlcmFuZAogICAgICogQHBhcmFtIHQgaW50ZXJwb2xhdGlvbiBhbW91bnQgYmV0d2VlbiB0aGUgc2VsZiBxdWF0ZXJuaW9uIGFuZCB0b1F1YXQKICAgICAqIEBwYXJhbSB0YXJnZXQgQSBxdWF0ZXJuaW9uIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uIElmIG5vdCBwcm92aWRlZCwgYSBuZXcgb25lIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIEByZXR1cm5zIHtRdWF0ZXJuaW9ufSBUaGUgInRhcmdldCIgb2JqZWN0CiAgICAgKi8KCgogICAgc2xlcnAodG9RdWF0LCB0LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gYW5ndWxhclZlbG9jaXR5LnggKiBhbmd1bGFyRmFjdG9yLngsCiAgICAgICAgICAgIGF5ID0gYW5ndWxhclZlbG9jaXR5LnkgKiBhbmd1bGFyRmFjdG9yLnksCiAgICAgICAgICAgIGF6ID0gYW5ndWxhclZlbG9jaXR5LnogKiBhbmd1bGFyRmFjdG9yLnosCiAgICAgICAgICAgIGJ4ID0gdGhpcy54LAogICAgICAgICAgICBieSA9IHRoaXMueSwKICAgICAgICAgICAgYnogPSB0aGlzLnosCiAgICAgICAgICAgIGJ3ID0gdGhpcy53OwogICAgICBjb25zdCBoYWxmX2R0ID0gZHQgKiAwLjU7CiAgICAgIHRhcmdldC54ICs9IGhhbGZfZHQgKiAoYXggKiBidyArIGF5ICogYnogLSBheiAqIGJ5KTsKICAgICAgdGFyZ2V0LnkgKz0gaGFsZl9kdCAqIChheSAqIGJ3ICsgYXogKiBieCAtIGF4ICogYnopOwogICAgICB0YXJnZXQueiArPSBoYWxmX2R0ICogKGF6ICogYncgKyBheCAqIGJ5IC0gYXkgKiBieCk7CiAgICAgIHRhcmdldC53ICs9IGhhbGZfZHQgKiAoLWF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBieik7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KICBjb25zdCBzZnZfdDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNmdl90MiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIFRoZSBhdmFpbGFibGUgc2hhcGUgdHlwZXMuCiAgICovCiAgY29uc3QgU0hBUEVfVFlQRVMgPSB7CiAgICAvKiogU1BIRVJFICovCiAgICBTUEhFUkU6IDEsCgogICAgLyoqIFBMQU5FICovCiAgICBQTEFORTogMiwKCiAgICAvKiogQk9YICovCiAgICBCT1g6IDQsCgogICAgLyoqIENPTVBPVU5EICovCiAgICBDT01QT1VORDogOCwKCiAgICAvKiogQ09OVkVYUE9MWUhFRFJPTiAqLwogICAgQ09OVkVYUE9MWUhFRFJPTjogMTYsCgogICAgLyoqIEhFSUdIVEZJRUxEICovCiAgICBIRUlHSFRGSUVMRDogMzIsCgogICAgLyoqIFBBUlRJQ0xFICovCiAgICBQQVJUSUNMRTogNjQsCgogICAgLyoqIENZTElOREVSICovCiAgICBDWUxJTkRFUjogMTI4LAoKICAgIC8qKiBUUklNRVNIICovCiAgICBUUklNRVNIOiAyNTYKICB9OwogIC8qKgogICAqIFNoYXBlVHlwZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBzaGFwZXMKICAgKi8KICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgdGhpcy5pZCA9IFNoYXBlLmlkQ291bnRlcisrOwogICAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGUgfHwgMDsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID8gb3B0aW9ucy5jb2xsaXNpb25SZXNwb25zZSA6IHRydWU7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgPyBvcHRpb25zLm1hdGVyaWFsIDogbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGJvdW5kaW5nIHNwaGVyZSByYWRpdXMuCiAgICAgKiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBpbiB0aGUgcHJvcGVydHkgYC5ib3VuZGluZ1NwaGVyZVJhZGl1c2AKICAgICAqLwoKCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhyb3cgYGNvbXB1dGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZvbHVtZSBvZiB0aGlzIHNoYXBlCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICB0aHJvdyBgdm9sdW1lKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGluZXJ0aWEgaW4gdGhlIGxvY2FsIGZyYW1lIGZvciB0aGlzIHNoYXBlLgogICAgICogQHNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfbW9tZW50c19vZl9pbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICB0aHJvdyBgY2FsY3VsYXRlTG9jYWxJbmVydGlhKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdCBmb3IgdGhlc2Uga2luZCBvZiBtZXRob2RzCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgdGhyb3cgYGNhbGN1bGF0ZVdvcmxkQUFCQigpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQoKICB9CiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwoKICAvKioKICAgKiBUcmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMuCiAgICovCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGdsb2JhbCBwb2ludCBpbiBsb2NhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb0xvY2FsKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgd29ybGRQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgbG9jYWwgcG9pbnQgaW4gZ2xvYmFsIHRyYW5zZm9ybSBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGQobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIHJldHVybiBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5wb3NpdGlvbiwgdGhpcy5xdWF0ZXJuaW9uLCBsb2NhbFBvaW50LCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHBvaW50VG9Mb2NhbEZyYW1lCiAgICAgKi8KCgogICAgc3RhdGljIHBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxQb2ludCwgcmVzdWx0KTsKICAgICAgcmVzdWx0LnZhZGQocG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb1dvcmxkRnJhbWUocXVhdGVybmlvbiwgbG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CiAgY29uc3QgdG1wUXVhdCQxID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwogIGNsYXNzIENvbnZleFBvbHloZWRyb24gZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogdmVydGljZXMgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggZmFjZSBjb25zaXN0cyBvZgogICAgICovCgogICAgLyoqIGZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkVmVydGljZXMgKi8KCiAgICAvKiogd29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHMgKi8KCiAgICAvKiogd29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlICovCgogICAgLyoqCiAgICAgKiBJZiBnaXZlbiwgdGhlc2UgbG9jYWxseSBkZWZpbmVkLCBub3JtYWxpemVkIGF4ZXMgYXJlIHRoZSBvbmx5IG9uZXMgYmVpbmcgY2hlY2tlZCB3aGVuIGRvaW5nIHNlcGFyYXRpbmcgYXhpcyBjaGVjay4KICAgICAqLwoKICAgIC8qKiB1bmlxdWVFZGdlcyAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIHZlcnRpY2VzIEFuIGFycmF5IG9mIFZlYzMncwogICAgICogQHBhcmFtIGZhY2VzIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBkZXNjcmliaW5nIHdoaWNoIHZlcnRpY2VzIHRoYXQgaXMgaW5jbHVkZWQgaW4gZWFjaCBmYWNlLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihwcm9wcykgewogICAgICBpZiAocHJvcHMgPT09IHZvaWQgMCkgewogICAgICAgIHByb3BzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IHsKICAgICAgICB2ZXJ0aWNlcyA9IFtdLAogICAgICAgIGZhY2VzID0gW10sCiAgICAgICAgbm9ybWFscyA9IFtdLAogICAgICAgIGF4ZXMsCiAgICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICAgICAgfSA9IHByb3BzOwogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTgogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnRleCAke3RoaXMuZmFjZXNbaV1bal19IG5vdCBmb3VuZCFgKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ldIHx8IG5ldyBWZWMzKCk7CiAgICAgICAgdGhpcy5nZXRGYWNlTm9ybWFsKGksIG4pOwogICAgICAgIG4ubmVnYXRlKG4pOwogICAgICAgIHRoaXMuZmFjZU5vcm1hbHNbaV0gPSBuOwogICAgICAgIGNvbnN0IHZlcnRleCA9IHRoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVswXV07CgogICAgICAgIGlmIChuLmRvdCh2ZXJ0ZXgpIDwgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcihgLmZhY2VOb3JtYWxzWyR7aX1dID0gVmVjMygke24udG9TdHJpbmcoKX0pIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuYCk7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybihgLnZlcnRpY2VzWyR7dGhpcy5mYWNlc1tpXVtqXX1dID0gVmVjMygke3RoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVtqXV0udG9TdHJpbmcoKX0pYCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIG5vcm1hbCBvZiBhIGZhY2UgZnJvbSBpdHMgdmVydGljZXMKICAgICAqLwoKCiAgICBnZXRGYWNlTm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tpXTsKICAgICAgY29uc3QgdmEgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCB2YiA9IHRoaXMudmVydGljZXNbZlsxXV07CiAgICAgIGNvbnN0IHZjID0gdGhpcy52ZXJ0aWNlc1tmWzJdXTsKICAgICAgQ29udmV4UG9seWhlZHJvbi5jb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWIgPSBuZXcgVmVjMygpOwogICAgICB2Yi52c3ViKHZhLCBhYik7CiAgICAgIHZjLnZzdWIodmIsIGNiKTsKICAgICAgY2IuY3Jvc3MoYWIsIHRhcmdldCk7CgogICAgICBpZiAoIXRhcmdldC5pc1plcm8oKSkgewogICAgICAgIHRhcmdldC5ub3JtYWxpemUoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAcGFyYW0gbWluRGlzdCBDbGFtcCBkaXN0YW5jZQogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgYW4gYXJyYXkgb2YgY29udGFjdCBwb2ludCBvYmplY3RzLCBzZWUgY2xpcEZhY2VBZ2FpbnN0SHVsbAogICAgICovCgoKICAgIGNsaXBBZ2FpbnN0SHVsbChwb3NBLCBxdWF0QSwgaHVsbEIsIHBvc0IsIHF1YXRCLCBzZXBhcmF0aW5nTm9ybWFsLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgV29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBsZXQgY2xvc2VzdEZhY2VCID0gLTE7CiAgICAgIGxldCBkbWF4ID0gLU51bWJlci5NQVhfVkFMVUU7CgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxCLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgV29ybGROb3JtYWwuY29weShodWxsQi5mYWNlTm9ybWFsc1tmYWNlXSk7CiAgICAgICAgcXVhdEIudm11bHQoV29ybGROb3JtYWwsIFdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCBkID0gV29ybGROb3JtYWwuZG90KHNlcGFyYXRpbmdOb3JtYWwpOwoKICAgICAgICBpZiAoZCA+IGRtYXgpIHsKICAgICAgICAgIGRtYXggPSBkOwogICAgICAgICAgY2xvc2VzdEZhY2VCID0gZmFjZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkVmVydHNCMSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGh1bGxCLnZlcnRpY2VzW2h1bGxCLmZhY2VzW2Nsb3Nlc3RGYWNlQl1baV1dOwogICAgICAgIGNvbnN0IHdvcmxkYiA9IG5ldyBWZWMzKCk7CiAgICAgICAgd29ybGRiLmNvcHkoYik7CiAgICAgICAgcXVhdEIudm11bHQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHBvc0IudmFkZCh3b3JsZGIsIHdvcmxkYik7CiAgICAgICAgd29ybGRWZXJ0c0IxLnB1c2god29ybGRiKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQiA+PSAwKSB7CiAgICAgICAgdGhpcy5jbGlwRmFjZUFnYWluc3RIdWxsKHNlcGFyYXRpbmdOb3JtYWwsIHBvc0EsIHF1YXRBLCB3b3JsZFZlcnRzQjEsIG1pbkRpc3QsIG1heERpc3QsIHJlc3VsdCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRmluZCB0aGUgc2VwYXJhdGluZyBheGlzIGJldHdlZW4gdGhpcyBodWxsIGFuZCBhbm90aGVyCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdmVjdG9yIHRvIHNhdmUgdGhlIGF4aXMgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyBmYWxzZSBpZiBhIHNlcGFyYXRpb24gaXMgZm91bmQsIGVsc2UgdHJ1ZQogICAgICovCgoKICAgIGZpbmRTZXBhcmF0aW5nQXhpcyhodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCLCB0YXJnZXQsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MzID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRub3JtYWwxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGVsdGFDID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBDcm9zcyA9IG5ldyBWZWMzKCk7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwoKICAgICAgaWYgKCFodWxsQS51bmlxdWVBeGVzKSB7CiAgICAgICAgY29uc3QgbnVtRmFjZXNBID0gZmFjZUxpc3RBID8gZmFjZUxpc3RBLmxlbmd0aCA6IGh1bGxBLmZhY2VzLmxlbmd0aDsgLy8gVGVzdCBmYWNlIG5vcm1hbHMgZnJvbSBodWxsQQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QVtpXSA6IGk7IC8vIEdldCB3b3JsZCBmYWNlIG5vcm1hbAoKICAgICAgICAgIGZhY2VBTm9ybWFsV1MzLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MzLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEEudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGF4aXMKICAgICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUF4ZXNbaV0sIGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhmYWNlQU5vcm1hbFdTMywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaHVsbEIudW5pcXVlQXhlcykgewogICAgICAgIC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEIKICAgICAgICBjb25zdCBudW1GYWNlc0IgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEIubGVuZ3RoIDogaHVsbEIuZmFjZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QiA/IGZhY2VMaXN0QltpXSA6IGk7CiAgICAgICAgICBXb3JsZG5vcm1hbDEuY29weShodWxsQi5mYWNlTm9ybWFsc1tmaV0pOwogICAgICAgICAgcXVhdEIudm11bHQoV29ybGRub3JtYWwxLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMgaW4gQgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBodWxsQi51bmlxdWVBeGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBxdWF0Qi52bXVsdChodWxsQi51bmlxdWVBeGVzW2ldLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRlc3QgZWRnZXMKCgogICAgICBmb3IgKGxldCBlMCA9IDA7IGUwICE9PSBodWxsQS51bmlxdWVFZGdlcy5sZW5ndGg7IGUwKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgZWRnZQogICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUVkZ2VzW2UwXSwgd29ybGRFZGdlMCk7CgogICAgICAgIGZvciAobGV0IGUxID0gMDsgZTEgIT09IGh1bGxCLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgZTErKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UgMgogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlRWRnZXNbZTFdLCB3b3JsZEVkZ2UxKTsKICAgICAgICAgIHdvcmxkRWRnZTAuY3Jvc3Mod29ybGRFZGdlMSwgQ3Jvc3MpOwoKICAgICAgICAgIGlmICghQ3Jvc3MuYWxtb3N0WmVybygpKSB7CiAgICAgICAgICAgIENyb3NzLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBkaXN0ID0gaHVsbEEudGVzdFNlcEF4aXMoQ3Jvc3MsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgICAgaWYgKGRpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGlzdCA8IGRtaW4pIHsKICAgICAgICAgICAgICBkbWluID0gZGlzdDsKICAgICAgICAgICAgICB0YXJnZXQuY29weShDcm9zcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHBvc0IudnN1Yihwb3NBLCBkZWx0YUMpOwoKICAgICAgaWYgKGRlbHRhQy5kb3QodGFyZ2V0KSA+IDAuMCkgewogICAgICAgIHRhcmdldC5uZWdhdGUodGFyZ2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFRlc3Qgc2VwYXJhdGluZyBheGlzIGFnYWluc3QgdHdvIGh1bGxzLiBCb3RoIGh1bGxzIGFyZSBwcm9qZWN0ZWQgb250byB0aGUgYXhpcyBhbmQgdGhlIG92ZXJsYXAgc2l6ZSBpcyByZXR1cm5lZCBpZiB0aGVyZSBpcyBvbmUuCiAgICAgKiBAcmV0dXJuIFRoZSBvdmVybGFwIGRlcHRoLCBvciBGQUxTRSBpZiBubyBwZW5ldHJhdGlvbi4KICAgICAqLwoKCiAgICB0ZXN0U2VwQXhpcyhheGlzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKSB7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgQ29udmV4UG9seWhlZHJvbi5wcm9qZWN0KGh1bGxBLCBheGlzLCBwb3NBLCBxdWF0QSwgbWF4bWluQSk7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQiwgYXhpcywgcG9zQiwgcXVhdEIsIG1heG1pbkIpOwogICAgICBjb25zdCBtYXhBID0gbWF4bWluQVswXTsKICAgICAgY29uc3QgbWluQSA9IG1heG1pbkFbMV07CiAgICAgIGNvbnN0IG1heEIgPSBtYXhtaW5CWzBdOwogICAgICBjb25zdCBtaW5CID0gbWF4bWluQlsxXTsKCiAgICAgIGlmIChtYXhBIDwgbWluQiB8fCBtYXhCIDwgbWluQSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2VwYXJhdGVkCiAgICAgIH0KCiAgICAgIGNvbnN0IGQwID0gbWF4QSAtIG1pbkI7CiAgICAgIGNvbnN0IGQxID0gbWF4QiAtIG1pbkE7CiAgICAgIGNvbnN0IGRlcHRoID0gZDAgPCBkMSA/IGQwIDogZDE7CiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICBjb25zdCBhYWJibWF4ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWFiYm1pbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29tcHV0ZUxvY2FsQUFCQihhYWJibWluLCBhYWJibWF4KTsKICAgICAgY29uc3QgeCA9IGFhYmJtYXgueCAtIGFhYmJtaW4ueDsKICAgICAgY29uc3QgeSA9IGFhYmJtYXgueSAtIGFhYmJtaW4ueTsKICAgICAgY29uc3QgeiA9IGFhYmJtYXgueiAtIGFhYmJtaW4uejsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeik7CiAgICAgIHRhcmdldC55ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHggKiAyICogeCArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueiA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB5ICogMiAqIHkgKyAyICogeCAqIDIgKiB4KTsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIGZhY2VfaSBJbmRleCBvZiB0aGUgZmFjZQogICAgICovCgoKICAgIGdldFBsYW5lQ29uc3RhbnRPZkZhY2UoZmFjZV9pKSB7CiAgICAgIGNvbnN0IGYgPSB0aGlzLmZhY2VzW2ZhY2VfaV07CiAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ZhY2VfaV07CiAgICAgIGNvbnN0IHYgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCBjID0gLW4uZG90KHYpOwogICAgICByZXR1cm4gYzsKICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgYWdhaW5zdCBhIGh1bGwuCiAgICAgKiBAcGFyYW0gd29ybGRWZXJ0c0IxIEFuIGFycmF5IG9mIFZlYzMgd2l0aCB2ZXJ0aWNlcyBpbiB0aGUgd29ybGQgZnJhbWUuCiAgICAgKiBAcGFyYW0gbWluRGlzdCBEaXN0YW5jZSBjbGFtcGluZwogICAgICogQHBhcmFtIEFycmF5IHJlc3VsdCBBcnJheSB0byBzdG9yZSByZXN1bHRpbmcgY29udGFjdCBwb2ludHMgaW4uIFdpbGwgYmUgb2JqZWN0cyB3aXRoIHByb3BlcnRpZXM6IHBvaW50LCBkZXB0aCwgbm9ybWFsLiBUaGVzZSBhcmUgcmVwcmVzZW50ZWQgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgZmFjZUFOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGVkZ2UwID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkUGxhbmVBbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHBsYW5lTm9ybWFsV1MxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRBMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwogICAgICBjb25zdCB3b3JsZFZlcnRzQjIgPSBbXTsKICAgICAgY29uc3QgcFZ0eEluID0gd29ybGRWZXJ0c0IxOwogICAgICBjb25zdCBwVnR4T3V0ID0gd29ybGRWZXJ0c0IyOwogICAgICBsZXQgY2xvc2VzdEZhY2VBID0gLTE7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsgLy8gRmluZCB0aGUgZmFjZSB3aXRoIG5vcm1hbCBjbG9zZXN0IHRvIHRoZSBzZXBhcmF0aW5nIGF4aXMKCiAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgaHVsbEEuZmFjZXMubGVuZ3RoOyBmYWNlKyspIHsKICAgICAgICBmYWNlQU5vcm1hbFdTLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MsIGZhY2VBTm9ybWFsV1MpOwogICAgICAgIGNvbnN0IGQgPSBmYWNlQU5vcm1hbFdTLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQSA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2xvc2VzdEZhY2VBIDwgMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBHZXQgdGhlIGZhY2UgYW5kIGNvbnN0cnVjdCBjb25uZWN0ZWQgZmFjZXMKCgogICAgICBjb25zdCBwb2x5QSA9IGh1bGxBLmZhY2VzW2Nsb3Nlc3RGYWNlQV07CiAgICAgIHBvbHlBLmNvbm5lY3RlZEZhY2VzID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBodWxsQS5mYWNlc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgLyogU2hhcmluZyBhIHZlcnRleCovCiAgICAgICAgICBwb2x5QS5pbmRleE9mKGh1bGxBLmZhY2VzW2ldW2pdKSAhPT0gLTEgJiYKICAgICAgICAgIC8qIE5vdCB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvciBjb25uZWN0aW9ucyBmcm9tICovCiAgICAgICAgICBpICE9PSBjbG9zZXN0RmFjZUEgJiYKICAgICAgICAgIC8qIE5vdCBhbHJlYWR5IGFkZGVkICovCiAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5pbmRleE9mKGkpID09PSAtMSkgewogICAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5wdXNoKGkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDbGlwIHRoZSBwb2x5Z29uIHRvIHRoZSBiYWNrIG9mIHRoZSBwbGFuZXMgb2YgYWxsIGZhY2VzIG9mIGh1bGwgQSwKICAgICAgLy8gdGhhdCBhcmUgYWRqYWNlbnQgdG8gdGhlIHdpdG5lc3MgZmFjZQoKCiAgICAgIGNvbnN0IG51bVZlcnRpY2VzQSA9IHBvbHlBLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXNBOyBpKyspIHsKICAgICAgICBjb25zdCBhID0gaHVsbEEudmVydGljZXNbcG9seUFbaV1dOwogICAgICAgIGNvbnN0IGIgPSBodWxsQS52ZXJ0aWNlc1twb2x5QVsoaSArIDEpICUgbnVtVmVydGljZXNBXV07CiAgICAgICAgYS52c3ViKGIsIGVkZ2UwKTsKICAgICAgICBXb3JsZEVkZ2UwLmNvcHkoZWRnZTApOwogICAgICAgIHF1YXRBLnZtdWx0KFdvcmxkRWRnZTAsIFdvcmxkRWRnZTApOwogICAgICAgIHBvc0EudmFkZChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICB3b3JsZFBsYW5lQW5vcm1hbDEuY29weSh0aGlzLmZhY2VOb3JtYWxzW2Nsb3Nlc3RGYWNlQV0pOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBwb3NBLnZhZGQod29ybGRQbGFuZUFub3JtYWwxLCB3b3JsZFBsYW5lQW5vcm1hbDEpOwogICAgICAgIFdvcmxkRWRnZTAuY3Jvc3Mod29ybGRQbGFuZUFub3JtYWwxLCBwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgcGxhbmVOb3JtYWxXUzEubmVnYXRlKHBsYW5lTm9ybWFsV1MxKTsKICAgICAgICB3b3JsZEExLmNvcHkoYSk7CiAgICAgICAgcXVhdEEudm11bHQod29ybGRBMSwgd29ybGRBMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIGNvbnN0IG90aGVyRmFjZSA9IHBvbHlBLmNvbm5lY3RlZEZhY2VzW2ldOwogICAgICAgIGxvY2FsUGxhbmVOb3JtYWwuY29weSh0aGlzLmZhY2VOb3JtYWxzW290aGVyRmFjZV0pOwogICAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShvdGhlckZhY2UpOwogICAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgICBxdWF0QS52bXVsdChwbGFuZU5vcm1hbFdTLCBwbGFuZU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsgLy8gQ2xpcCBmYWNlIGFnYWluc3Qgb3VyIGNvbnN0cnVjdGVkIHBsYW5lCgogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0UGxhbmUocFZ0eEluLCBwVnR4T3V0LCBwbGFuZU5vcm1hbFdTLCBwbGFuZUVxV1MpOyAvLyBUaHJvdyBhd2F5IGFsbCBjbGlwcGVkIHBvaW50cywgYnV0IHNhdmUgdGhlIHJlbWFpbmluZyB1bnRpbCBuZXh0IGNsaXAKCiAgICAgICAgd2hpbGUgKHBWdHhJbi5sZW5ndGgpIHsKICAgICAgICAgIHBWdHhJbi5zaGlmdCgpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHBWdHhPdXQubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4ucHVzaChwVnR4T3V0LnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgfSAvLyBvbmx5IGtlZXAgY29udGFjdCBwb2ludHMgdGhhdCBhcmUgYmVoaW5kIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgY29uc3QgbG9jYWxQbGFuZUVxID0gdGhpcy5nZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGNsb3Nlc3RGYWNlQSk7CiAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgIGNvbnN0IHBsYW5lRXFXUyA9IGxvY2FsUGxhbmVFcSAtIHBsYW5lTm9ybWFsV1MuZG90KHBvc0EpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVnR4SW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZGVwdGggPSBwbGFuZU5vcm1hbFdTLmRvdChwVnR4SW5baV0pICsgcGxhbmVFcVdTOyAvLyA/Pz8KCiAgICAgICAgaWYgKGRlcHRoIDw9IG1pbkRpc3QpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBjbGFtcGVkOiBkZXB0aD0ke2RlcHRofSB0byBtaW5EaXN0PSR7bWluRGlzdH1gKTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0YXJnZXQudmFkZCh2ZXJ0c1tpXSwgdGFyZ2V0KTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnNjYWxlKDEgLyB2ZXJ0cy5sZW5ndGgsIHRhcmdldCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZm9ybSBhbGwgbG9jYWwgcG9pbnRzLiBXaWxsIGNoYW5nZSB0aGUgLnZlcnRpY2VzCiAgICAgKi8KCgogICAgdHJhbnNmb3JtQWxsUG9pbnRzKG9mZnNldCwgcXVhdCkgewogICAgICBjb25zdCBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsgLy8gQXBwbHkgcm90YXRpb24KCiAgICAgIGlmIChxdWF0KSB7CiAgICAgICAgLy8gUm90YXRlIHZlcnRpY2VzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfSAvLyBSb3RhdGUgZmFjZSBub3JtYWxzCgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmZhY2VOb3JtYWxzW2ldOwogICAgICAgICAgcXVhdC52bXVsdCh2LCB2KTsKICAgICAgICB9CiAgICAgICAgLyoKICAgICAgICAgICAgICAvLyBSb3RhdGUgZWRnZXMKICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudW5pcXVlRWRnZXNbaV07CiAgICAgICAgICAgICAgICAgIHF1YXQudm11bHQodix2KTsKICAgICAgICAgICAgICB9Ki8KCiAgICAgIH0gLy8gQXBwbHkgb2Zmc2V0CgoKICAgICAgaWYgKG9mZnNldCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICB2LnZhZGQob2Zmc2V0LCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgcCBpcyBpbnNpZGUgdGhlIHBvbHloZWRyYS4gTXVzdCBiZSBpbiBsb2NhbCBjb29yZHMuCiAgICAgKiBUaGUgcG9pbnQgbGllcyBvdXRzaWRlIG9mIHRoZSBjb252ZXggaHVsbCBvZiB0aGUgb3RoZXIgcG9pbnRzIGlmIGFuZCBvbmx5IGlmIHRoZSBkaXJlY3Rpb24KICAgICAqIG9mIGFsbCB0aGUgdmVjdG9ycyBmcm9tIGl0IHRvIHRob3NlIG90aGVyIHBvaW50cyBhcmUgb24gbGVzcyB0aGFuIG9uZSBoYWxmIG9mIGEgc3BoZXJlIGFyb3VuZCBpdC4KICAgICAqIEBwYXJhbSBwIEEgcG9pbnQgZ2l2ZW4gaW4gbG9jYWwgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBwb2ludElzSW5zaWRlKHApIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCBmYWNlcyA9IHRoaXMuZmFjZXM7CiAgICAgIGNvbnN0IG5vcm1hbHMgPSB0aGlzLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBwb3NpdGl2ZVJlc3VsdCA9IG51bGw7CiAgICAgIGNvbnN0IHBvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5nZXRBdmVyYWdlUG9pbnRMb2NhbChwb2ludEluc2lkZSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ZhY2VzW2ldWzBdXTsgLy8gV2Ugb25seSBuZWVkIG9uZSBwb2ludCBpbiB0aGUgZmFjZQogICAgICAgIC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgICBjb25zdCB2VG9QID0gbmV3IFZlYzMoKTsKICAgICAgICBwLnZzdWIodiwgdlRvUCk7CiAgICAgICAgY29uc3QgcjEgPSBuLmRvdCh2VG9QKTsKICAgICAgICBjb25zdCB2VG9Qb2ludEluc2lkZSA9IG5ldyBWZWMzKCk7CiAgICAgICAgcG9pbnRJbnNpZGUudnN1Yih2LCB2VG9Qb2ludEluc2lkZSk7CiAgICAgICAgY29uc3QgcjIgPSBuLmRvdCh2VG9Qb2ludEluc2lkZSk7CgogICAgICAgIGlmIChyMSA8IDAgJiYgcjIgPiAwIHx8IHIxID4gMCAmJiByMiA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gRW5jb3VudGVyZWQgc29tZSBvdGhlciBzaWduLiBFeGl0LgogICAgICAgIH0KICAgICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgICAgcmV0dXJuIHBvc2l0aXZlUmVzdWx0ID8gMSA6IC0xOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbWF4IGFuZCBtaW4gZG90IHByb2R1Y3Qgb2YgYSBjb252ZXggaHVsbCBhdCBwb3NpdGlvbiAocG9zLHF1YXQpIHByb2plY3RlZCBvbnRvIGFuIGF4aXMuCiAgICAgKiBSZXN1bHRzIGFyZSBzYXZlZCBpbiB0aGUgYXJyYXkgbWF4bWluLgogICAgICogQHBhcmFtIHJlc3VsdCByZXN1bHRbMF0gYW5kIHJlc3VsdFsxXSB3aWxsIGJlIHNldCB0byBtYXhpbXVtIGFuZCBtaW5pbXVtLCByZXNwZWN0aXZlbHkuCiAgICAgKi8KCgogICAgc3RhdGljIHByb2plY3Qoc2hhcGUsIGF4aXMsIHBvcywgcXVhdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IG4gPSBzaGFwZS52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IGxvY2FsQXhpcyA9IHByb2plY3RfbG9jYWxBeGlzOwogICAgICBsZXQgbWF4ID0gMDsKICAgICAgbGV0IG1pbiA9IDA7CiAgICAgIGNvbnN0IGxvY2FsT3JpZ2luID0gcHJvamVjdF9sb2NhbE9yaWdpbjsKICAgICAgY29uc3QgdnMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgbG9jYWxPcmlnaW4uc2V0WmVybygpOyAvLyBUcmFuc2Zvcm0gdGhlIGF4aXMgdG8gbG9jYWwKCiAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBheGlzLCBsb2NhbEF4aXMpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBsb2NhbE9yaWdpbiwgbG9jYWxPcmlnaW4pOwogICAgICBjb25zdCBhZGQgPSBsb2NhbE9yaWdpbi5kb3QobG9jYWxBeGlzKTsKICAgICAgbWluID0gbWF4ID0gdnNbMF0uZG90KGxvY2FsQXhpcyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIGNvbnN0IHZhbCA9IHZzW2ldLmRvdChsb2NhbEF4aXMpOwoKICAgICAgICBpZiAodmFsID4gbWF4KSB7CiAgICAgICAgICBtYXggPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsIDwgbWluKSB7CiAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICB9CgogICAgICBtaW4gLT0gYWRkOwogICAgICBtYXggLT0gYWRkOwoKICAgICAgaWYgKG1pbiA+IG1heCkgewogICAgICAgIC8vIEluY29uc2lzdGVudCAtIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gbWluOwogICAgICAgIG1pbiA9IG1heDsKICAgICAgICBtYXggPSB0ZW1wOwogICAgICB9IC8vIE91dHB1dAoKCiAgICAgIHJlc3VsdFswXSA9IG1heDsKICAgICAgcmVzdWx0WzFdID0gbWluOwogICAgfQoKICB9CiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHByb2plY3RfbG9jYWxBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBwcm9qZWN0X2xvY2FsT3JpZ2luID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCiAgY2xhc3MgQm94IGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBUaGUgaGFsZiBleHRlbnRzIG9mIHRoZSBib3guCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgYnkgdGhlIGNvbnRhY3QgZ2VuZXJhdG9yIHRvIG1ha2UgY29udGFjdHMgd2l0aCBvdGhlciBjb252ZXggcG9seWhlZHJhIGZvciBleGFtcGxlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihoYWxmRXh0ZW50cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQk9YCiAgICAgIH0pOwogICAgICB0aGlzLmhhbGZFeHRlbnRzID0gaGFsZkV4dGVudHM7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gbnVsbDsKICAgICAgdGhpcy51cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBsb2NhbCBjb252ZXggcG9seWhlZHJvbiByZXByZXNlbnRhdGlvbiB1c2VkIGZvciBzb21lIGNvbGxpc2lvbnMuCiAgICAgKi8KCgogICAgdXBkYXRlQ29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uKCkgewogICAgICBjb25zdCBzeCA9IHRoaXMuaGFsZkV4dGVudHMueDsKICAgICAgY29uc3Qgc3kgPSB0aGlzLmhhbGZFeHRlbnRzLnk7CiAgICAgIGNvbnN0IHN6ID0gdGhpcy5oYWxmRXh0ZW50cy56OwogICAgICBjb25zdCBWID0gVmVjMzsKICAgICAgY29uc3QgdmVydGljZXMgPSBbbmV3IFYoLXN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCAtc3ksIHN6KSwgbmV3IFYoc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgc3ksIHN6KSwgbmV3IFYoLXN4LCBzeSwgc3opXTsKICAgICAgY29uc3QgZmFjZXMgPSBbWzMsIDIsIDEsIDBdLCAvLyAtegogICAgICBbNCwgNSwgNiwgN10sIC8vICt6CiAgICAgIFs1LCA0LCAwLCAxXSwgLy8gLXkKICAgICAgWzIsIDMsIDcsIDZdLCAvLyAreQogICAgICBbMCwgNCwgNywgM10sIC8vIC14CiAgICAgIFsxLCAyLCA2LCA1XSAvLyAreAogICAgICBdOwogICAgICBjb25zdCBheGVzID0gW25ldyBWKDAsIDAsIDEpLCBuZXcgVigwLCAxLCAwKSwgbmV3IFYoMSwgMCwgMCldOwogICAgICBjb25zdCBoID0gbmV3IENvbnZleFBvbHloZWRyb24oewogICAgICAgIHZlcnRpY2VzLAogICAgICAgIGZhY2VzLAogICAgICAgIGF4ZXMKICAgICAgfSk7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gaDsKICAgICAgaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0aGUgaW5lcnRpYSBvZiB0aGUgYm94LgogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CiAgY29uc3Qgd29ybGRDb3JuZXJUZW1wUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCB3b3JsZENvcm5lcnNUZW1wID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCiAgY29uc3QgQk9EWV9UWVBFUyA9IHsKICAgIC8qKiBEWU5BTUlDICovCiAgICBEWU5BTUlDOiAxLAoKICAgIC8qKiBTVEFUSUMgKi8KICAgIFNUQVRJQzogMiwKCiAgICAvKiogS0lORU1BVElDICovCiAgICBLSU5FTUFUSUM6IDQKICB9OwogIC8qKgogICAqIEJvZHlUeXBlCiAgICovCgogIC8qKgogICAqIEJPRFlfU0xFRVBfU1RBVEVTCiAgICovCiAgY29uc3QgQk9EWV9TTEVFUF9TVEFURVMgPSB7CiAgICAvKiogQVdBS0UgKi8KICAgIEFXQUtFOiAwLAoKICAgIC8qKiBTTEVFUFkgKi8KICAgIFNMRUVQWTogMSwKCiAgICAvKiogU0xFRVBJTkcgKi8KICAgIFNMRUVQSU5HOiAyCiAgfTsKICAvKioKICAgKiBCb2R5U2xlZXBTdGF0ZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBhbGwgYm9keSB0eXBlcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBzaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKDEpCiAgICogICAgIGNvbnN0IGJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoewogICAqICAgICAgIG1hc3M6IDEsCiAgICogICAgICAgc2hhcGUsCiAgICogICAgIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keSkKICAgKi8KICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pZCA9IEJvZHkuaWRDb3VudGVyKys7CiAgICAgIHRoaXMuaW5kZXggPSAtMTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcmVzdWx0KTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIHdvcmxkIHZlY3RvciB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHZlY3RvclRvTG9jYWxGcmFtZSh3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIGxvY2FsIGJvZHkgcG9pbnQgdG8gd29ybGQgZnJhbWUuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBib2R5IHdpdGggYSBsb2NhbCBvZmZzZXQgYW5kIG9yaWVudGF0aW9uLgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgYWRkU2hhcGUoc2hhcGUsIF9vZmZzZXQsIF9vcmllbnRhdGlvbikgewogICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CgogICAgICBpZiAoX29mZnNldCkgewogICAgICAgIG9mZnNldC5jb3B5KF9vZmZzZXQpOwogICAgICB9CgogICAgICBpZiAoX29yaWVudGF0aW9uKSB7CiAgICAgICAgb3JpZW50YXRpb24uY29weShfb3JpZW50YXRpb24pOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5wdXNoKHNoYXBlKTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnB1c2gob3JpZW50YXRpb24pOwogICAgICB0aGlzLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdSYWRpdXMoKTsKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBzaGFwZS5ib2R5ID0gdGhpczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIGJvZHkuCiAgICAgKiBAcmV0dXJuIFRoZSBib2R5IG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICByZW1vdmVTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2hhcGVzLmluZGV4T2Yoc2hhcGUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnNvbGUud2FybignU2hhcGUgZG9lcyBub3QgYmVsb25nIHRvIHRoZSBib2R5Jyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hhcGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPcmllbnRhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IG51bGw7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGJvdW5kaW5nIHJhZGl1cyBvZiB0aGUgYm9keS4gU2hvdWxkIGJlIGRvbmUgaWYgYW55IG9mIHRoZSBzaGFwZXMgYXJlIGNoYW5nZWQuCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdSYWRpdXMoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGxldCByYWRpdXMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICAgIHNoYXBlLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2hhcGVPZmZzZXRzW2ldLmxlbmd0aCgpOwogICAgICAgIGNvbnN0IHIgPSBzaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1czsKCiAgICAgICAgaWYgKG9mZnNldCArIHIgPiByYWRpdXMpIHsKICAgICAgICAgIHJhZGl1cyA9IG9mZnNldCArIHI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gcmFkaXVzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSAuYWFiYgogICAgICovCgoKICAgIHVwZGF0ZUFBQkIoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3Qgc2hhcGVPcmllbnRhdGlvbnMgPSB0aGlzLnNoYXBlT3JpZW50YXRpb25zOwogICAgICBjb25zdCBOID0gc2hhcGVzLmxlbmd0aDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gdG1wVmVjOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRtcFF1YXQ7CiAgICAgIGNvbnN0IGJvZHlRdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBhYWJiID0gdGhpcy5hYWJiOwogICAgICBjb25zdCBzaGFwZUFBQkIgPSB1cGRhdGVBQUJCX3NoYXBlQUFCQjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsgLy8gR2V0IHNoYXBlIHdvcmxkIHBvc2l0aW9uCgogICAgICAgIGJvZHlRdWF0LnZtdWx0KHNoYXBlT2Zmc2V0c1tpXSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQudmFkZCh0aGlzLnBvc2l0aW9uLCBvZmZzZXQpOyAvLyBHZXQgc2hhcGUgd29ybGQgcXVhdGVybmlvbgoKICAgICAgICBib2R5UXVhdC5tdWx0KHNoYXBlT3JpZW50YXRpb25zW2ldLCBvcmllbnRhdGlvbik7IC8vIEdldCBzaGFwZSBBQUJCCgogICAgICAgIHNoYXBlLmNhbGN1bGF0ZVdvcmxkQUFCQihvZmZzZXQsIG9yaWVudGF0aW9uLCBzaGFwZUFBQkIubG93ZXJCb3VuZCwgc2hhcGVBQUJCLnVwcGVyQm91bmQpOwoKICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgYWFiYi5jb3B5KHNoYXBlQUFCQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFhYmIuZXh0ZW5kKHNoYXBlQUFCQik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgYC5pbmVydGlhV29ybGRgIGFuZCBgLmludkluZXJ0aWFXb3JsZGAKICAgICAqLwoKCiAgICB1cGRhdGVJbmVydGlhV29ybGQoZm9yY2UpIHsKICAgICAgY29uc3QgSSA9IHRoaXMuaW52SW5lcnRpYTsKCiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDsgZWxzZSB7CiAgICAgICAgY29uc3QgbTEgPSB1aXdfbTE7CiAgICAgICAgY29uc3QgbTIgPSB1aXdfbTI7CiAgICAgICAgbTEuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pOwogICAgICAgIG0xLnRyYW5zcG9zZShtMik7CiAgICAgICAgbTEuc2NhbGUoSSwgbTEpOwogICAgICAgIG0xLm1tdWx0KG0yLCB0aGlzLmludkluZXJ0aWFXb3JsZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgZm9yY2UgdG8gYSBwb2ludCBvZiB0aGUgYm9keS4gVGhpcyBjb3VsZCBmb3IgZXhhbXBsZSBiZSBhIHBvaW50IG9uIHRoZSBCb2R5IHN1cmZhY2UuCiAgICAgKiBBcHBseWluZyBmb3JjZSB0aGlzIHdheSB3aWxsIGFkZCB0byBCb2R5LmZvcmNlIGFuZCBCb2R5LnRvcnF1ZS4KICAgICAqIEBwYXJhbSBmb3JjZSBUaGUgYW1vdW50IG9mIGZvcmNlIHRvIGFkZC4KICAgICAqIEBwYXJhbSByZWxhdGl2ZVBvaW50IEEgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIHRvIGFwcGx5IHRoZSBmb3JjZSBvbi4KICAgICAqLwoKCiAgICBhcHBseUZvcmNlKGZvcmNlLCByZWxhdGl2ZVBvaW50KSB7CiAgICAgIGlmIChyZWxhdGl2ZVBvaW50ID09PSB2b2lkIDApIHsKICAgICAgICByZWxhdGl2ZVBvaW50ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgLy8gTmVlZGVkPwogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBmb3JjZQoKCiAgICAgIGNvbnN0IHJvdEZvcmNlID0gQm9keV9hcHBseUZvcmNlX3JvdEZvcmNlOwogICAgICByZWxhdGl2ZVBvaW50LmNyb3NzKGZvcmNlLCByb3RGb3JjZSk7IC8vIEFkZCBsaW5lYXIgZm9yY2UKCiAgICAgIHRoaXMuZm9yY2UudmFkZChmb3JjZSwgdGhpcy5mb3JjZSk7IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgogICAgICB0aGlzLnRvcnF1ZS52YWRkKHJvdEZvcmNlLCB0aGlzLnRvcnF1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGZvcmNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEZvcmNlKGxvY2FsRm9yY2UsIGxvY2FsUG9pbnQpIHsKICAgICAgaWYgKGxvY2FsUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIGxvY2FsUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQpIHsKICAgICAgaWYgKHJlbGF0aXZlUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcG9pbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHkgY2VudGVyCgoKICAgICAgY29uc3QgciA9IHJlbGF0aXZlUG9pbnQ7IC8vIENvbXB1dGUgcHJvZHVjZWQgY2VudHJhbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCB2ZWxvID0gQm9keV9hcHBseUltcHVsc2VfdmVsbzsKICAgICAgdmVsby5jb3B5KGltcHVsc2UpOwogICAgICB2ZWxvLnNjYWxlKHRoaXMuaW52TWFzcywgdmVsbyk7IC8vIEFkZCBsaW5lYXIgaW1wdWxzZQoKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHZlbG8sIHRoaXMudmVsb2NpdHkpOyAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgaW1wdWxzZSB2ZWxvY2l0eQoKICAgICAgY29uc3Qgcm90VmVsbyA9IEJvZHlfYXBwbHlJbXB1bHNlX3JvdFZlbG87CiAgICAgIHIuY3Jvc3MoaW1wdWxzZSwgcm90VmVsbyk7CiAgICAgIC8qCiAgICAgICByb3RWZWxvLnggKj0gdGhpcy5pbnZJbmVydGlhLng7CiAgICAgICByb3RWZWxvLnkgKj0gdGhpcy5pbnZJbmVydGlhLnk7CiAgICAgICByb3RWZWxvLnogKj0gdGhpcy5pbnZJbmVydGlhLno7CiAgICAgICAqLwoKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQudm11bHQocm90VmVsbywgcm90VmVsbyk7IC8vIEFkZCByb3RhdGlvbmFsIEltcHVsc2UKCiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnZhZGQocm90VmVsbywgdGhpcy5hbmd1bGFyVmVsb2NpdHkpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBsb2NhbGx5LWRlZmluZWQgaW1wdWxzZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxJbXB1bHNlKGxvY2FsSW1wdWxzZSwgbG9jYWxQb2ludCkgewogICAgICBpZiAobG9jYWxQb2ludCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbG9jYWxQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgd29ybGRJbXB1bHNlID0gQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2U7CiAgICAgIGNvbnN0IHJlbGF0aXZlUG9pbnRXb3JsZCA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludDsgLy8gVHJhbnNmb3JtIHRoZSBmb3JjZSB2ZWN0b3IgdG8gd29ybGQgc3BhY2UKCiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsSW1wdWxzZSwgd29ybGRJbXB1bHNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUltcHVsc2Uod29ybGRJbXB1bHNlLCByZWxhdGl2ZVBvaW50V29ybGQpOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHlvdSBjaGFuZ2UgdGhlIGJvZHkgc2hhcGUgb3IgbWFzcy4KICAgICAqLwoKCiAgICB1cGRhdGVNYXNzUHJvcGVydGllcygpIHsKICAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBCb2R5X3VwZGF0ZU1hc3NQcm9wZXJ0aWVzX2hhbGZFeHRlbnRzOwogICAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwID8gMS4wIC8gdGhpcy5tYXNzIDogMDsKICAgICAgY29uc3QgSSA9IHRoaXMuaW5lcnRpYTsKICAgICAgY29uc3QgZml4ZWQgPSB0aGlzLmZpeGVkUm90YXRpb247IC8vIEFwcHJveGltYXRlIHdpdGggQUFCQiBib3gKCiAgICAgIHRoaXMudXBkYXRlQUFCQigpOwogICAgICBoYWxmRXh0ZW50cy5zZXQoKHRoaXMuYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLmFhYmIubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLmFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueSkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueiAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnopIC8gMik7CiAgICAgIEJveC5jYWxjdWxhdGVJbmVydGlhKGhhbGZFeHRlbnRzLCB0aGlzLm1hc3MsIEkpOwogICAgICB0aGlzLmludkluZXJ0aWEuc2V0KEkueCA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS54IDogMCwgSS55ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnkgOiAwLCBJLnogPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueiA6IDApOwogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCh0cnVlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHdvcmxkIHZlbG9jaXR5IG9mIGEgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gd29ybGRQb2ludAogICAgICogQHBhcmFtIHJlc3VsdAogICAgICogQHJldHVybiBUaGUgcmVzdWx0IHZlY3Rvci4KICAgICAqLwoKCiAgICBnZXRWZWxvY2l0eUF0V29ybGRQb2ludCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgY29uc3QgciA9IG5ldyBWZWMzKCk7CiAgICAgIHdvcmxkUG9pbnQudnN1Yih0aGlzLnBvc2l0aW9uLCByKTsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MociwgcmVzdWx0KTsKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogTW92ZSB0aGUgYm9keSBmb3J3YXJkIGluIHRpbWUuCiAgICAgKiBAcGFyYW0gZHQgVGltZSBzdGVwCiAgICAgKiBAcGFyYW0gcXVhdE5vcm1hbGl6ZSBTZXQgdG8gdHJ1ZSB0byBub3JtYWxpemUgdGhlIGJvZHkgcXVhdGVybmlvbgogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemVGYXN0IElmIHRoZSBxdWF0ZXJuaW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHVzaW5nICJmYXN0IiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgIC8vIFNhdmUgcHJldmlvdXMgcG9zaXRpb24KICAgICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5wb3NpdGlvbik7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uKTsKCiAgICAgIGlmICghKHRoaXMudHlwZSA9PT0gQm9keS5EWU5BTUlDIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHx8IHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIC8vIE9ubHkgZm9yIGR5bmFtaWMKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlbG8gPSB0aGlzLnZlbG9jaXR5OwogICAgICBjb25zdCBhbmd1bGFyVmVsbyA9IHRoaXMuYW5ndWxhclZlbG9jaXR5OwogICAgICBjb25zdCBwb3MgPSB0aGlzLnBvc2l0aW9uOwogICAgICBjb25zdCBmb3JjZSA9IHRoaXMuZm9yY2U7CiAgICAgIGNvbnN0IHRvcnF1ZSA9IHRoaXMudG9ycXVlOwogICAgICBjb25zdCBxdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBpbnZNYXNzID0gdGhpcy5pbnZNYXNzOwogICAgICBjb25zdCBpbnZJbmVydGlhID0gdGhpcy5pbnZJbmVydGlhV29ybGQ7CiAgICAgIGNvbnN0IGxpbmVhckZhY3RvciA9IHRoaXMubGluZWFyRmFjdG9yOwogICAgICBjb25zdCBpTWR0ID0gaW52TWFzcyAqIGR0OwogICAgICB2ZWxvLnggKz0gZm9yY2UueCAqIGlNZHQgKiBsaW5lYXJGYWN0b3IueDsKICAgICAgdmVsby55ICs9IGZvcmNlLnkgKiBpTWR0ICogbGluZWFyRmFjdG9yLnk7CiAgICAgIHZlbG8ueiArPSBmb3JjZS56ICogaU1kdCAqIGxpbmVhckZhY3Rvci56OwogICAgICBjb25zdCBlID0gaW52SW5lcnRpYS5lbGVtZW50czsKICAgICAgY29uc3QgYW5ndWxhckZhY3RvciA9IHRoaXMuYW5ndWxhckZhY3RvcjsKICAgICAgY29uc3QgdHggPSB0b3JxdWUueCAqIGFuZ3VsYXJGYWN0b3IueDsKICAgICAgY29uc3QgdHkgPSB0b3JxdWUueSAqIGFuZ3VsYXJGYWN0b3IueTsKICAgICAgY29uc3QgdHogPSB0b3JxdWUueiAqIGFuZ3VsYXJGYWN0b3IuejsKICAgICAgYW5ndWxhclZlbG8ueCArPSBkdCAqIChlWzBdICogdHggKyBlWzFdICogdHkgKyBlWzJdICogdHopOwogICAgICBhbmd1bGFyVmVsby55ICs9IGR0ICogKGVbM10gKiB0eCArIGVbNF0gKiB0eSArIGVbNV0gKiB0eik7CiAgICAgIGFuZ3VsYXJWZWxvLnogKz0gZHQgKiAoZVs2XSAqIHR4ICsgZVs3XSAqIHR5ICsgZVs4XSAqIHR6KTsgLy8gVXNlIG5ldyB2ZWxvY2l0eSAgLSBsZWFwIGZyb2cKCiAgICAgIHBvcy54ICs9IHZlbG8ueCAqIGR0OwogICAgICBwb3MueSArPSB2ZWxvLnkgKiBkdDsKICAgICAgcG9zLnogKz0gdmVsby56ICogZHQ7CiAgICAgIHF1YXQuaW50ZWdyYXRlKHRoaXMuYW5ndWxhclZlbG9jaXR5LCBkdCwgdGhpcy5hbmd1bGFyRmFjdG9yLCBxdWF0KTsKCiAgICAgIGlmIChxdWF0Tm9ybWFsaXplKSB7CiAgICAgICAgaWYgKHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgICAgICBxdWF0Lm5vcm1hbGl6ZUZhc3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhdC5ub3JtYWxpemUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsgLy8gVXBkYXRlIHdvcmxkIGluZXJ0aWEKCiAgICAgIHRoaXMudXBkYXRlSW5lcnRpYVdvcmxkKCk7CiAgICB9CgogIH0KICBCb2R5LmlkQ291bnRlciA9IDA7CiAgQm9keS5DT0xMSURFX0VWRU5UX05BTUUgPSAnY29sbGlkZSc7CiAgQm9keS5EWU5BTUlDID0gQk9EWV9UWVBFUy5EWU5BTUlDOwogIEJvZHkuU1RBVElDID0gQk9EWV9UWVBFUy5TVEFUSUM7CiAgQm9keS5LSU5FTUFUSUMgPSBCT0RZX1RZUEVTLktJTkVNQVRJQzsKICBCb2R5LkFXQUtFID0gQk9EWV9TTEVFUF9TVEFURVMuQVdBS0U7CiAgQm9keS5TTEVFUFkgPSBCT0RZX1NMRUVQX1NUQVRFUy5TTEVFUFk7CiAgQm9keS5TTEVFUElORyA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQSU5HOwogIEJvZHkud2FrZXVwRXZlbnQgPSB7CiAgICB0eXBlOiAnd2FrZXVwJwogIH07CiAgQm9keS5zbGVlcHlFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcHknCiAgfTsKICBCb2R5LnNsZWVwRXZlbnQgPSB7CiAgICB0eXBlOiAnc2xlZXAnCiAgfTsKICBjb25zdCB0bXBWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHVwZGF0ZUFBQkJfc2hhcGVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCB1aXdfbTEgPSBuZXcgTWF0MygpOwogIGNvbnN0IHVpd19tMiA9IG5ldyBNYXQzKCk7CiAgbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGJyb2FkcGhhc2UgaW1wbGVtZW50YXRpb25zCiAgICogQGF1dGhvciBzY2h0ZXBwZQogICAqLwogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudXNlQm91bmRpbmdCb3hlcyA9IGZhbHNlOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb2xsaXNpb24gcGFpcnMgZnJvbSB0aGUgd29ybGQKICAgICAqIEBwYXJhbSB3b3JsZCBUaGUgd29ybGQgdG8gc2VhcmNoIGluCiAgICAgKiBAcGFyYW0gcDEgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKiBAcGFyYW0gcDIgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxpc2lvblBhaXJzIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhpcyBCcm9hZFBoYXNlIGNsYXNzIScpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIGJvZHkgcGFpciBuZWVkcyB0byBiZSBpbnRlcnNlY3Rpb24gdGVzdGVkIGF0IGFsbC4KICAgICAqLwoKCiAgICBuZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihib2R5QSwgYm9keUIpIHsKICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIGZpbHRlciBtYXNrcwogICAgICBpZiAoKGJvZHlBLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUIuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDAgfHwgKGJvZHlCLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUEuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgdHlwZXMKCgogICAgICBpZiAoKChib2R5QS50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlBLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpICYmICgoYm9keUIudHlwZSAmIEJvZHkuU1RBVElDKSAhPT0gMCB8fCBib2R5Qi5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSkgewogICAgICAgIC8vIEJvdGggYm9kaWVzIGFyZSBzdGF0aWMgb3Igc2xlZXBpbmcuIFNraXAuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHZvbHVtZXMgb2YgdHdvIGJvZGllcyBpbnRlcnNlY3QuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0aW9uVGVzdChib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGlmICh0aGlzLnVzZUJvdW5kaW5nQm94ZXMpIHsKICAgICAgICB0aGlzLmRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICogQHBhcmFtIHBhaXJzMSBib2R5QSBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICogQHBhcmFtIHBhaXJzMiBib2R5QiBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICovCgoKICAgIGRvQm91bmRpbmdTcGhlcmVCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgciA9IEJyb2FkcGhhc2VfY29sbGlzaW9uUGFpcnNfcjsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgcik7CiAgICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzU3VtMiA9IChib2R5QS5ib3VuZGluZ1JhZGl1cyArIGJvZHlCLmJvdW5kaW5nUmFkaXVzKSAqKiAyOwogICAgICBjb25zdCBub3JtMiA9IHIubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgaWYgKG5vcm0yIDwgYm91bmRpbmdSYWRpdXNTdW0yKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgYm94ZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICovCgoKICAgIGRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKGJvZHlBLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlBLnVwZGF0ZUFBQkIoKTsKICAgICAgfQoKICAgICAgaWYgKGJvZHlCLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlCLnVwZGF0ZUFBQkIoKTsKICAgICAgfSAvLyBDaGVjayBBQUJCIC8gQUFCQgoKCiAgICAgIGlmIChib2R5QS5hYWJiLm92ZXJsYXBzKGJvZHlCLmFhYmIpKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBwYWlycyBmcm9tIHRoZSBwYWlyIGFycmF5cy4KICAgICAqLwoKCiAgICBtYWtlUGFpcnNVbmlxdWUocGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgdCA9IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3RlbXA7CiAgICAgIGNvbnN0IHAxID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDE7CiAgICAgIGNvbnN0IHAyID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDI7CiAgICAgIGNvbnN0IE4gPSBwYWlyczEubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIHAxW2ldID0gcGFpcnMxW2ldOwogICAgICAgIHAyW2ldID0gcGFpcnMyW2ldOwogICAgICB9CgogICAgICBwYWlyczEubGVuZ3RoID0gMDsKICAgICAgcGFpcnMyLmxlbmd0aCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgaWQxID0gcDFbaV0uaWQ7CiAgICAgICAgY29uc3QgaWQyID0gcDJbaV0uaWQ7CiAgICAgICAgY29uc3Qga2V5ID0gaWQxIDwgaWQyID8gYCR7aWQxfSwke2lkMn1gIDogYCR7aWQyfSwke2lkMX1gOwogICAgICAgIHRba2V5XSA9IGk7CiAgICAgICAgdC5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHQua2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHQua2V5cy5wb3AoKTsKICAgICAgICBjb25zdCBwYWlySW5kZXggPSB0W2tleV07CiAgICAgICAgcGFpcnMxLnB1c2gocDFbcGFpckluZGV4XSk7CiAgICAgICAgcGFpcnMyLnB1c2gocDJbcGFpckluZGV4XSk7CiAgICAgICAgZGVsZXRlIHRba2V5XTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBpbXBsZW1lbnRlZCBieSBzdWJjYXNzZXMKICAgICAqLwoKCiAgICBzZXRXb3JsZCh3b3JsZCkge30KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBvdmVybGFwLgogICAgICovCgoKICAgIHN0YXRpYyBib3VuZGluZ1NwaGVyZUNoZWNrKGJvZHlBLCBib2R5QikgewogICAgICBjb25zdCBkaXN0ID0gbmV3IFZlYzMoKTsgLy8gYnNjX2Rpc3Q7CgogICAgICBib2R5QS5wb3NpdGlvbi52c3ViKGJvZHlCLnBvc2l0aW9uLCBkaXN0KTsKICAgICAgY29uc3Qgc2EgPSBib2R5QS5zaGFwZXNbMF07CiAgICAgIGNvbnN0IHNiID0gYm9keUIuc2hhcGVzWzBdOwogICAgICByZXR1cm4gTWF0aC5wb3coc2EuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzYi5ib3VuZGluZ1NwaGVyZVJhZGl1cywgMikgPiBkaXN0Lmxlbmd0aFNxdWFyZWQoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbGwgdGhlIGJvZGllcyB3aXRoaW4gdGhlIEFBQkIuCiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KHdvcmxkLCBhYWJiLCByZXN1bHQpIHsKICAgICAgY29uc29sZS53YXJuKCcuYWFiYlF1ZXJ5IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIEJyb2FkcGhhc2Ugc3ViY2xhc3MuJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgfSAvLyBUZW1wIG9iamVjdHMKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBRdWF0ZXJuaW9uKCk7CiAgbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogTmFpdmUgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbiwgdXNlZCBpbiBsYWNrIG9mIGJldHRlciBvbmVzLgogICAqCiAgICogVGhlIG5haXZlIGJyb2FkcGhhc2UgbG9va3MgYXQgYWxsIHBvc3NpYmxlIHBhaXJzIHdpdGhvdXQgcmVzdHJpY3Rpb24sIHRoZXJlZm9yZSBpdCBoYXMgY29tcGxleGl0eSBOXjIgXyh3aGljaCBpcyBiYWQpXwogICAqLwogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSB3b3JsZC5ib2RpZXNbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfSAvLyBVZ2x5IGhhY2sgdW50aWwgQm9keSBnZXRzIGFhYmIKCgogICAgICAgIGlmIChiLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgfQoKICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCiAgY2xhc3MgUmF5Y2FzdFJlc3VsdCB7CiAgICAvKioKICAgICAqIHJheUZyb21Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiByYXlUb1dvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdE5vcm1hbFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdFBvaW50V29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGFzSGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIHNoYXBlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJvZHkKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGluZGV4IG9mIHRoZSBoaXQgdHJpYW5nbGUsIGlmIHRoZSBoaXQgc2hhcGUgd2FzIGEgdHJpbWVzaAogICAgICovCgogICAgLyoqCiAgICAgKiBEaXN0YW5jZSB0byB0aGUgaGl0LiBXaWxsIGJlIHNldCB0byAtMSBpZiB0aGVyZSB3YXMgbm8gaGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSByYXkgc2hvdWxkIHN0b3AgdHJhdmVyc2luZyB0aGUgYm9kaWVzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzZXQgYWxsIHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogYWJvcnQKICAgICAqLwoKCiAgICBhYm9ydCgpIHsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHNldChyYXlGcm9tV29ybGQsIHJheVRvV29ybGQsIGhpdE5vcm1hbFdvcmxkLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuY29weShyYXlGcm9tV29ybGQpOwogICAgICB0aGlzLnJheVRvV29ybGQuY29weShyYXlUb1dvcmxkKTsKICAgICAgdGhpcy5oaXROb3JtYWxXb3JsZC5jb3B5KGhpdE5vcm1hbFdvcmxkKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLmNvcHkoaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTsKICAgICAgdGhpcy5ib2R5ID0gYm9keTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgfQoKICB9CgogIGxldCBfU2hhcGUkdHlwZXMkU1BIRVJFLCBfU2hhcGUkdHlwZXMkUExBTkUsIF9TaGFwZSR0eXBlcyRCT1gsIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiwgX1NoYXBlJHR5cGVzJENPTlZFWFBPLCBfU2hhcGUkdHlwZXMkSEVJR0hURkksIF9TaGFwZSR0eXBlcyRUUklNRVNIOwoKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KICBjb25zdCBSQVlfTU9ERVMgPSB7CiAgICAvKiogQ0xPU0VTVCAqLwogICAgQ0xPU0VTVDogMSwKCiAgICAvKiogQU5ZICovCiAgICBBTlk6IDIsCgogICAgLyoqIEFMTCAqLwogICAgQUxMOiA0CiAgfTsKICAvKioKICAgKiBSYXlNb2RlCiAgICovCgogIF9TaGFwZSR0eXBlcyRTUEhFUkUgPSBTaGFwZS50eXBlcy5TUEhFUkU7CiAgX1NoYXBlJHR5cGVzJFBMQU5FID0gU2hhcGUudHlwZXMuUExBTkU7CiAgX1NoYXBlJHR5cGVzJEJPWCA9IFNoYXBlLnR5cGVzLkJPWDsKICBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIgPSBTaGFwZS50eXBlcy5DWUxJTkRFUjsKICBfU2hhcGUkdHlwZXMkQ09OVkVYUE8gPSBTaGFwZS50eXBlcy5DT05WRVhQT0xZSEVEUk9OOwogIF9TaGFwZSR0eXBlcyRIRUlHSFRGSSA9IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxEOwogIF9TaGFwZSR0eXBlcyRUUklNRVNIID0gU2hhcGUudHlwZXMuVFJJTUVTSDsKCiAgLyoqCiAgICogQSBsaW5lIGluIDNEIHNwYWNlIHRoYXQgaW50ZXJzZWN0cyBib2RpZXMgYW5kIHJldHVybiBwb2ludHMuCiAgICovCiAgY2xhc3MgUmF5IHsKICAgIC8qKgogICAgICogZnJvbQogICAgICovCgogICAgLyoqCiAgICAgKiB0bwogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb24KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHByZWNpc2lvbiBvZiB0aGUgcmF5LiBVc2VkIHdoZW4gY2hlY2tpbmcgcGFyYWxsZWxpdHkgZXRjLgogICAgICogQGRlZmF1bHQgMC4wMDAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBgZmFsc2VgIGlmIHlvdSBkb24ndCB3YW50IHRoZSBSYXkgdG8gdGFrZSBgY29sbGlzaW9uUmVzcG9uc2VgIGZsYWdzIGludG8gYWNjb3VudCBvbiBib2RpZXMgYW5kIHNoYXBlcy4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHJheSBza2lwcyBhbnkgaGl0cyB3aXRoIG5vcm1hbC5kb3QocmF5RGlyZWN0aW9uKSA8IDAuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJHcm91cAogICAgICogQGRlZmF1bHQgLTEKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGludGVyc2VjdGlvbiBtb2RlLiBTaG91bGQgYmUgUmF5LkFOWSwgUmF5LkFMTCBvciBSYXkuQ0xPU0VTVC4KICAgICAqIEBkZWZhdWx0IFJBWS5BTlkKICAgICAqLwoKICAgIC8qKgogICAgICogQ3VycmVudCByZXN1bHQgb2JqZWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBXaWxsIGJlIHNldCB0byBgdHJ1ZWAgZHVyaW5nIGludGVyc2VjdFdvcmxkKCkgaWYgdGhlIHJheSBoaXQgYW55dGhpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZXItcHJvdmlkZWQgcmVzdWx0IGNhbGxiYWNrLiBXaWxsIGJlIHVzZWQgaWYgbW9kZSBpcyBSYXkuQUxMLgogICAgICovCgogICAgLyoqCiAgICAgKiBDTE9TRVNUCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBBTEwKICAgICAqLwogICAgZ2V0IFtfU2hhcGUkdHlwZXMkU1BIRVJFXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFNwaGVyZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRQTEFORV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RQbGFuZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRCT1hdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Qm94OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENZTElOREVSXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRDT05WRVhQT10oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkSEVJR0hURkldKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkVFJJTUVTSF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RUcmltZXNoOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKGZyb20sIHRvKSB7CiAgICAgIGlmIChmcm9tID09PSB2b2lkIDApIHsKICAgICAgICBmcm9tID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgaWYgKHRvID09PSB2b2lkIDApIHsKICAgICAgICB0byA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CiAgUmF5LkNMT1NFU1QgPSBSQVlfTU9ERVMuQ0xPU0VTVDsKICBSYXkuQU5ZID0gUkFZX01PREVTLkFOWTsKICBSYXkuQUxMID0gUkFZX01PREVTLkFMTDsKICBjb25zdCB0bXBBQUJCJDEgPSBuZXcgQUFCQigpOwogIGNvbnN0IHRtcEFycmF5ID0gW107CiAgY29uc3QgdjEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3hpID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3FpID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYyA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgUmF5Y2FzdFJlc3VsdCgpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleF92ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9sb2NhbFRvID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkSW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIG5ldyBBQUJCKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF90cmlhbmdsZXMgPSBbXTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyZWVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7CiAgY29uc3QgdjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCBkaXJlY3Rpb24sIHBvc2l0aW9uKSB7CiAgICAvLyB2MCBpcyB2ZWN0b3IgZnJvbSBmcm9tIHRvIHBvc2l0aW9uCiAgICBwb3NpdGlvbi52c3ViKGZyb20sIHYwKTsKICAgIGNvbnN0IGRvdCA9IHYwLmRvdChkaXJlY3Rpb24pOyAvLyBpbnRlcnNlY3QgPSBkaXJlY3Rpb24qZG90ICsgZnJvbQoKICAgIGRpcmVjdGlvbi5zY2FsZShkb3QsIGludGVyc2VjdCk7CiAgICBpbnRlcnNlY3QudmFkZChmcm9tLCBpbnRlcnNlY3QpOwogICAgY29uc3QgZGlzdGFuY2UgPSBwb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyc2VjdCk7CiAgICByZXR1cm4gZGlzdGFuY2U7CiAgfQoKICAvKioKICAgKiBTd2VlcCBhbmQgcHJ1bmUgYnJvYWRwaGFzZSBhbG9uZyBvbmUgYXhpcy4KICAgKi8KICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIHRoaXMuc29ydExpc3QoKTsKICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNJbmRleCA9IHRoaXMuYXhpc0luZGV4OwogICAgICBsZXQgYXhpcyA9ICd4JzsKCiAgICAgIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBheGlzID0gJ3knOwogICAgICB9CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAyKSB7CiAgICAgICAgYXhpcyA9ICd6JzsKICAgICAgfQoKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBhYWJiLmxvd2VyQm91bmRbYXhpc107CiAgICAgIGFhYmIudXBwZXJCb3VuZFtheGlzXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXhpc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gYXhpc0xpc3RbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KCiAgY2xhc3MgVXRpbHMgewogICAgLyoqCiAgICAgKiBFeHRlbmQgYW4gb3B0aW9ucyBvYmplY3Qgd2l0aCBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4gTWF5IGJlIGZhbHN5OiBpbiB0aGlzIGNhc2UsIGEgbmV3IG9iamVjdCBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KICAgICAqIEBwYXJhbSBkZWZhdWx0cyBBbiBvYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEByZXR1cm4gVGhlIG1vZGlmaWVkIG9wdGlvbnMgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdHMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBiYXNlIGNsYXNzCiAgICovCiAgY2xhc3MgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIEVxdWF0aW9ucyB0byBiZSBzb2x2ZWQgaW4gdGhpcyBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50IHRoZSBib2RpZXMgdG8gY29sbGlkZSB3aGVuIHRoZXkgYXJlIGNvbm5lY3RlZC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KICBDb25zdHJhaW50LmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJvdGF0aW9uYWwgPSBuZXcgVmVjMygpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIG90aGVyIEphY29iaWFuRWxlbWVudAogICAgICovCgoKICAgIG11bHRpcGx5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHJldHVybiBlbGVtZW50LnNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyBlbGVtZW50LnJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHdpdGggdHdvIHZlY3RvcnMKICAgICAqLwoKCiAgICBtdWx0aXBseVZlY3RvcnMoc3BhdGlhbCwgcm90YXRpb25hbCkgewogICAgICByZXR1cm4gc3BhdGlhbC5kb3QodGhpcy5zcGF0aWFsKSArIHJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCiAgY2xhc3MgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBNaW5pbXVtIChyZWFkOiBuZWdhdGl2ZSBtYXgpIGZvcmNlIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heGltdW0gKHJlYWQ6IHBvc2l0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogQSBudW1iZXIsIHByb3BvcnRpb25hbCB0byB0aGUgZm9yY2UgYWRkZWQgdG8gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYmksIGJqLCBtaW5Gb3JjZSwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1pbkZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtaW5Gb3JjZSA9IC0xZTY7CiAgICAgIH0KCiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQogIEVxdWF0aW9uLmlkQ291bnRlciA9IDA7CiAgY29uc3QgaU1maSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaU1maiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWlfdm11bHRfdGF1aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWpfdm11bHRfdGF1aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wID0gbmV3IFZlYzMoKTsKICBjb25zdCBhZGRUb1dsYW1iZGFfdGVtcCA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KICBjbGFzcyBDb250YWN0RXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqICJib3VuY2luZXNzIjogdTEgPSAtZSp1MAogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZC1vcmllbnRlZCB2ZWN0b3IgdGhhdCBnb2VzIGZyb20gdGhlIGNlbnRlciBvZiBiaSB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgc3RhcnRzIGluIGJvZHkgaiBwb3NpdGlvbiBhbmQgZ29lcyB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udGFjdCBub3JtYWwsIHBvaW50aW5nIG91dCBvZiBib2R5IGkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAwLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7CiAgICAgIHRoaXMucmkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJqID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5uaSA9IG5ldyBWZWMzKCk7CiAgICB9CgogICAgY29tcHV0ZUIoaCkgewogICAgICBjb25zdCBhID0gdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgcmkgPSB0aGlzLnJpOwogICAgICBjb25zdCByaiA9IHRoaXMucmo7CiAgICAgIGNvbnN0IHJpeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDI7CiAgICAgIGNvbnN0IHZpID0gYmkudmVsb2NpdHk7CiAgICAgIGNvbnN0IHdpID0gYmkuYW5ndWxhclZlbG9jaXR5OwogICAgICBiaS5mb3JjZTsKICAgICAgYmkudG9ycXVlOwogICAgICBjb25zdCB2aiA9IGJqLnZlbG9jaXR5OwogICAgICBjb25zdCB3aiA9IGJqLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmouZm9yY2U7CiAgICAgIGJqLnRvcnF1ZTsKICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDM7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgbiA9IHRoaXMubmk7IC8vIENhbHVjbGF0ZSBjcm9zcyBwcm9kdWN0cwoKICAgICAgcmkuY3Jvc3Mobiwgcml4bik7CiAgICAgIHJqLmNyb3NzKG4sIHJqeG4pOyAvLyBnID0geGorcmogLSh4aStyaSkKICAgICAgLy8gRyA9IFsgLW5pICAtcml4biAgbmkgIHJqeG4gXQoKICAgICAgbi5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeG4ubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkobik7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanhuKTsgLy8gQ2FsY3VsYXRlIHRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IKCiAgICAgIHBlbmV0cmF0aW9uVmVjLmNvcHkoYmoucG9zaXRpb24pOwogICAgICBwZW5ldHJhdGlvblZlYy52YWRkKHJqLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIoYmkucG9zaXRpb24sIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgcGVuZXRyYXRpb25WZWMudnN1YihyaSwgcGVuZXRyYXRpb25WZWMpOwogICAgICBjb25zdCBnID0gbi5kb3QocGVuZXRyYXRpb25WZWMpOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgY29uc3QgZVBsdXNPbmUgPSB0aGlzLnJlc3RpdHV0aW9uICsgMTsKICAgICAgY29uc3QgR1cgPSBlUGx1c09uZSAqIHZqLmRvdChuKSAtIGVQbHVzT25lICogdmkuZG90KG4pICsgd2ouZG90KHJqeG4pIC0gd2kuZG90KHJpeG4pOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmVsYXRpdmUgdmVsb2NpdHkgaW4gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCgogICAgZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbCgpIHsKICAgICAgY29uc3QgdmkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aTsKICAgICAgY29uc3QgdmogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92ajsKICAgICAgY29uc3QgeGkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aTsKICAgICAgY29uc3QgeGogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94ajsKICAgICAgY29uc3QgcmVsVmVsID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfcmVsVmVsOwogICAgICB0aGlzLmJpLnBvc2l0aW9uLnZhZGQodGhpcy5yaSwgeGkpOwogICAgICB0aGlzLmJqLnBvc2l0aW9uLnZhZGQodGhpcy5yaiwgeGopOwogICAgICB0aGlzLmJpLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhpLCB2aSk7CiAgICAgIHRoaXMuYmouZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoeGosIHZqKTsKICAgICAgdmkudnN1Yih2aiwgcmVsVmVsKTsKICAgICAgcmV0dXJuIHRoaXMubmkuZG90KHJlbFZlbCk7CiAgICB9CgogIH0KICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMKCiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDMgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZpID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3hqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF9yZWxWZWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBDb25uZWN0cyB0d28gYm9kaWVzIGF0IGdpdmVuIG9mZnNldCBwb2ludHMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgYm9keUEgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgY29uc3QgYm9keUIgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgYm9keUEucG9zaXRpb24uc2V0KC0xLCAwLCAwKQogICAqICAgICBib2R5Qi5wb3NpdGlvbi5zZXQoMSwgMCwgMCkKICAgKiAgICAgYm9keUEuYWRkU2hhcGUoc2hhcGVBKQogICAqICAgICBib2R5Qi5hZGRTaGFwZShzaGFwZUIpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUEpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUIpCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RBID0gbmV3IFZlYzMoMSwgMCwgMCkKICAgKiAgICAgY29uc3QgbG9jYWxQaXZvdEIgPSBuZXcgVmVjMygtMSwgMCwgMCkKICAgKiAgICAgY29uc3QgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KGJvZHlBLCBsb2NhbFBpdm90QSwgYm9keUIsIGxvY2FsUGl2b3RCKQogICAqICAgICB3b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpCiAgICovCiAgY2xhc3MgUG9pbnRUb1BvaW50Q29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlCLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcGl2b3RBIFRoZSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3Mgb2YgYm9keUEgd2hpY2ggYm9keUEgaXMgY29uc3RyYWluZWQgdG8uCiAgICAgKiBAcGFyYW0gYm9keUIgQm9keSB0aGF0IHdpbGwgYmUgY29uc3RyYWluZWQgaW4gYSBzaW1pbGFyIHdheSB0byB0aGUgc2FtZSBwb2ludCBhcyBib2R5QS4gV2Ugd2lsbCB0aGVyZWZvcmUgZ2V0IGEgbGluayBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5Qi4gSWYgbm90IHNwZWNpZmllZCwgYm9keUEgd2lsbCBiZSBjb25zdHJhaW5lZCB0byBhIHN0YXRpYyBwb2ludC4KICAgICAqIEBwYXJhbSBwaXZvdEIgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QiB3aGljaCBib2R5QiBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBtYXhGb3JjZSBUaGUgbWF4aW11bSBmb3JjZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIGNvbnN0cmFpbiB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgcGl2b3RBLCBib2R5QiwgcGl2b3RCLCBtYXhGb3JjZSkgewogICAgICBpZiAocGl2b3RBID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAocGl2b3RCID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAobWF4Rm9yY2UgPT09IHZvaWQgMCkgewogICAgICAgIG1heEZvcmNlID0gMWU2OwogICAgICB9CgogICAgICBzdXBlcihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQoKICAvKioKICAgKiBDb25lIGVxdWF0aW9uLiBXb3JrcyB0byBrZWVwIHRoZSBnaXZlbiBib2R5IHdvcmxkIHZlY3RvcnMgYWxpZ25lZCwgb3IgdGlsdGVkIHdpdGhpbiBhIGdpdmVuIGFuZ2xlIGZyb20gZWFjaCBvdGhlci4KICAgKi8KICBjbGFzcyBDb25lRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIExvY2FsIGF4aXMgaW4gQQogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEIKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlICJjb25lIGFuZ2xlIiB0byBrZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CiAgY29uc3QgdG1wVmVjMSQyID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWMyJDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxFcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIG1heEFuZ2xlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IHRtcFZlYzEkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQxID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCiAgY2xhc3MgQ29uZVR3aXN0Q29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBheGlzIGRpcmVjdGlvbiBmb3IgdGhlIGNvbnN0cmFpbnQgb2YgdGhlIGJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGFwZXJ0dXJlIGFuZ2xlIG9mIHRoZSBjb25lLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHdpc3QgYW5nbGUgb2YgdGhlIGpvaW50LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gb3B0aW9ucy5heGlzQSA/IG9wdGlvbnMuYXhpc0EuY2xvbmUoKSA6IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gISFvcHRpb25zLmNvbGxpZGVDb25uZWN0ZWQ7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgICAgY29uc3QgYyA9IHRoaXMuY29uZUVxdWF0aW9uID0gbmV3IENvbmVFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCB0ID0gdGhpcy50d2lzdEVxdWF0aW9uID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy50d2lzdEFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMudHdpc3RBbmdsZSA6IDA7IC8vIE1ha2UgdGhlIGNvbmUgZXF1YXRpb24gcHVzaCB0aGUgYm9kaWVzIHRvd2FyZCB0aGUgY29uZSBheGlzLCBub3Qgb3V0d2FyZAoKICAgICAgYy5tYXhGb3JjZSA9IDA7CiAgICAgIGMubWluRm9yY2UgPSAtbWF4Rm9yY2U7IC8vIE1ha2UgdGhlIHR3aXN0IGVxdWF0aW9uIGFkZCB0b3JxdWUgdG93YXJkIHRoZSBpbml0aWFsIHBvc2l0aW9uCgogICAgICB0Lm1heEZvcmNlID0gMDsKICAgICAgdC5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChjLCB0KTsKICAgIH0KCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBjb25lID0gdGhpcy5jb25lRXF1YXRpb247CiAgICAgIGNvbnN0IHR3aXN0ID0gdGhpcy50d2lzdEVxdWF0aW9uOwogICAgICBzdXBlci51cGRhdGUoKTsgLy8gVXBkYXRlIHRoZSBheGVzIHRvIHRoZSBjb25lIGNvbnN0cmFpbnQKCiAgICAgIGJvZHlBLnZlY3RvclRvV29ybGRGcmFtZSh0aGlzLmF4aXNBLCBjb25lLmF4aXNBKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0IsIGNvbmUuYXhpc0IpOyAvLyBVcGRhdGUgdGhlIHdvcmxkIGF4ZXMgaW4gdGhlIHR3aXN0IGNvbnN0cmFpbnQKCiAgICAgIHRoaXMuYXhpc0EudGFuZ2VudHModHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNBLCB0d2lzdC5heGlzQSk7CiAgICAgIHRoaXMuYXhpc0IudGFuZ2VudHModHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNCLCB0d2lzdC5heGlzQik7CiAgICAgIGNvbmUuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgICB0d2lzdC5tYXhBbmdsZSA9IHRoaXMudHdpc3RBbmdsZTsKICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KICBjbGFzcyBEaXN0YW5jZUNvbnN0cmFpbnQgZXh0ZW5kcyBDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRpc3RhbmNlIFRoZSBkaXN0YW5jZSB0byBrZWVwLiBJZiB1bmRlZmluZWQsIGl0IHdpbGwgYmUgc2V0IHRvIHRoZSBjdXJyZW50IGRpc3RhbmNlIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgZGlzdGFuY2UsIG1heEZvcmNlKSB7CiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHN1cGVyKGJvZHlBLCBib2R5Qik7CgogICAgICBpZiAodHlwZW9mIGRpc3RhbmNlID09PSAndW5kZWZpbmVkJykgewogICAgICAgIGRpc3RhbmNlID0gYm9keUEucG9zaXRpb24uZGlzdGFuY2VUbyhib2R5Qi5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb24gPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goZXEpOyAvLyBNYWtlIGl0IGJpZGlyZWN0aW9uYWwKCiAgICAgIGVxLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICBlcS5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBlcSA9IHRoaXMuZGlzdGFuY2VFcXVhdGlvbjsKICAgICAgY29uc3QgaGFsZkRpc3QgPSB0aGlzLmRpc3RhbmNlICogMC41OwogICAgICBjb25zdCBub3JtYWwgPSBlcS5uaTsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBub3JtYWwuc2NhbGUoaGFsZkRpc3QsIGVxLnJpKTsKICAgICAgbm9ybWFsLnNjYWxlKC1oYWxmRGlzdCwgZXEucmopOwogICAgfQoKICB9CgogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCiAgY2xhc3MgTG9ja0NvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7IC8vIFNldCBwaXZvdCBwb2ludCBpbiBiZXR3ZWVuCgogICAgICBjb25zdCBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoYWxmV2F5ID0gbmV3IFZlYzMoKTsKICAgICAgYm9keUEucG9zaXRpb24udmFkZChib2R5Qi5wb3NpdGlvbiwgaGFsZldheSk7CiAgICAgIGhhbGZXYXkuc2NhbGUoMC41LCBoYWxmV2F5KTsKICAgICAgYm9keUIucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RCKTsKICAgICAgYm9keUEucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RBKTsgLy8gVGhlIHBvaW50LXRvLXBvaW50IGNvbnN0cmFpbnQgd2lsbCBrZWVwIGEgcG9pbnQgc2hhcmVkIGJldHdlZW4gdGhlIGJvZGllcwoKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOyAvLyBTdG9yZSBpbml0aWFsIHJvdGF0aW9uIG9mIHRoZSBib2RpZXMgYXMgdW5pdCB2ZWN0b3JzIGluIHRoZSBsb2NhbCBib2R5IHNwYWNlcwoKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIG1vdG9yIGNvbnN0cmFpbnQuIFRyaWVzIHRvIGtlZXAgdGhlIHJlbGF0aXZlIGFuZ3VsYXIgdmVsb2NpdHkgb2YgdGhlIGJvZGllcyB0byBhIGdpdmVuIHZhbHVlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KCiAgLyoqCiAgICogSGluZ2UgY29uc3RyYWludC4gVGhpbmsgb2YgaXQgYXMgYSBkb29yIGhpbmdlLiBJdCB0cmllcyB0byBrZWVwIHRoZSBkb29yIGluIHRoZSBjb3JyZWN0IHBsYWNlIGFuZCB3aXRoIHRoZSBjb3JyZWN0IG9yaWVudGF0aW9uLgogICAqLwogIGNsYXNzIEhpbmdlQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIGF4aXMsIGRlZmluZWQgbG9jYWxseSBpbiBib2R5Qi4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEhpbmdlQ29uc3RyYWludF91cGRhdGVfdG1wVmVjMiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KICBjbGFzcyBGcmljdGlvbkVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLy8gVGFuZ2VudAoKICAgIC8qKgogICAgICogQHBhcmFtIHNsaXBGb3JjZSBzaG91bGQgYmUgKy1GX2ZyaWN0aW9uID0gKy1tdSAqIEZfbm9ybWFsID0gKy1tdSAqIG0gKiBnCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgc2xpcEZvcmNlKSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLXNsaXBGb3JjZSwgc2xpcEZvcmNlKTsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KICBjbGFzcyBDb250YWN0TWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBJZGVudGlmaWVyIG9mIHRoaXMgbWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBhcnRpY2lwYXRpbmcgbWF0ZXJpYWxzLgogICAgICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgY29udGFjdCBlcXVhdGlvbnMuCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG0xLCBtMiwgb3B0aW9ucykgewogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMywKICAgICAgICBjb250YWN0RXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBjb250YWN0RXF1YXRpb25SZWxheGF0aW9uOiAzLAogICAgICAgIGZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbjogMwogICAgICB9KTsKICAgICAgdGhpcy5pZCA9IENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSBbbTEsIG0yXTsKICAgICAgdGhpcy5mcmljdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb247CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSBvcHRpb25zLnJlc3RpdHV0aW9uOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb247CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb247CiAgICB9CgogIH0KICBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyID0gMDsKCiAgLyoqCiAgICogRGVmaW5lcyBhIHBoeXNpY3MgbWF0ZXJpYWwuCiAgICovCiAgY2xhc3MgTWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBNYXRlcmlhbCBuYW1lLgogICAgICogSWYgb3B0aW9ucyBpcyBhIHN0cmluZywgbmFtZSB3aWxsIGJlIHNldCB0byB0aGF0IHN0cmluZy4KICAgICAqIEB0b2RvIERlcHJlY2F0ZSB0aGlzCiAgICAgKi8KCiAgICAvKiogTWF0ZXJpYWwgaWQuICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGZyaWN0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gZm9yIHRoaXMgbWF0ZXJpYWwuCiAgICAgKiBJZiBub24tbmVnYXRpdmUsIGl0IHdpbGwgYmUgdXNlZCBpbnN0ZWFkIG9mIHRoZSByZXN0aXR1dGlvbiBnaXZlbiBieSBDb250YWN0TWF0ZXJpYWxzLiBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIENvbnRhY3RNYXRlcmlhbCwgdGhlIHZhbHVlIGZyb20gYGRlZmF1bHRDb250YWN0TWF0ZXJpYWxgIGluIHRoZSBXb3JsZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQogIE1hdGVyaWFsLmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwogIGNsYXNzIFNwcmluZyB7CiAgICAvKioKICAgICAqIFJlc3QgbGVuZ3RoIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID4gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID49IDAuCiAgICAgKiBAZGVmYXVsdCAxMDAKICAgICAqLwoKICAgIC8qKgogICAgICogRGFtcGluZyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBGaXJzdCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogU2Vjb25kIGNvbm5lY3RlZCBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBBbmNob3IgZm9yIGJvZHlBIGluIGxvY2FsIGJvZHlBIGNvb3JkaW5hdGVzLgogICAgICogV2hlcmUgdG8gaG9vayB0aGUgc3ByaW5nIHRvIGJvZHkgQSwgaW4gbG9jYWwgYm9keSBjb29yZGluYXRlcy4KICAgICAqIEBkZWZhdWx0IG5ldyBWZWMzKCkKICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QiBpbiBsb2NhbCBib2R5QiBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEIsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJlc3RMZW5ndGggPSB0eXBlb2Ygb3B0aW9ucy5yZXN0TGVuZ3RoID09PSAnbnVtYmVyJyA/IG9wdGlvbnMucmVzdExlbmd0aCA6IDE7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gb3B0aW9ucy5zdGlmZm5lc3MgfHwgMTAwOwogICAgICB0aGlzLmRhbXBpbmcgPSBvcHRpb25zLmRhbXBpbmcgfHwgMTsKICAgICAgdGhpcy5ib2R5QSA9IGJvZHlBOwogICAgICB0aGlzLmJvZHlCID0gYm9keUI7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG9jYWxBbmNob3JBKSB7CiAgICAgICAgdGhpcy5sb2NhbEFuY2hvckEuY29weShvcHRpb25zLmxvY2FsQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQikgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JCLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckIpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckEpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQShvcHRpb25zLndvcmxkQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLndvcmxkQW5jaG9yQikgewogICAgICAgIHRoaXMuc2V0V29ybGRBbmNob3JCKG9wdGlvbnMud29ybGRBbmNob3JCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIHVzaW5nIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHNldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpIHsKICAgICAgdGhpcy5ib2R5QS5wb2ludFRvTG9jYWxGcmFtZSh3b3JsZEFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBCLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQSwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckEocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckEsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckIocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRoZSBzcHJpbmcgZm9yY2UgdG8gdGhlIGNvbm5lY3RlZCBib2RpZXMuCiAgICAgKi8KCgogICAgYXBwbHlGb3JjZSgpIHsKICAgICAgY29uc3QgayA9IHRoaXMuc3RpZmZuZXNzOwogICAgICBjb25zdCBkID0gdGhpcy5kYW1waW5nOwogICAgICBjb25zdCBsID0gdGhpcy5yZXN0TGVuZ3RoOwogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgciA9IGFwcGx5Rm9yY2VfcjsKICAgICAgY29uc3Qgcl91bml0ID0gYXBwbHlGb3JjZV9yX3VuaXQ7CiAgICAgIGNvbnN0IHUgPSBhcHBseUZvcmNlX3U7CiAgICAgIGNvbnN0IGYgPSBhcHBseUZvcmNlX2Y7CiAgICAgIGNvbnN0IHRtcCA9IGFwcGx5Rm9yY2VfdG1wOwogICAgICBjb25zdCB3b3JsZEFuY2hvckEgPSBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQTsKICAgICAgY29uc3Qgd29ybGRBbmNob3JCID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckI7CiAgICAgIGNvbnN0IHJpID0gYXBwbHlGb3JjZV9yaTsKICAgICAgY29uc3QgcmogPSBhcHBseUZvcmNlX3JqOwogICAgICBjb25zdCByaV94X2YgPSBhcHBseUZvcmNlX3JpX3hfZjsKICAgICAgY29uc3QgcmpfeF9mID0gYXBwbHlGb3JjZV9yal94X2Y7IC8vIEdldCB3b3JsZCBhbmNob3JzCgogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpOwogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQih3b3JsZEFuY2hvckIpOyAvLyBHZXQgb2Zmc2V0IHBvaW50cwoKICAgICAgd29ybGRBbmNob3JBLnZzdWIoYm9keUEucG9zaXRpb24sIHJpKTsKICAgICAgd29ybGRBbmNob3JCLnZzdWIoYm9keUIucG9zaXRpb24sIHJqKTsgLy8gQ29tcHV0ZSBkaXN0YW5jZSB2ZWN0b3IgYmV0d2VlbiB3b3JsZCBhbmNob3IgcG9pbnRzCgogICAgICB3b3JsZEFuY2hvckIudnN1Yih3b3JsZEFuY2hvckEsIHIpOwogICAgICBjb25zdCBybGVuID0gci5sZW5ndGgoKTsKICAgICAgcl91bml0LmNvcHkocik7CiAgICAgIHJfdW5pdC5ub3JtYWxpemUoKTsgLy8gQ29tcHV0ZSByZWxhdGl2ZSB2ZWxvY2l0eSBvZiB0aGUgYW5jaG9yIHBvaW50cywgdQoKICAgICAgYm9keUIudmVsb2NpdHkudnN1Yihib2R5QS52ZWxvY2l0eSwgdSk7IC8vIEFkZCByb3RhdGlvbmFsIHZlbG9jaXR5CgogICAgICBib2R5Qi5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmosIHRtcCk7CiAgICAgIHUudmFkZCh0bXAsIHUpOwogICAgICBib2R5QS5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmksIHRtcCk7CiAgICAgIHUudnN1Yih0bXAsIHUpOyAvLyBGID0gLSBrICogKCB4IC0gTCApIC0gRCAqICggdSApCgogICAgICByX3VuaXQuc2NhbGUoLWsgKiAocmxlbiAtIGwpIC0gZCAqIHUuZG90KHJfdW5pdCksIGYpOyAvLyBBZGQgZm9yY2VzIHRvIGJvZGllcwoKICAgICAgYm9keUEuZm9yY2UudnN1YihmLCBib2R5QS5mb3JjZSk7CiAgICAgIGJvZHlCLmZvcmNlLnZhZGQoZiwgYm9keUIuZm9yY2UpOyAvLyBBbmd1bGFyIGZvcmNlCgogICAgICByaS5jcm9zcyhmLCByaV94X2YpOwogICAgICByai5jcm9zcyhmLCByal94X2YpOwogICAgICBib2R5QS50b3JxdWUudnN1YihyaV94X2YsIGJvZHlBLnRvcnF1ZSk7CiAgICAgIGJvZHlCLnRvcnF1ZS52YWRkKHJqX3hfZiwgYm9keUIudG9ycXVlKTsKICAgIH0KCiAgfQogIGNvbnN0IGFwcGx5Rm9yY2VfciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yX3VuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfdSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV93b3JsZEFuY2hvckIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmlfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JqX3hfZiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV90bXAgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBXaGVlbEluZm8KICAgKi8KICBjbGFzcyBXaGVlbEluZm8gewogICAgLyoqCiAgICAgKiBNYXggdHJhdmVsIGRpc3RhbmNlIG9mIHRoZSBzdXNwZW5zaW9uLCBpbiBtZXRlcnMuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNwZWVkIHRvIGFwcGx5IHRvIHRoZSB3aGVlbCByb3RhdGlvbiB3aGVuIHRoZSB3aGVlbCBpcyBzbGlkaW5nLgogICAgICogQGRlZmF1bHQgLTAuMQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCBzaG91bGQgYmUgdXNlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaWRpbmcKICAgICAqLwoKICAgIC8qKgogICAgICogQ29ubmVjdGlvbiBwb2ludCwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBjaGFzc2lzIGJvZHkgZnJhbWUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Mb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlTG9jYWwKICAgICAqLwoKICAgIC8qKgogICAgICogYXhsZVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25SZXN0TGVuZ3RoCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25NYXhMZW5ndGgKICAgICAqIEBkZWZhdWx0IDIKICAgICAqLwoKICAgIC8qKgogICAgICogcmFkaXVzCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25TdGlmZm5lc3MKICAgICAqIEBkZWZhdWx0IDEwMAogICAgICovCgogICAgLyoqCiAgICAgKiBkYW1waW5nQ29tcHJlc3Npb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdSZWxheGF0aW9uCiAgICAgKiBAZGVmYXVsdCAxMAogICAgICovCgogICAgLyoqCiAgICAgKiBmcmljdGlvblNsaXAKICAgICAqIEBkZWZhdWx0IDEwLjUKICAgICAqLwoKICAgIC8qKiBmb3J3YXJkQWNjZWxlcmF0aW9uICovCgogICAgLyoqIHNpZGVBY2NlbGVyYXRpb24gKi8KCiAgICAvKioKICAgICAqIHN0ZWVyaW5nCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIHZhbHVlLCBpbiByYWRpYW5zLgogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBkZWx0YVJvdGF0aW9uCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJvbGxJbmZsdWVuY2UKICAgICAqIEBkZWZhdWx0IDAuMDEKICAgICAqLwoKICAgIC8qKgogICAgICogbWF4U3VzcGVuc2lvbkZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGVuZ2luZUZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJyYWtlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGlzRnJvbnRXaGVlbAogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkZvcmNlCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaXBJbmZvCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNraWRJbmZvCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25MZW5ndGgKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2lkZUltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogZm9yd2FyZEltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHJlc3VsdCBmcm9tIHJheWNhc3RpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZWVsIHdvcmxkIHRyYW5zZm9ybS4KICAgICAqLwoKICAgIC8qKgogICAgICogaXNJbkNvbnRhY3QKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQogIGNvbnN0IGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCByZWxwb3MgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCiAgY2xhc3MgUmF5Y2FzdFZlaGljbGUgewogICAgLyoqIFRoZSBjYXIgY2hhc3NpcyBib2R5LiAqLwoKICAgIC8qKiBUaGUgd2hlZWxzLiAqLwoKICAgIC8qKiBXaWxsIGJlIHNldCB0byB0cnVlIGlmIHRoZSBjYXIgaXMgc2xpZGluZy4gKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHJpZ2h0IGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIGZvcndhcmQgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBJbmRleCBvZiB0aGUgdXAgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBUaGUgY29uc3RyYWludHMuICovCgogICAgLyoqIE9wdGlvbmFsIHByZS1zdGVwIGNhbGxiYWNrLiAqLwoKICAgIC8qKiBOdW1iZXIgb2Ygd2hlZWxzIG9uIHRoZSBncm91bmQuICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIHRoaXMuY2hhc3Npc0JvZHkgPSBvcHRpb25zLmNoYXNzaXNCb2R5OwogICAgICB0aGlzLndoZWVsSW5mb3MgPSBbXTsKICAgICAgdGhpcy5zbGlkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMud29ybGQgPSBudWxsOwogICAgICB0aGlzLmluZGV4UmlnaHRBeGlzID0gdHlwZW9mIG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleFJpZ2h0QXhpcyA6IDI7CiAgICAgIHRoaXMuaW5kZXhGb3J3YXJkQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4Rm9yd2FyZEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzIDogMDsKICAgICAgdGhpcy5pbmRleFVwQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4VXBBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhVcEF4aXMgOiAxOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gW107CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHt9OwoKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gMDsKICAgICAgdGhpcy5udW1XaGVlbHNPbkdyb3VuZCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHdoZWVsLiBGb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9wdGlvbnMsIHNlZSBgV2hlZWxJbmZvYC4KICAgICAqLwoKCiAgICBhZGRXaGVlbChvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzYgPSBuZXcgVmVjMygpOwogIG5ldyBSYXkoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfcmF5dmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYXN0UmF5X3RhcmdldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZGlyZWN0aW9ucyA9IFtuZXcgVmVjMygxLCAwLCAwKSwgbmV3IFZlYzMoMCwgMSwgMCksIG5ldyBWZWMzKDAsIDAsIDEpXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSBuZXcgVmVjMygpOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2F4bGUgPSBbXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9mb3J3YXJkV1MgPSBbXTsKICBjb25zdCBzaWRlRnJpY3Rpb25TdGlmZm5lc3MyID0gMTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjYWxjUm9sbGluZ0ZyaWN0aW9uKGJvZHkwLCBib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCwgbWF4SW1wdWxzZSkgewogICAgbGV0IGoxID0gMDsKICAgIGNvbnN0IGNvbnRhY3RQb3NXb3JsZCA9IGZyaWN0aW9uUG9zV29ybGQ7IC8vIGNvbnN0IHJlbF9wb3MxID0gbmV3IFZlYzMoKTsKICAgIC8vIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKCiAgICBjb25zdCB2ZWwxID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwxOwogICAgY29uc3QgdmVsMiA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMjsKICAgIGNvbnN0IHZlbCA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsOyAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MC5wb3NpdGlvbiwgcmVsX3BvczEpOwogICAgLy8gY29udGFjdFBvc1dvcmxkLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MyKTsKCiAgICBib2R5MC5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDEpOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoY29udGFjdFBvc1dvcmxkLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgdnJlbCA9IGZyaWN0aW9uRGlyZWN0aW9uV29ybGQuZG90KHZlbCk7CiAgICBjb25zdCBkZW5vbTAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHkwLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkKTsKICAgIGNvbnN0IGRlbm9tMSA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTEsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgcmVsYXhhdGlvbiA9IDE7CiAgICBjb25zdCBqYWNEaWFnQUJJbnYgPSByZWxheGF0aW9uIC8gKGRlbm9tMCArIGRlbm9tMSk7IC8vIGNhbGN1bGF0ZSBqIHRoYXQgbW92ZXMgdXMgdG8gemVybyByZWxhdGl2ZSB2ZWxvY2l0eQoKICAgIGoxID0gLXZyZWwgKiBqYWNEaWFnQUJJbnY7CgogICAgaWYgKG1heEltcHVsc2UgPCBqMSkgewogICAgICBqMSA9IG1heEltcHVsc2U7CiAgICB9CgogICAgaWYgKGoxIDwgLW1heEltcHVsc2UpIHsKICAgICAgajEgPSAtbWF4SW1wdWxzZTsKICAgIH0KCiAgICByZXR1cm4gajE7CiAgfQoKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5LCBwb3MsIG5vcm1hbCkgewogICAgY29uc3QgcjAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwOwogICAgY29uc3QgYzAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwOwogICAgY29uc3QgdmVjID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl92ZWM7CiAgICBjb25zdCBtID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tOwogICAgcG9zLnZzdWIoYm9keS5wb3NpdGlvbiwgcjApOwogICAgcjAuY3Jvc3Mobm9ybWFsLCBjMCk7CiAgICBib2R5LmludkluZXJ0aWFXb3JsZC52bXVsdChjMCwgbSk7CiAgICBtLmNyb3NzKHIwLCB2ZWMpOwogICAgcmV0dXJuIGJvZHkuaW52TWFzcyArIG5vcm1hbC5kb3QodmVjKTsKICB9CgogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbCA9IG5ldyBWZWMzKCk7IC8vIGJpbGF0ZXJhbCBjb25zdHJhaW50IGJldHdlZW4gdHdvIGR5bmFtaWMgb2JqZWN0cwoKICBmdW5jdGlvbiByZXNvbHZlU2luZ2xlQmlsYXRlcmFsKGJvZHkxLCBwb3MxLCBib2R5MiwgcG9zMiwgbm9ybWFsKSB7CiAgICBjb25zdCBub3JtYWxMZW5TcXIgPSBub3JtYWwubGVuZ3RoU3F1YXJlZCgpOwoKICAgIGlmIChub3JtYWxMZW5TcXIgPiAxLjEpIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vIGltcHVsc2UKICAgIH0gLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwogICAgLy8gcG9zMS52c3ViKGJvZHkxLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBwb3MyLnZzdWIoYm9keTIucG9zaXRpb24sIHJlbF9wb3MyKTsKCgogICAgY29uc3QgdmVsMSA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMTsKICAgIGNvbnN0IHZlbDIgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDI7CiAgICBjb25zdCB2ZWwgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDsKICAgIGJvZHkxLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHBvczEsIHZlbDEpOwogICAgYm9keTIuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMiwgdmVsMik7CiAgICB2ZWwxLnZzdWIodmVsMiwgdmVsKTsKICAgIGNvbnN0IHJlbF92ZWwgPSBub3JtYWwuZG90KHZlbCk7CiAgICBjb25zdCBjb250YWN0RGFtcGluZyA9IDAuMjsKICAgIGNvbnN0IG1hc3NUZXJtID0gMSAvIChib2R5MS5pbnZNYXNzICsgYm9keTIuaW52TWFzcyk7CiAgICBjb25zdCBpbXB1bHNlID0gLWNvbnRhY3REYW1waW5nICogcmVsX3ZlbCAqIG1hc3NUZXJtOwogICAgcmV0dXJuIGltcHVsc2U7CiAgfQoKICAvKioKICAgKiBTcGhlcmljYWwgc2hhcGUKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCByYWRpdXMgPSAxCiAgICogICAgIGNvbnN0IHNwaGVyZVNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUocmFkaXVzKQogICAqICAgICBjb25zdCBzcGhlcmVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHNwaGVyZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoc3BoZXJlQm9keSkKICAgKi8KICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMS4wOwoKICAgICAgaWYgKHRoaXMucmFkaXVzIDwgMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHNwaGVyZSByYWRpdXMgY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKiogY2FsY3VsYXRlTG9jYWxJbmVydGlhICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgSSA9IDIuMCAqIG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzIC8gNS4wOwogICAgICB0YXJnZXQueCA9IEk7CiAgICAgIHRhcmdldC55ID0gSTsKICAgICAgdGFyZ2V0LnogPSBJOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqIHZvbHVtZSAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogTWF0aC5wb3codGhpcy5yYWRpdXMsIDMpIC8gMy4wOwogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gdGhpcy5yYWRpdXM7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgciA9IHRoaXMucmFkaXVzOwogICAgICBjb25zdCBheGVzID0gWyd4JywgJ3knLCAneiddOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBheGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXggPSBheGVzW2ldOwogICAgICAgIG1pbltheF0gPSBwb3NbYXhdIC0gcjsKICAgICAgICBtYXhbYXhdID0gcG9zW2F4XSArIHI7CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMgZm9yIGNhbGN1bGF0aW9uCgogIG5ldyBWZWMzKCk7IC8vIFJlbGF0aXZlIHZlbG9jaXR5CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpIHsKICAgICAgaWYgKHJhZGl1c1RvcCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzVG9wID0gMTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzQm90dG9tID0gMTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaGVpZ2h0ID0gMTsKICAgICAgfQoKICAgICAgaWYgKG51bVNlZ21lbnRzID09PSB2b2lkIDApIHsKICAgICAgICBudW1TZWdtZW50cyA9IDg7CiAgICAgIH0KCiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQoKICAvKioKICAgKiBQYXJ0aWNsZSBzaGFwZS4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwYXJ0aWNsZVNoYXBlID0gbmV3IENBTk5PTi5QYXJ0aWNsZSgpCiAgICogICAgIGNvbnN0IHBhcnRpY2xlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBwYXJ0aWNsZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGFydGljbGVCb2R5KQogICAqLwogIGNsYXNzIFBhcnRpY2xlIGV4dGVuZHMgU2hhcGUgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QQVJUSUNMRQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSAwOwogICAgfQoKICAgIGNhbGN1bGF0ZVdvcmxkQUFCQihwb3MsIHF1YXQsIG1pbiwgbWF4KSB7CiAgICAgIC8vIEdldCBlYWNoIGF4aXMgbWF4CiAgICAgIG1pbi5jb3B5KHBvcyk7CiAgICAgIG1heC5jb3B5KHBvcyk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBwbGFuZSwgZmFjaW5nIGluIHRoZSBaIGRpcmVjdGlvbi4gVGhlIHBsYW5lIGhhcyBpdHMgc3VyZmFjZSBhdCB6PTAgYW5kIGV2ZXJ5dGhpbmcgYmVsb3cgej0wIGlzIGFzc3VtZWQgdG8gYmUgc29saWQgcGxhbmUuIFRvIG1ha2UgdGhlIHBsYW5lIGZhY2UgaW4gc29tZSBvdGhlciBkaXJlY3Rpb24gdGhhbiB6LCB5b3UgbXVzdCBwdXQgaXQgaW5zaWRlIGEgQm9keSBhbmQgcm90YXRlIHRoYXQgYm9keS4gU2VlIHRoZSBkZW1vcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwbGFuZVNoYXBlID0gbmV3IENBTk5PTi5QbGFuZSgpCiAgICogICAgIGNvbnN0IHBsYW5lQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDAsIHNoYXBlOiAgcGxhbmVTaGFwZSB9KQogICAqICAgICBwbGFuZUJvZHkucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoLU1hdGguUEkgLyAyLCAwLCAwKSAvLyBtYWtlIGl0IGZhY2UgdXAKICAgKiAgICAgd29ybGQuYWRkQm9keShwbGFuZUJvZHkpCiAgICovCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB9CiAgICAvKiogY29tcHV0ZVdvcmxkTm9ybWFsICovCgoKICAgIGNvbXB1dGVXb3JsZE5vcm1hbChxdWF0KSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLndvcmxkTm9ybWFsOwogICAgICBuLnNldCgwLCAwLCAxKTsKICAgICAgcXVhdC52bXVsdChuLCBuKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQogIGNvbnN0IHRlbXBOb3JtYWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwogIGNsYXNzIEhlaWdodGZpZWxkIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBBbiBhcnJheSBvZiBudW1iZXJzLCBvciBoZWlnaHQgdmFsdWVzLCB0aGF0IGFyZSBzcHJlYWQgb3V0IGFsb25nIHRoZSB4IGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heCB2YWx1ZSBvZiB0aGUgZGF0YSBwb2ludHMgaW4gdGhlIGRhdGEgYXJyYXkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1pbmltdW0gdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjaW5nIGJldHdlZW4gdGhlIGRhdGEgcG9pbnRzIGluIFggYW5kIFkgZGlyZWN0aW9uLgogICAgICogQHRvZG8gZWxlbWVudFNpemVYIGFuZCBZCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRhdGEgQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihkYXRhLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG9wdGlvbnMubWF4VmFsdWU7CiAgICAgIHRoaXMubWluVmFsdWUgPSBvcHRpb25zLm1pblZhbHVlOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gb3B0aW9ucy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmIChvcHRpb25zLm1pblZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNaW5WYWx1ZSgpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5tYXhWYWx1ZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMudXBkYXRlTWF4VmFsdWUoKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLnBpbGxhckNvbnZleCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOyAvLyAiaV9qX2lzVXBwZXIiID0+IHsgY29udmV4OiAuLi4sIG9mZnNldDogLi4uIH0KICAgICAgLy8gZm9yIGV4YW1wbGU6CiAgICAgIC8vIF9jYWNoZWRQaWxsYXJzWyIwXzJfMSJdCgogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0ge307CiAgICB9CiAgICAvKioKICAgICAqIENhbGwgd2hlbmV2ZXIgeW91IGNoYW5nZSB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWluVmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWluVmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtaW5WYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA8IG1pblZhbHVlKSB7CiAgICAgICAgICAgIG1pblZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWluVmFsdWUgPSBtaW5WYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWF4VmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWF4VmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtYXhWYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA+IG1heFZhbHVlKSB7CiAgICAgICAgICAgIG1heFZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWF4VmFsdWUgPSBtYXhWYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBoZWlnaHQgdmFsdWUgYXQgYW4gaW5kZXguIERvbid0IGZvcmdldCB0byB1cGRhdGUgbWF4VmFsdWUgYW5kIG1pblZhbHVlIGFmdGVyIHlvdSdyZSBkb25lLgogICAgICovCgoKICAgIHNldEhlaWdodFZhbHVlQXRJbmRleCh4aSwgeWksIHZhbHVlKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGRhdGFbeGldW3lpXSA9IHZhbHVlOyAvLyBJbnZhbGlkYXRlIGNhY2hlCgogICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBmYWxzZSk7CgogICAgICBpZiAoeGkgPiAwKSB7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIHRydWUpOwogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIGlmICh5aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSAtIDEsIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCAmJiB4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSAtIDEsIHRydWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXgvbWluIGluIGEgcmVjdGFuZ2xlIGluIHRoZSBtYXRyaXggZGF0YQogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cyBpbi4KICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCBhcnJheSwgaWYgaXQgd2FzIHBhc3NlZCBpbi4gTWluaW11bSB3aWxsIGJlIGF0IHBvc2l0aW9uIDAgYW5kIG1heCBhdCAxLgogICAgICovCgoKICAgIGdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBbXTsKICAgICAgfQoKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBsb3dlckJvdW5kLAogICAgICAgIHVwcGVyQm91bmQKICAgICAgfSA9IF9yZWY7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKICAgICAgbG93ZXJCb3VuZC5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgdXBwZXJCb3VuZC5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0pOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGhlaWdodCBpbiB0aGUgaGVpZ2h0ZmllbGQgYXQgYSBnaXZlbiBwb3NpdGlvbgogICAgICovCgoKICAgIGdldEhlaWdodEF0KHgsIHksIGVkZ2VDbGFtcCkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBhID0gZ2V0SGVpZ2h0QXRfYTsKICAgICAgY29uc3QgYiA9IGdldEhlaWdodEF0X2I7CiAgICAgIGNvbnN0IGMgPSBnZXRIZWlnaHRBdF9jOwogICAgICBjb25zdCBpZHggPSBnZXRIZWlnaHRBdF9pZHg7CiAgICAgIHRoaXMuZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIGlkeCwgZWRnZUNsYW1wKTsKICAgICAgbGV0IHhpID0gaWR4WzBdOwogICAgICBsZXQgeWkgPSBpZHhbMV07CgogICAgICBpZiAoZWRnZUNsYW1wKSB7CiAgICAgICAgeGkgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHhpKSk7CiAgICAgICAgeWkgPSBNYXRoLm1pbihkYXRhWzBdLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHlpKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHVwcGVyID0gdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBnZXRIZWlnaHRBdF93ZWlnaHRzKTsKICAgICAgY29uc3QgdyA9IGdldEhlaWdodEF0X3dlaWdodHM7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aSArIDFdW3lpICsgMV0gKiB3LnggKyBkYXRhW3hpXVt5aSArIDFdICogdy55ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcuejsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aV1beWldICogdy54ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcueSArIGRhdGFbeGldW3lpICsgMV0gKiB3Lno7CiAgICAgIH0KICAgIH0KCiAgICBnZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICByZXR1cm4gYCR7eGl9XyR7eWl9XyR7Z2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwfWA7CiAgICB9CgogICAgZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KCiAgICBzZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIGNvbnZleCwgb2Zmc2V0KSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldID0gewogICAgICAgIGNvbnZleCwKICAgICAgICBvZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBjbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBkZWxldGUgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV07CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGZyb20gdGhlIGhlaWdodGZpZWxkCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGUoeGksIHlpLCB1cHBlciwgYSwgYiwgYykgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWkgKyAxXSk7CiAgICAgICAgYi5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSk7CiAgICAgICAgYy5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgYS5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgICBiLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgICBjLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB0cmlhbmdsZSBpbiB0aGUgdGVycmFpbiBpbiB0aGUgZm9ybSBvZiBhIHRyaWFuZ3VsYXIgY29udmV4IHNoYXBlLgogICAgICovCgoKICAgIGdldENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5waWxsYXJDb252ZXg7CiAgICAgIGxldCBvZmZzZXRSZXN1bHQgPSB0aGlzLnBpbGxhck9mZnNldDsKCiAgICAgIGlmICh0aGlzLmNhY2hlRW5hYmxlZCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSk7CgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IGRhdGEuY29udmV4OwogICAgICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBkYXRhLm9mZnNldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgICAgb2Zmc2V0UmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IHJlc3VsdDsKICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IG9mZnNldFJlc3VsdDsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBmYWNlcyA9IHJlc3VsdC5mYWNlczsgLy8gUmV1c2UgdmVydHMgaWYgcG9zc2libGUKCiAgICAgIHJlc3VsdC52ZXJ0aWNlcy5sZW5ndGggPSA2OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICBpZiAoIXJlc3VsdC52ZXJ0aWNlc1tpXSkgewogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV1c2UgZmFjZXMgaWYgcG9zc2libGUKCgogICAgICBmYWNlcy5sZW5ndGggPSA1OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICBpZiAoIWZhY2VzW2ldKSB7CiAgICAgICAgICBmYWNlc1tpXSA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgdmVydHMgPSByZXN1bHQudmVydGljZXM7CiAgICAgIGNvbnN0IGggPSAoTWF0aC5taW4oZGF0YVt4aV1beWldLCBkYXRhW3hpICsgMV1beWldLCBkYXRhW3hpXVt5aSArIDFdLCBkYXRhW3hpICsgMV1beWkgKyAxXSkgLSB0aGlzLm1pblZhbHVlKSAvIDIgKyB0aGlzLm1pblZhbHVlOwoKICAgICAgaWYgKCFnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgICAgLy8gQ2VudGVyIG9mIHRoZSB0cmlhbmdsZSBwaWxsYXIgLSBhbGwgcG9seWdvbnMgYXJlIGdpdmVuIHJlbGF0aXZlIHRvIHRoaXMgb25lCiAgICAgICAgb2Zmc2V0UmVzdWx0LnNldCgoeGkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCAvLyBzb3J0IG9mIGNlbnRlciBvZiBhIHRyaWFuZ2xlCiAgICAgICAgKHlpICsgMC4yNSkgKiBlbGVtZW50U2l6ZSwgaCAvLyB2ZXJ0aWNhbCBjZW50ZXIKICAgICAgICApOyAvLyBUb3AgdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbMF0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzFdLnNldCgwLjc1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsKICAgICAgICB2ZXJ0c1syXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7IC8vIGJvdHRvbSB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1szXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIDAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIHRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAteCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMl1bMV0gPSAyOwogICAgICAgIGZhY2VzWzJdWzJdID0gNTsKICAgICAgICBmYWNlc1syXVszXSA9IDM7IC8vIC15IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMTsKICAgICAgICBmYWNlc1szXVsxXSA9IDA7CiAgICAgICAgZmFjZXNbM11bMl0gPSAzOwogICAgICAgIGZhY2VzWzNdWzNdID0gNDsgLy8gK3h5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gNDsKICAgICAgICBmYWNlc1s0XVsxXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bMl0gPSAyOwogICAgICAgIGZhY2VzWzRdWzNdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuNzUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjc1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAwLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIC0wLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIFRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAreCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMV0gPSA1OwogICAgICAgIGZhY2VzWzJdWzJdID0gMzsKICAgICAgICBmYWNlc1syXVszXSA9IDA7IC8vICt5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMzsKICAgICAgICBmYWNlc1szXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbM11bMl0gPSAxOwogICAgICAgIGZhY2VzWzNdWzNdID0gMDsgLy8gLXh5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gMTsKICAgICAgICBmYWNlc1s0XVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbNF1bMl0gPSA1OwogICAgICAgIGZhY2VzWzRdWzNdID0gMjsKICAgICAgfQoKICAgICAgcmVzdWx0LmNvbXB1dGVOb3JtYWxzKCk7CiAgICAgIHJlc3VsdC5jb21wdXRlRWRnZXMoKTsKICAgICAgcmVzdWx0LnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgIHRoaXMuc2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlLCByZXN1bHQsIG9mZnNldFJlc3VsdCk7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KICBjb25zdCBnZXRIZWlnaHRBdF9pZHggPSBbXTsKICBjb25zdCBnZXRIZWlnaHRBdF93ZWlnaHRzID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9lMCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTEgPSBuZXcgVmVjMygpOyAvLyBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0JhcnljZW50cmljX2Nvb3JkaW5hdGVfc3lzdGVtCgogIGZ1bmN0aW9uIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBheCwgYXksIGJ4LCBieSwgY3gsIGN5LCByZXN1bHQpIHsKICAgIHJlc3VsdC54ID0gKChieSAtIGN5KSAqICh4IC0gY3gpICsgKGN4IC0gYngpICogKHkgLSBjeSkpIC8gKChieSAtIGN5KSAqIChheCAtIGN4KSArIChjeCAtIGJ4KSAqIChheSAtIGN5KSk7CiAgICByZXN1bHQueSA9ICgoY3kgLSBheSkgKiAoeCAtIGN4KSArIChheCAtIGN4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnogPSAxIC0gcmVzdWx0LnggLSByZXN1bHQueTsKICB9CgogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KICBjbGFzcyBPY3RyZWVOb2RlIHsKICAgIC8qKiBUaGUgcm9vdCBub2RlICovCgogICAgLyoqIEJvdW5kYXJ5IG9mIHRoaXMgbm9kZSAqLwoKICAgIC8qKiBDb250YWluZWQgZGF0YSBhdCB0aGUgY3VycmVudCBub2RlIGxldmVsICovCgogICAgLyoqIENoaWxkcmVuIHRvIHRoaXMgbm9kZSAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJvb3QgPSBvcHRpb25zLnJvb3QgfHwgbnVsbDsKICAgICAgdGhpcy5hYWJiID0gb3B0aW9ucy5hYWJiID8gb3B0aW9ucy5hYWJiLmNsb25lKCkgOiBuZXcgQUFCQigpOwogICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiByZXNldAogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLmNoaWxkcmVuLmxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGggPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBJbnNlcnQgZGF0YSBpbnRvIHRoaXMgbm9kZQogICAgICogQHJldHVybiBUcnVlIGlmIHN1Y2Nlc3NmdWwsIG90aGVyd2lzZSBmYWxzZQogICAgICovCgoKICAgIGluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwpIHsKICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsKICAgICAgICBsZXZlbCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVEYXRhID0gdGhpcy5kYXRhOyAvLyBJZ25vcmUgb2JqZWN0cyB0aGF0IGRvIG5vdCBiZWxvbmcgaW4gdGhpcyBub2RlCgogICAgICBpZiAoIXRoaXMuYWFiYi5jb250YWlucyhhYWJiKSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gb2JqZWN0IGNhbm5vdCBiZSBhZGRlZAogICAgICB9CgogICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICAgIGNvbnN0IG1heERlcHRoID0gdGhpcy5tYXhEZXB0aCB8fCB0aGlzLnJvb3QubWF4RGVwdGg7CgogICAgICBpZiAobGV2ZWwgPCBtYXhEZXB0aCkgewogICAgICAgIC8vIFN1YmRpdmlkZSBpZiB0aGVyZSBhcmUgbm8gY2hpbGRyZW4geWV0CiAgICAgICAgbGV0IHN1YmRpdmlkZWQgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuc3ViZGl2aWRlKCk7CiAgICAgICAgICBzdWJkaXZpZGVkID0gdHJ1ZTsKICAgICAgICB9IC8vIGFkZCB0byB3aGljaGV2ZXIgbm9kZSB3aWxsIGFjY2VwdCBpdAoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLmluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwgKyAxKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdWJkaXZpZGVkKSB7CiAgICAgICAgICAvLyBObyBjaGlsZHJlbiBhY2NlcHRlZCEgTWlnaHQgYXMgd2VsbCBqdXN0IHJlbW92ZSBlbSBzaW5jZSB0aGV5IGNvbnRhaW4gbm9uZQogICAgICAgICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gVG9vIGRlZXAsIG9yIGNoaWxkcmVuIGRpZG50IHdhbnQgaXQuIGFkZCBpdCBpbiBjdXJyZW50IG5vZGUKCgogICAgICBub2RlRGF0YS5wdXNoKGVsZW1lbnREYXRhKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSA4IGVxdWFsbHkgc2l6ZWQgY2hpbGRyZW4gbm9kZXMgYW5kIHB1dCB0aGVtIGluIHRoZSBgY2hpbGRyZW5gIGFycmF5LgogICAgICovCgoKICAgIHN1YmRpdmlkZSgpIHsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjaGlsZHJlbi5wdXNoKG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDAsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMCkKICAgICAgICB9KQogICAgICB9KSk7CiAgICAgIHUudnN1YihsLCBoYWxmRGlhZ29uYWwpOwogICAgICBoYWxmRGlhZ29uYWwuc2NhbGUoMC41LCBoYWxmRGlhZ29uYWwpOwogICAgICBjb25zdCByb290ID0gdGhpcy5yb290IHx8IHRoaXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gODsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTsgLy8gU2V0IGN1cnJlbnQgbm9kZSBhcyByb290CgogICAgICAgIGNoaWxkLnJvb3QgPSByb290OyAvLyBDb21wdXRlIGJvdW5kcwoKICAgICAgICBjb25zdCBsb3dlckJvdW5kID0gY2hpbGQuYWFiYi5sb3dlckJvdW5kOwogICAgICAgIGxvd2VyQm91bmQueCAqPSBoYWxmRGlhZ29uYWwueDsKICAgICAgICBsb3dlckJvdW5kLnkgKj0gaGFsZkRpYWdvbmFsLnk7CiAgICAgICAgbG93ZXJCb3VuZC56ICo9IGhhbGZEaWFnb25hbC56OwogICAgICAgIGxvd2VyQm91bmQudmFkZChsLCBsb3dlckJvdW5kKTsgLy8gVXBwZXIgYm91bmQgaXMgYWx3YXlzIGxvd2VyIGJvdW5kICsgaGFsZkRpYWdvbmFsCgogICAgICAgIGxvd2VyQm91bmQudmFkZChoYWxmRGlhZ29uYWwsIGNoaWxkLmFhYmIudXBwZXJCb3VuZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSB3aXRoaW4gYW4gQUFCQgogICAgICogQHJldHVybiBUaGUgInJlc3VsdCIgb2JqZWN0CiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KGFhYmIsIHJlc3VsdCkgewogICAgICB0aGlzLmRhdGE7IC8vIGFib3J0IGlmIHRoZSByYW5nZSBkb2VzIG5vdCBpbnRlcnNlY3QgdGhpcyBub2RlCiAgICAgIC8vIGlmICghdGhpcy5hYWJiLm92ZXJsYXBzKGFhYmIpKXsKICAgICAgLy8gICAgIHJldHVybiByZXN1bHQ7CiAgICAgIC8vIH0KICAgICAgLy8gQWRkIG9iamVjdHMgYXQgdGhpcyBsZXZlbAogICAgICAvLyBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGVEYXRhKTsKICAgICAgLy8gQWRkIGNoaWxkIGRhdGEKICAgICAgLy8gQHRvZG8gdW53cmFwIHJlY3Vyc2lvbiBpbnRvIGEgcXVldWUgLyBsb29wLCB0aGF0J3MgZmFzdGVyIGluIEpTCgogICAgICB0aGlzLmNoaWxkcmVuOyAvLyBmb3IgKGxldCBpID0gMCwgTiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpICE9PSBOOyBpKyspIHsKICAgICAgLy8gICAgIGNoaWxkcmVuW2ldLmFhYmJRdWVyeShhYWJiLCByZXN1bHQpOwogICAgICAvLyB9CgogICAgICBjb25zdCBxdWV1ZSA9IFt0aGlzXTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7CgogICAgICAgIGlmIChub2RlLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJlc3VsdCwgbm9kZS5kYXRhKTsKICAgICAgICB9CgogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHF1ZXVlLCBub2RlLmNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSBpbnRlcnNlY3RlZCBieSBhIHJheS4KICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIHJheVF1ZXJ5KHJheSwgdHJlZVRyYW5zZm9ybSwgcmVzdWx0KSB7CiAgICAgIC8vIFVzZSBhYWJiIHF1ZXJ5IGZvciBub3cuCgogICAgICAvKiogQHRvZG8gaW1wbGVtZW50IHJlYWwgcmF5IHF1ZXJ5IHdoaWNoIG5lZWRzIGxlc3MgbG9va3VwcyAqLwogICAgICByYXkuZ2V0QUFCQih0bXBBQUJCKTsKICAgICAgdG1wQUFCQi50b0xvY2FsRnJhbWUodHJlZVRyYW5zZm9ybSwgdG1wQUFCQik7CiAgICAgIHRoaXMuYWFiYlF1ZXJ5KHRtcEFBQkIsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHJlbW92ZUVtcHR5Tm9kZXMKICAgICAqLwoKCiAgICByZW1vdmVFbXB0eU5vZGVzKCkgewogICAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVtb3ZlRW1wdHlOb2RlcygpOwoKICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uY2hpbGRyZW4ubGVuZ3RoICYmICF0aGlzLmNoaWxkcmVuW2ldLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIE9jdHJlZQogICAqLwoKCiAgY2xhc3MgT2N0cmVlIGV4dGVuZHMgT2N0cmVlTm9kZSB7CiAgICAvKioKICAgICAqIE1heGltdW0gc3ViZGl2aXNpb24gZGVwdGgKICAgICAqIEBkZWZhdWx0IDgKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGFhYmIgVGhlIHRvdGFsIEFBQkIgb2YgdGhlIHRyZWUKICAgICAqLwogICAgY29uc3RydWN0b3IoYWFiYiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KICBjb25zdCBoYWxmRGlhZ29uYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcEFBQkIgPSBuZXcgQUFCQigpOwoKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwogIGNsYXNzIFRyaW1lc2ggZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIHZlcnRpY2VzCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXJzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggdHJpYW5nbGUgY29uc2lzdHMgb2YuIFRoZSBsZW5ndGggb2YgdGhpcyBhcnJheSBpcyB0aHVzIDMgdGltZXMgdGhlIG51bWJlciBvZiB0cmlhbmdsZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBub3JtYWxzIGRhdGEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBBQUJCIG9mIHRoZSBtZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2VzIHRvIHZlcnRleCBwYWlycywgbWFraW5nIHVwIGFsbCB1bmlxdWUgZWRnZXMgaW4gdGhlIHRyaW1lc2guCiAgICAgKi8KCiAgICAvKioKICAgICAqIExvY2FsIHNjYWxpbmcgb2YgdGhlIG1lc2guIFVzZSAuc2V0U2NhbGUoKSB0byBzZXQgaXQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmRleGVkIHRyaWFuZ2xlcy4gVXNlIC51cGRhdGVUcmVlKCkgdG8gdXBkYXRlIGl0LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuVFJJTUVTSAogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBgJHthfV8ke2J9YCA6IGAke2J9XyR7YX1gOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cywgdHViZSwgcmFkaWFsU2VnbWVudHMsIHR1YnVsYXJTZWdtZW50cywgYXJjKSB7CiAgICAgIGlmIChyYWRpdXMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGl1cyA9IDE7CiAgICAgIH0KCiAgICAgIGlmICh0dWJlID09PSB2b2lkIDApIHsKICAgICAgICB0dWJlID0gMC41OwogICAgICB9CgogICAgICBpZiAocmFkaWFsU2VnbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGlhbFNlZ21lbnRzID0gODsKICAgICAgfQoKICAgICAgaWYgKHR1YnVsYXJTZWdtZW50cyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdHVidWxhclNlZ21lbnRzID0gNjsKICAgICAgfQoKICAgICAgaWYgKGFyYyA9PT0gdm9pZCAwKSB7CiAgICAgICAgYXJjID0gTWF0aC5QSSAqIDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgdSA9IGkgLyB0dWJ1bGFyU2VnbWVudHMgKiBhcmM7CiAgICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgICBjb25zdCB4ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICAgIGNvbnN0IHkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgICAgY29uc3QgeiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goeCwgeSwgeik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiBqICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgICAgY29uc3QgYyA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgICAgY29uc3QgZCA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKTsKICAgIH0KCiAgfQogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnQgZXF1YXRpb24gc29sdmVyIGJhc2UgY2xhc3MuCiAgICovCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICB9CiAgICAvKioKICAgICAqIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzIQogICAgICogQHRvZG8gdXNlIGFic3RyYWN0CiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICByZXR1cm4gKC8vIFNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIGRvbmUhCiAgICAgICAgMAogICAgICApOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICBhZGRFcXVhdGlvbihlcSkgewogICAgICBpZiAoZXEuZW5hYmxlZCAmJiAhZXEuYmkuaXNUcmlnZ2VyICYmICFlcS5iai5pc1RyaWdnZXIpIHsKICAgICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICByZW1vdmVFcXVhdGlvbihlcSkgewogICAgICBjb25zdCBlcXMgPSB0aGlzLmVxdWF0aW9uczsKICAgICAgY29uc3QgaSA9IGVxcy5pbmRleE9mKGVxKTsKCiAgICAgIGlmIChpICE9PSAtMSkgewogICAgICAgIGVxcy5zcGxpY2UoaSwgMSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkIGFsbCBlcXVhdGlvbnMKICAgICAqLwoKCiAgICByZW1vdmVBbGxFcXVhdGlvbnMoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KICBjbGFzcyBHU1NvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuCiAgICAgKiBUaGUgbW9yZSBpdGVyYXRpb25zLCB0aGUgbW9yZSBjb3JyZWN0IHNpbXVsYXRpb24uIE1vcmUgaXRlcmF0aW9ucyBuZWVkIG1vcmUgY29tcHV0YXRpb25zIHRob3VnaC4gSWYgeW91IGhhdmUgYSBsYXJnZSBncmF2aXR5IGZvcmNlIGluIHlvdXIgd29ybGQsIHlvdSB3aWxsIG5lZWQgbW9yZSBpdGVyYXRpb25zLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRvbGVyYW5jZSBpcyByZWFjaGVkLCB0aGUgc3lzdGVtIGlzIGFzc3VtZWQgdG8gYmUgY29udmVyZ2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBAdG9kbyByZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgIH0KICAgIC8qKgogICAgICogU29sdmUKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyZm9ybWVkCiAgICAgKi8KCgogICAgc29sdmUoZHQsIHdvcmxkKSB7CiAgICAgIGxldCBpdGVyID0gMDsKICAgICAgY29uc3QgbWF4SXRlciA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgdG9sU3F1YXJlZCA9IHRoaXMudG9sZXJhbmNlICogdGhpcy50b2xlcmFuY2U7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBoID0gZHQ7CiAgICAgIGxldCBCOwogICAgICBsZXQgaW52QzsKICAgICAgbGV0IGRlbHRhbGFtYmRhOwogICAgICBsZXQgZGVsdGFsYW1iZGFUb3Q7CiAgICAgIGxldCBHV2xhbWJkYTsKICAgICAgbGV0IGxhbWJkYWo7IC8vIFVwZGF0ZSBzb2x2ZSBtYXNzCgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgICAgYm9kaWVzW2ldLnVwZGF0ZVNvbHZlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gVGhpbmdzIHRoYXQgZG8gbm90IGNoYW5nZSBkdXJpbmcgaXRlcmF0aW9uIGNhbiBiZSBjb21wdXRlZCBvbmNlCgoKICAgICAgY29uc3QgaW52Q3MgPSBHU1NvbHZlcl9zb2x2ZV9pbnZDczsKICAgICAgY29uc3QgQnMgPSBHU1NvbHZlcl9zb2x2ZV9CczsKICAgICAgY29uc3QgbGFtYmRhID0gR1NTb2x2ZXJfc29sdmVfbGFtYmRhOwogICAgICBpbnZDcy5sZW5ndGggPSBOZXE7CiAgICAgIEJzLmxlbmd0aCA9IE5lcTsKICAgICAgbGFtYmRhLmxlbmd0aCA9IE5lcTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXE7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBlcXVhdGlvbnNbaV07CiAgICAgICAgbGFtYmRhW2ldID0gMC4wOwogICAgICAgIEJzW2ldID0gYy5jb21wdXRlQihoKTsKICAgICAgICBpbnZDc1tpXSA9IDEuMCAvIGMuY29tcHV0ZUMoKTsKICAgICAgfQoKICAgICAgaWYgKE5lcSAhPT0gMCkgewogICAgICAgIC8vIFJlc2V0IHZsYW1iZGEKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdmxhbWJkYSA9IGIudmxhbWJkYTsKICAgICAgICAgIGNvbnN0IHdsYW1iZGEgPSBiLndsYW1iZGE7CiAgICAgICAgICB2bGFtYmRhLnNldCgwLCAwLCAwKTsKICAgICAgICAgIHdsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgIH0gLy8gSXRlcmF0ZSBvdmVyIGVxdWF0aW9ucwoKCiAgICAgICAgZm9yIChpdGVyID0gMDsgaXRlciAhPT0gbWF4SXRlcjsgaXRlcisrKSB7CiAgICAgICAgICAvLyBBY2N1bXVsYXRlIHRoZSB0b3RhbCBlcnJvciBmb3IgZWFjaCBpdGVyYXRpb24uCiAgICAgICAgICBkZWx0YWxhbWJkYVRvdCA9IDAuMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tqXTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgICAgICAgIEIgPSBCc1tqXTsKICAgICAgICAgICAgaW52QyA9IGludkNzW2pdOwogICAgICAgICAgICBsYW1iZGFqID0gbGFtYmRhW2pdOwogICAgICAgICAgICBHV2xhbWJkYSA9IGMuY29tcHV0ZUdXbGFtYmRhKCk7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gaW52QyAqIChCIC0gR1dsYW1iZGEgLSBjLmVwcyAqIGxhbWJkYWopOyAvLyBDbGFtcCBpZiB3ZSBhcmUgbm90IHdpdGhpbiB0aGUgbWluL21heCBpbnRlcnZhbAoKICAgICAgICAgICAgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA8IGMubWluRm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWluRm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA+IGMubWF4Rm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWF4Rm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYW1iZGFbal0gKz0gZGVsdGFsYW1iZGE7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhVG90ICs9IGRlbHRhbGFtYmRhID4gMC4wID8gZGVsdGFsYW1iZGEgOiAtZGVsdGFsYW1iZGE7IC8vIGFicyhkZWx0YWxhbWJkYSkKCiAgICAgICAgICAgIGMuYWRkVG9XbGFtYmRhKGRlbHRhbGFtYmRhKTsKICAgICAgICAgIH0gLy8gSWYgdGhlIHRvdGFsIGVycm9yIGlzIHNtYWxsIGVub3VnaCAtIHN0b3AgaXRlcmF0ZQoKCiAgICAgICAgICBpZiAoZGVsdGFsYW1iZGFUb3QgKiBkZWx0YWxhbWJkYVRvdCA8IHRvbFNxdWFyZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgcmVzdWx0IHRvIHZlbG9jaXR5CgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdiA9IGIudmVsb2NpdHk7CiAgICAgICAgICBjb25zdCB3ID0gYi5hbmd1bGFyVmVsb2NpdHk7CiAgICAgICAgICBiLnZsYW1iZGEudm11bChiLmxpbmVhckZhY3RvciwgYi52bGFtYmRhKTsKICAgICAgICAgIHYudmFkZChiLnZsYW1iZGEsIHYpOwogICAgICAgICAgYi53bGFtYmRhLnZtdWwoYi5hbmd1bGFyRmFjdG9yLCBiLndsYW1iZGEpOwogICAgICAgICAgdy52YWRkKGIud2xhbWJkYSwgdyk7CiAgICAgICAgfSAvLyBTZXQgdGhlIGAubXVsdGlwbGllcmAgcHJvcGVydHkgb2YgZWFjaCBlcXVhdGlvbgoKCiAgICAgICAgbGV0IGwgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICAgIGNvbnN0IGludkR0ID0gMSAvIGg7CgogICAgICAgIHdoaWxlIChsLS0pIHsKICAgICAgICAgIGVxdWF0aW9uc1tsXS5tdWx0aXBsaWVyID0gbGFtYmRhW2xdICogaW52RHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaXRlcjsKICAgIH0KCiAgfSAvLyBKdXN0IHRlbXBvcmFyeSBudW1iZXIgaG9sZGVycyB0aGF0IHdlIHdhbnQgdG8gcmV1c2UgZWFjaCBpdGVyYXRpb24uCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKCiAgLyoqCiAgICogU3BsaXRzIHRoZSBlcXVhdGlvbnMgaW50byBpc2xhbmRzIGFuZCBzb2x2ZXMgdGhlbSBpbmRlcGVuZGVudGx5LiBDYW4gaW1wcm92ZSBwZXJmb3JtYW5jZS4KICAgKi8KICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSBzdWJzb2x2ZXI7CiAgICAgIHRoaXMubm9kZXMgPSBbXTsKICAgICAgdGhpcy5ub2RlUG9vbCA9IFtdOyAvLyBDcmVhdGUgbmVlZGVkIG5vZGVzLCByZXVzZSBpZiBwb3NzaWJsZQoKICAgICAgd2hpbGUgKHRoaXMubm9kZVBvb2wubGVuZ3RoIDwgMTI4KSB7CiAgICAgICAgdGhpcy5ub2RlUG9vbC5wdXNoKHRoaXMuY3JlYXRlTm9kZSgpKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjcmVhdGVOb2RlCiAgICAgKi8KCgogICAgY3JlYXRlTm9kZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBib2R5OiBudWxsLAogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBlcXM6IFtdLAogICAgICAgIHZpc2l0ZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIHRoZSBzdWJzeXN0ZW1zCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICBjb25zdCBub2RlcyA9IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzOwogICAgICBjb25zdCBub2RlUG9vbCA9IHRoaXMubm9kZVBvb2w7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBzdWJzb2x2ZXIgPSB0aGlzLnN1YnNvbHZlcjsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlIChub2RlUG9vbC5sZW5ndGggPCBOYm9kaWVzKSB7CiAgICAgICAgbm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KCiAgICAgIG5vZGVzLmxlbmd0aCA9IE5ib2RpZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5ib2RpZXM7IGkrKykgewogICAgICAgIG5vZGVzW2ldID0gbm9kZVBvb2xbaV07CiAgICAgIH0gLy8gUmVzZXQgbm9kZSB2YWx1ZXMKCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgICAgIG5vZGUuYm9keSA9IGJvZGllc1tpXTsKICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS5lcXMubGVuZ3RoID0gMDsKICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5lcTsgaysrKSB7CiAgICAgICAgY29uc3QgZXEgPSBlcXVhdGlvbnNba107CiAgICAgICAgY29uc3QgaSA9IGJvZGllcy5pbmRleE9mKGVxLmJpKTsKICAgICAgICBjb25zdCBqID0gYm9kaWVzLmluZGV4T2YoZXEuYmopOwogICAgICAgIGNvbnN0IG5pID0gbm9kZXNbaV07CiAgICAgICAgY29uc3QgbmogPSBub2Rlc1tqXTsKICAgICAgICBuaS5jaGlsZHJlbi5wdXNoKG5qKTsKICAgICAgICBuaS5lcXMucHVzaChlcSk7CiAgICAgICAgbmouY2hpbGRyZW4ucHVzaChuaSk7CiAgICAgICAgbmouZXFzLnB1c2goZXEpOwogICAgICB9CgogICAgICBsZXQgY2hpbGQ7CiAgICAgIGxldCBuID0gMDsKICAgICAgbGV0IGVxcyA9IFNwbGl0U29sdmVyX3NvbHZlX2VxczsKICAgICAgc3Vic29sdmVyLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlOwogICAgICBzdWJzb2x2ZXIuaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgZHVtbXlXb3JsZCA9IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQ7CgogICAgICB3aGlsZSAoY2hpbGQgPSBnZXRVbnZpc2l0ZWROb2RlKG5vZGVzKSkgewogICAgICAgIGVxcy5sZW5ndGggPSAwOwogICAgICAgIGR1bW15V29ybGQuYm9kaWVzLmxlbmd0aCA9IDA7CiAgICAgICAgYmZzKGNoaWxkLCB2aXNpdEZ1bmMsIGR1bW15V29ybGQuYm9kaWVzLCBlcXMpOwogICAgICAgIGNvbnN0IE5lcXMgPSBlcXMubGVuZ3RoOwogICAgICAgIGVxcyA9IGVxcy5zb3J0KHNvcnRCeUlkKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcXM7IGkrKykgewogICAgICAgICAgc3Vic29sdmVyLmFkZEVxdWF0aW9uKGVxc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBzdWJzb2x2ZXIuc29sdmUoZHQsIGR1bW15V29ybGQpOwogICAgICAgIHN1YnNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsKICAgICAgICBuKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICB9IC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBzdWJzeXN0ZW1zCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzID0gW107IC8vIEFsbCBhbGxvY2F0ZWQgbm9kZSBvYmplY3RzCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2VxcyA9IFtdOyAvLyBUZW1wIGFycmF5CgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQgPSB7CiAgICBib2RpZXM6IFtdCiAgfTsgLy8gVGVtcCBvYmplY3QKCiAgY29uc3QgU1RBVElDID0gQm9keS5TVEFUSUM7CgogIGZ1bmN0aW9uIGdldFVudmlzaXRlZE5vZGUobm9kZXMpIHsKICAgIGNvbnN0IE5ub2RlcyA9IG5vZGVzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTm5vZGVzOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgaWYgKCFub2RlLnZpc2l0ZWQgJiYgIShub2RlLmJvZHkudHlwZSAmIFNUQVRJQykpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IHF1ZXVlID0gW107CgogIGZ1bmN0aW9uIGJmcyhyb290LCB2aXNpdEZ1bmMsIGJkcywgZXFzKSB7CiAgICBxdWV1ZS5wdXNoKHJvb3QpOwogICAgcm9vdC52aXNpdGVkID0gdHJ1ZTsKICAgIHZpc2l0RnVuYyhyb290LCBiZHMsIGVxcyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7IC8vIExvb3Agb3ZlciB1bnZpc2l0ZWQgY2hpbGQgbm9kZXMKCiAgICAgIGxldCBjaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCA9IGdldFVudmlzaXRlZE5vZGUobm9kZS5jaGlsZHJlbikpIHsKICAgICAgICBjaGlsZC52aXNpdGVkID0gdHJ1ZTsKICAgICAgICB2aXNpdEZ1bmMoY2hpbGQsIGJkcywgZXFzKTsKICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdmlzaXRGdW5jKG5vZGUsIGJkcywgZXFzKSB7CiAgICBiZHMucHVzaChub2RlLmJvZHkpOwogICAgY29uc3QgTmVxcyA9IG5vZGUuZXFzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmVxczsgaSsrKSB7CiAgICAgIGNvbnN0IGVxID0gbm9kZS5lcXNbaV07CgogICAgICBpZiAoIWVxcy5pbmNsdWRlcyhlcSkpIHsKICAgICAgICBlcXMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvcnRCeUlkKGEsIGIpIHsKICAgIHJldHVybiBiLmlkIC0gYS5pZDsKICB9CgogIC8qKgogICAqIEZvciBwb29saW5nIG9iamVjdHMgdGhhdCBjYW4gYmUgcmV1c2VkLgogICAqLwogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuIG9iamVjdCBhZnRlciB1c2UKICAgICAqLwogICAgcmVsZWFzZSgpIHsKICAgICAgY29uc3QgTmFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChpIDwgMCB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgPyB1bmRlZmluZWQgOiBhcmd1bWVudHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIG9iamVjdAogICAgICovCgoKICAgIGdldCgpIHsKICAgICAgaWYgKHRoaXMub2JqZWN0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RPYmplY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzLnBvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBvYmplY3QuIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBlYWNoIHN1YmNsYXNzLgogICAgICovCgoKICAgIGNvbnN0cnVjdE9iamVjdCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25zdHJ1Y3RPYmplY3QoKSBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBQb29sIHN1YmNsYXNzIHlldCEnKTsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBTZWxmLCBmb3IgY2hhaW5pbmcKICAgICAqLwoKCiAgICByZXNpemUoc2l6ZSkgewogICAgICBjb25zdCBvYmplY3RzID0gdGhpcy5vYmplY3RzOwoKICAgICAgd2hpbGUgKG9iamVjdHMubGVuZ3RoID4gc2l6ZSkgewogICAgICAgIG9iamVjdHMucG9wKCk7CiAgICAgIH0KCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA8IHNpemUpIHsKICAgICAgICBvYmplY3RzLnB1c2godGhpcy5jb25zdHJ1Y3RPYmplY3QoKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CgogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgogIGNsYXNzIFZlYzNQb29sIGV4dGVuZHMgUG9vbCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhIHZlY3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMygpOwogICAgfQoKICB9CgogIC8vIE5hbWluZyBydWxlOiBiYXNlZCBvZiB0aGUgb3JkZXIgaW4gU0hBUEVfVFlQRVMsCiAgLy8gdGhlIGZpcnN0IHBhcnQgb2YgdGhlIG1ldGhvZCBpcyBmb3JtZWQgYnkgdGhlCiAgLy8gc2hhcGUgdHlwZSB0aGF0IGNvbWVzIGJlZm9yZSwgaW4gdGhlIHNlY29uZCBwYXJ0CiAgLy8gdGhlcmUgaXMgdGhlIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBhZnRlciBpbiB0aGUgU0hBUEVfVFlQRVMgbGlzdAogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwoKICAvKioKICAgKiBIZWxwZXIgY2xhc3MgZm9yIHRoZSBXb3JsZC4gR2VuZXJhdGVzIENvbnRhY3RFcXVhdGlvbnMuCiAgICogQHRvZG8gU3BoZXJlLUNvbnZleFBvbHloZWRyb24gY29udGFjdHMKICAgKiBAdG9kbyBDb250YWN0IHJlZHVjdGlvbgogICAqIEB0b2RvIHNob3VsZCBtb3ZlIG1ldGhvZHMgdG8gcHJvdG90eXBlCiAgICovCiAgY2xhc3MgTmFycm93cGhhc2UgewogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzdG9yYWdlIG9mIHBvb2xlZCBjb250YWN0IHBvaW50cy4KICAgICAqLwoKICAgIC8qKgogICAgICogUG9vbGVkIHZlY3RvcnMuCiAgICAgKi8KICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVNwaGVyZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVNwaGVyZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVBsYW5lOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEJveF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveEJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVCb3g7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhDb252ZXhdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94Q29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlSGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94SGVpZ2h0ZmllbGRdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhIZWlnaHRmaWVsZF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleEhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVBhcnRpY2xlXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94UGFydGljbGVdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmN5bGluZGVyQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVDeWxpbmRlcl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmhlaWdodGZpZWxkQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5oZWlnaHRmaWVsZEN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBhcnRpY2xlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5wYXJ0aWNsZUN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVUcmltZXNoOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lVHJpbWVzaF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lVHJpbWVzaDsKICAgIH0gLy8gZ2V0IFtDT0xMSVNJT05fVFlQRVMuY29udmV4VHJpbWVzaF0oKSB7CiAgICAvLyAgIHJldHVybiB0aGlzLmNvbnZleFRyaW1lc2gKICAgIC8vIH0KCgogICAgY29uc3RydWN0b3Iod29ybGQpIHsKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsKICAgICAgdGhpcy5yZXN1bHQgPSBbXTsKICAgICAgdGhpcy5mcmljdGlvblJlc3VsdCA9IFtdOwogICAgICB0aGlzLnYzcG9vbCA9IG5ldyBWZWMzUG9vbCgpOwogICAgICB0aGlzLndvcmxkID0gd29ybGQ7CiAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogTWFrZSBhIGNvbnRhY3Qgb2JqZWN0LCBieSB1c2luZyB0aGUgaW50ZXJuYWwgcG9vbCBvciBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgKi8KCgogICAgY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCBvdmVycmlkZVNoYXBlQSwgb3ZlcnJpZGVTaGFwZUIpIHsKICAgICAgbGV0IGM7CgogICAgICBpZiAodGhpcy5jb250YWN0UG9pbnRQb29sLmxlbmd0aCkgewogICAgICAgIGMgPSB0aGlzLmNvbnRhY3RQb2ludFBvb2wucG9wKCk7CiAgICAgICAgYy5iaSA9IGJpOwogICAgICAgIGMuYmogPSBiajsKICAgICAgfSBlbHNlIHsKICAgICAgICBjID0gbmV3IENvbnRhY3RFcXVhdGlvbihiaSwgYmopOwogICAgICB9CgogICAgICBjLmVuYWJsZWQgPSBiaS5jb2xsaXNpb25SZXNwb25zZSAmJiBiai5jb2xsaXNpb25SZXNwb25zZSAmJiBzaS5jb2xsaXNpb25SZXNwb25zZSAmJiBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgY29uc3QgY20gPSB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWw7CiAgICAgIGMucmVzdGl0dXRpb24gPSBjbS5yZXN0aXR1dGlvbjsKICAgICAgYy5zZXRTcG9va1BhcmFtcyhjbS5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MsIGNtLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24sIHRoaXMud29ybGQuZHQpOwogICAgICBjb25zdCBtYXRBID0gc2kubWF0ZXJpYWwgfHwgYmkubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzai5tYXRlcmlhbCB8fCBiai5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5yZXN0aXR1dGlvbiA+PSAwICYmIG1hdEIucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgIGMucmVzdGl0dXRpb24gPSBtYXRBLnJlc3RpdHV0aW9uICogbWF0Qi5yZXN0aXR1dGlvbjsKICAgICAgfQoKICAgICAgYy5zaSA9IG92ZXJyaWRlU2hhcGVBIHx8IHNpOwogICAgICBjLnNqID0gb3ZlcnJpZGVTaGFwZUIgfHwgc2o7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoY29udGFjdEVxdWF0aW9uLCBvdXRBcnJheSkgewogICAgICBjb25zdCBib2R5QSA9IGNvbnRhY3RFcXVhdGlvbi5iaTsKICAgICAgY29uc3QgYm9keUIgPSBjb250YWN0RXF1YXRpb24uYmo7CiAgICAgIGNvbnN0IHNoYXBlQSA9IGNvbnRhY3RFcXVhdGlvbi5zaTsKICAgICAgY29uc3Qgc2hhcGVCID0gY29udGFjdEVxdWF0aW9uLnNqOwogICAgICBjb25zdCB3b3JsZCA9IHRoaXMud29ybGQ7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOyAvLyBJZiBmcmljdGlvbiBvciByZXN0aXR1dGlvbiB3ZXJlIHNwZWNpZmllZCBpbiB0aGUgbWF0ZXJpYWwsIHVzZSB0aGVtCgogICAgICBsZXQgZnJpY3Rpb24gPSBjbS5mcmljdGlvbjsKICAgICAgY29uc3QgbWF0QSA9IHNoYXBlQS5tYXRlcmlhbCB8fCBib2R5QS5tYXRlcmlhbDsKICAgICAgY29uc3QgbWF0QiA9IHNoYXBlQi5tYXRlcmlhbCB8fCBib2R5Qi5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5mcmljdGlvbiA+PSAwICYmIG1hdEIuZnJpY3Rpb24gPj0gMCkgewogICAgICAgIGZyaWN0aW9uID0gbWF0QS5mcmljdGlvbiAqIG1hdEIuZnJpY3Rpb247CiAgICAgIH0KCiAgICAgIGlmIChmcmljdGlvbiA+IDApIHsKICAgICAgICAvLyBDcmVhdGUgMiB0YW5nZW50IGVxdWF0aW9ucwogICAgICAgIC8vIFVzZXJzIG1heSBwcm92aWRlIGEgZm9yY2UgZGlmZmVyZW50IGZyb20gZ2xvYmFsIGdyYXZpdHkgdG8gdXNlIHdoZW4gY29tcHV0aW5nIGNvbnRhY3QgZnJpY3Rpb24uCiAgICAgICAgY29uc3QgbXVnID0gZnJpY3Rpb24gKiAod29ybGQuZnJpY3Rpb25HcmF2aXR5IHx8IHdvcmxkLmdyYXZpdHkpLmxlbmd0aCgpOwogICAgICAgIGxldCByZWR1Y2VkTWFzcyA9IGJvZHlBLmludk1hc3MgKyBib2R5Qi5pbnZNYXNzOwoKICAgICAgICBpZiAocmVkdWNlZE1hc3MgPiAwKSB7CiAgICAgICAgICByZWR1Y2VkTWFzcyA9IDEgLyByZWR1Y2VkTWFzczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvb2wgPSB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sOwogICAgICAgIGNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYm9keUEsIGJvZHlCLCBtdWcgKiByZWR1Y2VkTWFzcyk7CiAgICAgICAgY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjMS5iaSA9IGMyLmJpID0gYm9keUE7CiAgICAgICAgYzEuYmogPSBjMi5iaiA9IGJvZHlCOwogICAgICAgIGMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnICogcmVkdWNlZE1hc3M7CiAgICAgICAgYzEubWF4Rm9yY2UgPSBjMi5tYXhGb3JjZSA9IG11ZyAqIHJlZHVjZWRNYXNzOyAvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKCiAgICAgICAgYzEucmkuY29weShjb250YWN0RXF1YXRpb24ucmkpOwogICAgICAgIGMxLnJqLmNvcHkoY29udGFjdEVxdWF0aW9uLnJqKTsKICAgICAgICBjMi5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzIucmouY29weShjb250YWN0RXF1YXRpb24ucmopOyAvLyBDb25zdHJ1Y3QgdGFuZ2VudHMKCiAgICAgICAgY29udGFjdEVxdWF0aW9uLm5pLnRhbmdlbnRzKGMxLnQsIGMyLnQpOyAvLyBTZXQgc3Bvb2sgcGFyYW1zCgogICAgICAgIGMxLnNldFNwb29rUGFyYW1zKGNtLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MsIGNtLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uLCB3b3JsZC5kdCk7CiAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMS5lbmFibGVkID0gYzIuZW5hYmxlZCA9IGNvbnRhY3RFcXVhdGlvbi5lbmFibGVkOwogICAgICAgIG91dEFycmF5LnB1c2goYzEsIGMyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBUYWtlIHRoZSBhdmVyYWdlIE4gbGF0ZXN0IGNvbnRhY3QgcG9pbnQgb24gdGhlIHBsYW5lLgogICAgICovCgoKICAgIGNyZWF0ZUZyaWN0aW9uRnJvbUF2ZXJhZ2UobnVtQ29udGFjdHMpIHsKICAgICAgLy8gVGhlIGxhc3QgY29udGFjdEVxdWF0aW9uCiAgICAgIGxldCBjID0gdGhpcy5yZXN1bHRbdGhpcy5yZXN1bHQubGVuZ3RoIC0gMV07IC8vIENyZWF0ZSB0aGUgcmVzdWx0OiB0d28gImF2ZXJhZ2UiIGZyaWN0aW9uIGVxdWF0aW9ucwoKICAgICAgaWYgKCF0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoYywgdGhpcy5mcmljdGlvblJlc3VsdCkgfHwgbnVtQ29udGFjdHMgPT09IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGYxID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDJdOwogICAgICBjb25zdCBmMiA9IHRoaXMuZnJpY3Rpb25SZXN1bHRbdGhpcy5mcmljdGlvblJlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgYXZlcmFnZU5vcm1hbC5zZXRaZXJvKCk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEIuc2V0WmVybygpOwogICAgICBjb25zdCBib2R5QSA9IGMuYmk7CiAgICAgIGMuYmo7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbnVtQ29udGFjdHM7IGkrKykgewogICAgICAgIGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxIC0gaV07CgogICAgICAgIGlmIChjLmJpICE9PSBib2R5QSkgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52YWRkKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJpLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52c3ViKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJqLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGludk51bUNvbnRhY3RzID0gMSAvIG51bUNvbnRhY3RzOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmkpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmopOwogICAgICBmMi5yaS5jb3B5KGYxLnJpKTsgLy8gU2hvdWxkIGJlIHRoZSBzYW1lCgogICAgICBmMi5yai5jb3B5KGYxLnJqKTsKICAgICAgYXZlcmFnZU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgYXZlcmFnZU5vcm1hbC50YW5nZW50cyhmMS50LCBmMi50KTsgLy8gcmV0dXJuIGVxOwogICAgfQogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBhbGwgY29udGFjdHMgYmV0d2VlbiBhIGxpc3Qgb2YgYm9keSBwYWlycwogICAgICogQHBhcmFtIHAxIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHAyIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHJlc3VsdCBBcnJheSB0byBzdG9yZSBnZW5lcmF0ZWQgY29udGFjdHMKICAgICAqIEBwYXJhbSBvbGRjb250YWN0cyBPcHRpb25hbC4gQXJyYXkgb2YgcmV1c2FibGUgY29udGFjdCBvYmplY3RzCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdHMocDEsIHAyLCB3b3JsZCwgcmVzdWx0LCBvbGRjb250YWN0cywgZnJpY3Rpb25SZXN1bHQsIGZyaWN0aW9uUG9vbCkgewogICAgICAvLyBTYXZlIG9sZCBjb250YWN0IG9iamVjdHMKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gb2xkY29udGFjdHM7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBmcmljdGlvblBvb2w7CiAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0OwogICAgICB0aGlzLmZyaWN0aW9uUmVzdWx0ID0gZnJpY3Rpb25SZXN1bHQ7CiAgICAgIGNvbnN0IHFpID0gdG1wUXVhdDE7CiAgICAgIGNvbnN0IHFqID0gdG1wUXVhdDI7CiAgICAgIGNvbnN0IHhpID0gdG1wVmVjMTsKICAgICAgY29uc3QgeGogPSB0bXBWZWMyOwoKICAgICAgZm9yIChsZXQgayA9IDAsIE4gPSBwMS5sZW5ndGg7IGsgIT09IE47IGsrKykgewogICAgICAgIC8vIEdldCBjdXJyZW50IGNvbGxpc2lvbiBib2RpZXMKICAgICAgICBjb25zdCBiaSA9IHAxW2tdOwogICAgICAgIGNvbnN0IGJqID0gcDJba107IC8vIEdldCBjb250YWN0IG1hdGVyaWFsCgogICAgICAgIGxldCBib2R5Q29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBib2R5Q29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKGJpLm1hdGVyaWFsLCBiai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGp1c3RUZXN0ID0gYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LlNUQVRJQyB8fCBiaS50eXBlICYgQm9keS5TVEFUSUMgJiYgYmoudHlwZSAmIEJvZHkuS0lORU1BVElDIHx8IGJpLnR5cGUgJiBCb2R5LktJTkVNQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmkuc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBiaS5xdWF0ZXJuaW9uLm11bHQoYmkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICAgIGJpLnF1YXRlcm5pb24udm11bHQoYmkuc2hhcGVPZmZzZXRzW2ldLCB4aSk7CiAgICAgICAgICB4aS52YWRkKGJpLnBvc2l0aW9uLCB4aSk7CiAgICAgICAgICBjb25zdCBzaSA9IGJpLnNoYXBlc1tpXTsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJqLnNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAvLyBDb21wdXRlIHdvcmxkIHRyYW5zZm9ybSBvZiBzaGFwZXMKICAgICAgICAgICAgYmoucXVhdGVybmlvbi5tdWx0KGJqLnNoYXBlT3JpZW50YXRpb25zW2pdLCBxaik7CiAgICAgICAgICAgIGJqLnF1YXRlcm5pb24udm11bHQoYmouc2hhcGVPZmZzZXRzW2pdLCB4aik7CiAgICAgICAgICAgIHhqLnZhZGQoYmoucG9zaXRpb24sIHhqKTsKICAgICAgICAgICAgY29uc3Qgc2ogPSBiai5zaGFwZXNbal07CgogICAgICAgICAgICBpZiAoIShzaS5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2ouY29sbGlzaW9uRmlsdGVyR3JvdXAgJiYgc2ouY29sbGlzaW9uRmlsdGVyTWFzayAmIHNpLmNvbGxpc2lvbkZpbHRlckdyb3VwKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gR2V0IGNvbGxpc2lvbiBtYXRlcmlhbAoKCiAgICAgICAgICAgIGxldCBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IG51bGw7CgogICAgICAgICAgICBpZiAoc2kubWF0ZXJpYWwgJiYgc2oubWF0ZXJpYWwpIHsKICAgICAgICAgICAgICBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmdldENvbnRhY3RNYXRlcmlhbChzaS5tYXRlcmlhbCwgc2oubWF0ZXJpYWwpIHx8IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHNoYXBlQ29udGFjdE1hdGVyaWFsIHx8IGJvZHlDb250YWN0TWF0ZXJpYWwgfHwgd29ybGQuZGVmYXVsdENvbnRhY3RNYXRlcmlhbDsgLy8gR2V0IGNvbnRhY3RzCgogICAgICAgICAgICBjb25zdCByZXNvbHZlckluZGV4ID0gc2kudHlwZSB8IHNqLnR5cGU7CiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gdGhpc1tyZXNvbHZlckluZGV4XTsKCiAgICAgICAgICAgIGlmIChyZXNvbHZlcikgewogICAgICAgICAgICAgIGxldCByZXR2YWwgPSBmYWxzZTsgLy8gVE8gRE86IGludmVzdGlnYXRlIHdoeSBzcGhlcmVQYXJ0aWNsZSBhbmQgY29udmV4UGFydGljbGUKICAgICAgICAgICAgICAvLyByZXNvbHZlcnMgZXhwZWN0IHNpIGFuZCBzaiBzaGFwZXMgdG8gYmUgaW4gcmV2ZXJzZSBvcmRlcgogICAgICAgICAgICAgIC8vIChpLmUuIGxhcmdlciBpbnRlZ2VyIHZhbHVlIHR5cGUgZmlyc3QgaW5zdGVhZCBvZiBzbWFsbGVyIGZpcnN0KQoKICAgICAgICAgICAgICBpZiAoc2kudHlwZSA8IHNqLnR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHZhbCA9IHJlc29sdmVyLmNhbGwodGhpcywgc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJldHZhbCAmJiBqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgb3ZlcmxhcAogICAgICAgICAgICAgICAgd29ybGQuc2hhcGVPdmVybGFwS2VlcGVyLnNldChzaS5pZCwgc2ouaWQpOwogICAgICAgICAgICAgICAgd29ybGQuYm9keU92ZXJsYXBLZWVwZXIuc2V0KGJpLmlkLCBiai5pZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlU3BoZXJlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgIHJldHVybiB4aS5kaXN0YW5jZVNxdWFyZWQoeGopIDwgKHNpLnJhZGl1cyArIHNqLnJhZGl1cykgKiogMjsKICAgICAgfSAvLyBXZSB3aWxsIGhhdmUgb25seSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKCgogICAgICBjb25zdCBjb250YWN0RXEgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgeGoudnN1Yih4aSwgY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLm5pLm5vcm1hbGl6ZSgpOyAvLyBDb250YWN0IHBvaW50IGxvY2F0aW9ucwoKICAgICAgY29udGFjdEVxLnJpLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJqLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJpLnNjYWxlKHNpLnJhZGl1cywgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnNjYWxlKC1zai5yYWRpdXMsIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yaS52YWRkKHhpLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmkudnN1YihiaS5wb3NpdGlvbiwgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnZhZGQoeGosIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yai52c3ViKGJqLnBvc2l0aW9uLCBjb250YWN0RXEucmopOwogICAgICB0aGlzLnJlc3VsdC5wdXNoKGNvbnRhY3RFcSk7CiAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjb250YWN0RXEsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgfQoKICAgIHNwaGVyZVBsYW5lKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICByLm5pLnNldCgwLCAwLCAxKTsKICAgICAgcWoudm11bHQoci5uaSwgci5uaSk7CiAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBib2R5IGkgaXMgdGhlIHNwaGVyZSwgZmxpcCBub3JtYWwKCiAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIE5lZWRlZD8KICAgICAgLy8gVmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0IHBvaW50CgogICAgICByLm5pLnNjYWxlKHNpLnJhZGl1cywgci5yaSk7IC8vIFByb2plY3QgZG93biBzcGhlcmUgb24gcGxhbmUKCiAgICAgIHhpLnZzdWIoeGosIHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSk7CiAgICAgIHIubmkuc2NhbGUoci5uaS5kb3QocG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKSwgcGxhbmVfdG9fc3BoZXJlX29ydGhvKTsKICAgICAgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLnZzdWIocGxhbmVfdG9fc3BoZXJlX29ydGhvLCByLnJqKTsgLy8gVGhlIHNwaGVyZSBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gcGxhbmUKCiAgICAgIGlmICgtcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLmRvdChyLm5pKSA8PSBzaS5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKCiAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgIGNvbnN0IHJqID0gci5yajsKICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICBib3hCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOyAvLyB3ZSByZWZlciB0byB0aGUgYm94IGFzIGJvZHkgagoKICAgICAgY29uc3Qgc2lkZXMgPSBzcGhlcmVCb3hfc2lkZXM7CiAgICAgIHhpLnZzdWIoeGosIGJveF90b19zcGhlcmUpOwogICAgICBzai5nZXRTaWRlTm9ybWFscyhzaWRlcywgcWopOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOwoKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7IC8vIFN0b3JlIHRoZSByZXN1bHRpbmcgc2lkZSBwZW5ldHJhdGlvbiBpbmZvCgogICAgICBjb25zdCBzaWRlX25zID0gc3BoZXJlQm94X3NpZGVfbnM7CiAgICAgIGNvbnN0IHNpZGVfbnMxID0gc3BoZXJlQm94X3NpZGVfbnMxOwogICAgICBjb25zdCBzaWRlX25zMiA9IHNwaGVyZUJveF9zaWRlX25zMjsKICAgICAgbGV0IHNpZGVfaCA9IG51bGw7CiAgICAgIGxldCBzaWRlX3BlbmV0cmF0aW9ucyA9IDA7CiAgICAgIGxldCBzaWRlX2RvdDEgPSAwOwogICAgICBsZXQgc2lkZV9kb3QyID0gMDsKICAgICAgbGV0IHNpZGVfZGlzdGFuY2UgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaWR4ID0gMCwgbnNpZGVzID0gc2lkZXMubGVuZ3RoOyBpZHggIT09IG5zaWRlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGlkeCsrKSB7CiAgICAgICAgLy8gR2V0IHRoZSBwbGFuZSBzaWRlIG5vcm1hbCAobnMpCiAgICAgICAgY29uc3QgbnMgPSBzcGhlcmVCb3hfbnM7CiAgICAgICAgbnMuY29weShzaWRlc1tpZHhdKTsKICAgICAgICBjb25zdCBoID0gbnMubGVuZ3RoKCk7CiAgICAgICAgbnMubm9ybWFsaXplKCk7IC8vIFRoZSBub3JtYWwvZGlzdGFuY2UgZG90IHByb2R1Y3QgdGVsbHMgd2hpY2ggc2lkZSBvZiB0aGUgcGxhbmUgd2UgYXJlCgogICAgICAgIGNvbnN0IGRvdCA9IGJveF90b19zcGhlcmUuZG90KG5zKTsKCiAgICAgICAgaWYgKGRvdCA8IGggKyBSICYmIGRvdCA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayB0aGUgb3RoZXIgdHdvIGRpbWVuc2lvbnMKICAgICAgICAgIGNvbnN0IG5zMSA9IHNwaGVyZUJveF9uczE7CiAgICAgICAgICBjb25zdCBuczIgPSBzcGhlcmVCb3hfbnMyOwogICAgICAgICAgbnMxLmNvcHkoc2lkZXNbKGlkeCArIDEpICUgM10pOwogICAgICAgICAgbnMyLmNvcHkoc2lkZXNbKGlkeCArIDIpICUgM10pOwogICAgICAgICAgY29uc3QgaDEgPSBuczEubGVuZ3RoKCk7CiAgICAgICAgICBjb25zdCBoMiA9IG5zMi5sZW5ndGgoKTsKICAgICAgICAgIG5zMS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5zMi5ub3JtYWxpemUoKTsKICAgICAgICAgIGNvbnN0IGRvdDEgPSBib3hfdG9fc3BoZXJlLmRvdChuczEpOwogICAgICAgICAgY29uc3QgZG90MiA9IGJveF90b19zcGhlcmUuZG90KG5zMik7CgogICAgICAgICAgaWYgKGRvdDEgPCBoMSAmJiBkb3QxID4gLWgxICYmIGRvdDIgPCBoMiAmJiBkb3QyID4gLWgyKSB7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmFicyhkb3QgLSBoIC0gUik7CgogICAgICAgICAgICBpZiAoc2lkZV9kaXN0YW5jZSA9PT0gbnVsbCB8fCBkaXN0IDwgc2lkZV9kaXN0YW5jZSkgewogICAgICAgICAgICAgIHNpZGVfZGlzdGFuY2UgPSBkaXN0OwogICAgICAgICAgICAgIHNpZGVfZG90MSA9IGRvdDE7CiAgICAgICAgICAgICAgc2lkZV9kb3QyID0gZG90MjsKICAgICAgICAgICAgICBzaWRlX2ggPSBoOwogICAgICAgICAgICAgIHNpZGVfbnMuY29weShucyk7CiAgICAgICAgICAgICAgc2lkZV9uczEuY29weShuczEpOwogICAgICAgICAgICAgIHNpZGVfbnMyLmNvcHkobnMyKTsKICAgICAgICAgICAgICBzaWRlX3BlbmV0cmF0aW9ucysrOwoKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNpZGVfcGVuZXRyYXRpb25zKSB7CiAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHNpZGVfbnMuc2NhbGUoLVIsIHIucmkpOyAvLyBTcGhlcmUgcgoKICAgICAgICByLm5pLmNvcHkoc2lkZV9ucyk7CiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBzaG91bGQgYmUgb3V0IG9mIHNwaGVyZQoKICAgICAgICBzaWRlX25zLnNjYWxlKHNpZGVfaCwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczEuc2NhbGUoc2lkZV9kb3QxLCBzaWRlX25zMSk7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMxLCBzaWRlX25zKTsKICAgICAgICBzaWRlX25zMi5zY2FsZShzaWRlX2RvdDIsIHNpZGVfbnMyKTsKICAgICAgICBzaWRlX25zLnZhZGQoc2lkZV9uczIsIHIucmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9IC8vIENoZWNrIGNvcm5lcnMKCgogICAgICBsZXQgcmogPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVCb3hfc3BoZXJlX3RvX2Nvcm5lcjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSAyICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IDIgJiYgIWZvdW5kOyBrKyspIHsKICAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsICE9PSAyICYmICFmb3VuZDsgbCsrKSB7CiAgICAgICAgICAgIHJqLnNldCgwLCAwLCAwKTsKCiAgICAgICAgICAgIGlmIChqKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1swXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGspIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzFdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobCkgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMl0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gLy8gV29ybGQgcG9zaXRpb24gb2YgY29ybmVyCgoKICAgICAgICAgICAgeGoudmFkZChyaiwgc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICAgIHNwaGVyZV90b19jb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICAgIHIucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICAgICAgci5yai5jb3B5KHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UocmopOwogICAgICByaiA9IG51bGw7IC8vIENoZWNrIGVkZ2VzCgogICAgICBjb25zdCBlZGdlVGFuZ2VudCA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgZWRnZUNlbnRlciA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgciA9IHYzcG9vbC5nZXQoKTsgLy8gciA9IGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIKCiAgICAgIGNvbnN0IG9ydGhvZ29uYWwgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGRpc3QgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IE5zaWRlcyA9IHNpZGVzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOc2lkZXMgJiYgIWZvdW5kOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayAhPT0gTnNpZGVzICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBpZiAoaiAlIDMgIT09IGsgJSAzKSB7CiAgICAgICAgICAgIC8vIEdldCBlZGdlIHRhbmdlbnQKICAgICAgICAgICAgc2lkZXNba10uY3Jvc3Moc2lkZXNbal0sIGVkZ2VUYW5nZW50KTsKICAgICAgICAgICAgZWRnZVRhbmdlbnQubm9ybWFsaXplKCk7CiAgICAgICAgICAgIHNpZGVzW2pdLnZhZGQoc2lkZXNba10sIGVkZ2VDZW50ZXIpOwogICAgICAgICAgICByLmNvcHkoeGkpOwogICAgICAgICAgICByLnZzdWIoZWRnZUNlbnRlciwgcik7CiAgICAgICAgICAgIHIudnN1Yih4aiwgcik7CiAgICAgICAgICAgIGNvbnN0IG9ydGhvbm9ybSA9IHIuZG90KGVkZ2VUYW5nZW50KTsgLy8gZGlzdGFuY2UgZnJvbSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyIGluIHRoZSB0YW5nZW50IGRpcmVjdGlvbgoKICAgICAgICAgICAgZWRnZVRhbmdlbnQuc2NhbGUob3J0aG9ub3JtLCBvcnRob2dvbmFsKTsgLy8gVmVjdG9yIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KICAgICAgICAgICAgLy8gRmluZCB0aGUgdGhpcmQgc2lkZSBvcnRob2dvbmFsIHRvIHRoaXMgb25lCgogICAgICAgICAgICBsZXQgbCA9IDA7CgogICAgICAgICAgICB3aGlsZSAobCA9PT0gaiAlIDMgfHwgbCA9PT0gayAlIDMpIHsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0gLy8gdmVjIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIHByb2plY3RlZCB0byB0aGUgcGxhbmUgb3J0aG9nb25hbCB0byB0aGUgZWRnZSB0YW5nZW50CgoKICAgICAgICAgICAgZGlzdC5jb3B5KHhpKTsKICAgICAgICAgICAgZGlzdC52c3ViKG9ydGhvZ29uYWwsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoZWRnZUNlbnRlciwgZGlzdCk7CiAgICAgICAgICAgIGRpc3QudnN1Yih4aiwgZGlzdCk7IC8vIERpc3RhbmNlcyBpbiB0YW5nZW50IGRpcmVjdGlvbiBhbmQgZGlzdGFuY2UgaW4gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gaXQKCiAgICAgICAgICAgIGNvbnN0IHRkaXN0ID0gTWF0aC5hYnMob3J0aG9ub3JtKTsKICAgICAgICAgICAgY29uc3QgbmRpc3QgPSBkaXN0Lmxlbmd0aCgpOwoKICAgICAgICAgICAgaWYgKHRkaXN0IDwgc2lkZXNbbF0ubGVuZ3RoKCkgJiYgbmRpc3QgPCBSKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zdCByZXMgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIGVkZ2VDZW50ZXIudmFkZChvcnRob2dvbmFsLCByZXMucmopOyAvLyBib3ggcmoKCiAgICAgICAgICAgICAgcmVzLnJqLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICBkaXN0Lm5lZ2F0ZShyZXMubmkpOwogICAgICAgICAgICAgIHJlcy5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuY29weShyZXMucmopOwogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhqLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuc2NhbGUoUiwgcmVzLnJpKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgcmVzLnJpLnZhZGQoeGksIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJpLnZzdWIoYmkucG9zaXRpb24sIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJqLnZhZGQoeGosIHJlcy5yaik7CiAgICAgICAgICAgICAgcmVzLnJqLnZzdWIoYmoucG9zaXRpb24sIHJlcy5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyZXMpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyZXMsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2M3Bvb2wucmVsZWFzZShlZGdlVGFuZ2VudCwgZWRnZUNlbnRlciwgciwgb3J0aG9nb25hbCwgZGlzdCk7CiAgICB9CgogICAgcGxhbmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNqLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uaWQgPSBzai5pZDsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXgoc2ksIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4Q29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBzZXBBeGlzID0gY29udmV4Q29udmV4X3NlcEF4aXM7CgogICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoc2kuZmluZFNlcGFyYXRpbmdBeGlzKHNqLCB4aSwgcWksIHhqLCBxaiwgc2VwQXhpcywgZmFjZUxpc3RBLCBmYWNlTGlzdEIpKSB7CiAgICAgICAgY29uc3QgcmVzID0gW107CiAgICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgICAgIHNpLmNsaXBBZ2FpbnN0SHVsbCh4aSwgcWksIHNqLCB4aiwgcWosIHNlcEF4aXMsIC0xMDAsIDEwMCwgcmVzKTsKICAgICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gcmVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7CiAgICAgICAgICBzZXBBeGlzLm5lZ2F0ZShyLm5pKTsKICAgICAgICAgIHJlc1tqXS5ub3JtYWwubmVnYXRlKHEpOwogICAgICAgICAgcS5zY2FsZShyZXNbal0uZGVwdGgsIHEpOwogICAgICAgICAgcmVzW2pdLnBvaW50LnZhZGQocSwgcmkpOwogICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOyAvLyBDb250YWN0IHBvaW50cyBhcmUgaW4gd29ybGQgY29vcmRpbmF0ZXMuIFRyYW5zZm9ybSBiYWNrIHRvIHJlbGF0aXZlCgogICAgICAgICAgcmkudnN1Yih4aSwgcmkpOwogICAgICAgICAgcmoudnN1Yih4aiwgcmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICAgIHJpLnZzdWIoYmkucG9zaXRpb24sIHJpKTsKICAgICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7CiAgICAgIHhpLnZzdWIoeGosIGNvbnZleF90b19zcGhlcmUpOwogICAgICBjb25zdCBub3JtYWxzID0gc2ouZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IGZhY2VzID0gc2ouZmFjZXM7CiAgICAgIGNvbnN0IHZlcnRzID0gc2oudmVydGljZXM7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIC8vICAgICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBDaGVjayBjb3JuZXJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKICAgICAgICBjb25zdCB3b3JsZENvcm5lciA9IHNwaGVyZUNvbnZleF93b3JsZENvcm5lcjsKICAgICAgICBxai52bXVsdCh2LCB3b3JsZENvcm5lcik7CiAgICAgICAgeGoudmFkZCh3b3JsZENvcm5lciwgd29ybGRDb3JuZXIpOwogICAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Db3JuZXI7CiAgICAgICAgd29ybGRDb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgIGlmIChzcGhlcmVfdG9fY29ybmVyLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICByLnJpLmNvcHkoc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgci5yaS5zY2FsZShSLCByLnJpKTsKICAgICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGosIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIHNpZGUgKHBsYW5lKSBpbnRlcnNlY3Rpb25zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIG5mYWNlcyA9IGZhY2VzLmxlbmd0aDsgaSAhPT0gbmZhY2VzICYmIGZvdW5kID09PSBmYWxzZTsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9ybWFsID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07IC8vIEdldCB3b3JsZC10cmFuc2Zvcm1lZCBub3JtYWwgb2YgdGhlIGZhY2UKCiAgICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBzcGhlcmVDb252ZXhfd29ybGROb3JtYWw7CiAgICAgICAgcWoudm11bHQobm9ybWFsLCB3b3JsZE5vcm1hbCk7IC8vIEdldCBhIHdvcmxkIHZlcnRleCBmcm9tIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkUG9pbnQgPSBzcGhlcmVDb252ZXhfd29ybGRQb2ludDsKICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWzBdXSwgd29ybGRQb2ludCk7CiAgICAgICAgd29ybGRQb2ludC52YWRkKHhqLCB3b3JsZFBvaW50KTsgLy8gR2V0IGEgcG9pbnQgb24gdGhlIHNwaGVyZSwgY2xvc2VzdCB0byB0aGUgZmFjZSBub3JtYWwKCiAgICAgICAgY29uc3Qgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gc3BoZXJlQ29udmV4X3dvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZTsKICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsKICAgICAgICB4aS52YWRkKHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsgLy8gVmVjdG9yIGZyb20gYSBmYWNlIHBvaW50IHRvIHRoZSBjbG9zZXN0IHBvaW50IG9uIHRoZSBzcGhlcmUKCiAgICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWM7CiAgICAgICAgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lLnZzdWIod29ybGRQb2ludCwgcGVuZXRyYXRpb25WZWMpOyAvLyBUaGUgcGVuZXRyYXRpb24uIE5lZ2F0aXZlIHZhbHVlIG1lYW5zIG92ZXJsYXAuCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb25WZWMuZG90KHdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCB3b3JsZFBvaW50VG9TcGhlcmUgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Xb3JsZFBvaW50OwogICAgICAgIHhpLnZzdWIod29ybGRQb2ludCwgd29ybGRQb2ludFRvU3BoZXJlKTsKCiAgICAgICAgaWYgKHBlbmV0cmF0aW9uIDwgMCAmJiB3b3JsZFBvaW50VG9TcGhlcmUuZG90KHdvcmxkTm9ybWFsKSA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayBpZiB0aGUgc3BoZXJlIGlzIGluc2lkZSB0aGUgZmFjZSBwb2x5Z29uCiAgICAgICAgICBjb25zdCBmYWNlVmVydHMgPSBbXTsgLy8gRmFjZSB2ZXJ0aWNlcywgaW4gd29ybGQgY29vcmRzCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE52ZXJ0cyA9IGZhY2UubGVuZ3RoOyBqICE9PSBOdmVydHM7IGorKykgewogICAgICAgICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVtqXV0sIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgeGoudmFkZCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgICAgICBmYWNlVmVydHMucHVzaCh3b3JsZFZlcnRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHBvaW50SW5Qb2x5Z29uKGZhY2VWZXJ0cywgd29ybGROb3JtYWwsIHhpKSkgewogICAgICAgICAgICAvLyBJcyB0aGUgc3BoZXJlIGNlbnRlciBpbiB0aGUgZmFjZSBwb2x5Z29uPwogICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHIucmkpOyAvLyBDb250YWN0IG9mZnNldCwgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QKCiAgICAgICAgICAgIHdvcmxkTm9ybWFsLm5lZ2F0ZShyLm5pKTsgLy8gTm9ybWFsIHBvaW50aW5nIG91dCBvZiBzcGhlcmUKCiAgICAgICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjMiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLXBlbmV0cmF0aW9uLCBwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblNwaGVyZVBvaW50ID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgcGVuZXRyYXRpb25TcGhlcmVQb2ludCk7IC8veGkudnN1Yih4aikudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50KS52YWRkKHBlbmV0cmF0aW9uVmVjMiAsIHIucmopOwoKICAgICAgICAgICAgeGkudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50LCByLnJqKTsKICAgICAgICAgICAgci5yai52YWRkKHBlbmV0cmF0aW9uVmVjMiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uVmVjMik7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOwogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOyAvLyBXZSBvbmx5IGV4cGVjdCAqb25lKiBmYWNlIGNvbnRhY3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVkZ2U/CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBmYWNlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHR3byB3b3JsZCB0cmFuc2Zvcm1lZCB2ZXJ0aWNlcwogICAgICAgICAgICAgIGNvbnN0IHYxID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYyID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2VbKGogKyAxKSAlIGZhY2UubGVuZ3RoXV0sIHYxKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMikgJSBmYWNlLmxlbmd0aF1dLCB2Mik7CiAgICAgICAgICAgICAgeGoudmFkZCh2MSwgdjEpOwogICAgICAgICAgICAgIHhqLnZhZGQodjIsIHYyKTsgLy8gQ29uc3RydWN0IGVkZ2UgdmVjdG9yCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSBzcGhlcmVDb252ZXhfZWRnZTsKICAgICAgICAgICAgICB2Mi52c3ViKHYxLCBlZGdlKTsgLy8gQ29uc3RydWN0IHRoZSBzYW1lIHZlY3RvciwgYnV0IG5vcm1hbGl6ZWQKCiAgICAgICAgICAgICAgY29uc3QgZWRnZVVuaXQgPSBzcGhlcmVDb252ZXhfZWRnZVVuaXQ7CiAgICAgICAgICAgICAgZWRnZS51bml0KGVkZ2VVbml0KTsgLy8gcCBpcyB4aSBwcm9qZWN0ZWQgb250byB0aGUgZWRnZQoKICAgICAgICAgICAgICBjb25zdCBwID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYxX3RvX3hpID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHhpLnZzdWIodjEsIHYxX3RvX3hpKTsKICAgICAgICAgICAgICBjb25zdCBkb3QgPSB2MV90b194aS5kb3QoZWRnZVVuaXQpOwogICAgICAgICAgICAgIGVkZ2VVbml0LnNjYWxlKGRvdCwgcCk7CiAgICAgICAgICAgICAgcC52YWRkKHYxLCBwKTsgLy8gQ29tcHV0ZSBhIHZlY3RvciBmcm9tIHAgdG8gdGhlIGNlbnRlciBvZiB0aGUgc3BoZXJlCgogICAgICAgICAgICAgIGNvbnN0IHhpX3RvX3AgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgICAgcC52c3ViKHhpLCB4aV90b19wKTsgLy8gQ29sbGlzaW9uIGlmIHRoZSBlZGdlLXNwaGVyZSBkaXN0YW5jZSBpcyBsZXNzIHRoYW4gdGhlIHJhZGl1cwogICAgICAgICAgICAgIC8vIEFORCBpZiBwIGlzIGluIGJldHdlZW4gdjEgYW5kIHYyCgogICAgICAgICAgICAgIGlmIChkb3QgPiAwICYmIGRvdCAqIGRvdCA8IGVkZ2UubGVuZ3RoU3F1YXJlZCgpICYmIHhpX3RvX3AubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICAgIC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAgIC8vIEVkZ2UgY29udGFjdCEKICAgICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICAgIHAudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGksIHIubmkpOwogICAgICAgICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICAgIHIubmkuc2NhbGUoUiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsgLy8gUmVsZWFzZSB3b3JsZCB2ZXJ0aWNlcwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjEpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh4aV90b19wKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2Mik7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjFfdG9feGkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5mYWNldmVydHMgPSBmYWNlVmVydHMubGVuZ3RoOyBqICE9PSBOZmFjZXZlcnRzOyBqKyspIHsKICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwbGFuZUNvbnZleChwbGFuZVNoYXBlLCBjb252ZXhTaGFwZSwgcGxhbmVQb3NpdGlvbiwgY29udmV4UG9zaXRpb24sIHBsYW5lUXVhdCwgY29udmV4UXVhdCwgcGxhbmVCb2R5LCBjb252ZXhCb2R5LCBzaSwgc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFNpbXBseSByZXR1cm4gdGhlIHBvaW50cyBiZWhpbmQgdGhlIHBsYW5lLgogICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHBsYW5lQ29udmV4X3Y7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gcGxhbmVDb252ZXhfbm9ybWFsOwogICAgICB3b3JsZE5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdCh3b3JsZE5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGxldCBudW1Db250YWN0cyA9IDA7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lQ29udmV4X3JlbHBvczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBjb252ZXhTaGFwZS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEdldCB3b3JsZCBjb252ZXggdmVydGV4CiAgICAgICAgd29ybGRWZXJ0ZXguY29weShjb252ZXhTaGFwZS52ZXJ0aWNlc1tpXSk7CiAgICAgICAgY29udmV4UXVhdC52bXVsdCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnZleFBvc2l0aW9uLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICB3b3JsZFZlcnRleC52c3ViKHBsYW5lUG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY29uc3QgZG90ID0gd29ybGROb3JtYWwuZG90KHJlbHBvcyk7CgogICAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKHBsYW5lQm9keSwgY29udmV4Qm9keSwgcGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHNpLCBzaik7IC8vIEdldCB2ZXJ0ZXggcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgY29uc3QgcHJvamVjdGVkID0gcGxhbmVDb252ZXhfcHJvamVjdGVkOwogICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUod29ybGROb3JtYWwuZG90KHJlbHBvcyksIHByb2plY3RlZCk7CiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsKICAgICAgICAgIHByb2plY3RlZC52c3ViKHBsYW5lUG9zaXRpb24sIHIucmkpOyAvLyBGcm9tIHBsYW5lIHRvIHZlcnRleCBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICByLm5pLmNvcHkod29ybGROb3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsIG91dCBmcm9tIHBsYW5lCiAgICAgICAgICAvLyByaiBpcyBub3cganVzdCB0aGUgdmVjdG9yIGZyb20gdGhlIGNvbnZleCBjZW50ZXIgdG8gdGhlIHZlcnRleAoKICAgICAgICAgIHdvcmxkVmVydGV4LnZzdWIoY29udmV4UG9zaXRpb24sIHIucmopOyAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgogICAgICAgICAgci5yaS52YWRkKHBsYW5lUG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHBsYW5lQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICByLnJqLnZhZGQoY29udmV4UG9zaXRpb24sIHIucmopOwogICAgICAgICAgci5yai52c3ViKGNvbnZleEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIG51bUNvbnRhY3RzKys7CgogICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uICYmIG51bUNvbnRhY3RzKSB7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgfQogICAgfQoKICAgIGJveENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2kuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVIZWlnaHRmaWVsZChzcGhlcmVTaGFwZSwgaGZTaGFwZSwgc3BoZXJlUG9zLCBoZlBvcywgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCByYWRpdXMgPSBzcGhlcmVTaGFwZS5yYWRpdXM7CiAgICAgIGNvbnN0IHcgPSBoZlNoYXBlLmVsZW1lbnRTaXplOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDI7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbFNwaGVyZVBvcyA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBzcGhlcmVQb3MsIGxvY2FsU3BoZXJlUG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbFNwaGVyZVBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbFNwaGVyZVBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UgY2FuJ3QgdG91Y2ggdGhlIGJvdW5kaW5nIGhlaWdodCBib3gKCiAgICAgIGlmIChsb2NhbFNwaGVyZVBvcy56IC0gcmFkaXVzID4gbWF4IHx8IGxvY2FsU3BoZXJlUG9zLnogKyByYWRpdXMgPCBtaW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0OwoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGNvbnN0IG51bUNvbnRhY3RzQmVmb3JlID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBudW1Db250YWN0cyA9IHJlc3VsdC5sZW5ndGggLSBudW1Db250YWN0c0JlZm9yZTsKCiAgICAgICAgICBpZiAobnVtQ29udGFjdHMgPiAyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8qCiAgICAgICAgICAgIC8vIFNraXAgYWxsIGJ1dCAxCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbnVtQ29udGFjdHMgLSAxOyBrKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgKi8KCiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYm94SGVpZ2h0ZmllbGQoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3QgcmFkaXVzID0gY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CiAgICAgIGNvbnN0IHdvcmxkUGlsbGFyT2Zmc2V0ID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMjsKICAgICAgY29uc3QgZmFjZUxpc3QgPSBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdDsgLy8gR2V0IHNwaGVyZSBwb3NpdGlvbiB0byBoZWlnaHRmaWVsZCBsb2NhbCEKCiAgICAgIGNvbnN0IGxvY2FsQ29udmV4UG9zID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKGhmUG9zLCBoZlF1YXQsIGNvbnZleFBvcywgbG9jYWxDb252ZXhQb3MpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGxldCBpTWluWCA9IE1hdGguZmxvb3IoKGxvY2FsQ29udmV4UG9zLnggLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFggPSBNYXRoLmNlaWwoKGxvY2FsQ29udmV4UG9zLnggKyByYWRpdXMpIC8gdykgKyAxOwogICAgICBsZXQgaU1pblkgPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy55IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhZID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy55ICsgcmFkaXVzKSAvIHcpICsgMTsgLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKICAgICAgaWYgKGlNYXhYIDwgMCB8fCBpTWF4WSA8IDAgfHwgaU1pblggPiBkYXRhLmxlbmd0aCB8fCBpTWluWSA+IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCgoKICAgICAgaWYgKGlNaW5YIDwgMCkgewogICAgICAgIGlNaW5YID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYIDwgMCkgewogICAgICAgIGlNYXhYID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZIDwgMCkgewogICAgICAgIGlNaW5ZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZIDwgMCkgewogICAgICAgIGlNYXhZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5YID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1pblggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNYXhYID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWF4WSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1pblkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pbk1heCA9IFtdOwogICAgICBoZlNoYXBlLmdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIG1pbk1heCk7CiAgICAgIGNvbnN0IG1pbiA9IG1pbk1heFswXTsKICAgICAgY29uc3QgbWF4ID0gbWluTWF4WzFdOyAvLyBCYWlsIG91dCBpZiB3ZSdyZSBjYW50IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxDb252ZXhQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbENvbnZleFBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgbGV0IGludGVyc2VjdGluZyA9IGZhbHNlOyAvLyBMb3dlciB0cmlhbmdsZQoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgZmFsc2UpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSAvLyBVcHBlciB0cmlhbmdsZQoKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIHRydWUpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNwaGVyZVBhcnRpY2xlKHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFRoZSBub3JtYWwgaXMgdGhlIHVuaXQgdmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBwYXJ0aWNsZSBjZW50ZXIKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVTcGhlcmVfbm9ybWFsOwogICAgICBub3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICB4aS52c3ViKHhqLCBub3JtYWwpOwogICAgICBjb25zdCBsZW5ndGhTcXVhcmVkID0gbm9ybWFsLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgIGlmIChsZW5ndGhTcXVhcmVkIDw9IHNqLnJhZGl1cyAqIHNqLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgci5yai5jb3B5KG5vcm1hbCk7CiAgICAgICAgci5yai5zY2FsZShzai5yYWRpdXMsIHIucmopOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCgogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgcGxhbmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBub3JtYWwgPSBwYXJ0aWNsZVBsYW5lX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgYmoucXVhdGVybmlvbi52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZSBvcmllbnRhdGlvbgoKICAgICAgY29uc3QgcmVscG9zID0gcGFydGljbGVQbGFuZV9yZWxwb3M7CiAgICAgIHhpLnZzdWIoYmoucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsCgogICAgICAgIHIubmkubmVnYXRlKHIubmkpOwogICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKICAgICAgICAvLyBHZXQgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBhcnRpY2xlUGxhbmVfcHJvamVjdGVkOwogICAgICAgIG5vcm1hbC5zY2FsZShub3JtYWwuZG90KHhpKSwgcHJvamVjdGVkKTsKICAgICAgICB4aS52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsgLy9wcm9qZWN0ZWQudmFkZChiai5wb3NpdGlvbixwcm9qZWN0ZWQpOwogICAgICAgIC8vIHJqIGlzIG5vdyB0aGUgcHJvamVjdGVkIHdvcmxkIHBvc2l0aW9uIG1pbnVzIHBsYW5lIHBvc2l0aW9uCgogICAgICAgIHIucmouY29weShwcm9qZWN0ZWQpOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgYm94UGFydGljbGUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBsZXQgcGVuZXRyYXRlZEZhY2VJbmRleCA9IC0xOwogICAgICBjb25zdCBwZW5ldHJhdGVkRmFjZU5vcm1hbCA9IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsOwogICAgICBjb25zdCB3b3JsZFBlbmV0cmF0aW9uVmVjID0gY29udmV4UGFydGljbGVfd29ybGRQZW5ldHJhdGlvblZlYzsKICAgICAgbGV0IG1pblBlbmV0cmF0aW9uID0gbnVsbDsKCiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQogIGNvbnN0IGF2ZXJhZ2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGF2ZXJhZ2VDb250YWN0UG9pbnRBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdDEgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHRtcFF1YXQyID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92MiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2VkZ2VWZWN0b3JVbml0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2xvY2FsU3BoZXJlUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdHJpYW5nbGVzID0gW107CiAgY29uc3QgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZV90b19zcGhlcmVfb3J0aG8gPSBuZXcgVmVjMygpOyAvLyBTZWUgaHR0cDovL2J1bGxldHBoeXNpY3MuY29tL0J1bGxldC9CdWxsZXRGdWxsL1NwaGVyZVRyaWFuZ2xlRGV0ZWN0b3JfOGNwcF9zb3VyY2UuaHRtbAoKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl92dHAgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBwb2ludEluUG9seWdvbih2ZXJ0cywgbm9ybWFsLCBwKSB7CiAgICBsZXQgcG9zaXRpdmVSZXN1bHQgPSBudWxsOwogICAgY29uc3QgTiA9IHZlcnRzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsgLy8gR2V0IGVkZ2UgdG8gdGhlIG5leHQgdmVydGV4CgogICAgICBjb25zdCBlZGdlID0gcG9pbnRJblBvbHlnb25fZWRnZTsKICAgICAgdmVydHNbKGkgKyAxKSAlIE5dLnZzdWIodiwgZWRnZSk7IC8vIEdldCBjcm9zcyBwcm9kdWN0IGJldHdlZW4gcG9seWdvbiBub3JtYWwgYW5kIHRoZSBlZGdlCgogICAgICBjb25zdCBlZGdlX3hfbm9ybWFsID0gcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbDsgLy9jb25zdCBlZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKCiAgICAgIGVkZ2UuY3Jvc3Mobm9ybWFsLCBlZGdlX3hfbm9ybWFsKTsgLy8gR2V0IHZlY3RvciBiZXR3ZWVuIHBvaW50IGFuZCBjdXJyZW50IHZlcnRleAoKICAgICAgY29uc3QgdmVydGV4X3RvX3AgPSBwb2ludEluUG9seWdvbl92dHA7CiAgICAgIHAudnN1Yih2LCB2ZXJ0ZXhfdG9fcCk7IC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgY29uc3QgciA9IGVkZ2VfeF9ub3JtYWwuZG90KHZlcnRleF90b19wKTsgLy8gSWYgYWxsIHN1Y2ggZG90IHByb2R1Y3RzIGhhdmUgc2FtZSBzaWduLCB3ZSBhcmUgaW5zaWRlIHRoZSBwb2x5Z29uLgoKICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsIHx8IHIgPiAwICYmIHBvc2l0aXZlUmVzdWx0ID09PSB0cnVlIHx8IHIgPD0gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICBpZiAocG9zaXRpdmVSZXN1bHQgPT09IG51bGwpIHsKICAgICAgICAgIHBvc2l0aXZlUmVzdWx0ID0gciA+IDA7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEVuY291bnRlcmVkIHNvbWUgb3RoZXIgc2lnbi4gRXhpdC4KICAgICAgfQogICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgY29uc3QgYm94X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZXMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgY29uc3Qgc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X2VkZ2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZE5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9wZW5ldHJhdGlvblZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX2ZhY2VMaXN0ID0gWzBdOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwoKICBjbGFzcyBPdmVybGFwS2VlcGVyIHsKICAgIC8qKgogICAgICogQHRvZG8gUmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KCiAgY29uc3QgZ2V0S2V5ID0gKGksIGopID0+IGkgPCBqID8gYCR7aX0tJHtqfWAgOiBgJHtqfS0ke2l9YDsKICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CgogICAgLyoqIGdldCAqLwogICAgZ2V0KGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBjb25zdCBrZXkgPSBnZXRLZXkoaSwgaik7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiBkZWxldGUgKi8KCgogICAgZGVsZXRlKGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YS5rZXlzLmluZGV4T2Yoa2V5KTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmRhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogcmVzZXQgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGtleXMgPSBkYXRhLmtleXM7CgogICAgICB3aGlsZSAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5wb3AoKTsKICAgICAgICBkZWxldGUgZGF0YVtrZXldOwogICAgICB9CiAgICB9CgogIH0KCiAgLyoqCiAgICogVGhlIHBoeXNpY3Mgd29ybGQKICAgKi8KICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBHcmF2aXR5IHRvIHVzZSB3aGVuIGFwcHJveGltYXRpbmcgdGhlIGZyaWN0aW9uIG1heCBmb3JjZSAobXUqbWFzcypncmF2aXR5KS4KICAgICAqIElmIHVuZGVmaW5lZCwgZ2xvYmFsIGdyYXZpdHkgd2lsbCBiZSB1c2VkLgogICAgICogVXNlIHRvIGVuYWJsZSBmcmljdGlvbiBpbiBhIFdvcmxkIHdpdGggYSBudWxsIGdyYXZpdHkgdmVjdG9yIChubyBncmF2aXR5KS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGJyb2FkcGhhc2UgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IE5haXZlQnJvYWRwaGFzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYm9kaWVzIGluIHRoaXMgd29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogVHJ1ZSBpZiBhbnkgYm9kaWVzIGFyZSBub3Qgc2xlZXBpbmcsIGZhbHNlIGlmIGV2ZXJ5IGJvZHkgaXMgc2xlZXBpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBzb2x2ZXIgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IEdTU29sdmVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbk1hdHJpeAogICAgICovCgogICAgLyoqCiAgICAgKiBDb2xsaXNpb25NYXRyaXggZnJvbSB0aGUgcHJldmlvdXMgc3RlcC4KICAgICAqLwoKICAgIC8qKgogICAgICogQWxsIGFkZGVkIGNvbnRhY3RtYXRlcmlhbHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgdG8gbG9vayB1cCBhIENvbnRhY3RNYXRlcmlhbCBnaXZlbiB0d28gaW5zdGFuY2VzIG9mIE1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBtYXRlcmlhbCBvZiB0aGUgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGlzIGNvbnRhY3QgbWF0ZXJpYWwgaXMgdXNlZCBpZiBubyBzdWl0YWJsZSBjb250YWN0bWF0ZXJpYWwgaXMgZm91bmQgZm9yIGEgY29udGFjdC4KICAgICAqLwoKICAgIC8qKgogICAgICogVGltZSBhY2N1bXVsYXRvciBmb3IgaW50ZXJwb2xhdGlvbi4KICAgICAqIEBzZWUgaHR0cHM6Ly9nYWZmZXJvbmdhbWVzLmNvbS9nYW1lLXBoeXNpY3MvZml4LXlvdXItdGltZXN0ZXAvCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcigpOwogICAgICB0aGlzLmR0ID0gLTE7CiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9ICEhb3B0aW9ucy5hbGxvd1NsZWVwOwogICAgICB0aGlzLmNvbnRhY3RzID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMgPSBbXTsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplU2tpcCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgOiAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCA6IGZhbHNlOwogICAgICB0aGlzLnRpbWUgPSAwLjA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IDA7CiAgICAgIHRoaXMuZGVmYXVsdF9kdCA9IDEgLyA2MDsKICAgICAgdGhpcy5uZXh0SWQgPSAwOwogICAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMuZ3Jhdml0eSkgewogICAgICAgIHRoaXMuZ3Jhdml0eS5jb3B5KG9wdGlvbnMuZ3Jhdml0eSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmZyaWN0aW9uR3Jhdml0eSkgewogICAgICAgIHRoaXMuZnJpY3Rpb25HcmF2aXR5ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmZyaWN0aW9uR3Jhdml0eS5jb3B5KG9wdGlvbnMuZnJpY3Rpb25HcmF2aXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5icm9hZHBoYXNlID0gb3B0aW9ucy5icm9hZHBoYXNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJyb2FkcGhhc2UgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICAgIHRoaXMuYm9kaWVzID0gW107CiAgICAgIHRoaXMuaGFzQWN0aXZlQm9kaWVzID0gZmFsc2U7CiAgICAgIHRoaXMuc29sdmVyID0gb3B0aW9ucy5zb2x2ZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc29sdmVyIDogbmV3IEdTU29sdmVyKCk7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSBbXTsKICAgICAgdGhpcy5uYXJyb3dwaGFzZSA9IG5ldyBOYXJyb3dwaGFzZSh0aGlzKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSBuZXcgQXJyYXlDb2xsaXNpb25NYXRyaXgoKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gbmV3IE92ZXJsYXBLZWVwZXIoKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLmNvbnRhY3RtYXRlcmlhbHMgPSBbXTsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IG5ldyBUdXBsZURpY3Rpb25hcnkoKTsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoJ2RlZmF1bHQnKTsKICAgICAgdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbCh0aGlzLmRlZmF1bHRNYXRlcmlhbCwgdGhpcy5kZWZhdWx0TWF0ZXJpYWwsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjAKICAgICAgfSk7CiAgICAgIHRoaXMuZG9Qcm9maWxpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wcm9maWxlID0gewogICAgICAgIHNvbHZlOiAwLAogICAgICAgIG1ha2VDb250YWN0Q29uc3RyYWludHM6IDAsCiAgICAgICAgYnJvYWRwaGFzZTogMCwKICAgICAgICBpbnRlZ3JhdGU6IDAsCiAgICAgICAgbmFycm93cGhhc2U6IDAKICAgICAgfTsKICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7CiAgICAgIHRoaXMuc3Vic3lzdGVtcyA9IFtdOwogICAgICB0aGlzLmFkZEJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAnYWRkQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAncmVtb3ZlQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwID0ge307CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5zZXRXb3JsZCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb250YWN0IG1hdGVyaWFsIGJldHdlZW4gbWF0ZXJpYWxzIG0xIGFuZCBtMgogICAgICogQHJldHVybiBUaGUgY29udGFjdCBtYXRlcmlhbCBpZiBpdCB3YXMgZm91bmQuCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdE1hdGVyaWFsKG0xLCBtMikgewogICAgICByZXR1cm4gdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5nZXQobTEuaWQsIG0yLmlkKTsKICAgIH0KICAgIC8qKgogICAgICogU3RvcmUgb2xkIGNvbGxpc2lvbiBzdGF0ZSBpbmZvCiAgICAgKi8KCgogICAgY29sbGlzaW9uTWF0cml4VGljaygpIHsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXM7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSB0aGlzLmNvbGxpc2lvbk1hdHJpeDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSB0ZW1wOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5yZXNldCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyLnRpY2soKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBjb25zdHJhaW50IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIGFkZENvbnN0cmFpbnQoYykgewogICAgICB0aGlzLmNvbnN0cmFpbnRzLnB1c2goYyk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYSBjb25zdHJhaW50CiAgICAgKi8KCgogICAgcmVtb3ZlQ29uc3RyYWludChjKSB7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMuY29uc3RyYWludHMuaW5kZXhPZihjKTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5jb25zdHJhaW50cy5zcGxpY2UoaWR4LCAxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXljYXN0IHRlc3QKICAgICAqIEBkZXByZWNhdGVkIFVzZSAucmF5Y2FzdEFsbCwgLnJheWNhc3RDbG9zZXN0IG9yIC5yYXljYXN0QW55IGluc3RlYWQuCiAgICAgKi8KCgogICAgcmF5VGVzdChmcm9tLCB0bywgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSYXljYXN0UmVzdWx0KSB7CiAgICAgICAgLy8gRG8gcmF5Y2FzdENsb3Nlc3QKICAgICAgICB0aGlzLnJheWNhc3RDbG9zZXN0KGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBEbyByYXljYXN0QWxsCiAgICAgICAgdGhpcy5yYXljYXN0QWxsKGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCBhZ2FpbnN0IGFsbCBib2RpZXMuIFRoZSBwcm92aWRlZCBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGhpdCB3aXRoIGEgUmF5Y2FzdFJlc3VsdCBhcyBzaW5nbGUgYXJndW1lbnQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QWxsKGZyb20sIHRvLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQUxMOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRtcFJheS5pbnRlcnNlY3RXb3JsZCh0aGlzLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKgogICAgICogUmF5IGNhc3QsIGFuZCBzdG9wIGF0IHRoZSBmaXJzdCByZXN1bHQuIE5vdGUgdGhhdCB0aGUgb3JkZXIgaXMgcmFuZG9tIC0gYnV0IHRoZSBtZXRob2QgaXMgZmFzdC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbnkoZnJvbSwgdG8sIG9wdGlvbnMsIHJlc3VsdCkgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucywgcmVzdWx0KSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMubW9kZSA9IFJheS5DTE9TRVNUOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSByaWdpZCBib2R5IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICogQHRvZG8gSWYgdGhlIHNpbXVsYXRpb24gaGFzIG5vdCB5ZXQgc3RhcnRlZCwgd2h5IHJlY3JldGUgYW5kIGNvcHkgYXJyYXlzIGZvciBlYWNoIGJvZHk/IEFjY3VtdWxhdGUgaW4gZHluYW1pYyBhcnJheXMgaW4gdGhpcyBjYXNlLgogICAgICogQHRvZG8gQWRkaW5nIGFuIGFycmF5IG9mIGJvZGllcyBzaG91bGQgYmUgcG9zc2libGUuIFRoaXMgd291bGQgc2F2ZSBzb21lIGxvb3BzIHRvbwogICAgICovCgoKICAgIGFkZEJvZHkoYm9keSkgewogICAgICBpZiAodGhpcy5ib2RpZXMuaW5jbHVkZXMoYm9keSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGJvZHkuaW5kZXggPSB0aGlzLmJvZGllcy5sZW5ndGg7CiAgICAgIHRoaXMuYm9kaWVzLnB1c2goYm9keSk7CiAgICAgIGJvZHkud29ybGQgPSB0aGlzOwogICAgICBib2R5LmluaXRQb3NpdGlvbi5jb3B5KGJvZHkucG9zaXRpb24pOwogICAgICBib2R5LmluaXRWZWxvY2l0eS5jb3B5KGJvZHkudmVsb2NpdHkpOwogICAgICBib2R5LnRpbWVMYXN0U2xlZXB5ID0gdGhpcy50aW1lOwoKICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBCb2R5KSB7CiAgICAgICAgYm9keS5pbml0QW5ndWxhclZlbG9jaXR5LmNvcHkoYm9keS5hbmd1bGFyVmVsb2NpdHkpOwogICAgICAgIGJvZHkuaW5pdFF1YXRlcm5pb24uY29weShib2R5LnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKHRoaXMuYm9kaWVzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdID0gYm9keTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuYWRkQm9keUV2ZW50KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGEgcmlnaWQgYm9keSBmcm9tIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIHJlbW92ZUJvZHkoYm9keSkgewogICAgICBib2R5LndvcmxkID0gbnVsbDsKICAgICAgY29uc3QgbiA9IHRoaXMuYm9kaWVzLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwogICAgICBjb25zdCBpZHggPSBib2RpZXMuaW5kZXhPZihib2R5KTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgYm9kaWVzLnNwbGljZShpZHgsIDEpOyAvLyBUb2RvOiBzaG91bGQgdXNlIGEgZ2FyYmFnZSBmcmVlIG1ldGhvZAogICAgICAgIC8vIFJlY29tcHV0ZSBpbmRleAoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0uaW5kZXggPSBpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXguc2V0TnVtT2JqZWN0cyhuKTsKICAgICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudC5ib2R5ID0gYm9keTsKICAgICAgICBkZWxldGUgdGhpcy5pZFRvQm9keU1hcFtib2R5LmlkXTsKICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5yZW1vdmVCb2R5RXZlbnQpOwogICAgICB9CiAgICB9CgogICAgZ2V0Qm9keUJ5SWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRUb0JvZHlNYXBbaWRdOwogICAgfQogICAgLyoqCiAgICAgKiBAdG9kbyBNYWtlIGEgZmFzdGVyIG1hcAogICAgICovCgoKICAgIGdldFNoYXBlQnlJZChpZCkgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVzID0gYm9kaWVzW2ldLnNoYXBlczsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGFwZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2pdOwoKICAgICAgICAgIGlmIChzaGFwZS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnRhY3QgbWF0ZXJpYWwgZnJvbSB0aGUgV29ybGQuCiAgICAgKi8KCgogICAgcmVtb3ZlQ29udGFjdE1hdGVyaWFsKGNtYXQpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb250YWN0bWF0ZXJpYWxzLmluZGV4T2YoY21hdCk7CgogICAgICBpZiAoaWR4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmRlbGV0ZShjbWF0Lm1hdGVyaWFsc1swXS5pZCwgY21hdC5tYXRlcmlhbHNbMV0uaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBTdGVwIHRoZSBzaW11bGF0aW9uIGZvcndhcmQga2VlcGluZyB0cmFjayBvZiBsYXN0IGNhbGxlZCB0aW1lCiAgICAgKiB0byBiZSBhYmxlIHRvIHN0ZXAgdGhlIHdvcmxkIGF0IGEgZml4ZWQgcmF0ZSwgaW5kZXBlbmRlbnRseSBvZiBmcmFtZXJhdGUuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UgKGRlZmF1bHQ6IDEgLyA2MCkuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbCAoZGVmYXVsdDogMTApLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL3Bvc3QvZml4X3lvdXJfdGltZXN0ZXAvCiAgICAgKiBAZXhhbXBsZQogICAgICogICAgIC8vIFJ1biB0aGUgc2ltdWxhdGlvbiBpbmRlcGVuZGVudGx5IG9mIGZyYW1lcmF0ZSBldmVyeSAxIC8gNjAgbXMKICAgICAqICAgICB3b3JsZC5maXhlZFN0ZXAoKQogICAgICovCgoKICAgIGZpeGVkU3RlcChkdCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKGR0ID09PSB2b2lkIDApIHsKICAgICAgICBkdCA9IDEgLyA2MDsKICAgICAgfQoKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOyAvLyBzZWNvbmRzCgogICAgICBpZiAoIXRoaXMubGFzdENhbGxUaW1lKSB7CiAgICAgICAgdGhpcy5zdGVwKGR0LCB1bmRlZmluZWQsIG1heFN1YlN0ZXBzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0Q2FsbGVkID0gdGltZSAtIHRoaXMubGFzdENhbGxUaW1lOwogICAgICAgIHRoaXMuc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgICB9CgogICAgICB0aGlzLmxhc3RDYWxsVGltZSA9IHRpbWU7CiAgICB9CiAgICAvKioKICAgICAqIFN0ZXAgdGhlIHBoeXNpY3Mgd29ybGQgZm9yd2FyZCBpbiB0aW1lLgogICAgICoKICAgICAqIFRoZXJlIGFyZSB0d28gbW9kZXMuIFRoZSBzaW1wbGUgbW9kZSBpcyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uLiBJbiB0aGlzIGNhc2UgeW91IG9ubHkgdXNlIHRoZSBmaXJzdCBhcmd1bWVudC4gVGhlIHNlY29uZCBjYXNlIHVzZXMgaW50ZXJwb2xhdGlvbi4gSW4gdGhhdCB5b3UgYWxzbyBwcm92aWRlIHRoZSB0aW1lIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCB1c2VkLCBhcyB3ZWxsIGFzIHRoZSBtYXhpbXVtIGZpeGVkIHRpbWVzdGVwcyB0byB0YWtlLgogICAgICoKICAgICAqIEBwYXJhbSBkdCBUaGUgZml4ZWQgdGltZSBzdGVwIHNpemUgdG8gdXNlLgogICAgICogQHBhcmFtIHRpbWVTaW5jZUxhc3RDYWxsZWQgVGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGUgZnVuY3Rpb24gd2FzIGxhc3QgY2FsbGVkLgogICAgICogQHBhcmFtIG1heFN1YlN0ZXBzIE1heGltdW0gbnVtYmVyIG9mIGZpeGVkIHN0ZXBzIHRvIHRha2UgcGVyIGZ1bmN0aW9uIGNhbGwgKGRlZmF1bHQ6IDEwKS4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgIGxldCBzdWJzdGVwcyA9IDA7CgogICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IGR0ICYmIHN1YnN0ZXBzIDwgbWF4U3ViU3RlcHMpIHsKICAgICAgICAgIC8vIERvIGZpeGVkIHN0ZXBzIHRvIGNhdGNoIHVwCiAgICAgICAgICB0aGlzLmludGVybmFsU3RlcChkdCk7CiAgICAgICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IGR0OwogICAgICAgICAgc3Vic3RlcHMrKzsKCiAgICAgICAgICBpZiAocGVyZm9ybWFuY2Uubm93KCkgLSB0MCA+IGR0ICogMTAwMCkgewogICAgICAgICAgICAvLyBUaGUgZnJhbWVyYXRlIGlzIG5vdCBpbnRlcmFjdGl2ZSBhbnltb3JlLgogICAgICAgICAgICAvLyBXZSBhcmUgYmVsb3cgdGhlIHRhcmdldCBmcmFtZXJhdGUuCiAgICAgICAgICAgIC8vIEJldHRlciBiYWlsIG91dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgdGhlIGV4Y2VzcyBhY2N1bXVsYXRvciwgc2luY2Ugd2UgbWF5IG5vdAogICAgICAgIC8vIGhhdmUgaGFkIGVub3VnaCBzdWJzdGVwcyBhdmFpbGFibGUgdG8gY2F0Y2ggdXAKCgogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSB0aGlzLmFjY3VtdWxhdG9yICUgZHQ7CiAgICAgICAgY29uc3QgdCA9IHRoaXMuYWNjdW11bGF0b3IgLyBkdDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHRoaXMuYm9kaWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBiID0gdGhpcy5ib2RpZXNbal07CiAgICAgICAgICBiLnByZXZpb3VzUG9zaXRpb24ubGVycChiLnBvc2l0aW9uLCB0LCBiLmludGVycG9sYXRlZFBvc2l0aW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLnNsZXJwKGIucXVhdGVybmlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lICs9IHRpbWVTaW5jZUxhc3RDYWxsZWQ7CiAgICAgIH0KICAgIH0KCiAgICBpbnRlcm5hbFN0ZXAoZHQpIHsKICAgICAgdGhpcy5kdCA9IGR0OwogICAgICBjb25zdCBjb250YWN0cyA9IHRoaXMuY29udGFjdHM7CiAgICAgIGNvbnN0IHAxID0gV29ybGRfc3RlcF9wMTsKICAgICAgY29uc3QgcDIgPSBXb3JsZF9zdGVwX3AyOwogICAgICBjb25zdCBOID0gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgfSAvLyBBZGQgZ3Jhdml0eSB0byBhbGwgb2JqZWN0cwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkudHlwZSA9PT0gRFlOQU1JQykgewogICAgICAgICAgLy8gT25seSBmb3IgZHluYW1pYyBib2RpZXMKICAgICAgICAgIGNvbnN0IGYgPSBiaS5mb3JjZTsKICAgICAgICAgIGNvbnN0IG0gPSBiaS5tYXNzOwogICAgICAgICAgZi54ICs9IG0gKiBneDsKICAgICAgICAgIGYueSArPSBtICogZ3k7CiAgICAgICAgICBmLnogKz0gbSAqIGd6OwogICAgICAgIH0KICAgICAgfSAvLyBVcGRhdGUgc3Vic3lzdGVtcwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBOc3Vic3lzdGVtcyA9IHRoaXMuc3Vic3lzdGVtcy5sZW5ndGg7IGkgIT09IE5zdWJzeXN0ZW1zOyBpKyspIHsKICAgICAgICB0aGlzLnN1YnN5c3RlbXNbaV0udXBkYXRlKCk7CiAgICAgIH0gLy8gQ29sbGlzaW9uIGRldGVjdGlvbgoKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIHAxLmxlbmd0aCA9IDA7IC8vIENsZWFuIHVwIHBhaXIgYXJyYXlzIGZyb20gbGFzdCBzdGVwCgogICAgICBwMi5sZW5ndGggPSAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UuY29sbGlzaW9uUGFpcnModGhpcywgcDEsIHAyKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuYnJvYWRwaGFzZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9sZGNvbnRhY3RzID0gV29ybGRfc3RlcF9vbGRDb250YWN0czsKICAgICAgY29uc3QgTm9sZENvbnRhY3RzID0gY29udGFjdHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZENvbnRhY3RzOyBpKyspIHsKICAgICAgICBvbGRjb250YWN0cy5wdXNoKGNvbnRhY3RzW2ldKTsKICAgICAgfQoKICAgICAgY29udGFjdHMubGVuZ3RoID0gMDsgLy8gVHJhbnNmZXIgRnJpY3Rpb25FcXVhdGlvbiBmcm9tIGN1cnJlbnQgbGlzdCB0byB0aGUgcG9vbCBmb3IgcmV1c2UKCiAgICAgIGNvbnN0IE5vbGRGcmljdGlvbkVxdWF0aW9ucyA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZEZyaWN0aW9uRXF1YXRpb25zOyBpKyspIHsKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUG9vbC5wdXNoKHRoaXMuZnJpY3Rpb25FcXVhdGlvbnNbaV0pOwogICAgICB9CgogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UuZ2V0Q29udGFjdHMocDEsIHAyLCB0aGlzLCBjb250YWN0cywgb2xkY29udGFjdHMsIC8vIFRvIGJlIHJldXNlZAogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLCBmcmljdGlvbkVxdWF0aW9uUG9vbCk7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLm5hcnJvd3BoYXNlID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBMb29wIG92ZXIgYWxsIGNvbGxpc2lvbnMKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIFdha2UgdXAgYm9kaWVzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlKSB7CiAgICAgICAgICBiaS53YWtlVXAoKTsKICAgICAgICAgIGJpLndha2VVcEFmdGVyTmFycm93cGhhc2UgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIHVzZXItYWRkZWQgY29uc3RyYWludHMKCgogICAgICBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKICAgICAgICBjLnVwZGF0ZSgpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgTmVxID0gYy5lcXVhdGlvbnMubGVuZ3RoOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgY29uc3QgZXEgPSBjLmVxdWF0aW9uc1tqXTsKICAgICAgICAgIHNvbHZlci5hZGRFcXVhdGlvbihlcSk7CiAgICAgICAgfQogICAgICB9IC8vIFNvbHZlIHRoZSBjb25zdHJhaW5lZCBzeXN0ZW0KCgogICAgICBzb2x2ZXIuc29sdmUoZHQsIHRoaXMpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5zb2x2ZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIExlYXAgZnJvZwogICAgICAvLyB2bmV3ID0gdiArIGgqZi9tCiAgICAgIC8vIHhuZXcgPSB4ICsgaCp2bmV3CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9CgogICAgICBjb25zdCBzdGVwbnVtYmVyID0gdGhpcy5zdGVwbnVtYmVyOwogICAgICBjb25zdCBxdWF0Tm9ybWFsaXplID0gc3RlcG51bWJlciAlICh0aGlzLnF1YXROb3JtYWxpemVTa2lwICsgMSkgPT09IDA7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemVGYXN0ID0gdGhpcy5xdWF0Tm9ybWFsaXplRmFzdDsKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGJvZGllc1tpXS5pbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZvcmNlcygpOwogICAgICB0aGlzLmJyb2FkcGhhc2UuZGlydHkgPSB0cnVlOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5pbnRlZ3JhdGUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICB9IC8vIFVwZGF0ZSBzdGVwIG51bWJlcgoKCiAgICAgIHRoaXMuc3RlcG51bWJlciArPSAxOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50KTsgLy8gU2xlZXBpbmcgdXBkYXRlCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgogIG5ldyBBQUJCKCk7CiAgY29uc3QgdG1wUmF5ID0gbmV3IFJheSgpOyAvLyBwZXJmb3JtYW5jZS5ub3coKSBmYWxsYmFjayBvbiBEYXRlLm5vdygpCgogIGNvbnN0IHBlcmZvcm1hbmNlID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpOwoKICAgIGlmIChwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogICAgfQoKICAgIHBlcmZvcm1hbmNlLm5vdyA9ICgpID0+IERhdGUubm93KCkgLSBub3dPZmZzZXQ7CiAgfQoKICBuZXcgVmVjMygpOyAvLyBEaXNwYXRjaGVkIGFmdGVyIHRoZSB3b3JsZCBoYXMgc3RlcHBlZCBmb3J3YXJkIGluIHRpbWUuCiAgLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCiAgY29uc3QgV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3Bvc3RTdGVwJwogIH07IC8vIERpc3BhdGNoZWQgYmVmb3JlIHRoZSB3b3JsZCBzdGVwcyBmb3J3YXJkIGluIHRpbWUuCgogIGNvbnN0IFdvcmxkX3N0ZXBfcHJlU3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3ByZVN0ZXAnCiAgfTsKICBjb25zdCBXb3JsZF9zdGVwX2NvbGxpZGVFdmVudCA9IHsKICAgIHR5cGU6IEJvZHkuQ09MTElERV9FVkVOVF9OQU1FLAogICAgYm9keTogbnVsbCwKICAgIGNvbnRhY3Q6IG51bGwKICB9OyAvLyBQb29scyBmb3IgdW51c2VkIG9iamVjdHMKCiAgY29uc3QgV29ybGRfc3RlcF9vbGRDb250YWN0cyA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsgLy8gUmV1c2FibGUgYXJyYXlzIGZvciBjb2xsaXNpb24gcGFpcnMKCiAgY29uc3QgV29ybGRfc3RlcF9wMSA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfcDIgPSBbXTsgLy8gU3R1ZmYgZm9yIGVtaXRDb250YWN0RXZlbnRzCgogIGNvbnN0IGFkZGl0aW9ucyA9IFtdOwogIGNvbnN0IHJlbW92YWxzID0gW107CiAgY29uc3QgYmVnaW5Db250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5Db250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGVuZENvbnRhY3RFdmVudCA9IHsKICAgIHR5cGU6ICdlbmRDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGJlZ2luU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5TaGFwZUNvbnRhY3QnLAogICAgYm9keUE6IG51bGwsCiAgICBib2R5QjogbnVsbCwKICAgIHNoYXBlQTogbnVsbCwKICAgIHNoYXBlQjogbnVsbAogIH07CiAgY29uc3QgZW5kU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwoKICBjb25zdCBhZGRDb250YWN0TWF0ZXJpYWwgPSAod29ybGQsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmLCB1dWlkKSA9PiB7CiAgICBsZXQgW21hdGVyaWFsQSwgbWF0ZXJpYWxCLCBvcHRpb25zXSA9IF9yZWY7CiAgICBjb25zdCBtYXRBID0gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWxBKTsKICAgIGNvbnN0IG1hdEIgPSBjcmVhdGVNYXRlcmlhbChtYXRlcmlhbEIpOwogICAgY29uc3QgY29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbChtYXRBLCBtYXRCLCBvcHRpb25zKTsKICAgIGNvbnRhY3RNYXRlcmlhbC51dWlkID0gdXVpZDsKICAgIHdvcmxkLmFkZENvbnRhY3RNYXRlcmlhbChjb250YWN0TWF0ZXJpYWwpOwogIH07CiAgY29uc3QgcmVtb3ZlQ29udGFjdE1hdGVyaWFsID0gKHdvcmxkLCBjbVVVSUQpID0+IHsKICAgIGNvbnN0IGluZGV4ID0gd29ybGQuY29udGFjdG1hdGVyaWFscy5maW5kSW5kZXgoX3JlZjIgPT4gewogICAgICBsZXQgewogICAgICAgIHV1aWQKICAgICAgfSA9IF9yZWYyOwogICAgICByZXR1cm4gdXVpZCA9PT0gY21VVUlEOwogICAgfSk7CiAgICBjb25zdCBbewogICAgICBpZDogaQogICAgfSwgewogICAgICBpZDogagogICAgfV0gPSB3b3JsZC5jb250YWN0bWF0ZXJpYWxzW2luZGV4XS5tYXRlcmlhbHM7CiAgICB3b3JsZC5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpbmRleCwgMSk7CiAgICBkZWxldGUgd29ybGQuY29udGFjdE1hdGVyaWFsVGFibGUuZGF0YVtpIDwgaiA/IGAke2l9LSR7an1gIDogYCR7an0tJHtpfWBdOwogIH07CgogIGxldCBtYXRlcmlhbElkID0gMDsKICBjb25zdCBjcmVhdGVNYXRlcmlhbEZhY3RvcnkgPSBtYXRlcmlhbHMgPT4gZnVuY3Rpb24gKG5hbWVPck9wdGlvbnMpIHsKICAgIGlmIChuYW1lT3JPcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgbmFtZU9yT3B0aW9ucyA9IHt9OwogICAgfQogICAgY29uc3QgbWF0ZXJpYWxPcHRpb25zID0gdHlwZW9mIG5hbWVPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gewogICAgICBuYW1lOiBuYW1lT3JPcHRpb25zCiAgICB9IDogewogICAgICBuYW1lOiBTeW1ib2wuZm9yKGBNYXRlcmlhbCR7bWF0ZXJpYWxJZCsrfWApLAogICAgICAuLi5uYW1lT3JPcHRpb25zCiAgICB9OwogICAgY29uc3QgewogICAgICBuYW1lCiAgICB9ID0gbWF0ZXJpYWxPcHRpb25zOwogICAgbWF0ZXJpYWxzW25hbWVdID0gbWF0ZXJpYWxzW25hbWVdIHx8IG5ldyBNYXRlcmlhbChtYXRlcmlhbE9wdGlvbnMpOwogICAgcmV0dXJuIG1hdGVyaWFsc1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBAdHlwZWRlZiB7IGltcG9ydCgnY2Fubm9uLWVzJykuTWF0ZXJpYWxPcHRpb25zIH0gTWF0ZXJpYWxPcHRpb25zCiAgICovCgogIGNvbnN0IG1ha2VWZWMzID0gX3JlZiA9PiB7CiAgICBsZXQgW3gsIHksIHpdID0gX3JlZjsKICAgIHJldHVybiBuZXcgVmVjMyh4LCB5LCB6KTsKICB9OwogIGNvbnN0IHByZXBhcmVTcGhlcmUgPSBhcmdzID0+IEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdOwogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gX3JlZjIgPT4gewogICAgbGV0IFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdID0gX3JlZjI7CiAgICByZXR1cm4gW3sKICAgICAgYXhlczogYSA/IGEubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZCwKICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMsCiAgICAgIGZhY2VzLAogICAgICBub3JtYWxzOiBuID8gbi5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgICB2ZXJ0aWNlczogdiA/IHYubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZAogICAgfV07CiAgfTsKICBmdW5jdGlvbiBjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnQm94JzoKICAgICAgICByZXR1cm4gbmV3IEJveChuZXcgVmVjMyguLi5hcmdzLm1hcCh2ID0+IHYgLyAyKSkpOwogICAgICAvLyBleHRlbnRzID0+IGhhbGZFeHRlbnRzCiAgICAgIGNhc2UgJ0NvbnZleFBvbHloZWRyb24nOgogICAgICAgIHJldHVybiBuZXcgQ29udmV4UG9seWhlZHJvbiguLi5wcmVwYXJlQ29udmV4UG9seWhlZHJvbihhcmdzKSk7CiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCiAgICAgIGNhc2UgJ0hlaWdodGZpZWxkJzoKICAgICAgICByZXR1cm4gbmV3IEhlaWdodGZpZWxkKC4uLmFyZ3MpOwogICAgICAvLyBbIEFycmF5IGRhdGEsIG9wdGlvbnM6IHttaW5WYWx1ZSwgbWF4VmFsdWUsIGVsZW1lbnRTaXplfSAgXSA9IGFyZ3MKICAgICAgY2FzZSAnUGFydGljbGUnOgogICAgICAgIHJldHVybiBuZXcgUGFydGljbGUoKTsKICAgICAgLy8gbm8gYXJncwogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CiAgICAgIGNhc2UgJ1NwaGVyZSc6CiAgICAgICAgcmV0dXJuIG5ldyBTcGhlcmUoLi4ucHJlcGFyZVNwaGVyZShhcmdzKSk7CiAgICAgIC8vIHJhZGl1cyA9IGFyZ3MKICAgICAgY2FzZSAnVHJpbWVzaCc6CiAgICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKC4uLmFyZ3MpOwogICAgICAvLyBbdmVydGljZXMsIGluZGljZXNdID0gYXJncwogICAgfQogIH0KCiAgLyoqCiAgICogQHBhcmFtIHtUSFJFRS5RdWF0ZXJuaW9ufSB0YXJnZXQKICAgKiBAcGFyYW0ge3sgcm90YXRpb24/OiBUSFJFRS5WZWN0b3IzVHVwbGUgcXVhdGVybmlvbj86IFRIUkVFLlZlY3RvcjRUdXBsZSB9fSBwcm9wcwogICAqIEByZXR1cm5zIHtUSFJFRS5RdWF0ZXJuaW9ufQogICAqLwogIGNvbnN0IHNldFF1YXRlcm5pb24gPSAodGFyZ2V0LCBfcmVmMykgPT4gewogICAgbGV0IHsKICAgICAgcXVhdGVybmlvbiwKICAgICAgcm90YXRpb24KICAgIH0gPSBfcmVmMzsKICAgIGlmIChxdWF0ZXJuaW9uKSB7CiAgICAgIHRhcmdldC5zZXQoLi4ucXVhdGVybmlvbik7CiAgICB9IGVsc2UgaWYgKHJvdGF0aW9uKSB7CiAgICAgIHRhcmdldC5zZXRGcm9tRXVsZXIoLi4ucm90YXRpb24pOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICAvKioKICAgKiBAZnVuY3Rpb24KICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnV1aWQKICAgKiBAcGFyYW0ge0JvZHlQcm9wc30gb3B0aW9ucy5wcm9wcwogICAqIEBwYXJhbSB7Qm9keVNoYXBlVHlwZX0gb3B0aW9ucy50eXBlCiAgICogQHBhcmFtIHsobWF0ZXJpYWxPcHRpb25zOiBNYXRlcmlhbE9wdGlvbnMpID0+IE1hdGVyaWFsID19IG9wdGlvbnMuY3JlYXRlTWF0ZXJpYWwKICAgKiBAcmV0dXJucyB7Qm9keX0KICAgKi8KICBjb25zdCBwcm9wc1RvQm9keSA9IG9wdGlvbnMgPT4gewogICAgY29uc3QgewogICAgICB1dWlkLAogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgY3JlYXRlTWF0ZXJpYWwgPSBtYXRlcmlhbE9wdGlvbnMgPT4gbmV3IE1hdGVyaWFsKG1hdGVyaWFsT3B0aW9ucykKICAgIH0gPSBvcHRpb25zOwogICAgY29uc3QgewogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyVmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFyZ3MgPSBbXSwKICAgICAgY29sbGlzaW9uUmVzcG9uc2UsCiAgICAgIGxpbmVhckZhY3RvciA9IFsxLCAxLCAxXSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIG9uQ29sbGlkZSwKICAgICAgcG9zaXRpb24gPSBbMCwgMCwgMF0sCiAgICAgIHJvdGF0aW9uLAogICAgICBxdWF0ZXJuaW9uLAogICAgICBzaGFwZXMsCiAgICAgIHR5cGU6IGJvZHlUeXBlLAogICAgICB2ZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7CiAgICAgIC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgbWF0ZXJpYWw6IG1hdGVyaWFsID8gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkLAogICAgICB0eXBlOiBib2R5VHlwZSA/IEJvZHlbYm9keVR5cGUudG9VcHBlckNhc2UoKV0gOiB1bmRlZmluZWQKICAgIH0pOwogICAgYm9keS51dWlkID0gdXVpZDsKICAgIGlmIChjb2xsaXNpb25SZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvZHkuY29sbGlzaW9uUmVzcG9uc2UgPSBjb2xsaXNpb25SZXNwb25zZTsKICAgIH0KICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKF9yZWY0ID0+IHsKICAgICAgICBsZXQgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIHJvdGF0aW9uLAogICAgICAgICAgcXVhdGVybmlvbiwKICAgICAgICAgIG1hdGVyaWFsLAogICAgICAgICAgLi4uZXh0cmEKICAgICAgICB9ID0gX3JlZjQ7CiAgICAgICAgY29uc3Qgc2hhcGVCb2R5ID0gYm9keS5hZGRTaGFwZShjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSwgcG9zaXRpb24gPyBuZXcgVmVjMyguLi5wb3NpdGlvbikgOiB1bmRlZmluZWQsIHNldFF1YXRlcm5pb24obmV3IFF1YXRlcm5pb24oMCwgMCwgMCwgMSksIHsKICAgICAgICAgIHF1YXRlcm5pb24sCiAgICAgICAgICByb3RhdGlvbgogICAgICAgIH0pKTsKICAgICAgICBpZiAobWF0ZXJpYWwpIHNoYXBlQm9keS5tYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQogICAgYm9keS5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0sIHBvc2l0aW9uWzFdLCBwb3NpdGlvblsyXSk7CiAgICBib2R5LnZlbG9jaXR5LnNldCh2ZWxvY2l0eVswXSwgdmVsb2NpdHlbMV0sIHZlbG9jaXR5WzJdKTsKICAgIGJvZHkuYW5ndWxhclZlbG9jaXR5LnNldChhbmd1bGFyVmVsb2NpdHlbMF0sIGFuZ3VsYXJWZWxvY2l0eVsxXSwgYW5ndWxhclZlbG9jaXR5WzJdKTsKICAgIGJvZHkubGluZWFyRmFjdG9yLnNldChsaW5lYXJGYWN0b3JbMF0sIGxpbmVhckZhY3RvclsxXSwgbGluZWFyRmFjdG9yWzJdKTsKICAgIGJvZHkuYW5ndWxhckZhY3Rvci5zZXQoYW5ndWxhckZhY3RvclswXSwgYW5ndWxhckZhY3RvclsxXSwgYW5ndWxhckZhY3RvclsyXSk7CiAgICBzZXRRdWF0ZXJuaW9uKGJvZHkucXVhdGVybmlvbiwgewogICAgICBxdWF0ZXJuaW9uLAogICAgICByb3RhdGlvbgogICAgfSk7CiAgICByZXR1cm4gYm9keTsKICB9OwoKICBjb25zdCBhZGRCb2RpZXMgPSAoc3RhdGUsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHsKICAgICAgICBjcmVhdGVNYXRlcmlhbCwKICAgICAgICBwcm9wczogcHJvcHNbaV0sCiAgICAgICAgdHlwZSwKICAgICAgICB1dWlkOiB1dWlkW2ldCiAgICAgIH0pOwogICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCBfcmVmMiA9PiB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBib2R5LAogICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgY29udGFjdAogICAgICAgIH0gPSBfcmVmMjsKICAgICAgICBpZiAoIWJvZHkudXVpZCB8fCAhdGFyZ2V0LnV1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBuaSwKICAgICAgICAgIHJpLAogICAgICAgICAgcmosCiAgICAgICAgICBiaSwKICAgICAgICAgIGJqLAogICAgICAgICAgaWQKICAgICAgICB9ID0gY29udGFjdDsKICAgICAgICBjb25zdCBjb250YWN0UG9pbnQgPSBiaS5wb3NpdGlvbi52YWRkKHJpKTsKICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsID0gYmkgPT09IGJvZHkgPyBuaSA6IG5pLnNjYWxlKC0xKTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGJvZHk6IGJvZHkudXVpZCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlcnM6IHsKICAgICAgICAgICAgYm9keUZpbHRlckdyb3VwOiBib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICBib2R5RmlsdGVyTWFzazogYm9keS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJHcm91cDogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJNYXNrOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyTWFzawogICAgICAgICAgfSwKICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiB1c2UgaWQgaW5zdGVhZCBvZiB1dWlkCiAgICAgICAgICAgIGJpOiBiaS51dWlkLAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IHVzZSBpZCBpbnN0ZWFkIG9mIHV1aWQKICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgIC8vIE5vcm1hbCBvZiB0aGUgY29udGFjdCwgcmVsYXRpdmUgdG8gdGhlIGNvbGxpZGluZyBib2R5CiAgICAgICAgICAgIGNvbnRhY3ROb3JtYWw6IGNvbnRhY3ROb3JtYWwudG9BcnJheSgpLAogICAgICAgICAgICAvLyBXb3JsZCBwb3NpdGlvbiBvZiB0aGUgY29udGFjdAogICAgICAgICAgICBjb250YWN0UG9pbnQ6IGNvbnRhY3RQb2ludC50b0FycmF5KCksCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgIG5pOiBuaS50b0FycmF5KCksCiAgICAgICAgICAgIHJpOiByaS50b0FycmF5KCksCiAgICAgICAgICAgIHJqOiByai50b0FycmF5KCkKICAgICAgICAgIH0sCiAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgIHRhcmdldDogdGFyZ2V0LnV1aWQsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGNvbnN0IHRyaXBsZXRUb1ZlYzMgPSB0ID0+IHQgPyBuZXcgVmVjMyguLi50KSA6IHVuZGVmaW5lZDsKCiAgY29uc3QgYWRkQ29uc3RyYWludCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IFtib2R5QSwgYm9keUIsIHsKICAgICAgICBhbmdsZSwKICAgICAgICBheGlzQSwKICAgICAgICBheGlzQiwKICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIG1heEZvcmNlLAogICAgICAgIG1heE11bHRpcGxpZXIsCiAgICAgICAgcGl2b3RBLAogICAgICAgIHBpdm90QiwKICAgICAgICB0d2lzdEFuZ2xlLAogICAgICAgIHdha2VVcEJvZGllcwogICAgICB9XSwKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBsZXQgY29uc3RyYWludDsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdQb2ludFRvUG9pbnQnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCB0cmlwbGV0VG9WZWMzKHBpdm90QSksIHN0YXRlLmJvZGllc1tib2R5Ql0sIHRyaXBsZXRUb1ZlYzMocGl2b3RCKSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBhbmdsZSwKICAgICAgICAgIGF4aXNBOiB0cmlwbGV0VG9WZWMzKGF4aXNBKSwKICAgICAgICAgIGF4aXNCOiB0cmlwbGV0VG9WZWMzKGF4aXNCKSwKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICBtYXhGb3JjZSwKICAgICAgICAgIHBpdm90QTogdHJpcGxldFRvVmVjMyhwaXZvdEEpLAogICAgICAgICAgcGl2b3RCOiB0cmlwbGV0VG9WZWMzKHBpdm90QiksCiAgICAgICAgICB0d2lzdEFuZ2xlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0hpbmdlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IEhpbmdlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBheGlzQTogdHJpcGxldFRvVmVjMyhheGlzQSksCiAgICAgICAgICBheGlzQjogdHJpcGxldFRvVmVjMyhheGlzQiksCiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgICAgbWF4Rm9yY2UsCiAgICAgICAgICBwaXZvdEE6IHRyaXBsZXRUb1ZlYzMocGl2b3RBKSwKICAgICAgICAgIHBpdm90QjogdHJpcGxldFRvVmVjMyhwaXZvdEIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBkaXN0YW5jZSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdMb2NrJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IExvY2tDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIG1heEZvcmNlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICB3YWtlVXBCb2RpZXMKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgaWYgKG1heE11bHRpcGxpZXIgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zdCBwb3N0U3RlcENvbnN0cmFpbnQgPSAoKSA9PiB7CiAgICAgICAgLy8gVGhlIG11bHRpcGxpZXIgaXMgcHJvcG9ydGlvbmFsIHRvIGhvdyBtdWNoIGZvcmNlIGlzIGFkZGVkIHRvIHRoZSBib2RpZXMgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgICAgLy8gSWYgdGhpcyBleGNlZWRzIGEgbGltaXQgdGhlIGNvbnN0cmFpbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGguYWJzKGNvbnN0cmFpbnQuZXF1YXRpb25zWzBdLm11bHRpcGxpZXIpOwogICAgICAgIGlmIChtdWx0aXBsaWVyID4gbWF4TXVsdGlwbGllcikgewogICAgICAgICAgY29uc3RyYWludC5kaXNhYmxlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSA9IHBvc3RTdGVwQ29uc3RyYWludDsKICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gdG9VcHBlcmNhc2Uoc3RyKSB7CiAgICByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7CiAgfQogIGNvbnN0IGFkZFJheSA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IHsKICAgICAgICBmcm9tLAogICAgICAgIG1vZGUsCiAgICAgICAgdG8sCiAgICAgICAgLi4ucmF5T3B0aW9ucwogICAgICB9LAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHJheSA9IG5ldyBSYXkodHJpcGxldFRvVmVjMyhmcm9tKSwgdHJpcGxldFRvVmVjMyh0bykpOwogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgbW9kZTogUkFZX01PREVTW3RvVXBwZXJjYXNlKG1vZGUpXSwKICAgICAgcmVzdWx0OiBuZXcgUmF5Y2FzdFJlc3VsdCgpLAogICAgICAuLi5yYXlPcHRpb25zCiAgICB9OwogICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdCB8fCAhb3B0aW9ucy5yZXN1bHQuYm9keSkgcmV0dXJuOwogICAgICBjb25zdCB7CiAgICAgICAgYm9keSwKICAgICAgICBzaGFwZSwKICAgICAgICByYXlGcm9tV29ybGQsCiAgICAgICAgcmF5VG9Xb3JsZCwKICAgICAgICBoaXROb3JtYWxXb3JsZCwKICAgICAgICBoaXRQb2ludFdvcmxkLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA9IG9wdGlvbnMucmVzdWx0OwogICAgICBjb25zdCBib2R5VVVJRCA9IGJvZHkudXVpZDsKICAgICAgaWYgKCFib2R5VVVJRCkgcmV0dXJuOwogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBib2R5OiBib2R5VVVJRCwKICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgIHJheTogewogICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgIGZyb20sCiAgICAgICAgICB0bywKICAgICAgICAgIHV1aWQKICAgICAgICB9LAogICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICBzaGFwZTogc2hhcGUgPyB7CiAgICAgICAgICAuLi5zaGFwZSwKICAgICAgICAgIGJvZHk6IGJvZHlVVUlECiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH07CiAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgfTsKCiAgY29uc3QgYWRkUmF5Y2FzdFZlaGljbGUgPSAoc3RhdGUsIGRhdGEpID0+IHsKICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gZGF0YS5wcm9wczsKICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgaW5kZXhGb3J3YXJkQXhpcywKICAgICAgaW5kZXhSaWdodEF4aXMsCiAgICAgIGluZGV4VXBBeGlzCiAgICB9KTsKICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgYXhsZUxvY2FsLAogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCwKICAgICAgICBkaXJlY3Rpb25Mb2NhbCwKICAgICAgICAuLi5yZXN0CiAgICAgIH0gPSB3aGVlbEluZm9zW2ldOwogICAgICB2ZWhpY2xlLmFkZFdoZWVsKHsKICAgICAgICBheGxlTG9jYWw6IHRyaXBsZXRUb1ZlYzMoYXhsZUxvY2FsKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWw6IHRyaXBsZXRUb1ZlYzMoY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsKSwKICAgICAgICBkaXJlY3Rpb25Mb2NhbDogdHJpcGxldFRvVmVjMyhkaXJlY3Rpb25Mb2NhbCksCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZVN0ZXAgPSAoKSA9PiB7CiAgICAgIHZlaGljbGUudXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICB9OwogICAgY29uc3QgcG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoaWNsZS53aGVlbEluZm9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmVoaWNsZS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICBjb25zdCB0ID0gdmVoaWNsZS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfTsKICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0gPSB7CiAgICAgIHBvc3RTdGVwLAogICAgICBwcmVTdGVwLAogICAgICB2ZWhpY2xlCiAgICB9OwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHByZVN0ZXApOwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBwb3N0U3RlcCk7CiAgfTsKCiAgY29uc3QgYWRkU3ByaW5nID0gKHN0YXRlLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wczogW2JvZHlBLCBib2R5QiwgewogICAgICAgIGRhbXBpbmcsCiAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgIHN0aWZmbmVzcywKICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgd29ybGRBbmNob3JCCiAgICAgIH1dLAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHNwcmluZyA9IG5ldyBTcHJpbmcoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICBkYW1waW5nLAogICAgICBsb2NhbEFuY2hvckE6IHRyaXBsZXRUb1ZlYzMobG9jYWxBbmNob3JBKSwKICAgICAgbG9jYWxBbmNob3JCOiB0cmlwbGV0VG9WZWMzKGxvY2FsQW5jaG9yQiksCiAgICAgIHJlc3RMZW5ndGgsCiAgICAgIHN0aWZmbmVzcywKICAgICAgd29ybGRBbmNob3JBOiB0cmlwbGV0VG9WZWMzKHdvcmxkQW5jaG9yQSksCiAgICAgIHdvcmxkQW5jaG9yQjogdHJpcGxldFRvVmVjMyh3b3JsZEFuY2hvckIpCiAgICB9KTsKICAgIHNwcmluZy51dWlkID0gdXVpZDsKICAgIGNvbnN0IHBvc3RTdGVwU3ByaW5nID0gKCkgPT4gc3ByaW5nLmFwcGx5Rm9yY2UoKTsKICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsKCiAgICAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgfTsKCiAgZnVuY3Rpb24gZW1pdEJlZ2luQ29udGFjdChfcmVmKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmOwogICAgaWYgKCEoYm9keUEgIT0gbnVsbCAmJiBib2R5QS51dWlkKSB8fCAhKGJvZHlCICE9IG51bGwgJiYgYm9keUIudXVpZCkpIHJldHVybjsKICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQsCiAgICAgIG9wOiAnZXZlbnQnLAogICAgICB0eXBlOiAnY29sbGlkZUJlZ2luJwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGVtaXRFbmRDb250YWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmMjsKICAgIGlmICghKGJvZHlBICE9IG51bGwgJiYgYm9keUEudXVpZCkgfHwgIShib2R5QiAhPSBudWxsICYmIGJvZHlCLnV1aWQpKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkLAogICAgICBvcDogJ2V2ZW50JywKICAgICAgdHlwZTogJ2NvbGxpZGVFbmQnCiAgICB9KTsKICB9CiAgY29uc3QgaW5pdCA9ICh3b3JsZCwgX3JlZjMpID0+IHsKICAgIGxldCB7CiAgICAgIGFsbG93U2xlZXAsCiAgICAgIGF4aXNJbmRleCA9IDAsCiAgICAgIGJyb2FkcGhhc2UsCiAgICAgIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwsCiAgICAgIGZyaWN0aW9uR3Jhdml0eSwKICAgICAgZ3Jhdml0eSwKICAgICAgaXRlcmF0aW9ucywKICAgICAgcXVhdE5vcm1hbGl6ZUZhc3QsCiAgICAgIHF1YXROb3JtYWxpemVTa2lwLAogICAgICBzb2x2ZXIsCiAgICAgIHRvbGVyYW5jZQogICAgfSA9IF9yZWYzOwogICAgd29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICB3b3JsZC5ncmF2aXR5LnNldCguLi5ncmF2aXR5KTsKICAgIHdvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGZyaWN0aW9uR3Jhdml0eSA/IG5ldyBWZWMzKC4uLmZyaWN0aW9uR3Jhdml0eSkgOiB1bmRlZmluZWQ7CiAgICB3b3JsZC5xdWF0Tm9ybWFsaXplRmFzdCA9IHF1YXROb3JtYWxpemVGYXN0OwogICAgd29ybGQucXVhdE5vcm1hbGl6ZVNraXAgPSBxdWF0Tm9ybWFsaXplU2tpcDsKICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgd29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgIH0KICAgIGlmICh3b3JsZC5zb2x2ZXIgaW5zdGFuY2VvZiBHU1NvbHZlcikgewogICAgICB3b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICB3b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICB9CiAgICB3b3JsZC5icm9hZHBoYXNlID0gYnJvYWRwaGFzZSA9PT0gJ1NBUCcgPyBuZXcgU0FQQnJvYWRwaGFzZSh3b3JsZCkgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICBpZiAod29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgd29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXg7CiAgICB9CiAgICB3b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICBPYmplY3QuYXNzaWduKHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogIH07CgogIGNvbnN0IGlzUW9yViA9IHYgPT4gdiBpbnN0YW5jZW9mIFF1YXRlcm5pb24gfHwgdiBpbnN0YW5jZW9mIFZlYzM7CiAgY29uc3Qgc3RlcCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcG9zaXRpb25zLAogICAgICBwcm9wczogewogICAgICAgIG1heFN1YlN0ZXBzLAogICAgICAgIHN0ZXBTaXplLAogICAgICAgIHRpbWVTaW5jZUxhc3RDYWxsZWQKICAgICAgfSwKICAgICAgcXVhdGVybmlvbnMKICAgIH0gPSBfcmVmOwogICAgc3RhdGUud29ybGQuc3RlcChzdGVwU2l6ZSwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgY29uc3QgcCA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5wb3NpdGlvbjsKICAgICAgY29uc3QgcSA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5xdWF0ZXJuaW9uOwogICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgfQogICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gW107CiAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgIGNvbnN0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgY29uc3QgewogICAgICAgIGJvZGllcywKICAgICAgICB2ZWhpY2xlcwogICAgICB9ID0gc3RhdGU7CiAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0ID09PSAndmVoaWNsZXMnID8KICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdmVoaWNsZXNbdXVpZF0udmVoaWNsZVt0eXBlXSA6CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogRGlmZmVyZW50aWF0ZSB0aGVzZSAidHlwZXMiCiAgICAgIGJvZGllc1t1dWlkXVt0eXBlXTsKICAgICAgY29uc3Qgc2VyaWFsaXphYmxlVmFsdWUgPSBpc1FvclYodmFsdWUpID8gdmFsdWUudG9BcnJheSgpIDogdmFsdWU7CiAgICAgIG9ic2VydmF0aW9ucy5wdXNoKFtOdW1iZXIoaWQpLCBzZXJpYWxpemFibGVWYWx1ZSwKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdHlwZV0pOwogICAgfQogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMsCiAgICAgIG9ic2VydmF0aW9ucywKICAgICAgb3A6ICdmcmFtZScsCiAgICAgIHBvc2l0aW9ucywKICAgICAgcXVhdGVybmlvbnMKICAgIH07CiAgICBpZiAoc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcpIHsKICAgICAgbWVzc2FnZS5ib2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMucmVkdWNlKChib2RpZXMsIGJvZHkpID0+IHsKICAgICAgICBpZiAoYm9keS51dWlkKSBib2RpZXMucHVzaChib2R5LnV1aWQpOwogICAgICAgIHJldHVybiBib2RpZXM7CiAgICAgIH0sIFtdKTsKICAgICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSBmYWxzZTsKICAgIH0KICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGNvbnN0cmFpbnRzOiB7fSwKICAgIG1hdGVyaWFsczoge30sCiAgICByYXlzOiB7fSwKICAgIHNwcmluZ0luc3RhbmNlczoge30sCiAgICBzcHJpbmdzOiB7fSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdmVoaWNsZXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpCiAgfTsKCiAgLy8vIDxyZWZlcmVuY2Ugbm8tZGVmYXVsdC1saWI9InRydWUiLz4KICBjb25zdCBpc0hpbmdlQ29uc3RyYWludCA9IGMgPT4gYyBpbnN0YW5jZW9mIEhpbmdlQ29uc3RyYWludDsKICBmdW5jdGlvbiBzeW5jQm9kaWVzKCkgewogICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSB0cnVlOwogICAgc3RhdGUuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLnJlZHVjZSgoYm9kaWVzLCBib2R5KSA9PiBib2R5LnV1aWQgPyB7CiAgICAgIC4uLmJvZGllcywKICAgICAgW2JvZHkudXVpZF06IGJvZHkKICAgIH0gOiBib2RpZXMsIHt9KTsKICB9CiAgY29uc3QgYnJvYWRwaGFzZXMgPSB7CiAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICBTQVBCcm9hZHBoYXNlCiAgfTsKICBjb25zdCBjcmVhdGVNYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsRmFjdG9yeShzdGF0ZS5tYXRlcmlhbHMpOwogIHNlbGYub25tZXNzYWdlID0gX3JlZiA9PiB7CiAgICBsZXQgewogICAgICBkYXRhCiAgICB9ID0gX3JlZjsKICAgIHN3aXRjaCAoZGF0YS5vcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBpbml0KHN0YXRlLndvcmxkLCBkYXRhLnByb3BzKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgc3RlcChzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZEJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgYWRkQm9kaWVzKHN0YXRlLCBjcmVhdGVNYXRlcmlhbCwgZGF0YSk7CiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlQm9keShzdGF0ZS5ib2RpZXNbZGF0YS51dWlkW2ldXSk7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWRbaV0pOwogICAgICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgdHlwZQogICAgICAgICAgfSA9IGRhdGEucHJvcHM7CiAgICAgICAgICBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXSA9IFtkYXRhLnV1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1tkYXRhLnByb3BzXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnBvc2l0aW9uLnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0UXVhdGVybmlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ucXVhdGVybmlvbi5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSwgZGF0YS5wcm9wc1szXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFJvdGF0aW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VmVsb2NpdHknOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnZlbG9jaXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hbmd1bGFyVmVsb2NpdHkuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmxpbmVhckZhY3Rvci5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5tYXNzID0gZGF0YS5wcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXRlcmlhbCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ubWF0ZXJpYWwgPSBkYXRhLnByb3BzID8gY3JlYXRlTWF0ZXJpYWwoZGF0YS5wcm9wcykgOiBudWxsOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5saW5lYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uYWxsb3dTbGVlcCA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnNsZWVwVGltZUxpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmZpeGVkUm90YXRpb24gPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRGcmljdGlvbkdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGRhdGEucHJvcHMgPyBuZXcgVmVjMyguLi5kYXRhLnByb3BzKSA6IHVuZGVmaW5lZDsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXNUcmlnZ2VyJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5pc1RyaWdnZXIgPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRHcmF2aXR5JzoKICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuc29sdmVyIGluc3RhbmNlb2YgR1NTb2x2ZXIpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBkYXRhLnByb3BzOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgaWYgKHN0YXRlLndvcmxkLnNvbHZlciBpbnN0YW5jZW9mIEdTU29sdmVyKSB7CiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGRhdGEucHJvcHM7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRCcm9hZHBoYXNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlID0gbmV3IChicm9hZHBoYXNlc1tgJHtkYXRhLnByb3BzfUJyb2FkcGhhc2VgXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UuYXhpc0luZGV4ID0gZGF0YS5wcm9wcyA9PT0gdW5kZWZpbmVkIHx8IGRhdGEucHJvcHMgPT09IG51bGwgPyAwIDogZGF0YS5wcm9wczsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5Rm9yY2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUxvY2FsRm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5kYXRhLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5VG9ycXVlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5kYXRhLnByb3BzWzBdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGFkZENvbnN0cmFpbnQoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoX3JlZjIgPT4gewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgdXVpZAogICAgICAgICAgfSA9IF9yZWYyOwogICAgICAgICAgcmV0dXJuIHV1aWQgPT09IGRhdGEudXVpZDsKICAgICAgICB9KS5tYXAoYyA9PiBzdGF0ZS53b3JsZC5yZW1vdmVDb25zdHJhaW50KGMpKTsKICAgICAgICBpZiAoc3RhdGUuY29uc3RyYWludHNbZGF0YS51dWlkXSkgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmRpc2FibGVNb3RvcigpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcihjID0+IGMudXVpZCA9PT0gZGF0YS51dWlkKS5maWx0ZXIoaXNIaW5nZUNvbnN0cmFpbnQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChkYXRhLnByb3BzKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UoZGF0YS5wcm9wcykpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGFkZFNwcmluZyhzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0uc3RpZmZuZXNzID0gZGF0YS5wcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0ucmVzdExlbmd0aCA9IGRhdGEucHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1tkYXRhLnV1aWRdLmRhbXBpbmcgPSBkYXRhLnByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5JzoKICAgICAgICB7CiAgICAgICAgICBhZGRSYXkoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW2RhdGEudXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbZGF0YS51dWlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGFkZFJheWNhc3RWZWhpY2xlKHN0YXRlLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnBvc3RTdGVwKTsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXTsKICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWQpOwogICAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1trZXldOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdhcHBseVJheWNhc3RWZWhpY2xlRW5naW5lRm9yY2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLmFwcGx5RW5naW5lRm9yY2UodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gZGF0YS5wcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZENvbnRhY3RNYXRlcmlhbCc6CiAgICAgICAgewogICAgICAgICAgYWRkQ29udGFjdE1hdGVyaWFsKHN0YXRlLndvcmxkLCBjcmVhdGVNYXRlcmlhbCwgZGF0YS5wcm9wcywgZGF0YS51dWlkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlQ29udGFjdE1hdGVyaWFsJzoKICAgICAgICB7CiAgICAgICAgICByZW1vdmVDb250YWN0TWF0ZXJpYWwoc3RhdGUud29ybGQsIGRhdGEudXVpZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ud2FrZVVwKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NsZWVwJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK");class _Ue extends NUe{constructor(n){let{allowSleep:i=!1,axisIndex:r=0,broadphase:s="Naive",defaultContactMaterial:o={contactEquationStiffness:1e6},frictionGravity:a=null,gravity:l=[0,-9.81,0],iterations:c=5,quatNormalizeFast:u=!1,quatNormalizeSkip:d=0,size:h=1e3,solver:I="GS",tolerance:p=.001}=n;super();wi(this,"messageQueue",[]);wi(this,"worker",null);this.config={allowSleep:i,axisIndex:r,broadphase:s,defaultContactMaterial:o,frictionGravity:a,gravity:l,iterations:c,quatNormalizeFast:u,quatNormalizeSkip:d,size:h,solver:I,tolerance:p},this.buffers={positions:new Float32Array(h*3),quaternions:new Float32Array(h*4)}}get axisIndex(){return this.config.axisIndex}set axisIndex(n){this.config.axisIndex=n,this.postMessage({op:"setAxisIndex",props:n})}get broadphase(){return this.config.broadphase}set broadphase(n){this.config.broadphase=n,this.postMessage({op:"setBroadphase",props:n})}get frictionGravity(){return this.config.frictionGravity}set frictionGravity(n){this.config.frictionGravity=n,this.postMessage({op:"setFrictionGravity",props:n})}get gravity(){return this.config.gravity}set gravity(n){this.config.gravity=n,this.postMessage({op:"setGravity",props:n})}get iterations(){return this.config.iterations}set iterations(n){this.config.iterations=n,this.postMessage({op:"setIterations",props:n})}get tolerance(){return this.config.tolerance}set tolerance(n){this.config.tolerance=n,this.postMessage({op:"setTolerance",props:n})}addBodies(n){let{props:i,type:r,uuid:s}=n;this.postMessage({op:"addBodies",props:i,type:r,uuid:s})}addConstraint(n){let{props:[i,r,s],type:o,uuid:a}=n;this.postMessage({op:"addConstraint",props:[i,r,s],type:o,uuid:a})}addContactMaterial(n){let{props:i,uuid:r}=n;this.postMessage({op:"addContactMaterial",props:i,uuid:r})}addRay(n){let{props:i,uuid:r}=n;this.postMessage({op:"addRay",props:i,uuid:r})}addRaycastVehicle(n){let{props:[i,r,s,o,a,l],uuid:c}=n;this.postMessage({op:"addRaycastVehicle",props:[i,r,s,o,a,l],uuid:c})}addSpring(n){let{props:[i,r,s],uuid:o}=n;this.postMessage({op:"addSpring",props:[i,r,s],uuid:o})}applyForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyForce",props:i,uuid:r})}applyImpulse(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyImpulse",props:i,uuid:r})}applyLocalForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyLocalForce",props:i,uuid:r})}applyLocalImpulse(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyLocalImpulse",props:i,uuid:r})}applyRaycastVehicleEngineForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyRaycastVehicleEngineForce",props:i,uuid:r})}applyTorque(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyTorque",props:i,uuid:r})}connect(){this.worker=new FUe,this.worker.onmessage=n=>{if(n.data.op==="frame"){this.buffers.positions=n.data.positions,this.buffers.quaternions=n.data.quaternions,this.emit(n.data.op,n.data);return}this.emit(n.data.type,n.data)};for(const n of this.messageQueue)this.worker.postMessage(n);this.messageQueue.length=0}disableConstraint(n){let{uuid:i}=n;this.postMessage({op:"disableConstraint",uuid:i})}disableConstraintMotor(n){let{uuid:i}=n;this.postMessage({op:"disableConstraintMotor",uuid:i})}disconnect(){this.worker&&(this.worker.onmessage=null)}enableConstraint(n){let{uuid:i}=n;this.postMessage({op:"enableConstraint",uuid:i})}enableConstraintMotor(n){let{uuid:i}=n;this.postMessage({op:"enableConstraintMotor",uuid:i})}init(){const{allowSleep:n,axisIndex:i,broadphase:r,defaultContactMaterial:s,frictionGravity:o,gravity:a,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:u,solver:d,tolerance:h}=this.config;this.postMessage({op:"init",props:{allowSleep:n,axisIndex:i,broadphase:r,defaultContactMaterial:s,frictionGravity:o,gravity:a,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:u,solver:d,tolerance:h}})}removeBodies(n){let{uuid:i}=n;this.postMessage({op:"removeBodies",uuid:i})}removeConstraint(n){let{uuid:i}=n;this.postMessage({op:"removeConstraint",uuid:i})}removeContactMaterial(n){let{uuid:i}=n;this.postMessage({op:"removeContactMaterial",uuid:i})}removeRay(n){let{uuid:i}=n;this.postMessage({op:"removeRay",uuid:i})}removeRaycastVehicle(n){let{uuid:i}=n;this.postMessage({op:"removeRaycastVehicle",uuid:i})}removeSpring(n){let{uuid:i}=n;this.postMessage({op:"removeSpring",uuid:i})}setAllowSleep(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAllowSleep",props:i,uuid:r})}setAngularDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularDamping",props:i,uuid:r})}setAngularFactor(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularFactor",props:i,uuid:r})}setAngularVelocity(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularVelocity",props:i,uuid:r})}setCollisionFilterGroup(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionFilterGroup",props:i,uuid:r})}setCollisionFilterMask(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionFilterMask",props:i,uuid:r})}setCollisionResponse(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionResponse",props:i,uuid:r})}setConstraintMotorMaxForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"setConstraintMotorMaxForce",props:i,uuid:r})}setConstraintMotorSpeed(n){let{props:i,uuid:r}=n;this.postMessage({op:"setConstraintMotorSpeed",props:i,uuid:r})}setFixedRotation(n){let{props:i,uuid:r}=n;this.postMessage({op:"setFixedRotation",props:i,uuid:r})}setIsTrigger(n){let{props:i,uuid:r}=n;this.postMessage({op:"setIsTrigger",props:i,uuid:r})}setLinearDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setLinearDamping",props:i,uuid:r})}setLinearFactor(n){let{props:i,uuid:r}=n;this.postMessage({op:"setLinearFactor",props:i,uuid:r})}setMass(n){let{props:i,uuid:r}=n;this.postMessage({op:"setMass",props:i,uuid:r})}setMaterial(n){let{props:i,uuid:r}=n;this.postMessage({op:"setMaterial",props:i,uuid:r})}setPosition(n){let{props:i,uuid:r}=n;this.postMessage({op:"setPosition",props:i,uuid:r})}setQuaternion(n){let{props:[i,r,s,o],uuid:a}=n;this.postMessage({op:"setQuaternion",props:[i,r,s,o],uuid:a})}setRaycastVehicleBrake(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRaycastVehicleBrake",props:i,uuid:r})}setRaycastVehicleSteeringValue(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRaycastVehicleSteeringValue",props:i,uuid:r})}setRotation(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRotation",props:i,uuid:r})}setSleepSpeedLimit(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSleepSpeedLimit",props:i,uuid:r})}setSleepTimeLimit(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSleepTimeLimit",props:i,uuid:r})}setSpringDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringDamping",props:i,uuid:r})}setSpringRestLength(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringRestLength",props:i,uuid:r})}setSpringStiffness(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringStiffness",props:i,uuid:r})}setUserData(n){let{props:i,uuid:r}=n;this.postMessage({op:"setUserData",props:i,uuid:r})}setVelocity(n){let{props:i,uuid:r}=n;this.postMessage({op:"setVelocity",props:i,uuid:r})}sleep(n){let{uuid:i}=n;this.postMessage({op:"sleep",uuid:i})}step(n){var i;const{buffers:{positions:r,quaternions:s}}=this;!r.byteLength&&!s.byteLength||(i=this.worker)==null||i.postMessage({op:"step",positions:r,props:n,quaternions:s},[r.buffer,s.buffer])}subscribe(n){let{props:{id:i,target:r,type:s},uuid:o}=n;this.postMessage({op:"subscribe",props:{id:i,target:r,type:s},uuid:o})}terminate(){var n;(n=this.worker)==null||n.terminate(),this.worker=null}unsubscribe(n){let{props:i}=n;this.postMessage({op:"unsubscribe",props:i})}wakeUp(n){let{uuid:i}=n;this.postMessage({op:"wakeUp",uuid:i})}postMessage(n){if(this.worker)return this.worker.postMessage(n);this.messageQueue.push(n)}}class Bc{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){e===void 0&&(e=new ee);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){n===void 0&&(n=new ee);const i=this.elements,r=e.x,s=e.y,o=e.z;return n.x=i[0]*r+i[1]*s+i[2]*o,n.y=i[3]*r+i[4]*s+i[5]*o,n.z=i[6]*r+i[7]*s+i[8]*o,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){n===void 0&&(n=new Bc);const i=this.elements,r=e.elements,s=n.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],I=i[7],p=i[8],y=r[0],A=r[1],m=r[2],b=r[3],v=r[4],w=r[5],x=r[6],B=r[7],Z=r[8];return s[0]=o*y+a*b+l*x,s[1]=o*A+a*v+l*B,s[2]=o*m+a*w+l*Z,s[3]=c*y+u*b+d*x,s[4]=c*A+u*v+d*B,s[5]=c*m+u*w+d*Z,s[6]=h*y+I*b+p*x,s[7]=h*A+I*v+p*B,s[8]=h*m+I*w+p*Z,n}scale(e,n){n===void 0&&(n=new Bc);const i=this.elements,r=n.elements;for(let s=0;s!==3;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return n}solve(e,n){n===void 0&&(n=new ee);const i=3,r=4,s=[];let o,a;for(o=0;o<i*r;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+r*a]=this.elements[o+3*a];s[3+4*0]=e.x,s[3+4*1]=e.y,s[3+4*2]=e.z;let l=3;const c=l;let u;const d=4;let h;do{if(o=c-l,s[o+r*o]===0){for(a=o+1;a<c;a++)if(s[o+r*a]!==0){u=d;do h=d-u,s[h+r*o]+=s[h+r*a];while(--u);break}}if(s[o+r*o]!==0)for(a=o+1;a<c;a++){const I=s[o+r*a]/s[o+r*o];u=d;do h=d-u,s[h+r*a]=h<=o?0:s[h+r*a]-s[h+r*o]*I;while(--u)}}while(--l);if(n.z=s[2*r+3]/s[2*r+2],n.y=(s[1*r+3]-s[1*r+2]*n.z)/s[1*r+1],n.x=(s[0*r+3]-s[0*r+2]*n.z-s[0*r+1]*n.y)/s[0*r+0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(i===void 0)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";const n=",";for(let i=0;i<9;i++)e+=this.elements[i]+n;return e}reverse(e){e===void 0&&(e=new Bc);const n=3,i=6,r=TUe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+i*o]=this.elements[s+3*o];r[3+6*0]=1,r[3+6*1]=0,r[3+6*2]=0,r[4+6*0]=0,r[4+6*1]=1,r[4+6*2]=0,r[5+6*0]=0,r[5+6*1]=0,r[5+6*2]=1;let a=3;const l=a;let c;const u=i;let d;do{if(s=l-a,r[s+i*s]===0){for(o=s+1;o<l;o++)if(r[s+i*o]!==0){c=u;do d=u-c,r[d+i*s]+=r[d+i*o];while(--c);break}}if(r[s+i*s]!==0)for(o=s+1;o<l;o++){const h=r[s+i*o]/r[s+i*s];c=u;do d=u-c,r[d+i*o]=d<=s?0:r[d+i*o]-r[d+i*s]*h;while(--c)}}while(--a);s=2;do{o=s-1;do{const h=r[s+i*o]/r[s+i*s];c=i;do d=i-c,r[d+i*o]=r[d+i*o]-r[d+i*s]*h;while(--c)}while(o--)}while(--s);s=2;do{const h=1/r[s+i*s];c=i;do d=i-c,r[d+i*s]=r[d+i*s]*h;while(--c)}while(s--);s=2;do{o=2;do{if(d=r[n+o+i*s],isNaN(d)||d===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,d)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,r=e.z,s=e.w,o=n+n,a=i+i,l=r+r,c=n*o,u=n*a,d=n*l,h=i*a,I=i*l,p=r*l,y=s*o,A=s*a,m=s*l,b=this.elements;return b[3*0+0]=1-(h+p),b[3*0+1]=u-m,b[3*0+2]=d+A,b[3*1+0]=u+m,b[3*1+1]=1-(c+p),b[3*1+2]=I-y,b[3*2+0]=d-A,b[3*2+1]=I+y,b[3*2+2]=1-(c+h),this}transpose(e){e===void 0&&(e=new Bc);const n=this.elements,i=e.elements;let r;return i[0]=n[0],i[4]=n[4],i[8]=n[8],r=n[1],i[1]=n[3],i[3]=r,r=n[2],i[2]=n[6],i[6]=r,r=n[5],i[5]=n[7],i[7]=r,e}}const TUe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class ee{constructor(e,n,i){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){n===void 0&&(n=new ee);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return n.x=a*s-l*r,n.y=l*i-o*s,n.z=o*r-a*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(n)n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z;else return new ee(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,n){if(n)n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z;else return new ee(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new Bc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e){e===void 0&&(e=new ee);const n=this.x,i=this.y,r=this.z;let s=Math.sqrt(n*n+i*i+r*r);return s>0?(s=1/s,e.x=n*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,n){n===void 0&&(n=new ee);const i=this.x,r=this.y,s=this.z;return n.x=e*i,n.y=e*r,n.z=e*s,n}vmul(e,n){return n===void 0&&(n=new ee),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return i===void 0&&(i=new ee),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new ee),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const r=XUe,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=EUe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*n,i.y=s+(e.y-s)*n,i.z=o+(e.z-o)*n}almostEquals(e,n){return n===void 0&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(rj),rj.almostEquals(e,n)}clone(){return new ee(this.x,this.y,this.z)}}ee.ZERO=new ee(0,0,0);ee.UNIT_X=new ee(1,0,0);ee.UNIT_Y=new ee(0,1,0);ee.UNIT_Z=new ee(0,0,1);const XUe=new ee,EUe=new ee,rj=new ee;class Ia{constructor(e){e===void 0&&(e={}),this.lowerBound=new ee,this.upperBound=new ee,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,sj),c=sj),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return n&&(n.vadd(s,s),n.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new Ia().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound,o=r.x<=i.x&&i.x<=s.x||n.x<=s.x&&s.x<=i.x,a=r.y<=i.y&&i.y<=s.y||n.y<=s.y&&s.y<=i.y,l=r.z<=i.z&&i.z<=s.z||n.z<=s.z&&s.z<=i.z;return o&&a&&l}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return n.x<=r.x&&i.x>=s.x&&n.y<=r.y&&i.y>=s.y&&n.z<=r.z&&i.z>=s.z}getCorners(e,n,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),n.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,n){const i=oj,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7];this.getCorners(r,s,o,a,l,c,u,d);for(let h=0;h!==8;h++){const I=i[h];e.pointToLocal(I,I)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=oj,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7];this.getCorners(r,s,o,a,l,c,u,d);for(let h=0;h!==8;h++){const I=i[h];e.pointToWorld(I,I)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,r=1/n.x,s=1/n.y,o=1/n.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,d=(this.lowerBound.z-i.z)*o,h=(this.upperBound.z-i.z)*o,I=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(d,h)),p=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(d,h));return!(p<0||I>p)}}const sj=new ee,oj=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee];class ps{constructor(e,n,i,r){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),r===void 0&&(r=1),this.x=e,this.y=n,this.z=i,this.w=r}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(n*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n*.5),this}toAxisAngle(e){e===void 0&&(e=new ee),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=YUe,r=kUe;e.tangents(i,r),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){n===void 0&&(n=new ps);const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return n.x=i*u+o*a+r*c-s*l,n.y=r*u+o*l+s*a-i*c,n.z=s*u+o*c+i*l-r*a,n.w=o*u-i*a-r*l-s*c,n}inverse(e){e===void 0&&(e=new ps);const n=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(n*n+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return e===void 0&&(e=new ps),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){n===void 0&&(n=new ee);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,d=c*r+l*i-o*s,h=c*s+o*r-a*i,I=-o*i-a*r-l*s;return n.x=u*c+I*-o+d*-l-h*-a,n.y=d*c+I*-a+h*-o-u*-l,n.z=h*c+I*-l+u*-a-d*-o,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){n===void 0&&(n="YZX");let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(n){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),i===void 0){const d=o*o,h=a*a,I=l*l;i=Math.atan2(2*a*c-2*o*l,1-2*h-2*I),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*d-2*I)}break;default:throw new Error(`Euler order ${n} not supported yet.`)}e.y=i,e.z=r,e.x=s}setFromEuler(e,n,i,r){r===void 0&&(r="XYZ");const s=Math.cos(e/2),o=Math.cos(n/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(n/2),u=Math.sin(i/2);return r==="XYZ"?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):r==="YXZ"?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):r==="ZXY"?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):r==="ZYX"?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):r==="YZX"?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):r==="XZY"&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new ps(this.x,this.y,this.z,this.w)}slerp(e,n,i){i===void 0&&(i=new ps);const r=this.x,s=this.y,o=this.z,a=this.w;let l=e.x,c=e.y,u=e.z,d=e.w,h,I,p,y,A;return I=r*l+s*c+o*u+a*d,I<0&&(I=-I,l=-l,c=-c,u=-u,d=-d),1-I>1e-6?(h=Math.acos(I),p=Math.sin(h),y=Math.sin((1-n)*h)/p,A=Math.sin(n*h)/p):(y=1-n,A=n),i.x=y*r+A*l,i.y=y*s+A*c,i.z=y*o+A*u,i.w=y*a+A*d,i}integrate(e,n,i,r){r===void 0&&(r=new ps);const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,d=this.w,h=n*.5;return r.x+=h*(s*d+o*u-a*c),r.y+=h*(o*d+a*l-s*u),r.z+=h*(a*d+s*c-o*l),r.w+=h*(-s*l-o*c-a*u),r}}const YUe=new ee,kUe=new ee,HUe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class zt{constructor(e){e===void 0&&(e={}),this.id=zt.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,n,i,r){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}zt.idCounter=0;zt.types=HUe;class js{constructor(e){e===void 0&&(e={}),this.position=new ee,this.quaternion=new ps,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return js.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return js.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return n===void 0&&(n=new ee),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,r){return r===void 0&&(r=new ee),i.vsub(e,r),n.conjugate(aj),aj.vmult(r,r),r}static pointToWorldFrame(e,n,i,r){return r===void 0&&(r=new ee),n.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,n,i){return i===void 0&&(i=new ee),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,r){return r===void 0&&(r=new ee),n.w*=-1,n.vmult(i,r),n.w*=-1,r}}const aj=new ps;new ee;new ee;new ee;new ee;new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee;new ee;new ps;new Ia;new Bc;new Bc;new Bc;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ps;new ee;new ee;new ee;new ee;class O3{constructor(){this.rayFromWorld=new ee,this.rayToWorld=new ee,this.hitNormalWorld=new ee,this.hitPointWorld=new ee,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let rne,sne,one,ane,lne,cne,gne;const Q_={CLOSEST:1,ANY:2,ALL:4};rne=zt.types.SPHERE;sne=zt.types.PLANE;one=zt.types.BOX;ane=zt.types.CYLINDER;lne=zt.types.CONVEXPOLYHEDRON;cne=zt.types.HEIGHTFIELD;gne=zt.types.TRIMESH;class Qr{get[rne](){return this._intersectSphere}get[sne](){return this._intersectPlane}get[one](){return this._intersectBox}get[ane](){return this._intersectConvex}get[lne](){return this._intersectConvex}get[cne](){return this._intersectHeightfield}get[gne](){return this._intersectTrimesh}constructor(e,n){e===void 0&&(e=new ee),n===void 0&&(n=new ee),this.from=e.clone(),this.to=n.clone(),this.direction=new ee,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Qr.ANY,this.result=new O3,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||Qr.ANY,this.result=n.result||new O3,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=typeof n.checkCollisionResponse<"u"?n.checkCollisionResponse:!0,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(lj),lN.length=0,e.broadphase.aabbQuery(e,lj,lN),this.intersectBodies(lN),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=KUe,s=LUe;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,r){const s=this.from;if(i4e(s,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,n,i,r,e)}_intersectBox(e,n,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,r,s)}_intersectPlane(e,n,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new ee(0,0,1);n.vmult(c,c);const u=new ee;o.vsub(i,u);const d=u.dot(c);a.vsub(i,u);const h=u.dot(c);if(d*h>0||o.distanceTo(a)<d)return;const I=c.dot(l);if(Math.abs(I)<this.precision)return;const p=new ee,y=new ee,A=new ee;o.vsub(i,p);const m=-c.dot(p)/I;l.scale(m,y),o.vadd(y,A),this.reportIntersection(c,A,s,r,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,r=this.to,s=this.from;n.x=Math.min(r.x,s.x),n.y=Math.min(r.y,s.y),n.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,n,i,r,s){e.data,e.elementSize;const o=zUe;o.from.copy(this.from),o.to.copy(this.to),js.pointToLocalFrame(i,n,o.from,o.from),js.pointToLocalFrame(i,n,o.to,o.to),o.updateDirection();const a=jUe;let l,c,u,d;l=c=0,u=d=e.data.length-1;const h=new Ia;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),u=Math.min(u,a[0]+1),d=Math.min(d,a[1]+1);for(let I=l;I<u;I++)for(let p=c;p<d;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(I,p,h),!!h.overlapsRay(o)){if(e.getConvexTrianglePillar(I,p,!1),js.pointToWorldFrame(i,n,e.pillarOffset,jv),this._intersectConvex(e.pillarConvex,n,jv,r,s,cj),this.result.shouldStop)return;e.getConvexTrianglePillar(I,p,!0),js.pointToWorldFrame(i,n,e.pillarOffset,jv),this._intersectConvex(e.pillarConvex,n,jv,r,s,cj)}}}_intersectSphere(e,n,i,r,s){const o=this.from,a=this.to,l=e.radius,c=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),d=(o.x-i.x)**2+(o.y-i.y)**2+(o.z-i.z)**2-l**2,h=u**2-4*c*d,I=PUe,p=OUe;if(!(h<0))if(h===0)o.lerp(a,h,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1);else{const y=(-u-Math.sqrt(h))/(2*c),A=(-u+Math.sqrt(h))/(2*c);if(y>=0&&y<=1&&(o.lerp(a,y,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1)),this.result.shouldStop)return;A>=0&&A<=1&&(o.lerp(a,A,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1))}}_intersectConvex(e,n,i,r,s,o){const a=DUe,l=gj,c=o&&o.faceList||null,u=e.faces,d=e.vertices,h=e.faceNormals,I=this.direction,p=this.from,y=this.to,A=p.distanceTo(y),m=c?c.length:u.length,b=this.result;for(let v=0;!b.shouldStop&&v<m;v++){const w=c?c[v]:v,x=u[w],B=h[w],Z=n,N=i;l.copy(d[x[0]]),Z.vmult(l,l),l.vadd(N,l),l.vsub(p,l),Z.vmult(B,a);const W=I.dot(a);if(Math.abs(W)<this.precision)continue;const M=a.dot(l)/W;if(!(M<0)){I.scale(M,ks),ks.vadd(p,ks),Ga.copy(d[x[0]]),Z.vmult(Ga,Ga),N.vadd(Ga,Ga);for(let F=1;!b.shouldStop&&F<x.length-1;F++){Il.copy(d[x[F]]),fl.copy(d[x[F+1]]),Z.vmult(Il,Il),Z.vmult(fl,fl),N.vadd(Il,Il),N.vadd(fl,fl);const T=ks.distanceTo(p);!(Qr.pointInTriangle(ks,Ga,Il,fl)||Qr.pointInTriangle(ks,Il,Ga,fl))||T>A||this.reportIntersection(a,ks,s,r,w)}}}}_intersectTrimesh(e,n,i,r,s,o){const a=UUe,l=t4e,c=n4e,u=gj,d=JUe,h=QUe,I=qUe,p=e4e,y=$Ue,A=e.indices;e.vertices;const m=this.from,b=this.to,v=this.direction;c.position.copy(i),c.quaternion.copy(n),js.vectorToLocalFrame(i,n,v,d),js.pointToLocalFrame(i,n,m,h),js.pointToLocalFrame(i,n,b,I),I.x*=e.scale.x,I.y*=e.scale.y,I.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,I.vsub(h,d),d.normalize();const w=h.distanceSquared(I);e.tree.rayQuery(this,c,l);for(let x=0,B=l.length;!this.result.shouldStop&&x!==B;x++){const Z=l[x];e.getNormal(Z,a),e.getVertex(A[Z*3],Ga),Ga.vsub(h,u);const N=d.dot(a),W=a.dot(u)/N;if(W<0)continue;d.scale(W,ks),ks.vadd(h,ks),e.getVertex(A[Z*3+1],Il),e.getVertex(A[Z*3+2],fl);const M=ks.distanceSquared(h);!(Qr.pointInTriangle(ks,Il,Ga,fl)||Qr.pointInTriangle(ks,Ga,Il,fl))||M>w||(js.vectorToWorldFrame(n,a,y),js.pointToWorldFrame(i,n,ks,p),this.reportIntersection(y,p,s,r,Z))}l.length=0}reportIntersection(e,n,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(n),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case Qr.ALL:this.hasHit=!0,c.set(o,a,e,n,i,r,l),c.hasHit=!0,this.callback(c);break;case Qr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,n,i,r,l));break;case Qr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,n,i,r,l),c.shouldStop=!0;break}}static pointInTriangle(e,n,i,r){r.vsub(n,gd),i.vsub(n,rm),e.vsub(n,cN);const s=gd.dot(gd),o=gd.dot(rm),a=gd.dot(cN),l=rm.dot(rm),c=rm.dot(cN);let u,d;return(u=l*a-o*c)>=0&&(d=s*c-o*a)>=0&&u+d<s*l-o*o}}Qr.CLOSEST=Q_.CLOSEST;Qr.ANY=Q_.ANY;Qr.ALL=Q_.ALL;const lj=new Ia,lN=[],rm=new ee,cN=new ee,KUe=new ee,LUe=new ps,ks=new ee,Ga=new ee,Il=new ee,fl=new ee;new ee;new O3;const cj={faceList:[0]},jv=new ee,zUe=new Qr,jUe=[],PUe=new ee,OUe=new ee,DUe=new ee;new ee;new ee;const gj=new ee,UUe=new ee,JUe=new ee,QUe=new ee,qUe=new ee,$Ue=new ee,e4e=new ee;new Ia;const t4e=[],n4e=new js,gd=new ee,Pv=new ee;function i4e(t,e,n){n.vsub(t,gd);const i=gd.dot(e);return e.scale(i,Pv),Pv.vadd(t,Pv),n.distanceTo(Pv)}new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new Qr;new ee;new ee;new ee;new ee(1,0,0),new ee(0,1,0),new ee(0,0,1);new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new Ia;new ee;new Ia;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new Ia;new ee;new js;new Ia;zt.types.SPHERE,zt.types.SPHERE|zt.types.PLANE,zt.types.BOX|zt.types.BOX,zt.types.SPHERE|zt.types.BOX,zt.types.PLANE|zt.types.BOX,zt.types.CONVEXPOLYHEDRON,zt.types.SPHERE|zt.types.CONVEXPOLYHEDRON,zt.types.PLANE|zt.types.CONVEXPOLYHEDRON,zt.types.BOX|zt.types.CONVEXPOLYHEDRON,zt.types.SPHERE|zt.types.HEIGHTFIELD,zt.types.BOX|zt.types.HEIGHTFIELD,zt.types.CONVEXPOLYHEDRON|zt.types.HEIGHTFIELD,zt.types.PARTICLE|zt.types.SPHERE,zt.types.PLANE|zt.types.PARTICLE,zt.types.BOX|zt.types.PARTICLE,zt.types.PARTICLE|zt.types.CONVEXPOLYHEDRON,zt.types.CYLINDER,zt.types.SPHERE|zt.types.CYLINDER,zt.types.PLANE|zt.types.CYLINDER,zt.types.BOX|zt.types.CYLINDER,zt.types.CONVEXPOLYHEDRON|zt.types.CYLINDER,zt.types.HEIGHTFIELD|zt.types.CYLINDER,zt.types.PARTICLE|zt.types.CYLINDER,zt.types.SPHERE|zt.types.TRIMESH,zt.types.PLANE|zt.types.TRIMESH;new ee;new ee;new ee;new ee;new ee;new ps;new ps;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new Ia;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee,new ee,new ee,new ee,new ee,new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ps;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new Ia;new Qr;const sm=globalThis.performance||{};if(!sm.now){let t=Date.now();sm.timing&&sm.timing.navigationStart&&(t=sm.timing.navigationStart),sm.now=()=>Date.now()-t}new ee;class Sc{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){e===void 0&&(e=new te);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){n===void 0&&(n=new te);const i=this.elements,r=e.x,s=e.y,o=e.z;return n.x=i[0]*r+i[1]*s+i[2]*o,n.y=i[3]*r+i[4]*s+i[5]*o,n.z=i[6]*r+i[7]*s+i[8]*o,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){n===void 0&&(n=new Sc);const i=this.elements,r=e.elements,s=n.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],I=i[7],p=i[8],y=r[0],A=r[1],m=r[2],b=r[3],v=r[4],w=r[5],x=r[6],B=r[7],Z=r[8];return s[0]=o*y+a*b+l*x,s[1]=o*A+a*v+l*B,s[2]=o*m+a*w+l*Z,s[3]=c*y+u*b+d*x,s[4]=c*A+u*v+d*B,s[5]=c*m+u*w+d*Z,s[6]=h*y+I*b+p*x,s[7]=h*A+I*v+p*B,s[8]=h*m+I*w+p*Z,n}scale(e,n){n===void 0&&(n=new Sc);const i=this.elements,r=n.elements;for(let s=0;s!==3;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return n}solve(e,n){n===void 0&&(n=new te);const i=3,r=4,s=[];let o,a;for(o=0;o<i*r;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+r*a]=this.elements[o+3*a];s[3+4*0]=e.x,s[3+4*1]=e.y,s[3+4*2]=e.z;let l=3;const c=l;let u;const d=4;let h;do{if(o=c-l,s[o+r*o]===0){for(a=o+1;a<c;a++)if(s[o+r*a]!==0){u=d;do h=d-u,s[h+r*o]+=s[h+r*a];while(--u);break}}if(s[o+r*o]!==0)for(a=o+1;a<c;a++){const I=s[o+r*a]/s[o+r*o];u=d;do h=d-u,s[h+r*a]=h<=o?0:s[h+r*a]-s[h+r*o]*I;while(--u)}}while(--l);if(n.z=s[2*r+3]/s[2*r+2],n.y=(s[1*r+3]-s[1*r+2]*n.z)/s[1*r+1],n.x=(s[0*r+3]-s[0*r+2]*n.z-s[0*r+1]*n.y)/s[0*r+0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(i===void 0)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";const n=",";for(let i=0;i<9;i++)e+=this.elements[i]+n;return e}reverse(e){e===void 0&&(e=new Sc);const n=3,i=6,r=r4e;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+i*o]=this.elements[s+3*o];r[3+6*0]=1,r[3+6*1]=0,r[3+6*2]=0,r[4+6*0]=0,r[4+6*1]=1,r[4+6*2]=0,r[5+6*0]=0,r[5+6*1]=0,r[5+6*2]=1;let a=3;const l=a;let c;const u=i;let d;do{if(s=l-a,r[s+i*s]===0){for(o=s+1;o<l;o++)if(r[s+i*o]!==0){c=u;do d=u-c,r[d+i*s]+=r[d+i*o];while(--c);break}}if(r[s+i*s]!==0)for(o=s+1;o<l;o++){const h=r[s+i*o]/r[s+i*s];c=u;do d=u-c,r[d+i*o]=d<=s?0:r[d+i*o]-r[d+i*s]*h;while(--c)}}while(--a);s=2;do{o=s-1;do{const h=r[s+i*o]/r[s+i*s];c=i;do d=i-c,r[d+i*o]=r[d+i*o]-r[d+i*s]*h;while(--c)}while(o--)}while(--s);s=2;do{const h=1/r[s+i*s];c=i;do d=i-c,r[d+i*s]=r[d+i*s]*h;while(--c)}while(s--);s=2;do{o=2;do{if(d=r[n+o+i*s],isNaN(d)||d===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,d)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,r=e.z,s=e.w,o=n+n,a=i+i,l=r+r,c=n*o,u=n*a,d=n*l,h=i*a,I=i*l,p=r*l,y=s*o,A=s*a,m=s*l,b=this.elements;return b[3*0+0]=1-(h+p),b[3*0+1]=u-m,b[3*0+2]=d+A,b[3*1+0]=u+m,b[3*1+1]=1-(c+p),b[3*1+2]=I-y,b[3*2+0]=d-A,b[3*2+1]=I+y,b[3*2+2]=1-(c+h),this}transpose(e){e===void 0&&(e=new Sc);const n=this.elements,i=e.elements;let r;return i[0]=n[0],i[4]=n[4],i[8]=n[8],r=n[1],i[1]=n[3],i[3]=r,r=n[2],i[2]=n[6],i[6]=r,r=n[5],i[5]=n[7],i[7]=r,e}}const r4e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class te{constructor(e,n,i){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){n===void 0&&(n=new te);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return n.x=a*s-l*r,n.y=l*i-o*s,n.z=o*r-a*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(n)n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z;else return new te(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,n){if(n)n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z;else return new te(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new Sc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e){e===void 0&&(e=new te);const n=this.x,i=this.y,r=this.z;let s=Math.sqrt(n*n+i*i+r*r);return s>0?(s=1/s,e.x=n*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,n){n===void 0&&(n=new te);const i=this.x,r=this.y,s=this.z;return n.x=e*i,n.y=e*r,n.z=e*s,n}vmul(e,n){return n===void 0&&(n=new te),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return i===void 0&&(i=new te),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new te),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const r=s4e,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=o4e;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*n,i.y=s+(e.y-s)*n,i.z=o+(e.z-o)*n}almostEquals(e,n){return n===void 0&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(uj),uj.almostEquals(e,n)}clone(){return new te(this.x,this.y,this.z)}}te.ZERO=new te(0,0,0);te.UNIT_X=new te(1,0,0);te.UNIT_Y=new te(0,1,0);te.UNIT_Z=new te(0,0,1);const s4e=new te,o4e=new te,uj=new te;class fa{constructor(e){e===void 0&&(e={}),this.lowerBound=new te,this.upperBound=new te,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,dj),c=dj),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return n&&(n.vadd(s,s),n.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new fa().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound,o=r.x<=i.x&&i.x<=s.x||n.x<=s.x&&s.x<=i.x,a=r.y<=i.y&&i.y<=s.y||n.y<=s.y&&s.y<=i.y,l=r.z<=i.z&&i.z<=s.z||n.z<=s.z&&s.z<=i.z;return o&&a&&l}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return n.x<=r.x&&i.x>=s.x&&n.y<=r.y&&i.y>=s.y&&n.z<=r.z&&i.z>=s.z}getCorners(e,n,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),n.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,n){const i=hj,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7];this.getCorners(r,s,o,a,l,c,u,d);for(let h=0;h!==8;h++){const I=i[h];e.pointToLocal(I,I)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=hj,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7];this.getCorners(r,s,o,a,l,c,u,d);for(let h=0;h!==8;h++){const I=i[h];e.pointToWorld(I,I)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,r=1/n.x,s=1/n.y,o=1/n.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,d=(this.lowerBound.z-i.z)*o,h=(this.upperBound.z-i.z)*o,I=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(d,h)),p=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(d,h));return!(p<0||I>p)}}const dj=new te,hj=[new te,new te,new te,new te,new te,new te,new te,new te];class ms{constructor(e,n,i,r){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),r===void 0&&(r=1),this.x=e,this.y=n,this.z=i,this.w=r}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(n*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n*.5),this}toAxisAngle(e){e===void 0&&(e=new te),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=a4e,r=l4e;e.tangents(i,r),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){n===void 0&&(n=new ms);const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return n.x=i*u+o*a+r*c-s*l,n.y=r*u+o*l+s*a-i*c,n.z=s*u+o*c+i*l-r*a,n.w=o*u-i*a-r*l-s*c,n}inverse(e){e===void 0&&(e=new ms);const n=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(n*n+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return e===void 0&&(e=new ms),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){n===void 0&&(n=new te);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,d=c*r+l*i-o*s,h=c*s+o*r-a*i,I=-o*i-a*r-l*s;return n.x=u*c+I*-o+d*-l-h*-a,n.y=d*c+I*-a+h*-o-u*-l,n.z=h*c+I*-l+u*-a-d*-o,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){n===void 0&&(n="YZX");let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(n){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),i===void 0){const d=o*o,h=a*a,I=l*l;i=Math.atan2(2*a*c-2*o*l,1-2*h-2*I),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*d-2*I)}break;default:throw new Error(`Euler order ${n} not supported yet.`)}e.y=i,e.z=r,e.x=s}setFromEuler(e,n,i,r){r===void 0&&(r="XYZ");const s=Math.cos(e/2),o=Math.cos(n/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(n/2),u=Math.sin(i/2);return r==="XYZ"?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):r==="YXZ"?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):r==="ZXY"?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):r==="ZYX"?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):r==="YZX"?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):r==="XZY"&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new ms(this.x,this.y,this.z,this.w)}slerp(e,n,i){i===void 0&&(i=new ms);const r=this.x,s=this.y,o=this.z,a=this.w;let l=e.x,c=e.y,u=e.z,d=e.w,h,I,p,y,A;return I=r*l+s*c+o*u+a*d,I<0&&(I=-I,l=-l,c=-c,u=-u,d=-d),1-I>1e-6?(h=Math.acos(I),p=Math.sin(h),y=Math.sin((1-n)*h)/p,A=Math.sin(n*h)/p):(y=1-n,A=n),i.x=y*r+A*l,i.y=y*s+A*c,i.z=y*o+A*u,i.w=y*a+A*d,i}integrate(e,n,i,r){r===void 0&&(r=new ms);const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,d=this.w,h=n*.5;return r.x+=h*(s*d+o*u-a*c),r.y+=h*(o*d+a*l-s*u),r.z+=h*(a*d+s*c-o*l),r.w+=h*(-s*l-o*c-a*u),r}}const a4e=new te,l4e=new te,c4e={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class jt{constructor(e){e===void 0&&(e={}),this.id=jt.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,n,i,r){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}jt.idCounter=0;jt.types=c4e;class Ps{constructor(e){e===void 0&&(e={}),this.position=new te,this.quaternion=new ms,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return Ps.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return Ps.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return n===void 0&&(n=new te),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,r){return r===void 0&&(r=new te),i.vsub(e,r),n.conjugate(Ij),Ij.vmult(r,r),r}static pointToWorldFrame(e,n,i,r){return r===void 0&&(r=new te),n.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,n,i){return i===void 0&&(i=new te),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,r){return r===void 0&&(r=new te),n.w*=-1,n.vmult(i,r),n.w*=-1,r}}const Ij=new ms;new te;new te;new te;new te;new te,new te,new te,new te,new te,new te,new te,new te;new te;new ms;new fa;new Sc;new Sc;new Sc;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new ms;new te;new te;new te;new te;class D3{constructor(){this.rayFromWorld=new te,this.rayToWorld=new te,this.hitNormalWorld=new te,this.hitPointWorld=new te,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let une,dne,hne,Ine,fne,Cne,pne;const q_={CLOSEST:1,ANY:2,ALL:4};une=jt.types.SPHERE;dne=jt.types.PLANE;hne=jt.types.BOX;Ine=jt.types.CYLINDER;fne=jt.types.CONVEXPOLYHEDRON;Cne=jt.types.HEIGHTFIELD;pne=jt.types.TRIMESH;class qr{get[une](){return this._intersectSphere}get[dne](){return this._intersectPlane}get[hne](){return this._intersectBox}get[Ine](){return this._intersectConvex}get[fne](){return this._intersectConvex}get[Cne](){return this._intersectHeightfield}get[pne](){return this._intersectTrimesh}constructor(e,n){e===void 0&&(e=new te),n===void 0&&(n=new te),this.from=e.clone(),this.to=n.clone(),this.direction=new te,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=qr.ANY,this.result=new D3,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||qr.ANY,this.result=n.result||new D3,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=typeof n.checkCollisionResponse<"u"?n.checkCollisionResponse:!0,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(fj),gN.length=0,e.broadphase.aabbQuery(e,fj,gN),this.intersectBodies(gN),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=g4e,s=u4e;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,r){const s=this.from;if(G4e(s,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,n,i,r,e)}_intersectBox(e,n,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,r,s)}_intersectPlane(e,n,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new te(0,0,1);n.vmult(c,c);const u=new te;o.vsub(i,u);const d=u.dot(c);a.vsub(i,u);const h=u.dot(c);if(d*h>0||o.distanceTo(a)<d)return;const I=c.dot(l);if(Math.abs(I)<this.precision)return;const p=new te,y=new te,A=new te;o.vsub(i,p);const m=-c.dot(p)/I;l.scale(m,y),o.vadd(y,A),this.reportIntersection(c,A,s,r,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,r=this.to,s=this.from;n.x=Math.min(r.x,s.x),n.y=Math.min(r.y,s.y),n.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,n,i,r,s){e.data,e.elementSize;const o=d4e;o.from.copy(this.from),o.to.copy(this.to),Ps.pointToLocalFrame(i,n,o.from,o.from),Ps.pointToLocalFrame(i,n,o.to,o.to),o.updateDirection();const a=h4e;let l,c,u,d;l=c=0,u=d=e.data.length-1;const h=new fa;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),u=Math.min(u,a[0]+1),d=Math.min(d,a[1]+1);for(let I=l;I<u;I++)for(let p=c;p<d;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(I,p,h),!!h.overlapsRay(o)){if(e.getConvexTrianglePillar(I,p,!1),Ps.pointToWorldFrame(i,n,e.pillarOffset,Ov),this._intersectConvex(e.pillarConvex,n,Ov,r,s,Cj),this.result.shouldStop)return;e.getConvexTrianglePillar(I,p,!0),Ps.pointToWorldFrame(i,n,e.pillarOffset,Ov),this._intersectConvex(e.pillarConvex,n,Ov,r,s,Cj)}}}_intersectSphere(e,n,i,r,s){const o=this.from,a=this.to,l=e.radius,c=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),d=(o.x-i.x)**2+(o.y-i.y)**2+(o.z-i.z)**2-l**2,h=u**2-4*c*d,I=I4e,p=f4e;if(!(h<0))if(h===0)o.lerp(a,h,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1);else{const y=(-u-Math.sqrt(h))/(2*c),A=(-u+Math.sqrt(h))/(2*c);if(y>=0&&y<=1&&(o.lerp(a,y,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1)),this.result.shouldStop)return;A>=0&&A<=1&&(o.lerp(a,A,I),I.vsub(i,p),p.normalize(),this.reportIntersection(p,I,s,r,-1))}}_intersectConvex(e,n,i,r,s,o){const a=C4e,l=pj,c=o&&o.faceList||null,u=e.faces,d=e.vertices,h=e.faceNormals,I=this.direction,p=this.from,y=this.to,A=p.distanceTo(y),m=c?c.length:u.length,b=this.result;for(let v=0;!b.shouldStop&&v<m;v++){const w=c?c[v]:v,x=u[w],B=h[w],Z=n,N=i;l.copy(d[x[0]]),Z.vmult(l,l),l.vadd(N,l),l.vsub(p,l),Z.vmult(B,a);const W=I.dot(a);if(Math.abs(W)<this.precision)continue;const M=a.dot(l)/W;if(!(M<0)){I.scale(M,Hs),Hs.vadd(p,Hs),Ba.copy(d[x[0]]),Z.vmult(Ba,Ba),N.vadd(Ba,Ba);for(let F=1;!b.shouldStop&&F<x.length-1;F++){Cl.copy(d[x[F]]),pl.copy(d[x[F+1]]),Z.vmult(Cl,Cl),Z.vmult(pl,pl),N.vadd(Cl,Cl),N.vadd(pl,pl);const T=Hs.distanceTo(p);!(qr.pointInTriangle(Hs,Ba,Cl,pl)||qr.pointInTriangle(Hs,Cl,Ba,pl))||T>A||this.reportIntersection(a,Hs,s,r,w)}}}}_intersectTrimesh(e,n,i,r,s,o){const a=p4e,l=x4e,c=w4e,u=pj,d=m4e,h=A4e,I=y4e,p=v4e,y=b4e,A=e.indices;e.vertices;const m=this.from,b=this.to,v=this.direction;c.position.copy(i),c.quaternion.copy(n),Ps.vectorToLocalFrame(i,n,v,d),Ps.pointToLocalFrame(i,n,m,h),Ps.pointToLocalFrame(i,n,b,I),I.x*=e.scale.x,I.y*=e.scale.y,I.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,I.vsub(h,d),d.normalize();const w=h.distanceSquared(I);e.tree.rayQuery(this,c,l);for(let x=0,B=l.length;!this.result.shouldStop&&x!==B;x++){const Z=l[x];e.getNormal(Z,a),e.getVertex(A[Z*3],Ba),Ba.vsub(h,u);const N=d.dot(a),W=a.dot(u)/N;if(W<0)continue;d.scale(W,Hs),Hs.vadd(h,Hs),e.getVertex(A[Z*3+1],Cl),e.getVertex(A[Z*3+2],pl);const M=Hs.distanceSquared(h);!(qr.pointInTriangle(Hs,Cl,Ba,pl)||qr.pointInTriangle(Hs,Ba,Cl,pl))||M>w||(Ps.vectorToWorldFrame(n,a,y),Ps.pointToWorldFrame(i,n,Hs,p),this.reportIntersection(y,p,s,r,Z))}l.length=0}reportIntersection(e,n,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(n),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case qr.ALL:this.hasHit=!0,c.set(o,a,e,n,i,r,l),c.hasHit=!0,this.callback(c);break;case qr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,n,i,r,l));break;case qr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,n,i,r,l),c.shouldStop=!0;break}}static pointInTriangle(e,n,i,r){r.vsub(n,ud),i.vsub(n,om),e.vsub(n,uN);const s=ud.dot(ud),o=ud.dot(om),a=ud.dot(uN),l=om.dot(om),c=om.dot(uN);let u,d;return(u=l*a-o*c)>=0&&(d=s*c-o*a)>=0&&u+d<s*l-o*o}}qr.CLOSEST=q_.CLOSEST;qr.ANY=q_.ANY;qr.ALL=q_.ALL;const fj=new fa,gN=[],om=new te,uN=new te,g4e=new te,u4e=new ms,Hs=new te,Ba=new te,Cl=new te,pl=new te;new te;new D3;const Cj={faceList:[0]},Ov=new te,d4e=new qr,h4e=[],I4e=new te,f4e=new te,C4e=new te;new te;new te;const pj=new te,p4e=new te,m4e=new te,A4e=new te,y4e=new te,b4e=new te,v4e=new te;new fa;const x4e=[],w4e=new Ps,ud=new te,Dv=new te;function G4e(t,e,n){n.vsub(t,ud);const i=ud.dot(e);return e.scale(i,Dv),Dv.vadd(t,Dv),n.distanceTo(Dv)}new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new qr;new te;new te;new te;new te(1,0,0),new te(0,1,0),new te(0,0,1);new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new fa;new te;new fa;new te;new te;new te;new te;new te;new te;new te;new fa;new te;new Ps;new fa;jt.types.SPHERE,jt.types.SPHERE|jt.types.PLANE,jt.types.BOX|jt.types.BOX,jt.types.SPHERE|jt.types.BOX,jt.types.PLANE|jt.types.BOX,jt.types.CONVEXPOLYHEDRON,jt.types.SPHERE|jt.types.CONVEXPOLYHEDRON,jt.types.PLANE|jt.types.CONVEXPOLYHEDRON,jt.types.BOX|jt.types.CONVEXPOLYHEDRON,jt.types.SPHERE|jt.types.HEIGHTFIELD,jt.types.BOX|jt.types.HEIGHTFIELD,jt.types.CONVEXPOLYHEDRON|jt.types.HEIGHTFIELD,jt.types.PARTICLE|jt.types.SPHERE,jt.types.PLANE|jt.types.PARTICLE,jt.types.BOX|jt.types.PARTICLE,jt.types.PARTICLE|jt.types.CONVEXPOLYHEDRON,jt.types.CYLINDER,jt.types.SPHERE|jt.types.CYLINDER,jt.types.PLANE|jt.types.CYLINDER,jt.types.BOX|jt.types.CYLINDER,jt.types.CONVEXPOLYHEDRON|jt.types.CYLINDER,jt.types.HEIGHTFIELD|jt.types.CYLINDER,jt.types.PARTICLE|jt.types.CYLINDER,jt.types.SPHERE|jt.types.TRIMESH,jt.types.PLANE|jt.types.TRIMESH;new te;new te;new te;new te;new te;new ms;new ms;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new fa;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te,new te,new te,new te,new te,new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new te;new ms;new te;new te;new te;new te;new te;new te;new te;new te;new te;new fa;new qr;const am=globalThis.performance||{};if(!am.now){let t=Date.now();am.timing&&am.timing.navigationStart&&(t=am.timing.navigationStart),am.now=()=>Date.now()-t}new te;const B4e=S.createContext(null);new J(1,1,1);new J;new Qt;new Tn;new no;const S4e=new J,Z4e=new J(1,1,1),R4e=new Zr,Uv=new Qt;function mj(t,e,n,i,r){return i===void 0&&(i=Z4e),t!==void 0?(Uv.compose(S4e.fromArray(e,t*3),R4e.fromArray(n,t*4),i),r&&(r.matrixAutoUpdate=!1,r.matrix.copy(Uv)),Uv):Uv.identity()}const N4e=()=>{const t=[];return e=>t.includes(e)?!1:!!t.push(e)};function W4e(t){let{allowSleep:e=!1,axisIndex:n=0,broadphase:i="Naive",children:r,defaultContactMaterial:s={contactEquationStiffness:1e6},frictionGravity:o=null,gravity:a=[0,-9.81,0],isPaused:l=!1,iterations:c=5,maxSubSteps:u=10,quatNormalizeFast:d=!1,quatNormalizeSkip:h=0,shouldInvalidate:I=!0,size:p=1e3,solver:y="GS",stepSize:A=1/60,tolerance:m=.001}=t;const{invalidate:b}=Fr(),[{bodies:v,events:w,refs:x,scaleOverrides:B,subscriptions:Z,worker:N}]=S.useState(()=>({bodies:{},events:{},refs:{},scaleOverrides:{},subscriptions:{},worker:new _Ue({allowSleep:e,axisIndex:n,broadphase:i,defaultContactMaterial:s,frictionGravity:o,gravity:a,iterations:c,quatNormalizeFast:d,quatNormalizeSkip:h,size:p,solver:y,tolerance:m})}));let W=0;const M=S.useCallback((O,_)=>{l||(W+=_,N.step({maxSubSteps:u,stepSize:A,timeSinceLastCalled:W}),W=0)},[l,u,A]),F=O=>{var _;let{body:E,contact:{bi:P,bj:q,...re},target:de,...Re}=O;const Pe=(_=w[de])==null?void 0:_.collide;Pe&&Pe({body:x[E],contact:{bi:x[P],bj:x[q],...re},target:x[de],...Re})},T=O=>{var _,E;let{bodyA:P,bodyB:q}=O;const re=(_=w[P])==null?void 0:_.collideBegin;re&&re({body:x[q],op:"event",target:x[P],type:"collideBegin"});const de=(E=w[q])==null?void 0:E.collideBegin;de&&de({body:x[P],op:"event",target:x[q],type:"collideBegin"})},H=O=>{var _,E;let{bodyA:P,bodyB:q}=O;const re=(_=w[P])==null?void 0:_.collideEnd;re&&re({body:x[q],op:"event",target:x[P],type:"collideEnd"});const de=(E=w[q])==null?void 0:E.collideEnd;de&&de({body:x[P],op:"event",target:x[q],type:"collideEnd"})},K=O=>{let{active:_,bodies:E=[],observations:P,positions:q,quaternions:re}=O;for(let de=0;de<E.length;de++)v[E[de]]=de;if(P.forEach(de=>{let[Re,Pe,ae]=de;const Me=(Z[Re]||{})[ae];Me&&Me(Pe)}),!!_){for(const de of Object.values(x).filter(N4e()))if(de instanceof I_)for(let Re=0;Re<de.count;Re++){const Pe=`${de.uuid}/${Re}`,ae=v[Pe];ae!==void 0&&(de.setMatrixAt(Re,mj(ae,q,re,B[Pe])),de.instanceMatrix.needsUpdate=!0)}else{const Re=B[de.uuid]||de.scale;mj(v[de.uuid],q,re,Re,de)}I&&b()}},z=O=>{var _;let{body:E,ray:{uuid:P,...q},...re}=O;const de=(_=w[P])==null?void 0:_.rayhit;de&&de({body:E?x[E]:null,ray:{uuid:P,...q},...re})};Fs(M),S.useEffect(()=>(N.connect(),N.init(),N.on("collide",F),N.on("collideBegin",T),N.on("collideEnd",H),N.on("frame",K),N.on("rayhit",z),()=>{N.terminate(),N.removeAllListeners()}),[]),S.useEffect(()=>{N.axisIndex=n},[n]),S.useEffect(()=>{N.broadphase=i},[i]),S.useEffect(()=>{N.gravity=a},[a]),S.useEffect(()=>{N.iterations=c},[c]),S.useEffect(()=>{N.tolerance=m},[m]);const j=S.useMemo(()=>({bodies:v,events:w,refs:x,scaleOverrides:B,subscriptions:Z,worker:N}),[v,w,x,Z,N]);return g.jsx(B4e.Provider,{value:j,children:r})}const Ll=Object.create(null);Ll.open="0";Ll.close="1";Ll.ping="2";Ll.pong="3";Ll.message="4";Ll.upgrade="5";Ll.noop="6";const Sx=Object.create(null);Object.keys(Ll).forEach(t=>{Sx[Ll[t]]=t});const U3={type:"error",data:"parser error"},mne=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ane=typeof ArrayBuffer=="function",yne=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,$_=({type:t,data:e},n,i)=>mne&&e instanceof Blob?n?i(e):Aj(e,i):Ane&&(e instanceof ArrayBuffer||yne(e))?n?i(e):Aj(new Blob([e]),i):i(Ll[t]+(e||"")),Aj=(t,e)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];e("b"+(i||""))},n.readAsDataURL(t)};function yj(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let dN;function M4e(t,e){if(mne&&t.data instanceof Blob)return t.data.arrayBuffer().then(yj).then(e);if(Ane&&(t.data instanceof ArrayBuffer||yne(t.data)))return e(yj(t.data));$_(t,!1,n=>{dN||(dN=new TextEncoder),e(dN.encode(n))})}const bj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<bj.length;t++)bm[bj.charCodeAt(t)]=t;const V4e=t=>{let e=t.length*.75,n=t.length,i,r=0,s,o,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(i=0;i<n;i+=4)s=bm[t.charCodeAt(i)],o=bm[t.charCodeAt(i+1)],a=bm[t.charCodeAt(i+2)],l=bm[t.charCodeAt(i+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|l&63;return c},F4e=typeof ArrayBuffer=="function",eT=(t,e)=>{if(typeof t!="string")return{type:"message",data:bne(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:_4e(t.substring(1),e)}:Sx[n]?t.length>1?{type:Sx[n],data:t.substring(1)}:{type:Sx[n]}:U3},_4e=(t,e)=>{if(F4e){const n=V4e(t);return bne(n,e)}else return{base64:!0,data:t}},bne=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},vne="",T4e=(t,e)=>{const n=t.length,i=new Array(n);let r=0;t.forEach((s,o)=>{$_(s,!1,a=>{i[o]=a,++r===n&&e(i.join(vne))})})},X4e=(t,e)=>{const n=t.split(vne),i=[];for(let r=0;r<n.length;r++){const s=eT(n[r],e);if(i.push(s),s.type==="error")break}return i};function E4e(){return new TransformStream({transform(t,e){M4e(t,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const s=new DataView(r.buffer);s.setUint8(0,126),s.setUint16(1,i)}else{r=new Uint8Array(9);const s=new DataView(r.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}t.data&&typeof t.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(n)})}})}let hN;function Jv(t){return t.reduce((e,n)=>e+n.length,0)}function Qv(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let i=0;for(let r=0;r<e;r++)n[r]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),n}function Y4e(t,e){hN||(hN=new TextDecoder);const n=[];let i=0,r=-1,s=!1;return new TransformStream({transform(o,a){for(n.push(o);;){if(i===0){if(Jv(n)<1)break;const l=Qv(n,1);s=(l[0]&128)===128,r=l[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(Jv(n)<2)break;const l=Qv(n,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),i=3}else if(i===2){if(Jv(n)<8)break;const l=Qv(n,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(U3);break}r=u*Math.pow(2,32)+c.getUint32(4),i=3}else{if(Jv(n)<r)break;const l=Qv(n,r);a.enqueue(eT(s?l:hN.decode(l),e)),i=0}if(r===0||r>t){a.enqueue(U3);break}}}})}const xne=4;function nr(t){if(t)return k4e(t)}function k4e(t){for(var e in nr.prototype)t[e]=nr.prototype[e];return t}nr.prototype.on=nr.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};nr.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};nr.prototype.off=nr.prototype.removeListener=nr.prototype.removeAllListeners=nr.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===e||i.fn===e){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+t],this};nr.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,e)}return this};nr.prototype.emitReserved=nr.prototype.emit;nr.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};nr.prototype.hasListeners=function(t){return!!this.listeners(t).length};const SS=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),Uo=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),H4e="arraybuffer";function wne(t,...e){return e.reduce((n,i)=>(t.hasOwnProperty(i)&&(n[i]=t[i]),n),{})}const K4e=Uo.setTimeout,L4e=Uo.clearTimeout;function ZS(t,e){e.useNativeTimers?(t.setTimeoutFn=K4e.bind(Uo),t.clearTimeoutFn=L4e.bind(Uo)):(t.setTimeoutFn=Uo.setTimeout.bind(Uo),t.clearTimeoutFn=Uo.clearTimeout.bind(Uo))}const z4e=1.33;function j4e(t){return typeof t=="string"?P4e(t):Math.ceil((t.byteLength||t.size)*z4e)}function P4e(t){let e=0,n=0;for(let i=0,r=t.length;i<r;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}function Gne(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function O4e(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function D4e(t){let e={},n=t.split("&");for(let i=0,r=n.length;i<r;i++){let s=n[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class U4e extends Error{constructor(e,n,i){super(e),this.description=n,this.context=i,this.type="TransportError"}}class tT extends nr{constructor(e){super(),this.writable=!1,ZS(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,i){return super.emitReserved("error",new U4e(e,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=eT(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=O4e(e);return n.length?"?"+n:""}}class J4e extends tT{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};X4e(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,T4e(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Gne()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let Bne=!1;try{Bne=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Q4e=Bne;function q4e(){}class $4e extends J4e{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,n){const i=this.request({method:"POST",data:e});i.on("success",n),i.on("error",(r,s)=>{this.onError("xhr post error",r,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=e}}let nf=class Zx extends nr{constructor(e,n,i){super(),this.createRequest=e,ZS(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const n=wne(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Zx.requestsCount++,Zx.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=q4e,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Zx.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};nf.requestsCount=0;nf.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",vj);else if(typeof addEventListener=="function"){const t="onpagehide"in Uo?"pagehide":"unload";addEventListener(t,vj,!1)}}function vj(){for(let t in nf.requests)nf.requests.hasOwnProperty(t)&&nf.requests[t].abort()}const eJe=function(){const t=Sne({xdomain:!1});return t&&t.responseType!==null}();class tJe extends $4e{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=eJe&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new nf(Sne,this.uri(),e)}}function Sne(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Q4e))return new XMLHttpRequest}catch{}if(!e)try{return new Uo[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Zne=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class nJe extends tT{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,i=Zne?{}:wne(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],r=n===e.length-1;$_(i,this.supportsBinary,s=>{try{this.doWrite(i,s)}catch{}r&&SS(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Gne()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const IN=Uo.WebSocket||Uo.MozWebSocket;class iJe extends nJe{createSocket(e,n,i){return Zne?new IN(e,n,i):n?new IN(e,n):new IN(e)}doWrite(e,n){this.ws.send(n)}}class rJe extends tT{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=Y4e(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(n).getReader(),r=E4e();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const s=()=>{i.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],r=n===e.length-1;this._writer.write(i).then(()=>{r&&SS(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const sJe={websocket:iJe,webtransport:rJe,polling:tJe},oJe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,aJe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function J3(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),i=t.indexOf("]");n!=-1&&i!=-1&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let r=oJe.exec(t||""),s={},o=14;for(;o--;)s[aJe[o]]=r[o]||"";return n!=-1&&i!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=lJe(s,s.path),s.queryKey=cJe(s,s.query),s}function lJe(t,e){const n=/\/{2,9}/g,i=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function cJe(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,s){r&&(n[r]=s)}),n}const Q3=typeof addEventListener=="function"&&typeof removeEventListener=="function",Rx=[];Q3&&addEventListener("offline",()=>{Rx.forEach(t=>t())},!1);class qg extends nr{constructor(e,n){if(super(),this.binaryType=H4e,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const i=J3(e);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=J3(n.host).host);ZS(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=D4e(this.opts.query)),Q3&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Rx.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=xne,n.transport=e,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&qg.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",qg.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(n+=j4e(r)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,SS(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,i){return this._sendPacket("message",e,n,i),this}send(e,n,i){return this._sendPacket("message",e,n,i),this}_sendPacket(e,n,i,r){if(typeof n=="function"&&(r=n,n=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const s={type:e,data:n,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(qg.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Q3&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Rx.indexOf(this._offlineEventListener);i!==-1&&Rx.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}qg.protocol=xne;class gJe extends qg{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),i=!1;qg.priorWebsocketSuccess=!1;const r=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;qg.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function s(){i||(i=!0,u(),n.close(),n=null)}const o=d=>{const h=new Error("probe error: "+d);h.transport=n.name,s(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function l(){o("socket closed")}function c(d){n&&d.name!==n.name&&s()}const u=()=>{n.removeListener("open",r),n.removeListener("error",o),n.removeListener("close",a),this.off("close",l),this.off("upgrading",c)};n.once("open",r),n.once("error",o),n.once("close",a),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&n.push(e[i]);return n}}let uJe=class extends gJe{constructor(e,n={}){const i=typeof e=="object"?e:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>sJe[r]).filter(r=>!!r)),super(e,i)}};function dJe(t,e="",n){let i=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),i=J3(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(n&&n.port===i.port?"":":"+i.port),i}const hJe=typeof ArrayBuffer=="function",IJe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Rne=Object.prototype.toString,fJe=typeof Blob=="function"||typeof Blob<"u"&&Rne.call(Blob)==="[object BlobConstructor]",CJe=typeof File=="function"||typeof File<"u"&&Rne.call(File)==="[object FileConstructor]";function nT(t){return hJe&&(t instanceof ArrayBuffer||IJe(t))||fJe&&t instanceof Blob||CJe&&t instanceof File}function Nx(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,i=t.length;n<i;n++)if(Nx(t[n]))return!0;return!1}if(nT(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Nx(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Nx(t[n]))return!0;return!1}function pJe(t){const e=[],n=t.data,i=t;return i.data=q3(n,e),i.attachments=e.length,{packet:i,buffers:e}}function q3(t,e){if(!t)return t;if(nT(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=q3(t[i],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=q3(t[i],e));return n}return t}function mJe(t,e){return t.data=$3(t.data,e),delete t.attachments,t}function $3(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=$3(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=$3(t[n],e));return t}const AJe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],yJe=5;var Vn;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Vn||(Vn={}));class bJe{constructor(e){this.replacer=e}encode(e){return(e.type===Vn.EVENT||e.type===Vn.ACK)&&Nx(e)?this.encodeAsBinary({type:e.type===Vn.EVENT?Vn.BINARY_EVENT:Vn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===Vn.BINARY_EVENT||e.type===Vn.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=pJe(e),i=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(i),r}}function xj(t){return Object.prototype.toString.call(t)==="[object Object]"}class iT extends nr{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const i=n.type===Vn.BINARY_EVENT;i||n.type===Vn.BINARY_ACK?(n.type=i?Vn.EVENT:Vn.ACK,this.reconstructor=new vJe(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(nT(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const i={type:Number(e.charAt(0))};if(Vn[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===Vn.BINARY_EVENT||i.type===Vn.BINARY_ACK){const s=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(s,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(n+1)==="/"){const s=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););i.nsp=e.substring(s,n)}else i.nsp="/";const r=e.charAt(n+1);if(r!==""&&Number(r)==r){const s=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}i.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){const s=this.tryParse(e.substr(n));if(iT.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case Vn.CONNECT:return xj(n);case Vn.DISCONNECT:return n===void 0;case Vn.CONNECT_ERROR:return typeof n=="string"||xj(n);case Vn.EVENT:case Vn.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&AJe.indexOf(n[0])===-1);case Vn.ACK:case Vn.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vJe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=mJe(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const xJe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:iT,Encoder:bJe,get PacketType(){return Vn},protocol:yJe},Symbol.toStringTag,{value:"Module"}));function _a(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const wJe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Nne extends nr{constructor(e,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_a(e,"open",this.onopen.bind(this)),_a(e,"packet",this.onpacket.bind(this)),_a(e,"error",this.onerror.bind(this)),_a(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var i,r,s;if(wJe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Vn.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,d=n.pop();this._registerAckCallback(u,d),o.id=u}const a=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var i;const r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[e]=n;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);n.call(this,new Error("operation has timed out"))},r),o=(...a)=>{this.io.clearTimeoutFn(s),n.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((i,r)=>{const s=(o,a)=>o?r(o):i(a);s.withError=!0,n.push(s),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...s)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...s)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Vn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Vn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Vn.EVENT:case Vn.BINARY_EVENT:this.onevent(e);break;case Vn.ACK:case Vn.BINARY_ACK:this.onack(e);break;case Vn.DISCONNECT:this.ondisconnect();break;case Vn.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let i=!1;return function(...r){i||(i=!0,n.packet({type:Vn.ACK,id:e,data:r}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Vn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,e.data)}}}function ep(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ep.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};ep.prototype.reset=function(){this.attempts=0};ep.prototype.setMin=function(t){this.ms=t};ep.prototype.setMax=function(t){this.max=t};ep.prototype.setJitter=function(t){this.jitter=t};class eV extends nr{constructor(e,n){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,ZS(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new ep({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const r=n.parser||xJe;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new uJe(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=_a(n,"open",function(){i.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=_a(n,"error",s);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{r(),s(new Error("timeout")),n.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_a(e,"ping",this.onping.bind(this)),_a(e,"data",this.ondata.bind(this)),_a(e,"error",this.onerror.bind(this)),_a(e,"close",this.onclose.bind(this)),_a(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){SS(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new Nne(this,e,n),this.nsps[e]=i),i}_destroy(e){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let i=0;i<n.length;i++)this.engine.write(n[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const lm={};function Wx(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=dJe(t,e.path||"/socket.io"),i=n.source,r=n.id,s=n.path,o=lm[r]&&s in lm[r].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new eV(i,e):(lm[r]||(lm[r]=new eV(i,e)),l=lm[r]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}Object.assign(Wx,{Manager:eV,Socket:Nne,io:Wx,connect:Wx});const GJe=`
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  uniform float time;
  uniform float temperature;

  void main() {
    vUv = uv;
    vPosition = position;
    vNormal = normal;

    // Add wave animation based on temperature
    float wave = sin(position.x * 10.0 + time * 2.0) * sin(position.z * 10.0 + time * 1.5) * temperature * 0.01;
    vec3 newPosition = position + normal * wave;

    gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
  }
`,BJe=`
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  uniform float time;
  uniform float temperature;
  uniform vec3 color;

  void main() {
    // Base color transitions from orange to white based on temperature
    vec3 baseColor = mix(vec3(1.0, 0.5, 0.0), vec3(1.0, 1.0, 1.0), temperature);

    // Add some noise for realistic surface
    float noise = sin(vUv.x * 50.0 + time) * sin(vUv.y * 50.0 + time * 0.7) * 0.1;

    // Fresnel effect for edge glow
    vec3 viewDirection = normalize(cameraPosition - vPosition);
    float fresnel = pow(1.0 - dot(viewDirection, vNormal), 2.0);

    vec3 finalColor = baseColor + noise + fresnel * vec3(1.0, 0.8, 0.4) * temperature;

    gl_FragColor = vec4(finalColor, 1.0);
  }
`;function SJe({emissions:t}){const e=S.useRef(null);Fs(i=>{if(e.current){const r=e.current.geometry.attributes.position.array;for(let s=0;s<r.length;s+=3)r[s+1]+=.01,r[s+1]>8&&(r[s+1]=5,r[s]=(Math.random()-.5)*.8,r[s+2]=(Math.random()-.5)*.8);e.current.geometry.attributes.position.needsUpdate=!0}});const n=Math.floor(t/5)+10;return g.jsxs("points",{ref:e,children:[g.jsx("bufferGeometry",{children:g.jsx("bufferAttribute",{attach:"attributes-position",count:n,array:new Float32Array(n*3).map((i,r)=>r%3===0?(Math.random()-.5)*.8:r%3===1?5+Math.random()*2:(Math.random()-.5)*.8),itemSize:3})}),g.jsx("pointsMaterial",{size:.05,color:"#666666",transparent:!0,opacity:.6,sizeAttenuation:!0})]})}function ZJe({temperature:t,doorOpen:e,vibration:n,showCrossSection:i,emergencyMode:r,failureScenario:s}){const o=S.useRef(null),a=S.useRef(null),l=S.useRef(null),c=S.useRef(null);return Fs(u=>{var d,h,I,p,y;if(o.current){const A=(d=o.current.children.find(m=>m.name==="moltenMetal"))==null?void 0:d.material;if(A&&A.uniforms&&(A.uniforms.time.value=u.clock.elapsedTime,A.uniforms.temperature.value=(t-1e3)/1e3),r){const m=(h=o.current.children.find(b=>b.name==="moltenMetal"))==null?void 0:h.material;m&&m.uniforms&&(m.uniforms.temperature.value=Math.max(0,m.uniforms.temperature.value-.01))}if(s)switch(s){case"overheat":const m=(I=o.current.children.find(x=>x.name==="moltenMetal"))==null?void 0:I.material;m&&m.uniforms&&(m.uniforms.temperature.value=Math.min(1,m.uniforms.temperature.value+.005));break;case"vibration":const b=.02;o.current.position.x=(Math.random()-.5)*b,o.current.position.z=(Math.random()-.5)*b;return;case"gas-leak":const v=(p=o.current.children.find(x=>x.name==="outerShell"))==null?void 0:p.material;v&&(v.transparent=!0,v.opacity=.7);break;case"power-failure":const w=(y=o.current.children.find(x=>x.name==="moltenMetal"))==null?void 0:y.material;w&&w.uniforms&&(w.uniforms.temperature.value=Math.max(0,w.uniforms.temperature.value-.002));break}if(n>3&&s!=="vibration"){const m=(n-3)*.005;o.current.position.x=(Math.random()-.5)*m,o.current.position.z=(Math.random()-.5)*m}else(!s||s!=="vibration")&&(o.current.position.x=0,o.current.position.z=0)}if(a.current){const A=e||r?Math.PI/2:0;a.current.rotation.y+=(A-a.current.rotation.y)*.05}l.current&&(l.current.visible=i),c.current&&(c.current.position.y=6+Math.sin(u.clock.elapsedTime*.5)*.2)}),g.jsxs("group",{ref:o,name:"Furnace_Root",children:[g.jsxs("mesh",{position:[0,2,0],name:"outerShell",children:[g.jsx("cylinderGeometry",{args:[1.25,1.45,4.2,32,1,!1,0,Math.PI*2]}),g.jsx("meshStandardMaterial",{color:"#2a2a2a",roughness:.7,metalness:.95,transparent:i,opacity:i?.3:1})]}),Array.from({length:8},(u,d)=>g.jsxs("mesh",{position:[0,2,0],rotation:[0,d*Math.PI/4,0],children:[g.jsx("boxGeometry",{args:[.05,4.2,.1]}),g.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.9,roughness:.6})]},`rib-${d}`)),g.jsxs("mesh",{position:[0,1.2,0],children:[g.jsx("torusGeometry",{args:[1.3,.1,8,32]}),g.jsx("meshStandardMaterial",{color:"#666666",roughness:.8})]}),g.jsxs("mesh",{position:[0,2.8,0],children:[g.jsx("torusGeometry",{args:[1.3,.1,8,32]}),g.jsx("meshStandardMaterial",{color:"#666666",roughness:.8})]}),Array.from({length:16},(u,d)=>g.jsxs("mesh",{position:[Math.cos(d*Math.PI/8)*1.35,2+Math.sin(d*Math.PI/4)*.8,Math.sin(d*Math.PI/8)*1.35],children:[g.jsx("cylinderGeometry",{args:[.03,.03,.1,8]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.8,roughness:.4})]},`bolt-${d}`)),Array.from({length:4},(u,d)=>g.jsxs("mesh",{position:[Math.cos(d*Math.PI/2)*1.26,2.5,Math.sin(d*Math.PI/2)*1.26],children:[g.jsx("planeGeometry",{args:[.2,.3]}),g.jsx("meshStandardMaterial",{color:"#ffaa00",emissive:"#442200",emissiveIntensity:t>1400?.5:.2,transparent:!0,opacity:.8})]},`window-${d}`)),g.jsxs("mesh",{position:[0,1.5,0],children:[g.jsx("torusGeometry",{args:[1.4,.05,6,32]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.3})]}),g.jsxs("mesh",{position:[0,2.5,0],children:[g.jsx("torusGeometry",{args:[1.4,.05,6,32]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.3})]}),g.jsxs("mesh",{position:[0,1.8,0],name:"moltenMetal",children:[g.jsx("cylinderGeometry",{args:[1.1,1.15,3.2,32]}),g.jsx("shaderMaterial",{vertexShader:GJe,fragmentShader:BJe,uniforms:{time:{value:0},temperature:{value:(t-1e3)/1e3},color:{value:new wt(1,.5,0)}}})]}),g.jsxs("mesh",{position:[0,1.8,0],children:[g.jsx("cylinderGeometry",{args:[1.12,1.12,3.3,32]}),g.jsx("meshBasicMaterial",{color:"#ff4400",transparent:!0,opacity:.1+(t-1e3)/1e3*.3})]}),g.jsxs("mesh",{ref:l,position:[0,2,0],rotation:[0,Math.PI/2,0],children:[g.jsx("planeGeometry",{args:[2.5,4.2]}),g.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:.8,side:rs})]}),g.jsxs("group",{ref:a,position:[1.25,1.8,0],children:[g.jsxs("mesh",{position:[0,0,0],children:[g.jsx("boxGeometry",{args:[.15,1.4,.08]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.5})]}),g.jsxs("mesh",{position:[-.1,.5,0],children:[g.jsx("cylinderGeometry",{args:[.08,.08,.2,16]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7})]}),g.jsxs("mesh",{position:[-.1,-.5,0],children:[g.jsx("cylinderGeometry",{args:[.08,.08,.2,16]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7})]}),g.jsxs("mesh",{position:[-.2,.3,0],children:[g.jsx("boxGeometry",{args:[.25,.05,.05]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.9})]}),g.jsxs("mesh",{position:[-.2,-.3,0],children:[g.jsx("boxGeometry",{args:[.25,.05,.05]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.9})]})]}),g.jsxs("mesh",{position:[0,5.5,0],children:[g.jsx("cylinderGeometry",{args:[.4,.5,3.5,16]}),g.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.8,roughness:.6})]}),g.jsxs("group",{name:"Sensors_Group",children:[g.jsxs("group",{position:[1.6,3.2,0],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.1,.3,.1]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8})]}),g.jsxs("mesh",{position:[0,.2,0],children:[g.jsx("sphereGeometry",{args:[.08,16,16]}),g.jsx("meshStandardMaterial",{color:t>1500?"#ff0000":t>1400?"#ffaa00":"#00ff00",emissive:t>1500?"#440000":t>1400?"#442200":"#004400",emissiveIntensity:.8})]}),g.jsxs("mesh",{position:[0,-.2,0],children:[g.jsx("cylinderGeometry",{args:[.02,.02,.4,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]})]}),g.jsxs("group",{position:[-1.6,3.2,0],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.1,.3,.1]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8})]}),g.jsxs("mesh",{position:[0,.2,0],children:[g.jsx("sphereGeometry",{args:[.08,16,16]}),g.jsx("meshStandardMaterial",{color:"#4444ff",emissive:"#000044",emissiveIntensity:.8})]}),g.jsxs("mesh",{position:[0,-.2,0],children:[g.jsx("cylinderGeometry",{args:[.02,.02,.4,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]})]}),g.jsxs("group",{position:[0,3.2,1.6],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.1,.3,.1]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8})]}),g.jsxs("mesh",{position:[0,.2,0],children:[g.jsx("sphereGeometry",{args:[.08,16,16]}),g.jsx("meshStandardMaterial",{color:n>4?"#ff0000":n>3?"#ffaa00":"#00ff00",emissive:n>4?"#440000":n>3?"#442200":"#004400",emissiveIntensity:.8})]}),g.jsxs("mesh",{position:[0,-.2,0],children:[g.jsx("cylinderGeometry",{args:[.02,.02,.4,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]})]})]}),g.jsxs("mesh",{name:"temp_sensor_anchor",position:[1.6,3.5,0],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"emissions_sensor_anchor",position:[-1.6,3.5,0],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"vibration_sensor_anchor",position:[0,3.5,1.6],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"energy_panel_anchor",position:[2.5,1.5,2],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"system_status_anchor",position:[0,4,0],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]})]})}function RJe({scrapLevel:t}){const e=S.useRef(null),n=S.useRef(null);return Fs(i=>{var r;e.current&&e.current.material&&((r=e.current.material.map)==null||r.offset.set(i.clock.elapsedTime*.5,0)),n.current&&n.current.children.forEach((s,o)=>{s.rotation.x=i.clock.elapsedTime*2+o*.5})}),g.jsxs("group",{name:"Conveyor_Root",children:[g.jsxs("mesh",{position:[-3,.3,0],children:[g.jsx("boxGeometry",{args:[4.2,.6,1.4]}),g.jsx("meshStandardMaterial",{color:"#2a2a2a",metalness:.8,roughness:.4})]}),g.jsxs("mesh",{position:[-3,.9,.7],children:[g.jsx("boxGeometry",{args:[4.2,.8,.1]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[-3,.9,-.7],children:[g.jsx("boxGeometry",{args:[4.2,.8,.1]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[-3,1.2,0],children:[g.jsx("boxGeometry",{args:[4.2,.1,1.4]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.7,roughness:.5})]}),Array.from({length:4},(i,r)=>g.jsxs("group",{position:[-3+(r-1.5)*1.2,-.2,0],children:[g.jsxs("mesh",{children:[g.jsx("cylinderGeometry",{args:[.08,.08,.8,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9,roughness:.3})]}),g.jsxs("mesh",{position:[0,-.4,0],children:[g.jsx("cylinderGeometry",{args:[.12,.12,.1,8]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.4})]})]},`leg-${r}`)),g.jsx("group",{ref:n,children:Array.from({length:6},(i,r)=>g.jsxs("mesh",{position:[-3+(r-2.5)*.7,.7,0],children:[g.jsx("cylinderGeometry",{args:[.06,.06,1.2,12]}),g.jsx("meshStandardMaterial",{color:"#222222",metalness:.9,roughness:.2})]},`roller-${r}`))}),g.jsxs("mesh",{ref:e,position:[-3,.71,0],rotation:[-Math.PI/2,0,0],children:[g.jsx("planeGeometry",{args:[3.8,1]}),g.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.8})]}),g.jsxs("group",{position:[-5,1.5,0],name:"RoboticArm",children:[g.jsxs("mesh",{children:[g.jsx("cylinderGeometry",{args:[.2,.2,.3,16]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.4})]}),g.jsxs("mesh",{position:[.8,.5,0],rotation:[0,0,Math.PI/6],children:[g.jsx("boxGeometry",{args:[1.6,.15,.15]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.9,roughness:.3})]}),g.jsxs("mesh",{position:[1.8,1,0],rotation:[0,0,Math.PI/4],children:[g.jsx("boxGeometry",{args:[.8,.12,.12]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.9,roughness:.3})]}),g.jsxs("mesh",{position:[2.3,1.2,0],children:[g.jsx("boxGeometry",{args:[.3,.1,.2]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[0,.2,0],children:[g.jsx("sphereGeometry",{args:[.05,8,8]}),g.jsx("meshStandardMaterial",{color:"#00ff00",emissive:"#004400",emissiveIntensity:.5})]})]}),Array.from({length:Math.floor(t/10)},(i,r)=>g.jsxs("group",{position:[-3+(r-4)*.4,.8,(Math.random()-.5)*.5],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.15,.08,.12]}),g.jsx("meshStandardMaterial",{color:"#654321",roughness:.9})]}),g.jsxs("mesh",{position:[0,.05,0],children:[g.jsx("boxGeometry",{args:[.12,.06,.1]}),g.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.8})]})]},`scrap-${r}`)),g.jsxs("group",{position:[-1,1.2,1],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.4,.6,.1]}),g.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),g.jsxs("mesh",{position:[0,.1,.06],children:[g.jsx("planeGeometry",{args:[.3,.4]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.3})]})]})]})}function NJe(){const t=S.useRef(null);return Fs(e=>{t.current&&t.current.children.forEach((n,i)=>{const r=n;if(r.material){const s=r.material;s.emissiveIntensity=.3+Math.sin(e.clock.elapsedTime*2+i)*.1}})}),g.jsxs("group",{name:"Cooling_System_Root",position:[2,0,-3],children:[g.jsxs("mesh",{position:[0,1.5,0],children:[g.jsx("cylinderGeometry",{args:[.8,1,3,16]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5})]}),g.jsxs("group",{ref:t,children:[Array.from({length:3},(e,n)=>g.jsxs("mesh",{position:[0,1+n*.5,0],children:[g.jsx("cylinderGeometry",{args:[.1,.1,2,12]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.3,transparent:!0,opacity:.8})]},`h-pipe-${n}`)),Array.from({length:4},(e,n)=>g.jsxs("mesh",{position:[-1+n*.5,1.5,0],children:[g.jsx("cylinderGeometry",{args:[.08,.08,3,12]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.3,transparent:!0,opacity:.8})]},`v-pipe-${n}`))]}),Array.from({length:6},(e,n)=>g.jsxs("mesh",{position:[-.8+n*.3,2.5,0],rotation:[0,0,Math.PI/2],children:[g.jsx("coneGeometry",{args:[.05,.15,8]}),g.jsx("meshStandardMaterial",{color:"#00ffff",emissive:"#004444",emissiveIntensity:.5})]},`arrow-${n}`)),Array.from({length:3},(e,n)=>g.jsxs("group",{position:[-.5+n*.5,.5,0],children:[g.jsxs("mesh",{children:[g.jsx("cylinderGeometry",{args:[.12,.12,.2,12]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8})]}),g.jsxs("mesh",{position:[0,0,.15],children:[g.jsx("torusGeometry",{args:[.08,.02,8,16]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]})]},`valve-${n}`)),g.jsxs("mesh",{position:[0,3.2,0],children:[g.jsx("cylinderGeometry",{args:[.3,.4,.5,12]}),g.jsx("meshStandardMaterial",{color:"#cccccc",metalness:.6,roughness:.4})]})]})}function WJe({emissions:t}){const e=S.useRef(null);return Fs(n=>{if(e.current&&e.current.material){const i=e.current.material;i.emissiveIntensity=.5+Math.sin(n.clock.elapsedTime*3)*.2}}),g.jsxs("group",{name:"Emissions_Scrubber",position:[-4,0,4],children:[g.jsxs("mesh",{position:[0,1.5,0],children:[g.jsx("cylinderGeometry",{args:[.6,.8,3,16]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.7,roughness:.6})]}),Array.from({length:8},(n,i)=>g.jsxs("mesh",{position:[Math.cos(i*Math.PI/4)*.4,1.5+Math.sin(i*Math.PI/2)*.5,Math.sin(i*Math.PI/4)*.4],children:[g.jsx("boxGeometry",{args:[.1,.8,.1]}),g.jsx("meshStandardMaterial",{color:"#666666",roughness:.9})]},`filter-${i}`)),g.jsxs("mesh",{ref:e,position:[.8,2,0],children:[g.jsx("boxGeometry",{args:[.4,.6,.05]}),g.jsx("meshStandardMaterial",{color:"#001122",emissive:"#004466",emissiveIntensity:.5})]}),g.jsxs("mesh",{position:[.8,2,.03],children:[g.jsx("planeGeometry",{args:[.35,.5]}),g.jsx("meshStandardMaterial",{color:"#00ffaa",emissive:"#004422",emissiveIntensity:.3})]}),g.jsxs("mesh",{position:[.6,2.3,0],children:[g.jsx("sphereGeometry",{args:[.03,8,8]}),g.jsx("meshStandardMaterial",{color:t>60?"#ff0000":t>40?"#ffaa00":"#00ff00",emissive:t>60?"#440000":t>40?"#442200":"#004400",emissiveIntensity:.8})]}),g.jsxs("mesh",{position:[0,3.2,0],children:[g.jsx("cylinderGeometry",{args:[.2,.3,1,12]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.4})]})]})}function MJe({energy:t}){const e=S.useRef(null);return Fs(n=>{if(e.current&&e.current.material){const i=e.current.material;i.emissiveIntensity=.2+t/1500*.8+Math.sin(n.clock.elapsedTime*4)*.1}}),g.jsxs("group",{name:"Energy_Module",position:[3,0,2],children:[g.jsxs("mesh",{position:[0,1,0],children:[g.jsx("boxGeometry",{args:[1.2,2,.8]}),g.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.9,roughness:.3})]}),Array.from({length:6},(n,i)=>g.jsxs("mesh",{position:[.6,.5+i*.25,0],children:[g.jsx("boxGeometry",{args:[.1,.15,.6]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8,roughness:.4})]},`fin-${i}`)),g.jsxs("mesh",{ref:e,position:[0,1,0],children:[g.jsx("sphereGeometry",{args:[.3,16,16]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.5,transparent:!0,opacity:.7})]}),g.jsxs("mesh",{position:[0,1,.41],children:[g.jsx("planeGeometry",{args:[1,1.8]}),g.jsx("meshStandardMaterial",{color:"#00ffaa",emissive:"#004422",emissiveIntensity:.3})]}),Array.from({length:4},(n,i)=>g.jsxs("mesh",{position:[-.4,.5+i*.3,.41],children:[g.jsx("sphereGeometry",{args:[.02,8,8]}),g.jsx("meshStandardMaterial",{color:i===0?"#00ff00":i===1?"#ffff00":i===2?"#ffaa00":"#ff0000",emissive:i===0?"#004400":i===1?"#444400":i===2?"#442200":"#440000",emissiveIntensity:.6})]},`indicator-${i}`)),g.jsxs("mesh",{position:[.6,1.5,0],rotation:[0,0,Math.PI/2],children:[g.jsx("cylinderGeometry",{args:[.03,.03,.8,8]}),g.jsx("meshStandardMaterial",{color:"#333333"})]}),g.jsxs("mesh",{position:[-.6,1.5,0],rotation:[0,0,Math.PI/2],children:[g.jsx("cylinderGeometry",{args:[.03,.03,.8,8]}),g.jsx("meshStandardMaterial",{color:"#333333"})]})]})}function VJe(){const t=S.useRef(null),e=S.useRef(null);return Fs(n=>{e.current&&(e.current.position.x=Math.sin(n.clock.elapsedTime*.3)*2),t.current&&(t.current.position.y=4+Math.sin(n.clock.elapsedTime*.5)*.5)}),g.jsxs("group",{name:"Crane_Root",position:[0,6,0],children:[g.jsxs("mesh",{position:[0,0,0],children:[g.jsx("boxGeometry",{args:[8,.3,.3]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.4})]}),g.jsxs("mesh",{position:[0,-.3,0],children:[g.jsx("boxGeometry",{args:[8,.3,.3]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8,roughness:.4})]}),g.jsxs("mesh",{position:[-3.5,-3,0],children:[g.jsx("cylinderGeometry",{args:[.15,.15,6,12]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[3.5,-3,0],children:[g.jsx("cylinderGeometry",{args:[.15,.15,6,12]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[0,-.6,0],children:[g.jsx("boxGeometry",{args:[8,.1,.1]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.9,roughness:.3})]}),g.jsxs("group",{ref:e,position:[0,-.8,0],children:[g.jsxs("mesh",{children:[g.jsx("boxGeometry",{args:[.8,.4,.4]}),g.jsx("meshStandardMaterial",{color:"#222222",metalness:.8,roughness:.4})]}),g.jsxs("group",{position:[0,-.3,0],children:[g.jsxs("mesh",{children:[g.jsx("cylinderGeometry",{args:[.05,.05,.6,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]}),g.jsxs("mesh",{ref:t,position:[0,-.4,0],children:[g.jsx("coneGeometry",{args:[.1,.2,8]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.8})]})]}),g.jsxs("mesh",{position:[.3,.1,0],children:[g.jsx("sphereGeometry",{args:[.03,8,8]}),g.jsx("meshStandardMaterial",{color:"#00ff00",emissive:"#004400",emissiveIntensity:.5})]}),g.jsxs("mesh",{position:[-.3,.1,0],children:[g.jsx("sphereGeometry",{args:[.03,8,8]}),g.jsx("meshStandardMaterial",{color:"#ffff00",emissive:"#444400",emissiveIntensity:.5})]})]})]})}function FJe(){return g.jsxs("group",{name:"ControlRoom_Root",position:[6,2,-4],children:[g.jsxs("mesh",{position:[0,0,0],children:[g.jsx("boxGeometry",{args:[3,2.5,2]}),g.jsx("meshStandardMaterial",{color:"#cccccc",transparent:!0,opacity:.3,metalness:.1,roughness:.1})]}),g.jsxs("mesh",{position:[1.51,0,0],children:[g.jsx("planeGeometry",{args:[2,2.5]}),g.jsx("meshStandardMaterial",{color:"#aaccff",transparent:!0,opacity:.2,side:rs})]}),g.jsxs("mesh",{position:[-1.51,0,0],children:[g.jsx("planeGeometry",{args:[2,2.5]}),g.jsx("meshStandardMaterial",{color:"#aaccff",transparent:!0,opacity:.2,side:rs})]}),g.jsxs("mesh",{position:[.5,-.5,0],children:[g.jsx("boxGeometry",{args:[1,.1,.8]}),g.jsx("meshStandardMaterial",{color:"#8B4513"})]}),g.jsxs("mesh",{position:[-.5,-.5,0],children:[g.jsx("boxGeometry",{args:[1,.1,.8]}),g.jsx("meshStandardMaterial",{color:"#8B4513"})]}),g.jsxs("mesh",{position:[.5,.2,.41],children:[g.jsx("planeGeometry",{args:[.8,.6]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.4,transparent:!0,opacity:.8})]}),g.jsxs("mesh",{position:[-.5,.2,.41],children:[g.jsx("planeGeometry",{args:[.8,.6]}),g.jsx("meshStandardMaterial",{color:"#00ffaa",emissive:"#004422",emissiveIntensity:.4,transparent:!0,opacity:.8})]}),g.jsx("group",{position:[0,-1.5,1],children:Array.from({length:5},(t,e)=>g.jsxs("mesh",{position:[0,e*.2,-e*.2],children:[g.jsx("boxGeometry",{args:[2,.05,.3]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.6})]},`step-${e}`))})]})}function _Je(){return g.jsxs("group",{name:"Walkway_Railings",children:[g.jsxs("mesh",{position:[0,3.5,0],children:[g.jsx("cylinderGeometry",{args:[3.5,3.5,.2,32]}),g.jsx("meshStandardMaterial",{color:"#444444",metalness:.7,roughness:.5})]}),g.jsxs("mesh",{position:[0,4,0],children:[g.jsx("torusGeometry",{args:[3.5,.05,8,32]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]}),g.jsxs("mesh",{position:[0,4.3,0],children:[g.jsx("torusGeometry",{args:[3.5,.05,8,32]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]}),Array.from({length:8},(t,e)=>g.jsxs("mesh",{position:[Math.cos(e*Math.PI/4)*3.5,3.8,Math.sin(e*Math.PI/4)*3.5],children:[g.jsx("cylinderGeometry",{args:[.05,.05,.6,8]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.9})]},`support-${e}`)),g.jsx("group",{position:[4,1.5,0],children:Array.from({length:10},(t,e)=>g.jsxs("group",{children:[g.jsxs("mesh",{position:[0,e*.3,0],children:[g.jsx("cylinderGeometry",{args:[.02,.02,.4,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]}),g.jsxs("mesh",{position:[.2,e*.3,0],children:[g.jsx("cylinderGeometry",{args:[.02,.02,.4,8]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]})]},`rung-${e}`))}),Array.from({length:16},(t,e)=>g.jsxs("mesh",{position:[Math.cos(e*Math.PI/8)*3.6,4.1,Math.sin(e*Math.PI/8)*3.6],children:[g.jsx("sphereGeometry",{args:[.02,6,6]}),g.jsx("meshStandardMaterial",{color:"#00aaff",emissive:"#002244",emissiveIntensity:.6})]},`led-${e}`))]})}function TJe(){return g.jsxs("group",{name:"HVAC_Ducting",children:[g.jsxs("mesh",{position:[0,8,0],children:[g.jsx("boxGeometry",{args:[1,.5,1]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.6,roughness:.5})]}),g.jsxs("mesh",{position:[1.5,7.5,0],rotation:[0,0,Math.PI/4],children:[g.jsx("boxGeometry",{args:[1.5,.4,.4]}),g.jsx("meshStandardMaterial",{color:"#555555",metalness:.7,roughness:.4})]}),g.jsxs("mesh",{position:[-1.5,7.5,0],rotation:[0,0,-Math.PI/4],children:[g.jsx("boxGeometry",{args:[1.5,.4,.4]}),g.jsx("meshStandardMaterial",{color:"#555555",metalness:.7,roughness:.4})]}),Array.from({length:4},(t,e)=>g.jsxs("mesh",{position:[Math.cos(e*Math.PI/2)*.8,8.26,Math.sin(e*Math.PI/2)*.8],children:[g.jsx("planeGeometry",{args:[.3,.3]}),g.jsx("meshStandardMaterial",{color:"#333333",transparent:!0,opacity:.7})]},`grille-${e}`)),g.jsxs("mesh",{position:[2,9,0],children:[g.jsx("cylinderGeometry",{args:[.08,.08,4,12]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]}),g.jsxs("mesh",{position:[-2,9,0],children:[g.jsx("cylinderGeometry",{args:[.08,.08,4,12]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.8})]})]})}function XJe(){return g.jsxs("group",{name:"Environment_Root",children:[g.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.1,0],children:[g.jsx("planeGeometry",{args:[25,25]}),g.jsx("meshStandardMaterial",{color:"#2a2a2a",roughness:.8,metalness:.1})]}),g.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.09,0],children:[g.jsx("planeGeometry",{args:[25,25]}),g.jsx("meshStandardMaterial",{color:"#444444",transparent:!0,opacity:.3,roughness:.1,metalness:.9})]}),g.jsxs("mesh",{position:[0,.1,-6],children:[g.jsx("boxGeometry",{args:[6,.2,4]}),g.jsx("meshStandardMaterial",{color:"#333333",metalness:.6,roughness:.5})]}),g.jsxs("mesh",{position:[0,.11,-6],children:[g.jsx("boxGeometry",{args:[5.8,.01,3.8]}),g.jsx("meshStandardMaterial",{color:"#ffff00",transparent:!0,opacity:.2})]}),g.jsxs("mesh",{position:[3,0,-4],rotation:[0,0,Math.PI/6],children:[g.jsx("boxGeometry",{args:[3,.15,1.5]}),g.jsx("meshStandardMaterial",{color:"#666666",metalness:.5,roughness:.6})]}),Array.from({length:6},(t,e)=>g.jsxs("group",{position:[Math.cos(e*Math.PI/3)*8,7,Math.sin(e*Math.PI/3)*8],children:[g.jsxs("mesh",{children:[g.jsx("cylinderGeometry",{args:[.1,.1,.5,8]}),g.jsx("meshStandardMaterial",{color:"#333333"})]}),g.jsx("pointLight",{position:[0,-.3,0],intensity:1,color:"#ffffff",distance:10})]},`light-${e}`))]})}function qv({sensor:t,position:e}){const n=S.useRef(null);Fs(r=>{n.current&&(n.current.position.y=e[1]+Math.sin(r.clock.elapsedTime*2+e[0])*.1)});const i=r=>{switch(r){case"critical":return"text-red-400 border-red-400/50 shadow-red-400/20";case"warning":return"text-yellow-400 border-yellow-400/50 shadow-yellow-400/20";default:return"text-green-400 border-green-400/50 shadow-green-400/20"}};return g.jsx(P_,{position:e,center:!0,children:g.jsxs("div",{className:`bg-black/90 ${i(t.status)} px-3 py-2 rounded-lg text-sm font-mono border backdrop-blur-sm shadow-lg transition-all duration-300 hover:scale-110`,children:[g.jsx("div",{className:"font-semibold",children:t.name}),g.jsxs("div",{className:"text-lg font-bold",children:[t.value,t.unit]}),g.jsx("div",{className:`w-2 h-2 rounded-full mx-auto mt-1 ${t.status==="critical"?"bg-red-400 animate-pulse":t.status==="warning"?"bg-yellow-400 animate-pulse":"bg-green-400"}`})]})})}function $v({position:t,onClick:e,tooltip:n,status:i}){const[r,s]=S.useState(!1),o=S.useRef(null);Fs(l=>{if(o.current){const c=1+Math.sin(l.clock.elapsedTime*3)*.1;o.current.scale.setScalar(c)}});const a=l=>{switch(l){case"critical":return"#ff0000";case"warning":return"#ffaa00";default:return"#00ff00"}};return g.jsxs("group",{children:[g.jsxs("mesh",{ref:o,position:t,onClick:e,onPointerOver:()=>s(!0),onPointerOut:()=>s(!1),children:[g.jsx("sphereGeometry",{args:[.15,16,16]}),g.jsx("meshStandardMaterial",{color:a(i),emissive:a(i),emissiveIntensity:.3})]}),g.jsxs("mesh",{position:t,rotation:[0,0,Math.PI/2],children:[g.jsx("torusGeometry",{args:[.2,.02,8,16]}),g.jsx("meshBasicMaterial",{color:a(i),transparent:!0,opacity:.6})]}),r&&g.jsx(P_,{position:t,center:!0,children:g.jsx("div",{className:"bg-black/90 text-white px-3 py-2 rounded-lg text-sm font-mono border border-cyan-400/50 backdrop-blur-sm shadow-lg",children:n})})]})}function EJe({sensorData:t}){const e=[{time:"+5min",temp:t.temperature+20,emissions:t.emissions+5},{time:"+10min",temp:t.temperature+40,emissions:t.emissions+10},{time:"+15min",temp:t.temperature+60,emissions:t.emissions+15},{time:"+20min",temp:t.temperature+80,emissions:t.emissions+20},{time:"+25min",temp:t.temperature+100,emissions:t.emissions+25},{time:"+30min",temp:t.temperature+120,emissions:t.emissions+30}];return g.jsx(P_,{fullscreen:!0,children:g.jsxs("div",{className:"absolute top-4 right-4 bg-black/80 backdrop-blur-sm rounded-lg p-4 border border-cyan-400/50",children:[g.jsx("h3",{className:"text-cyan-400 font-bold mb-3",children:"30-Minute Forecast"}),g.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:e.map((n,i)=>g.jsxs("div",{className:"flex justify-between items-center text-sm",children:[g.jsx("span",{className:"text-gray-300",children:n.time}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("span",{className:`font-mono ${n.temp>1600?"text-red-400":n.temp>1500?"text-yellow-400":"text-green-400"}`,children:[n.temp,"C"]}),g.jsxs("span",{className:`font-mono ${n.emissions>70?"text-red-400":n.emissions>50?"text-yellow-400":"text-green-400"}`,children:[n.emissions,"ppm"]})]})]},i))}),g.jsx("div",{className:"mt-3 text-xs text-gray-400",children:" Critical threshold: 1600C / 70ppm"})]})})}function YJe({sensorData:t,selectedFurnace:e,cameraView:n,showCrossSection:i,forecastMode:r,emergencyMode:s,failureScenario:o}){const a=S.useRef(),l=S.useRef(null),c=S.useRef({x:0,y:0});Fr(),S.useEffect(()=>{const d=h=>{c.current.x=h.clientX/window.innerWidth*2-1,c.current.y=-(h.clientY/window.innerHeight)*2+1};return window.addEventListener("mousemove",d),()=>window.removeEventListener("mousemove",d)},[]),Fs(d=>{if(l.current){const h=Math.sin(d.clock.elapsedTime*.5)*.1,I=Math.sin(d.clock.elapsedTime*.2)*.02,p=.3,y=I+c.current.x*p,A=c.current.y*p*.5;l.current.position.y=h,l.current.rotation.y+=(y-l.current.rotation.y)*.05,l.current.rotation.x+=(A-l.current.rotation.x)*.05}});const u={overview:{position:[5,5,5],target:[0,2,0]},top:{position:[0,10,0],target:[0,0,0]},front:{position:[0,2,8],target:[0,2,0]},side:{position:[8,2,0],target:[0,2,0]},interior:{position:[0,2,2],target:[0,2,0]}};return S.useEffect(()=>{a.current&&u[n]},[n]),g.jsxs("group",{ref:l,children:[g.jsx(QDe,{preset:"warehouse"}),g.jsx("fog",{attach:"fog",args:["#1a1a1a",10,50]}),g.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0}),g.jsx("pointLight",{position:[0,5,0],intensity:2,color:"#ff6600"}),g.jsx("ambientLight",{intensity:.3}),g.jsxs(W4e,{gravity:[0,-9.81,0],children:[g.jsx(XJe,{}),g.jsx(ZJe,{temperature:t.temperature,doorOpen:t.doorStatus==="open",vibration:t.vibration,showCrossSection:i,emergencyMode:s,failureScenario:o}),g.jsx(RJe,{scrapLevel:t.scrapLevel}),g.jsx(NJe,{}),g.jsx(WJe,{emissions:t.emissions}),g.jsx(MJe,{energy:t.energy}),g.jsx(VJe,{}),g.jsx(FJe,{}),g.jsx(_Je,{}),g.jsx(TJe,{}),g.jsx(SJe,{emissions:t.emissions}),g.jsxs("mesh",{position:[0,2,0],children:[g.jsx("sphereGeometry",{args:[1.3,16,16]}),g.jsx("meshBasicMaterial",{color:"#ffaa00",transparent:!0,opacity:.1+(t.temperature-1e3)/1e3*.2})]}),g.jsx(sN,{count:50,scale:[10,10,10],size:2,speed:.3,opacity:.6,color:"#ff6600"}),g.jsx(sN,{count:30,scale:[4,2,4],position:[2,2,-3],size:1,speed:.5,opacity:.4,color:"#ffffff"}),g.jsx(sN,{count:20,scale:[2,2,2],position:[c.current.x*3,c.current.y*2+1,0],size:.5,speed:1,opacity:.6,color:"#00aaff"}),g.jsx($v,{position:[1.6,3.2,0],onClick:()=>console.log("Temperature sensor clicked"),tooltip:`Temperature Sensor - Current: ${t.temperature}C`,status:t.temperature>1500?"critical":t.temperature>1400?"warning":"normal"}),g.jsx($v,{position:[-1.6,3.2,0],onClick:()=>console.log("Emissions sensor clicked"),tooltip:`Gas Emissions Sensor - Current: ${t.emissions} ppm`,status:t.emissions>60?"critical":t.emissions>40?"warning":"normal"}),g.jsx($v,{position:[0,3.2,1.6],onClick:()=>console.log("Vibration sensor clicked"),tooltip:`Vibration Sensor - Current: ${t.vibration} Hz`,status:t.vibration>4?"critical":t.vibration>3?"warning":"normal"}),g.jsx($v,{position:[2.5,1.5,2],onClick:()=>console.log("Energy monitor clicked"),tooltip:`Energy Monitor - Current: ${t.energy} kW`,status:t.energy>1400?"critical":t.energy>1200?"warning":"normal"}),g.jsx(qv,{sensor:{name:"Temperature",value:t.temperature,unit:"C",status:t.temperature>1500?"critical":t.temperature>1400?"warning":"normal"},position:[1.6,3.7,0]}),g.jsx(qv,{sensor:{name:"Emissions",value:t.emissions,unit:"ppm",status:t.emissions>60?"critical":t.emissions>40?"warning":"normal"},position:[-1.6,3.7,0]}),g.jsx(qv,{sensor:{name:"Vibration",value:t.vibration,unit:"Hz",status:t.vibration>4?"critical":t.vibration>3?"warning":"normal"},position:[0,3.7,1.6]}),g.jsx(qv,{sensor:{name:"Energy",value:t.energy,unit:"kW",status:t.energy>1400?"critical":t.energy>1200?"warning":"normal"},position:[2.5,2,2]}),g.jsxs("mesh",{name:"system_status_anchor",position:[0,4.5,0],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"camera_ui_anchor",position:[0,5,8],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]}),g.jsxs("mesh",{name:"maintenance_anchor",position:[4,2,0],children:[g.jsx("sphereGeometry",{args:[.01,8,8]}),g.jsx("meshBasicMaterial",{visible:!1})]})]}),g.jsx(VDe,{ref:a,enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:2,maxDistance:50,maxPolarAngle:Math.PI,minPolarAngle:0,enableDamping:!0,dampingFactor:.05,rotateSpeed:.5,panSpeed:.8,zoomSpeed:.6}),r&&g.jsx(EJe,{sensorData:t})]})}function kJe(){S.useState(null);const[t,e]=S.useState("F1"),[n,i]=S.useState("overview");S.useState(!0),S.useState(100);const[r,s]=S.useState(!1),[o,a]=S.useState("realtime"),[l,c]=S.useState(!1),[u,d]=S.useState(!1),[h,I]=S.useState(null),[p,y]=S.useState(!1),[A,m]=S.useState([]),[b,v]=S.useState(0);S.useRef(null);const{data:w=[],isLoading:x}=vD({queryKey:["/api/hotspots"],refetchInterval:2e3}),{data:B}=Lq(),[Z,N]=S.useState({temperature:1420,emissions:45,vibration:3.2,purity:94,energy:1250,doorStatus:"closed",oxygenFlow:92,scrapLevel:75}),[W,M]=S.useState(null);S.useEffect(()=>{const O=Wx("http://localhost:5000");return M(O),O.on("sensorData",_=>{N(_)}),()=>{O.close()}},[]),S.useEffect(()=>{var O,_,E,P,q,re,de,Re;if(B!=null&&B.sensors){const Pe=B.sensors;N({temperature:((O=Pe.find(ae=>ae.type==="temperature"))==null?void 0:O.value)||1420,emissions:((_=Pe.find(ae=>ae.type==="emissions"))==null?void 0:_.value)||45,vibration:((E=Pe.find(ae=>ae.type==="vibration"))==null?void 0:E.value)||3.2,purity:((P=Pe.find(ae=>ae.type==="purity"))==null?void 0:P.value)||94,energy:((q=Pe.find(ae=>ae.type==="energy"))==null?void 0:q.value)||1250,doorStatus:((re=Pe.find(ae=>ae.type==="door"))==null?void 0:re.value)||"closed",oxygenFlow:((de=Pe.find(ae=>ae.type==="oxygen"))==null?void 0:de.value)||92,scrapLevel:((Re=Pe.find(ae=>ae.type==="scrapLevel"))==null?void 0:Re.value)||75})}},[B]);const F=O=>{i(O)},T=()=>{c(!l)},H=()=>{const O=document.querySelector('[data-testid="canvas-3d-twin"]');O&&O.requestFullscreen&&(document.fullscreenElement?document.exitFullscreen():O.requestFullscreen())},K=()=>{var P,q;const O=document.querySelector('[data-testid="canvas-3d-twin"] canvas');if(!O)return;const _=(q=(P=O.__r3f)==null?void 0:P.root)==null?void 0:q.scene;if(!_)return;new l2().parse(_,re=>{const de=JSON.stringify(re,null,2),Re=new Blob([de],{type:"application/json"}),Pe=URL.createObjectURL(Re),ae=document.createElement("a");ae.href=Pe,ae.download="ecosteel-plant.gltf",document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(Pe)},re=>{console.error("Error exporting GLTF:",re)},{binary:!1})},z=S.useCallback(()=>{const O=[],_=Date.now()-144e5;for(let E=0;E<240;E++){const P=E*60*1e3;O.push({timestamp:_+P,temperature:1400+Math.sin(E*.1)*100+Math.random()*50,emissions:40+Math.sin(E*.15)*20+Math.random()*10,vibration:3+Math.sin(E*.2)*1+Math.random()*.5,purity:90+Math.sin(E*.05)*8+Math.random()*5,energy:1200+Math.sin(E*.08)*200+Math.random()*100,doorStatus:Math.random()>.95?"open":"closed",oxygenFlow:85+Math.sin(E*.12)*10+Math.random()*5,scrapLevel:70+Math.sin(E*.06)*20+Math.random()*10})}return O},[]),j=S.useCallback(()=>{if(p)y(!1),v(0);else{const O=z();m(O),v(0),y(!0)}},[p,z]);return S.useEffect(()=>{if(p&&A.length>0){const O=setInterval(()=>{v(_=>{if(_>=A.length-1)return y(!1),0;const E=_+1;return N(A[E]),E})},100);return()=>clearInterval(O)}},[p,A]),g.jsx("div",{className:"flex-1 overflow-auto p-3 md:p-6 grid-bg",children:g.jsxs("div",{className:"max-w-screen-2xl mx-auto space-y-4 md:space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-foreground mb-1 md:mb-2",children:"Digital Twin"}),g.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"3D visualization of steel plant infrastructure"})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx(Mt,{variant:"outline",size:"icon","data-testid":"button-zoom-in",children:g.jsx(Sle,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"outline",size:"icon","data-testid":"button-zoom-out",children:g.jsx(Zle,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"outline",size:"icon","data-testid":"button-reset",children:g.jsx($D,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"outline",size:"icon","data-testid":"button-export",onClick:K,children:g.jsx(c5,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"outline",size:"icon","data-testid":"button-fullscreen",children:g.jsx(AY,{className:"w-4 h-4"})})]})]}),x&&g.jsx(Ye,{className:"bg-black border-gray-800",children:g.jsx(ke,{className:"p-6 text-center text-white",children:"Loading digital twin data..."})}),g.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 mb-4",children:[g.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.jsxs(Ml,{value:t,onValueChange:e,children:[g.jsx(za,{className:"w-28 md:w-32",children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"F1",children:"Machine 1"}),g.jsx(An,{value:"F2",children:"Machine 2"}),g.jsx(An,{value:"F3",children:"Machine 3"}),g.jsx(An,{value:"F4",children:"Machine 4"}),g.jsx(An,{value:"F5",children:"Machine 5"}),g.jsx(An,{value:"F6",children:"Machine 6"})]})]}),g.jsxs(nn,{variant:"outline",className:"flex items-center gap-1 md:gap-2 text-xs",children:[g.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${u?"bg-red-500":o==="failure"?"bg-yellow-500":"bg-green-500"}`}),g.jsx("span",{className:"hidden sm:inline",children:u?"EMERGENCY":o==="failure"?"SIMULATION":"LIVE"}),g.jsx("span",{className:"sm:hidden",children:u?"EMG":o==="failure"?"SIM":"LIVE"})]})]}),g.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-2",children:[g.jsxs(Mt,{variant:n==="overview"?"default":"outline",size:"sm",onClick:()=>F("overview"),className:"text-xs md:text-sm",children:[g.jsx(Xc,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),g.jsx("span",{className:"hidden sm:inline",children:"Overview"}),g.jsx("span",{className:"sm:hidden",children:"View"})]}),g.jsxs(Mt,{variant:n==="interior"?"default":"outline",size:"sm",onClick:()=>{F("interior"),T()},className:"text-xs md:text-sm",children:[g.jsx(W0,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),g.jsx("span",{className:"hidden sm:inline",children:"Interior"}),g.jsx("span",{className:"sm:hidden",children:"Int"})]}),g.jsx(Mt,{variant:"outline",size:"sm",className:"text-xs md:text-sm",onClick:H,children:g.jsx(AY,{className:"w-3 h-3 md:w-4 md:h-4"})})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 lg:gap-6",children:[g.jsx("div",{className:"lg:col-span-10",children:g.jsx(Ye,{className:"bg-black border-gray-800 overflow-hidden",children:g.jsx(UOe,{shadows:!0,camera:{position:[5,5,5],fov:60},gl:{antialias:!0,alpha:!1},className:"w-full h-[85vh] lg:h-[90vh]","data-testid":"canvas-3d-twin",children:g.jsx(S.Suspense,{fallback:null,children:g.jsx(YJe,{sensorData:Z,selectedFurnace:t,cameraView:n,showCrossSection:l,forecastMode:r,emergencyMode:u,failureScenario:h})})})})}),g.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Timeline Control"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>v(Math.max(0,b-10)),children:g.jsx(eU,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:p?"default":"outline",size:"sm",onClick:j,children:p?g.jsx(R2,{className:"w-4 h-4"}):g.jsx(N2,{className:"w-4 h-4"})}),g.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>v(Math.min(A.length-1,b+10)),children:g.jsx(tU,{className:"w-4 h-4"})}),g.jsx("span",{className:"text-sm ml-2",children:p?"Playback":"Live"})]}),g.jsx(wc,{value:[p&&A.length>0?b/A.length*100:100],onValueChange:O=>{if(p&&A.length>0){const _=Math.floor(O[0]/100*A.length);v(_),N(A[_])}},max:100,step:1,className:"w-full"}),g.jsx("div",{className:"text-xs text-muted-foreground text-center",children:p?`${Math.floor(b/60)}h ${b%60}m ago`:"Live Data"})]})]}),g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Furnace Status"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"text-2xl font-bold text-primary",children:[Z.temperature.toFixed(1),"C"]}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Temperature"})]}),g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"text-2xl font-bold text-blue-500",children:[Z.emissions.toFixed(0)," ppm"]}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Emissions"})]}),g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"text-2xl font-bold text-orange-500",children:[Z.vibration.toFixed(2)," Hz"]}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Vibration"})]}),g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"text-2xl font-bold text-green-500",children:[Z.purity,"%"]}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Purity"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{children:"Energy Usage"}),g.jsxs("span",{children:[Z.energy," kW"]})]}),g.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:g.jsx("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${Z.energy/1500*100}%`}})})]})]})]}),g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Sensor List"})}),g.jsxs(ke,{className:"space-y-3",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Temperature"}),g.jsxs(nn,{variant:"secondary",children:[Z.temperature.toFixed(1),"C"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Emissions"}),g.jsxs(nn,{variant:"secondary",children:[Z.emissions.toFixed(0)," ppm"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Vibration"}),g.jsxs(nn,{variant:"secondary",children:[Z.vibration.toFixed(2)," Hz"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Scrap Level"}),g.jsxs(nn,{variant:"secondary",children:[Z.scrapLevel,"%"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Door Status"}),g.jsx(nn,{variant:Z.doorStatus==="open"?"default":"secondary",children:Z.doorStatus})]})]})]}),g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Alerts"})}),g.jsxs(ke,{className:"space-y-3",children:[Z.temperature>1500&&g.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 rounded",children:[g.jsx(gr,{className:"w-4 h-4 text-destructive"}),g.jsx("span",{className:"text-sm",children:"High Temperature"})]}),Z.vibration>4&&g.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-500/10 rounded",children:[g.jsx(Xl,{className:"w-4 h-4 text-yellow-500"}),g.jsx("span",{className:"text-sm",children:"High Vibration"})]}),Z.emissions>60&&g.jsxs("div",{className:"flex items-center gap-2 p-2 bg-orange-500/10 rounded",children:[g.jsx(ZW,{className:"w-4 h-4 text-orange-500"}),g.jsx("span",{className:"text-sm",children:"High Emissions"})]})]})]}),g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Parameters"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-sm",children:"Oxygen Flow"}),g.jsx(wc,{value:[Z.oxygenFlow],onValueChange:O=>N(_=>({..._,oxygenFlow:O[0]})),max:100,step:1}),g.jsxs("div",{className:"text-xs text-muted-foreground",children:[Z.oxygenFlow,"%"]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-sm",children:"Load Percentage"}),g.jsx(wc,{value:[75],max:100,step:1}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"75%"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-sm",children:"Power Level"}),g.jsx(wc,{value:[85],max:100,step:1}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"85%"})]})]})]}),g.jsxs(Ye,{className:"bg-black border-gray-800",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-white text-base",children:"Simulation Control"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-sm",children:"Mode"}),g.jsxs(Ml,{value:o,onValueChange:a,children:[g.jsx(za,{children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"realtime",children:"Real-time"}),g.jsx(An,{value:"simulation",children:"Training Mode"}),g.jsx(An,{value:"failure",children:"Failure Simulation"})]})]})]}),o==="failure"&&g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-sm",children:"Failure Scenario"}),g.jsxs(Ml,{value:h||"",onValueChange:I,children:[g.jsx(za,{children:g.jsx(Vl,{placeholder:"Select scenario"})}),g.jsxs(ja,{children:[g.jsx(An,{value:"overheat",children:"Overheating"}),g.jsx(An,{value:"vibration",children:"Excessive Vibration"}),g.jsx(An,{value:"gas-leak",children:"Gas Leak"}),g.jsx(An,{value:"power-failure",children:"Power Failure"}),g.jsx(An,{value:"scrap-jam",children:"Scrap Conveyor Jam"})]})]})]}),g.jsx(Mt,{variant:u?"destructive":"outline",className:"w-full",onClick:()=>d(!u),children:u?"End Emergency":"Trigger Emergency"}),u&&g.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/50 rounded",children:[g.jsx("div",{className:"text-sm font-semibold text-red-400 mb-2",children:"EMERGENCY PROTOCOLS ACTIVE"}),g.jsxs("div",{className:"text-xs text-red-300 space-y-1",children:[g.jsx("div",{children:" Automatic shutdown initiated"}),g.jsx("div",{children:" Emergency cooling activated"}),g.jsx("div",{children:" Safety systems engaged"})]})]})]})]})]})]}),g.jsx(Ye,{className:"bg-black border-gray-800 mt-4 md:mt-6",children:g.jsx(ke,{className:"p-3 md:p-4",children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:"Temperature"}),g.jsx("div",{className:"h-6 md:h-8 bg-gradient-to-r from-blue-500 via-orange-500 to-red-500 rounded"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:"Emissions"}),g.jsx("div",{className:"h-6 md:h-8 bg-gradient-to-r from-green-500 to-red-500 rounded mx-auto",style:{width:`${Math.max(20,Z.emissions/100*100)}%`}})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:"Vibration"}),g.jsx("div",{className:"h-6 md:h-8 bg-gradient-to-r from-green-500 to-red-500 rounded mx-auto",style:{width:`${Math.max(20,Z.vibration/5*100)}%`}})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-xs md:text-sm text-muted-foreground mb-1",children:"Purity"}),g.jsx("div",{className:"h-6 md:h-8 bg-gradient-to-r from-red-500 to-green-500 rounded mx-auto",style:{width:`${Math.max(20,Z.purity)}%`}})]})]})})})]})})}function HJe(){const[t,e]=S.useState(!1),[n,i]=S.useState([]),[r,s]=S.useState(0),[o,a]=S.useState("webcam"),[l,c]=S.useState("auto"),[u,d]=S.useState({temperature:25.3,humidity:65,weight:0,dimensions:{length:0,width:0,height:0}}),[h,I]=S.useState("loaded"),[p,y]=S.useState(0),A=S.useRef(null),m=S.useRef(null),b=S.useRef(null);S.useEffect(()=>{(()=>{setTimeout(()=>{I("ready"),console.log("OpenCV.js and ML models loaded successfully")},1e3)})()},[]);const v=async()=>{try{const N={video:{width:{ideal:1280},height:{ideal:720},facingMode:o==="webcam"?"user":"environment"}},W=await navigator.mediaDevices.getUserMedia(N);A.current&&(A.current.srcObject=W,b.current=W)}catch(N){console.error("Error accessing camera:",N),a("mock")}},w=()=>{b.current&&(b.current.getTracks().forEach(N=>N.stop()),b.current=null),A.current&&(A.current.srcObject=null)},x=async()=>{e(!0),await v();const N=()=>{if(!t)return;const W=performance.now();setTimeout(()=>{const M=[{type:"steel",confidence:94,bbox:[150,120,280,200],material:"Carbon Steel A36",grade:"A"},{type:"rust",confidence:87,bbox:[180,140,50,40],severity:"moderate"},{type:"paint",confidence:76,bbox:[300,180,80,30],color:"blue"},{type:"oil",confidence:82,bbox:[250,300,60,25],contamination:"light"}];d({temperature:24.8+Math.random()*2,humidity:62+Math.random()*6,weight:45.2+Math.random()*5,dimensions:{length:120+Math.random()*10,width:80+Math.random()*5,height:25+Math.random()*3}}),i(M),s(78+Math.random()*15);const F=performance.now();y(F-W),l==="auto"&&setTimeout(N,100)},150)};N()},B=()=>{e(!1),i([]),s(0),w()},Z=()=>{if(m.current&&A.current){const N=m.current,W=A.current,M=N.getContext("2d");M&&(N.width=W.videoWidth,N.height=W.videoHeight,M.drawImage(W,0,0),console.log("Captured frame for detailed analysis"))}};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Advanced Scrap AI Detector"}),g.jsx("p",{className:"text-muted-foreground",children:"OpenCV ML-powered material detection with IoT integration"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(nn,{variant:"outline",className:h==="ready"?"text-green-600":"text-yellow-600",children:[g.jsx(jI,{className:"w-4 h-4 mr-1"}),"ML Model: ",h]}),g.jsxs(nn,{variant:"outline",className:"text-blue-600",children:[g.jsx(pA,{className:"w-4 h-4 mr-1"}),"IoT Connected"]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[g.jsx(Ye,{children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(zI,{className:"w-5 h-5 text-blue-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"Camera"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:o==="mock"?"Mock Mode":"HD 720p"})]})]})})}),g.jsx(Ye,{children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(jI,{className:"w-5 h-5 text-green-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"Processing"}),g.jsxs("div",{className:"text-xs text-muted-foreground",children:[p.toFixed(1),"ms/frame"]})]})]})})}),g.jsx(Ye,{children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(to,{className:"w-5 h-5 text-yellow-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"IoT Sensors"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"4 Active"})]})]})})}),g.jsx(Ye,{children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(yY,{className:"w-5 h-5 text-purple-600"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium",children:"Scan Mode"}),g.jsx("div",{className:"text-xs text-muted-foreground capitalize",children:l})]})]})})})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(zI,{className:"w-5 h-5"}),"Live Camera Feed"]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Ml,{value:o,onValueChange:a,children:[g.jsx(za,{className:"w-32",children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"webcam",children:"Webcam"}),g.jsx(An,{value:"mobile",children:"Mobile Cam"}),g.jsx(An,{value:"industrial",children:"Industrial Cam"}),g.jsx(An,{value:"mock",children:"Mock Camera"})]})]}),g.jsxs(Ml,{value:l,onValueChange:c,children:[g.jsx(za,{className:"w-24",children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"auto",children:"Auto"}),g.jsx(An,{value:"manual",children:"Manual"}),g.jsx(An,{value:"continuous",children:"Continuous"})]})]})]})]})}),g.jsxs(ke,{children:[g.jsxs("div",{className:"relative aspect-video bg-muted rounded-lg overflow-hidden mb-4",children:[g.jsx("video",{ref:A,className:"w-full h-full object-cover",autoPlay:!0,muted:!0,playsInline:!0}),g.jsx("canvas",{ref:m,className:"absolute inset-0 w-full h-full",style:{display:"none"}}),n.map((N,W)=>g.jsx("div",{className:`absolute border-2 rounded ${N.type==="steel"?"border-green-500":N.type==="rust"?"border-red-500":N.type==="paint"?"border-blue-500":"border-orange-500"}`,style:{left:`${N.bbox[0]}px`,top:`${N.bbox[1]}px`,width:`${N.bbox[2]}px`,height:`${N.bbox[3]}px`},children:g.jsxs("div",{className:`absolute -top-6 left-0 text-white text-xs px-2 py-0.5 rounded ${N.type==="steel"?"bg-green-500":N.type==="rust"?"bg-red-500":N.type==="paint"?"bg-blue-500":"bg-orange-500"}`,children:[N.material||N.type," (",N.confidence,"%)",N.grade&&` - Grade ${N.grade}`]})},W)),!t&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:g.jsxs("div",{className:"text-center text-white",children:[g.jsx(zI,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),g.jsx("p",{className:"text-lg",children:"Camera Offline"}),g.jsx("p",{className:"text-sm opacity-75",children:"Select camera and click scan to start detection"})]})}),t&&g.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white text-xs px-2 py-1 rounded",children:["OpenCV Processing: ",p.toFixed(1),"ms"]})]}),g.jsxs("div",{className:"flex gap-2",children:[t?g.jsxs(Mt,{onClick:B,variant:"destructive",className:"flex-1",children:[g.jsx(R2,{className:"w-4 h-4 mr-2"}),"Stop Scanning"]}):g.jsxs(Mt,{onClick:x,className:"flex-1",children:[g.jsx(N2,{className:"w-4 h-4 mr-2"}),"Start AI Scanning"]}),g.jsxs(Mt,{onClick:Z,variant:"outline",disabled:!t,children:[g.jsx(yY,{className:"w-4 h-4 mr-2"}),"Capture"]}),g.jsxs(Mt,{variant:"outline",disabled:!n.length,children:[g.jsx(bY,{className:"w-4 h-4 mr-2"}),"Send to Furnace"]})]})]})]})}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Material Analysis"})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsxs("div",{className:"text-3xl font-bold text-primary mb-2",children:[r.toFixed(1),"%"]}),g.jsx(sC,{value:r,className:"mb-2"}),g.jsx("div",{className:"flex justify-center gap-2 text-sm",children:g.jsx(nn,{variant:r>85?"default":r>70?"secondary":"destructive",children:r>85?"Prime Quality":r>70?"Good Quality":"Needs Processing"})})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"IoT Sensor Data"})}),g.jsxs(ke,{className:"space-y-3",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Temperature"}),g.jsxs("span",{className:"font-mono",children:[u.temperature.toFixed(1),"C"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Humidity"}),g.jsxs("span",{className:"font-mono",children:[u.humidity.toFixed(1),"%"]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"text-sm",children:"Weight"}),g.jsxs("span",{className:"font-mono",children:[u.weight.toFixed(1)," kg"]})]}),g.jsxs("div",{className:"text-sm text-muted-foreground",children:["Dimensions: ",u.dimensions.length.toFixed(0),"  ",u.dimensions.width.toFixed(0),"  ",u.dimensions.height.toFixed(0)," cm"]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"OpenCV ML Results"})}),g.jsx(ke,{className:"space-y-3",children:n.length>0?n.map((N,W)=>g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[N.type==="steel"?g.jsx(ta,{className:"w-4 h-4 text-green-600"}):g.jsx(gr,{className:"w-4 h-4 text-red-600"}),g.jsx("span",{className:"text-sm capitalize font-medium",children:N.type})]}),g.jsxs("span",{className:"text-sm font-mono",children:[N.confidence,"%"]})]}),N.material&&g.jsxs("div",{className:"text-xs text-muted-foreground ml-6",children:["Material: ",N.material,N.grade&&` (Grade ${N.grade})`]}),g.jsx(sC,{value:N.confidence,className:"h-1"})]},W)):g.jsxs("div",{className:"text-center text-muted-foreground py-4",children:[g.jsx(ta,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),g.jsx("p",{children:"No analysis in progress"}),g.jsx("p",{className:"text-xs",children:"Start scanning to begin ML detection"})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Actions"})}),g.jsxs(ke,{className:"space-y-2",children:[g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(Xc,{className:"w-4 h-4 mr-2"}),"View Analysis History"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(bY,{className:"w-4 h-4 mr-2"}),"Export Report"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(jI,{className:"w-4 h-4 mr-2"}),"Retrain Model"]})]})]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Material Composition Analysis"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-3",children:n.filter(N=>N.material).map((N,W)=>g.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:N.material}),g.jsxs("div",{className:"text-sm text-muted-foreground",children:["Grade ",N.grade]})]}),g.jsxs(nn,{variant:"outline",children:[N.confidence,"% match"]})]},W))})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Processing Metrics"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Frame Rate"}),g.jsx("span",{className:"font-mono",children:"30 FPS"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Processing Latency"}),g.jsxs("span",{className:"font-mono",children:[p.toFixed(1)," ms"]})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"Model Accuracy"}),g.jsx("span",{className:"font-mono",children:"94.2%"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-sm",children:"IoT Data Points"}),g.jsx("span",{className:"font-mono",children:"12 active"})]})]})})]})]})]})}const KJe=[{time:"00:00",nox:45,co:120,pm:15},{time:"04:00",nox:52,co:135,pm:18},{time:"08:00",nox:48,co:128,pm:16},{time:"12:00",nox:65,co:145,pm:22},{time:"16:00",nox:58,co:138,pm:19},{time:"20:00",nox:42,co:115,pm:12}],fN={nox:{good:40,moderate:60,poor:80},co:{good:100,moderate:150,poor:200},pm:{good:10,moderate:20,poor:30}};function LJe(){const n=(i=>({status:"Unhealthy",color:"text-orange-600",bg:"bg-orange-100"}))();return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Emissions Monitor"}),g.jsx("p",{className:"text-muted-foreground",children:"Real-time air quality and emission tracking"})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs(nn,{variant:"outline",className:`${n.bg} ${n.color} border-current`,children:[n.status," Air Quality"]}),g.jsxs(nn,{variant:"outline",className:"text-green-600 bg-green-100",children:[g.jsx(ta,{className:"w-4 h-4 mr-1"}),"In Limits"]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[g.jsxs(Ye,{className:"lg:col-span-2",children:[g.jsx(tt,{children:g.jsx(nt,{children:"Air Quality Index"})}),g.jsxs(ke,{children:[g.jsx("div",{className:"flex items-center justify-center",children:g.jsxs("div",{className:"relative w-48 h-48",children:[g.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[g.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),g.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#f97316",strokeWidth:"8",strokeDasharray:`${142/200*251.2} 251.2`,strokeLinecap:"round"})]}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-3xl font-bold",children:142}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"AQI"})]})})]})}),g.jsxs("div",{className:"mt-4 grid grid-cols-4 gap-2 text-xs",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mx-auto mb-1"}),"Good",g.jsx("br",{}),"(0-50)"]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mx-auto mb-1"}),"Moderate",g.jsx("br",{}),"(51-100)"]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mx-auto mb-1"}),"Unhealthy",g.jsx("br",{}),"(101-150)"]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mx-auto mb-1"}),"Hazardous",g.jsx("br",{}),"(151+)"]})]})]})]}),g.jsxs(Ye,{className:"lg:col-span-2",children:[g.jsx(tt,{children:g.jsx(nt,{children:"Current Gas Levels"})}),g.jsx(ke,{className:"space-y-4",children:[{name:"NOx",value:58,unit:"ppm",threshold:fN.nox},{name:"CO",value:138,unit:"ppm",threshold:fN.co},{name:"PM2.5",value:19,unit:"g/m",threshold:fN.pm}].map(i=>{const r=i.value/i.threshold.poor*100,s=i.value<=i.threshold.good;return i.value<=i.threshold.moderate,g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{className:"font-medium",children:i.name}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-lg font-bold",children:i.value}),g.jsx("span",{className:"text-sm text-muted-foreground",children:i.unit}),s?g.jsx(ta,{className:"w-4 h-4 text-green-600"}):g.jsx(gr,{className:"w-4 h-4 text-orange-600"})]})]}),g.jsx(sC,{value:Math.min(r,100),className:`h-2 ${r>80?"[&>div]:bg-red-500":r>60?"[&>div]:bg-orange-500":"[&>div]:bg-green-500"}`}),g.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[g.jsx("span",{children:"0"}),g.jsxs("span",{className:"text-green-600",children:["Good: ",i.threshold.good]}),g.jsxs("span",{className:"text-orange-600",children:["Mod: ",i.threshold.moderate]}),g.jsxs("span",{className:"text-red-600",children:["Poor: ",i.threshold.poor]})]})]},i.name)})})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Emission Trends (24h)"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:KJe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"nox",stroke:"#ef4444",strokeWidth:2,name:"NOx (ppm)"}),g.jsx(jn,{type:"monotone",dataKey:"co",stroke:"#f97316",strokeWidth:2,name:"CO (ppm)"}),g.jsx(jn,{type:"monotone",dataKey:"pm",stroke:"#eab308",strokeWidth:2,name:"PM2.5 (g/m)"})]})})})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(ta,{className:"w-5 h-5 text-green-600"}),"Compliance Status"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"IN LIMITS"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"All emissions within regulatory thresholds"})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(M0,{className:"w-5 h-5 text-blue-600"}),"Emission Reduction"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:"-12%"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"vs last month average"})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(to,{className:"w-5 h-5 text-orange-600"}),"Peak Detection"]})}),g.jsx(ke,{children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:"2"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Spike events today"})]})})]})]})]})}const rT=S.forwardRef(({className:t,...e},n)=>g.jsx("div",{className:"relative w-full overflow-auto",children:g.jsx("table",{ref:n,className:At("w-full caption-bottom text-sm",t),...e})}));rT.displayName="Table";const sT=S.forwardRef(({className:t,...e},n)=>g.jsx("thead",{ref:n,className:At("[&_tr]:border-b",t),...e}));sT.displayName="TableHeader";const oT=S.forwardRef(({className:t,...e},n)=>g.jsx("tbody",{ref:n,className:At("[&_tr:last-child]:border-0",t),...e}));oT.displayName="TableBody";const zJe=S.forwardRef(({className:t,...e},n)=>g.jsx("tfoot",{ref:n,className:At("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));zJe.displayName="TableFooter";const m0=S.forwardRef(({className:t,...e},n)=>g.jsx("tr",{ref:n,className:At("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));m0.displayName="TableRow";const $r=S.forwardRef(({className:t,...e},n)=>g.jsx("th",{ref:n,className:At("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));$r.displayName="TableHead";const es=S.forwardRef(({className:t,...e},n)=>g.jsx("td",{ref:n,className:At("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));es.displayName="TableCell";const jJe=S.forwardRef(({className:t,...e},n)=>g.jsx("caption",{ref:n,className:At("mt-4 text-sm text-muted-foreground",t),...e}));jJe.displayName="TableCaption";const PJe=[{time:"00:00",vibration:2.1},{time:"04:00",vibration:2.3},{time:"08:00",vibration:3.1},{time:"12:00",vibration:4.2},{time:"16:00",vibration:3.8},{time:"20:00",vibration:2.5}],wj=[{x:1,y:2.1,anomaly:!1},{x:2,y:2.3,anomaly:!1},{x:3,y:3.1,anomaly:!1},{x:4,y:4.2,anomaly:!0},{x:5,y:3.8,anomaly:!1},{x:6,y:2.5,anomaly:!1}],OJe=[{name:"Main Motor",health:78,risk:"Medium",nextMaintenance:"2024-02-15",status:"Normal",location:"Furnace 1"},{name:"Bearing Assembly",health:45,risk:"High",nextMaintenance:"2024-01-28",status:"Warning",location:"Furnace 2"},{name:"Conveyor Belt",health:92,risk:"Low",nextMaintenance:"2024-03-10",status:"Normal",location:"Furnace 1"},{name:"Gas Valve",health:67,risk:"Medium",nextMaintenance:"2024-02-05",status:"Normal",location:"Furnace 3"}];function DJe(){const t=e=>{switch(e.toLowerCase()){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Predictive Maintenance"}),g.jsx("p",{className:"text-muted-foreground",children:"AI-powered equipment health monitoring and maintenance scheduling"})]}),g.jsxs(nn,{variant:"outline",className:"text-accent",children:[g.jsx(Xl,{className:"w-4 h-4 mr-1"}),"AI Monitoring Active"]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[g.jsxs(Ye,{children:[g.jsxs(tt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[g.jsx(nt,{className:"text-sm font-medium",children:"Health Score"}),g.jsx(fle,{className:"h-4 w-4 text-muted-foreground"})]}),g.jsxs(ke,{children:[g.jsx("div",{className:"text-2xl font-bold",children:"84%"}),g.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.jsx("span",{className:"text-green-600",children:"+2.1%"})," from last week"]})]})]}),g.jsxs(Ye,{children:[g.jsxs(tt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[g.jsx(nt,{className:"text-sm font-medium",children:"Remaining Life"}),g.jsx(M0,{className:"h-4 w-4 text-muted-foreground"})]}),g.jsxs(ke,{children:[g.jsx("div",{className:"text-2xl font-bold",children:"2.3 Years"}),g.jsx("p",{className:"text-xs text-muted-foreground",children:"Average across all equipment"})]})]}),g.jsxs(Ye,{children:[g.jsxs(tt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[g.jsx(nt,{className:"text-sm font-medium",children:"Next Maintenance"}),g.jsx(l5,{className:"h-4 w-4 text-muted-foreground"})]}),g.jsxs(ke,{children:[g.jsx("div",{className:"text-2xl font-bold",children:"Jan 28"}),g.jsx("p",{className:"text-xs text-muted-foreground",children:"Bearing Assembly - Furnace 2"})]})]}),g.jsxs(Ye,{children:[g.jsxs(tt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[g.jsx(nt,{className:"text-sm font-medium",children:"Active Alerts"}),g.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),g.jsxs(ke,{children:[g.jsx("div",{className:"text-2xl font-bold",children:"3"}),g.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.jsx("span",{className:"text-red-600",children:"1 critical"}),", 2 warnings"]})]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Vibration Trend Analysis"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:PJe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{label:{value:"Vibration (mm/s)",angle:-90,position:"insideLeft"}}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"vibration",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4}})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Anomaly Detection"})}),g.jsxs(ke,{children:[g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(PEe,{data:wj,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"x"}),g.jsx(ii,{label:{value:"Vibration Level",angle:-90,position:"insideLeft"}}),g.jsx(qn,{}),g.jsx(ih,{dataKey:"y",fill:"#22c55e"}),wj.filter(e=>e.anomaly).map((e,n)=>g.jsx(ih,{data:[e],dataKey:"y",fill:"#ef4444"},`anomaly-${n}`))]})}),g.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),g.jsx("span",{className:"text-sm",children:"Normal"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),g.jsx("span",{className:"text-sm",children:"Anomaly"})]})]})]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Equipment Status"})}),g.jsx(ke,{children:g.jsxs(rT,{children:[g.jsx(sT,{children:g.jsxs(m0,{children:[g.jsx($r,{children:"Component"}),g.jsx($r,{children:"Location"}),g.jsx($r,{children:"Health Score"}),g.jsx($r,{children:"Risk Level"}),g.jsx($r,{children:"Next Maintenance"}),g.jsx($r,{children:"Status"}),g.jsx($r,{children:"Actions"})]})}),g.jsx(oT,{children:OJe.map((e,n)=>g.jsxs(m0,{children:[g.jsx(es,{className:"font-medium",children:e.name}),g.jsx(es,{children:e.location}),g.jsx(es,{children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(sC,{value:e.health,className:"w-16"}),g.jsxs("span",{className:"text-sm font-mono",children:[e.health,"%"]})]})}),g.jsx(es,{children:g.jsx(nn,{className:t(e.risk),children:e.risk})}),g.jsx(es,{children:e.nextMaintenance}),g.jsx(es,{children:g.jsx(nn,{variant:e.status==="Normal"?"default":"destructive",children:e.status})}),g.jsx(es,{children:g.jsxs(Mt,{variant:"outline",size:"sm",children:[g.jsx(ZC,{className:"w-4 h-4 mr-1"}),"Schedule"]})})]},n))})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Upcoming Maintenance Schedule"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:[{date:"Jan 28, 2024",component:"Bearing Assembly",furnace:"F2",type:"Critical",priority:"High"},{date:"Feb 5, 2024",component:"Gas Valve",furnace:"F3",type:"Preventive",priority:"Medium"},{date:"Feb 15, 2024",component:"Main Motor",furnace:"F1",type:"Inspection",priority:"Low"},{date:"Feb 22, 2024",component:"Conveyor Belt",furnace:"F1",type:"Lubrication",priority:"Low"}].map((e,n)=>g.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-lg font-bold",children:e.date.split(",")[0]}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Jan"})]}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:e.component}),g.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.furnace," - ",e.type]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(nn,{variant:e.priority==="High"?"destructive":e.priority==="Medium"?"secondary":"outline",children:e.priority}),g.jsx(Mt,{variant:"outline",size:"sm",children:"View Details"})]})]},n))})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Recent Maintenance Activities"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:[{date:"Jan 15, 2024",component:"Temperature Sensor",action:"Calibration",technician:"John Smith",status:"Completed"},{date:"Jan 12, 2024",component:"Gas Manifold",action:"Leak Test",technician:"Sarah Johnson",status:"Completed"},{date:"Jan 8, 2024",component:"Motor Bearing",action:"Lubrication",technician:"Mike Davis",status:"Completed"},{date:"Jan 5, 2024",component:"Control Panel",action:"Software Update",technician:"Admin",status:"Completed"}].map((e,n)=>g.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:e.component}),g.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.action," - ",e.technician]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm font-medium",children:e.date}),g.jsx(nn,{variant:"outline",className:"text-green-600",children:e.status})]})]},n))})})]})]})}const UJe=[{date:"2024-01-01",purity:89},{date:"2024-01-02",purity:92},{date:"2024-01-03",purity:87},{date:"2024-01-04",purity:94},{date:"2024-01-05",purity:91},{date:"2024-01-06",purity:88},{date:"2024-01-07",purity:95}],JJe=[{furnace:"F1",time:"00:00",purity:85},{furnace:"F1",time:"06:00",purity:88},{furnace:"F1",time:"12:00",purity:92},{furnace:"F1",time:"18:00",purity:89},{furnace:"F2",time:"00:00",purity:82},{furnace:"F2",time:"06:00",purity:85},{furnace:"F2",time:"12:00",purity:87},{furnace:"F2",time:"18:00",purity:84},{furnace:"F3",time:"00:00",purity:90},{furnace:"F3",time:"06:00",purity:93},{furnace:"F3",time:"12:00",purity:91},{furnace:"F3",time:"18:00",purity:88}],QJe=[{name:"Rust",percentage:35,color:"#ef4444"},{name:"Plastic",percentage:25,color:"#f97316"},{name:"Dust",percentage:20,color:"#eab308"},{name:"Oil",percentage:15,color:"#22c55e"},{name:"Other",percentage:5,color:"#8b5cf6"}],qJe=[{id:"BATCH-2024-001",date:"2024-01-15 14:30",furnace:"Furnace 1",purity:94,weight:"2.5 tons",status:"accepted",contaminants:["rust","dust"]},{id:"BATCH-2024-002",date:"2024-01-15 13:45",furnace:"Furnace 2",purity:67,weight:"1.8 tons",status:"rejected",contaminants:["plastic","oil","rust"]},{id:"BATCH-2024-003",date:"2024-01-15 12:20",furnace:"Furnace 1",purity:89,weight:"3.2 tons",status:"accepted",contaminants:["dust"]},{id:"BATCH-2024-004",date:"2024-01-15 11:15",furnace:"Furnace 3",purity:72,weight:"2.1 tons",status:"rejected",contaminants:["plastic","rust","oil"]}];function $Je(){return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Scrap Quality History"}),g.jsx("p",{className:"text-muted-foreground",children:"Historical analysis of scrap quality and processing data"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Mt,{variant:"outline",children:[g.jsx(Ile,{className:"w-4 h-4 mr-2"}),"Filter"]}),g.jsxs(Mt,{variant:"outline",children:[g.jsx(c5,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(M0,{className:"w-5 h-5"}),"Purity Trend (7 Days)"]})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:UJe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"date"}),g.jsx(ii,{domain:[80,100]}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"purity",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:6}})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(CA,{className:"w-5 h-5"}),"Impurity Distribution"]})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:QJe.map(t=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:t.color}}),g.jsx("span",{className:"font-medium",children:t.name})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-24 bg-gray-100 rounded-full h-2",children:g.jsx("div",{className:"h-2 rounded-full",style:{width:`${t.percentage}%`,backgroundColor:t.color}})}),g.jsxs("span",{className:"text-sm font-mono w-12",children:[t.percentage,"%"]})]})]},t.name))})})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Purity by Furnace & Time"})}),g.jsxs(ke,{children:[g.jsx("div",{className:"overflow-x-auto",children:g.jsxs("table",{className:"w-full",children:[g.jsx("thead",{children:g.jsxs("tr",{children:[g.jsx("th",{className:"text-left p-2 font-medium",children:"Furnace"}),g.jsx("th",{className:"text-center p-2 font-medium",children:"00:00"}),g.jsx("th",{className:"text-center p-2 font-medium",children:"06:00"}),g.jsx("th",{className:"text-center p-2 font-medium",children:"12:00"}),g.jsx("th",{className:"text-center p-2 font-medium",children:"18:00"})]})}),g.jsx("tbody",{children:["F1","F2","F3"].map(t=>g.jsxs("tr",{children:[g.jsx("td",{className:"p-2 font-medium",children:t}),["00:00","06:00","12:00","18:00"].map(e=>{const n=JJe.find(s=>s.furnace===t&&s.time===e),i=(n==null?void 0:n.purity)||0,r=Math.min((i-80)/20*100,100);return g.jsx("td",{className:"p-2 text-center",children:g.jsx("div",{className:"w-12 h-8 rounded flex items-center justify-center text-xs font-mono text-white",style:{backgroundColor:`hsl(${120-r*1.2}, 70%, ${50+r*.3}%)`},children:i})},e)})]},t))})]})}),g.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4",children:[g.jsx("span",{className:"text-sm text-muted-foreground",children:"Low"}),g.jsx("div",{className:"flex gap-1",children:[0,25,50,75,100].map(t=>g.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:`hsl(${120-t*1.2}, 70%, ${50+t*.3}%)`}},t))}),g.jsx("span",{className:"text-sm text-muted-foreground",children:"High"})]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Batch Processing History"})}),g.jsx(ke,{children:g.jsxs(rT,{children:[g.jsx(sT,{children:g.jsxs(m0,{children:[g.jsx($r,{children:"Batch ID"}),g.jsx($r,{children:"Date & Time"}),g.jsx($r,{children:"Furnace"}),g.jsx($r,{children:"Purity"}),g.jsx($r,{children:"Weight"}),g.jsx($r,{children:"Contaminants"}),g.jsx($r,{children:"Status"}),g.jsx($r,{children:"Actions"})]})}),g.jsx(oT,{children:qJe.map(t=>g.jsxs(m0,{children:[g.jsx(es,{className:"font-mono font-medium",children:t.id}),g.jsx(es,{children:t.date}),g.jsx(es,{children:t.furnace}),g.jsx(es,{children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("span",{className:"font-mono",children:[t.purity,"%"]}),g.jsx("div",{className:"w-16 bg-gray-100 rounded-full h-2",children:g.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t.purity}%`}})})]})}),g.jsx(es,{children:t.weight}),g.jsx(es,{children:g.jsx("div",{className:"flex flex-wrap gap-1",children:t.contaminants.map(e=>g.jsx(nn,{variant:"outline",className:"text-xs",children:e},e))})}),g.jsx(es,{children:g.jsx(nn,{variant:t.status==="accepted"?"default":"destructive",children:t.status})}),g.jsx(es,{children:g.jsx(Mt,{variant:"outline",size:"sm",children:"View Details"})})]},t.id))})]})})]})]})}const eQe=[{month:"Jan",efficiency:89},{month:"Feb",efficiency:92},{month:"Mar",efficiency:88},{month:"Apr",efficiency:94},{month:"May",efficiency:91},{month:"Jun",efficiency:96}],tQe=[{month:"Jan",nox:45,co:120},{month:"Feb",nox:42,co:115},{month:"Mar",nox:48,co:125},{month:"Apr",nox:38,co:110},{month:"May",nox:41,co:118},{month:"Jun",nox:35,co:105}],Gj=[{name:"High Quality",value:65,color:"#22c55e"},{name:"Medium Quality",value:25,color:"#eab308"},{name:"Low Quality",value:10,color:"#ef4444"}],nQe=[{month:"Jan",events:12},{month:"Feb",events:8},{month:"Mar",events:15},{month:"Apr",events:6},{month:"May",events:9},{month:"Jun",events:4}],iQe=[{month:"Jan",savings:12500},{month:"Feb",savings:15200},{month:"Mar",savings:13800},{month:"Apr",savings:18900},{month:"May",savings:16700},{month:"Jun",savings:21300}];function rQe(){S.useState("monthly");const t=[{title:"Efficiency Report",icon:M0,value:"92.4%",change:"+3.2%",trend:"up",description:"Average furnace efficiency"},{title:"Emissions Report",icon:to,value:"IN LIMITS",change:"-8.5%",trend:"down",description:"vs regulatory thresholds"},{title:"Scrap Quality",icon:xle,value:"87.3%",change:"+2.1%",trend:"up",description:"Average purity score"},{title:"Maintenance Events",icon:gr,value:"9",change:"-45%",trend:"down",description:"This month"}];return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Reports & Analytics"}),g.jsx("p",{className:"text-muted-foreground",children:"Comprehensive performance reports and analytics"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Mt,{variant:"outline",children:[g.jsx(l5,{className:"w-4 h-4 mr-2"}),"Date Range"]}),g.jsxs(Mt,{children:[g.jsx(c5,{className:"w-4 h-4 mr-2"}),"Export PDF"]})]})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:t.map((e,n)=>g.jsxs(Ye,{children:[g.jsxs(tt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[g.jsx(nt,{className:"text-sm font-medium",children:e.title}),g.jsx(e.icon,{className:"h-4 w-4 text-muted-foreground"})]}),g.jsxs(ke,{children:[g.jsx("div",{className:"text-2xl font-bold",children:e.value}),g.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.jsx("span",{className:e.trend==="up"?"text-green-600":"text-red-600",children:e.change})," ",e.description]})]})]},n))}),g.jsxs(VC,{defaultValue:"monthly",className:"space-y-6",children:[g.jsxs(hh,{className:"grid w-full grid-cols-3",children:[g.jsx(di,{value:"daily",children:"Daily Reports"}),g.jsx(di,{value:"weekly",children:"Weekly Reports"}),g.jsx(di,{value:"monthly",children:"Monthly Reports"})]}),g.jsxs(ri,{value:"daily",className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Daily Production Summary"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Total Production"}),g.jsx("span",{className:"font-bold",children:"2,450 tons"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Average Efficiency"}),g.jsx("span",{className:"font-bold text-green-600",children:"92.4%"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Energy Consumption"}),g.jsx("span",{className:"font-bold",children:"4,680 kWh"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Scrap Utilization"}),g.jsx("span",{className:"font-bold",children:"87.3%"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Quality Metrics"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Average Purity"}),g.jsx("span",{className:"font-bold",children:"89.2%"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Defect Rate"}),g.jsx("span",{className:"font-bold text-red-600",children:"2.1%"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Grade A Output"}),g.jsx("span",{className:"font-bold text-green-600",children:"94.5%"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Customer Returns"}),g.jsx("span",{className:"font-bold",children:"0.3%"})]})]})})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Furnace Performance"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:250,children:g.jsxs(VI,{data:[{furnace:"F1",efficiency:94},{furnace:"F2",efficiency:89},{furnace:"F3",efficiency:87},{furnace:"F4",efficiency:92}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"furnace"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(Gr,{dataKey:"efficiency",fill:"#3b82f6"})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Environmental Impact"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"CO2 Emissions"}),g.jsx("span",{className:"font-bold",children:"45 tons"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Energy Saved"}),g.jsx("span",{className:"font-bold text-green-600",children:"$1,240"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Water Usage"}),g.jsx("span",{className:"font-bold",children:"2,300 m"})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("span",{children:"Waste Recycled"}),g.jsx("span",{className:"font-bold text-green-600",children:"89.7%"})]})]})})]})]})]}),g.jsxs(ri,{value:"weekly",className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Weekly Efficiency Trends"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:[{day:"Mon",efficiency:91},{day:"Tue",efficiency:93},{day:"Wed",efficiency:89},{day:"Thu",efficiency:95},{day:"Fri",efficiency:92},{day:"Sat",efficiency:88},{day:"Sun",efficiency:90}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"day"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"efficiency",stroke:"#3b82f6",strokeWidth:3})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Weekly Production Volume"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(VI,{data:[{day:"Mon",production:18500},{day:"Tue",production:19200},{day:"Wed",production:17800},{day:"Thu",production:20100},{day:"Fri",production:19600},{day:"Sat",production:15200},{day:"Sun",production:16800}],children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"day"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(Gr,{dataKey:"production",fill:"#22c55e"})]})})})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Maintenance Summary"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Scheduled"}),g.jsx("span",{className:"font-medium",children:"3"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Unscheduled"}),g.jsx("span",{className:"font-medium text-red-600",children:"1"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Downtime"}),g.jsx("span",{className:"font-medium",children:"2.3 hours"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Quality Control"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Inspections"}),g.jsx("span",{className:"font-medium",children:"47"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Passed"}),g.jsx("span",{className:"font-medium text-green-600",children:"45"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Failed"}),g.jsx("span",{className:"font-medium text-red-600",children:"2"})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Cost Analysis"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Operating Cost"}),g.jsx("span",{className:"font-medium",children:"$45,200"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Cost per Ton"}),g.jsx("span",{className:"font-medium",children:"$18.45"})]}),g.jsxs("div",{className:"flex justify-between",children:[g.jsx("span",{children:"Savings"}),g.jsx("span",{className:"font-medium text-green-600",children:"$2,340"})]})]})})]})]})]}),g.jsxs(ri,{value:"monthly",className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Furnace Efficiency Trends"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:eQe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"month"}),g.jsx(ii,{domain:[85,100]}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"efficiency",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:6}})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Emissions Reduction"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(VI,{data:tQe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"month"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(Gr,{dataKey:"nox",fill:"#ef4444",name:"NOx (ppm)"}),g.jsx(Gr,{dataKey:"co",fill:"#f97316",name:"CO (ppm)"})]})})})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Scrap Quality Distribution"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(jEe,{children:[g.jsx(Dc,{data:Gj,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:n})=>`${e} ${(n*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:Gj.map((e,n)=>g.jsx(j0,{fill:e.color},`cell-${n}`))}),g.jsx(qn,{})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Maintenance Events"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(VI,{data:nQe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"month"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(Gr,{dataKey:"events",fill:"#eab308"})]})})})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Energy Savings & Cost Reduction"})}),g.jsxs(ke,{children:[g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(Ds,{data:iQe,children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"month"}),g.jsx(ii,{}),g.jsx(qn,{formatter:e=>[`$${e.toLocaleString()}`,"Savings"]}),g.jsx(jn,{type:"monotone",dataKey:"savings",stroke:"#22c55e",strokeWidth:3,dot:{fill:"#22c55e",strokeWidth:2,r:6}})]})}),g.jsxs("div",{className:"mt-4 text-center",children:[g.jsx("div",{className:"text-2xl font-bold text-green-600",children:"$108,400"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Total energy savings this year"})]})]})]})]}),g.jsx(ri,{value:"quarterly",children:g.jsx(Ye,{children:g.jsx(ke,{className:"flex items-center justify-center h-64",children:g.jsxs("div",{className:"text-center",children:[g.jsx(BW,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),g.jsx("h3",{className:"text-lg font-medium mb-2",children:"Quarterly Reports"}),g.jsx("p",{className:"text-muted-foreground",children:"Detailed quarterly analysis coming soon"})]})})})}),g.jsx(ri,{value:"annual",children:g.jsx(Ye,{children:g.jsx(ke,{className:"flex items-center justify-center h-64",children:g.jsxs("div",{className:"text-center",children:[g.jsx(BW,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),g.jsx("h3",{className:"text-lg font-medium mb-2",children:"Annual Reports"}),g.jsx("p",{className:"text-muted-foreground",children:"Comprehensive annual analysis coming soon"})]})})})})]})]})}const Bj=[{id:1,title:"High Vibration Detected",description:"Motor M3 showing abnormal vibration levels",severity:"high",location:"Furnace 1 - Motor Assembly",steps:["Approach motor M3 safely","Check vibration sensor readings","Inspect bearing housing for damage","Check lubrication levels","Schedule maintenance if vibration > 5.0 mm/s"],icon:gr,color:"text-red-600"},{id:2,title:"Door Safety Lock",description:"Ensure safety interlock is engaged",severity:"critical",location:"Furnace 2 - Access Door",steps:["Verify door is fully closed","Check safety lock indicator light","Test emergency stop functionality","Confirm pressure sensors are active","Only proceed with lock engaged"],icon:ta,color:"text-green-600"},{id:3,title:"Overheating Zone",description:"Temperature exceeding safe limits",severity:"high",location:"Furnace 3 - Heating Zone B",steps:["Reduce power input by 20%","Check cooling system status","Monitor temperature for 5 minutes","Inspect insulation integrity","Contact maintenance if temp > 1500C"],icon:Ud,color:"text-orange-600"},{id:4,title:"Gas Leak Detected",description:"Minor gas pressure fluctuation",severity:"medium",location:"Furnace 1 - Gas Manifold",steps:["Isolate affected gas line","Check pressure gauges","Inspect valve connections","Run leak detection test","Replace faulty components"],icon:to,color:"text-yellow-600"}];function sQe(){const[t,e]=S.useState(Bj[0]),n=i=>{switch(i){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-50 text-yellow-800 border-yellow-200";default:return"bg-gray-50 text-gray-800 border-gray-200"}};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"AR Operator Guide"}),g.jsx("p",{className:"text-muted-foreground",children:"Augmented reality assistance for furnace operations"})]}),g.jsxs(nn,{variant:"outline",className:"text-accent",children:[g.jsx(nU,{className:"w-4 h-4 mr-1"}),"Mobile Optimized"]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(zI,{className:"w-5 h-5"}),"Live AR View"]})}),g.jsxs(ke,{children:[g.jsxs("div",{className:"relative aspect-[9/16] bg-gradient-to-br from-gray-900 to-gray-700 rounded-lg overflow-hidden",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute top-1/4 left-1/4 w-1/2 h-1/3 border-2 border-blue-400 rounded-lg opacity-75",children:g.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white text-xs px-2 py-1 rounded",children:"Furnace 1"})}),g.jsx("div",{className:"absolute top-1/3 right-1/4 w-4 h-4 bg-red-500 rounded-full animate-pulse",children:g.jsx("div",{className:"absolute -right-20 top-0 bg-red-500 text-white text-xs px-2 py-1 rounded whitespace-nowrap",children:"High Vibration"})}),g.jsx("div",{className:"absolute bottom-1/3 left-1/3 w-4 h-4 bg-orange-500 rounded-full animate-pulse",children:g.jsx("div",{className:"absolute -left-24 top-0 bg-orange-500 text-white text-xs px-2 py-1 rounded whitespace-nowrap",children:"Overheating"})}),g.jsxs("div",{className:"absolute top-1/2 left-1/6 bg-black/70 text-white text-xs p-2 rounded",children:[g.jsx("div",{children:"T: 1420C"}),g.jsx("div",{children:"V: 3.2 mm/s"})]}),g.jsxs("div",{className:"absolute bottom-1/4 right-1/6 bg-black/70 text-white text-xs p-2 rounded",children:[g.jsx("div",{children:"Gas: 98%"}),g.jsx("div",{children:"Door: LOCKED"})]})]}),g.jsxs("div",{className:"absolute inset-2 border border-white/30 rounded pointer-events-none",children:[g.jsx("div",{className:"absolute top-2 left-2 w-6 h-6 border-l-2 border-t-2 border-white"}),g.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 border-r-2 border-t-2 border-white"}),g.jsx("div",{className:"absolute bottom-2 left-2 w-6 h-6 border-l-2 border-b-2 border-white"}),g.jsx("div",{className:"absolute bottom-2 right-2 w-6 h-6 border-r-2 border-b-2 border-white"})]}),g.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:g.jsx("div",{className:"w-8 h-8 border border-white/50 rounded-full",children:g.jsx("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-white rounded-full transform -translate-x-1/2 -translate-y-1/2"})})})]}),g.jsxs("div",{className:"mt-4 flex gap-2",children:[g.jsxs(Mt,{className:"flex-1",children:[g.jsx(zI,{className:"w-4 h-4 mr-2"}),"Scan Equipment"]}),g.jsxs(Mt,{variant:"outline",children:[g.jsx(ZC,{className:"w-4 h-4 mr-2"}),"Maintenance Mode"]})]})]})]})}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Active Alerts"})}),g.jsx(ke,{className:"space-y-3",children:Bj.map(i=>g.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${t.id===i.id?"border-primary bg-primary/5":"border-border hover:bg-muted/50"}`,onClick:()=>e(i),children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx(i.icon,{className:`w-5 h-5 mt-0.5 ${i.color}`}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"font-medium text-sm",children:i.title}),g.jsx("div",{className:"text-xs text-muted-foreground",children:i.location}),g.jsx(nn,{className:`mt-1 text-xs ${n(i.severity)}`,children:i.severity})]})]})},i.id))})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Instructions"})}),g.jsx(ke,{children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(t.icon,{className:`w-5 h-5 ${t.color}`}),g.jsx("span",{className:"font-medium",children:t.title})]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:t.description}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("h4",{className:"font-medium text-sm",children:"Step-by-step procedure:"}),g.jsx("ol",{className:"space-y-1",children:t.steps.map((i,r)=>g.jsxs("li",{className:"text-sm flex items-start gap-2",children:[g.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium mt-0.5",children:r+1}),g.jsx("span",{children:i})]},r))})]}),g.jsx("div",{className:"pt-3 border-t",children:g.jsx(Mt,{className:"w-full",children:"Mark as Complete"})})]})})]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"AR System Status"})}),g.jsx(ke,{children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2",children:g.jsx(ta,{className:"w-6 h-6 text-green-600"})}),g.jsx("div",{className:"text-sm font-medium",children:"Camera"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Active"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2",children:g.jsx(ta,{className:"w-6 h-6 text-green-600"})}),g.jsx("div",{className:"text-sm font-medium",children:"GPS"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Locked"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2",children:g.jsx(ta,{className:"w-6 h-6 text-green-600"})}),g.jsx("div",{className:"text-sm font-medium",children:"Sensors"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Connected"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-2",children:g.jsx(gr,{className:"w-6 h-6 text-yellow-600"})}),g.jsx("div",{className:"text-sm font-medium",children:"Network"}),g.jsx("div",{className:"text-xs text-muted-foreground",children:"Limited"})]})]})})]})]})}const Wr=[{id:"F1",name:"Blast Furnace 1",temperature:[1420,1415,1435,1428,1442,1430],power:[1250,1240,1280,1260,1290,1270],emissions:[85,82,88,92,89,87],efficiency:[92,91,94,93,95,94],status:"live"},{id:"F2",name:"Blast Furnace 2",temperature:[1380,1375,1395,1388,1402,1390],power:[1180,1170,1210,1190,1220,1200],emissions:[78,75,82,85,79,77],efficiency:[89,88,91,90,92,91],status:"live"},{id:"F3",name:"Blast Furnace 3",temperature:[1450,1445,1465,1458,1472,1460],power:[1320,1310,1350,1330,1360,1340],emissions:[95,92,98,102,99,97],efficiency:[87,86,89,88,90,89],status:"alert"},{id:"F4",name:"Blast Furnace 4",temperature:[1400,1395,1415,1408,1422,1410],power:[1220,1210,1250,1230,1260,1240],emissions:[82,79,85,88,83,81],efficiency:[91,90,93,92,94,93],status:"idle"}],ex=["00:00","04:00","08:00","12:00","16:00","20:00"];function oQe(){const[t,e]=S.useState("temperature"),[n,i]=S.useState(["F1","F2","F3","F4"]),r=()=>ex.map((l,c)=>{const u={time:l};return n.forEach(d=>{const h=Wr.find(I=>I.id===d);h&&(u[d]=h[t][c])}),u}),s=l=>{switch(l){case"temperature":return"Temperature (C)";case"power":return"Power (A)";case"emissions":return"Emissions (ppm)";case"efficiency":return"Efficiency (%)";default:return l}},o=l=>{switch(l){case"live":return g.jsx(nn,{className:"bg-green-100 text-green-800",children:"LIVE"});case"idle":return g.jsx(nn,{variant:"secondary",children:"IDLE"});case"alert":return g.jsx(nn,{className:"bg-red-100 text-red-800",children:"ALERT"});default:return g.jsx(nn,{variant:"outline",children:"UNKNOWN"})}},a=l=>{i(c=>c.includes(l)?c.filter(u=>u!==l):[...c,l])};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Multi-Furnace Comparison"}),g.jsx("p",{className:"text-muted-foreground",children:"Compare performance across all furnaces simultaneously"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Mt,{variant:"outline",children:[g.jsx(W0,{className:"w-4 h-4 mr-2"}),"Configure"]}),g.jsxs(Mt,{children:[g.jsx(CA,{className:"w-4 h-4 mr-2"}),"Export Data"]})]})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Select Furnaces to Compare"})}),g.jsx(ke,{children:g.jsx("div",{className:"flex flex-wrap gap-2",children:Wr.map(l=>g.jsxs(Mt,{variant:n.includes(l.id)?"default":"outline",onClick:()=>a(l.id),className:"flex items-center gap-2",children:[o(l.status),l.name]},l.id))})})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[g.jsxs(Ye,{className:"lg:col-span-1",children:[g.jsx(tt,{children:g.jsx(nt,{children:"Metric Selection"})}),g.jsxs(ke,{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Compare By:"}),g.jsxs(Ml,{value:t,onValueChange:e,children:[g.jsx(za,{children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"temperature",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Ud,{className:"w-4 h-4"}),"Temperature"]})}),g.jsx(An,{value:"power",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(to,{className:"w-4 h-4"}),"Power Consumption"]})}),g.jsx(An,{value:"emissions",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Xl,{className:"w-4 h-4"}),"Emissions"]})}),g.jsx(An,{value:"efficiency",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(M0,{className:"w-4 h-4"}),"Efficiency"]})})]})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("h4",{className:"font-medium",children:"Current Values"}),n.map(l=>{const c=Wr.find(h=>h.id===l);if(!c)return null;const u=c[t][c[t].length-1],d=t==="temperature"?"C":t==="power"?"A":t==="emissions"?"ppm":"%";return g.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted/50 rounded",children:[g.jsx("span",{className:"text-sm",children:c.name}),g.jsxs("span",{className:"font-mono font-medium",children:[u,d]})]},l)})]})]})]}),g.jsxs(Ye,{className:"lg:col-span-3",children:[g.jsx(tt,{children:g.jsxs(nt,{children:[s(t)," Comparison"]})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:400,children:g.jsxs(Ds,{data:r(),children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),n.map((l,c)=>{var d;const u=["#3b82f6","#ef4444","#22c55e","#f59e0b"];return g.jsx(jn,{type:"monotone",dataKey:l,stroke:u[c%u.length],strokeWidth:2,name:(d=Wr.find(h=>h.id===l))==null?void 0:d.name,dot:{fill:u[c%u.length],strokeWidth:2,r:4}},l)})]})})})]})]}),g.jsxs(VC,{defaultValue:"overview",className:"space-y-6",children:[g.jsxs(hh,{className:"grid w-full grid-cols-4",children:[g.jsx(di,{value:"overview",children:"Overview"}),g.jsx(di,{value:"performance",children:"Performance"}),g.jsx(di,{value:"efficiency",children:"Efficiency"}),g.jsx(di,{value:"alerts",children:"Alerts"})]}),g.jsx(ri,{value:"overview",children:g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map(l=>{const c=Wr.find(u=>u.id===l);return c?g.jsxs(Ye,{children:[g.jsx(tt,{className:"pb-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(nt,{className:"text-lg",children:c.name}),o(c.status)]})}),g.jsx(ke,{className:"space-y-3",children:g.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[g.jsxs("div",{children:[g.jsx("div",{className:"text-muted-foreground",children:"Temp"}),g.jsxs("div",{className:"font-bold",children:[c.temperature[c.temperature.length-1],"C"]})]}),g.jsxs("div",{children:[g.jsx("div",{className:"text-muted-foreground",children:"Power"}),g.jsxs("div",{className:"font-bold",children:[c.power[c.power.length-1],"A"]})]}),g.jsxs("div",{children:[g.jsx("div",{className:"text-muted-foreground",children:"Emissions"}),g.jsxs("div",{className:"font-bold",children:[c.emissions[c.emissions.length-1],"ppm"]})]}),g.jsxs("div",{children:[g.jsx("div",{className:"text-muted-foreground",children:"Efficiency"}),g.jsxs("div",{className:"font-bold",children:[c.efficiency[c.efficiency.length-1],"%"]})]})]})})]},l):null})})}),g.jsx(ri,{value:"performance",children:g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Temperature Trends"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(OEe,{data:ex.map((l,c)=>({time:l,F1:Wr[0].temperature[c],F2:Wr[1].temperature[c],F3:Wr[2].temperature[c],F4:Wr[3].temperature[c]})),children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(xs,{type:"monotone",dataKey:"F1",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3}),g.jsx(xs,{type:"monotone",dataKey:"F2",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.3}),g.jsx(xs,{type:"monotone",dataKey:"F3",stackId:"1",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.3}),g.jsx(xs,{type:"monotone",dataKey:"F4",stackId:"1",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.3})]})})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Power Consumption Comparison"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:300,children:g.jsxs(VI,{data:ex.map((l,c)=>({time:l,F1:Wr[0].power[c],F2:Wr[1].power[c],F3:Wr[2].power[c],F4:Wr[3].power[c]})),children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{}),g.jsx(qn,{}),g.jsx(Gr,{dataKey:"F1",fill:"#3b82f6",name:"Furnace 1"}),g.jsx(Gr,{dataKey:"F2",fill:"#ef4444",name:"Furnace 2"}),g.jsx(Gr,{dataKey:"F3",fill:"#22c55e",name:"Furnace 3"}),g.jsx(Gr,{dataKey:"F4",fill:"#f59e0b",name:"Furnace 4"})]})})})]})]})}),g.jsx(ri,{value:"efficiency",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Efficiency Analysis"})}),g.jsx(ke,{children:g.jsx(Ai,{width:"100%",height:400,children:g.jsxs(Ds,{data:ex.map((l,c)=>({time:l,F1:Wr[0].efficiency[c],F2:Wr[1].efficiency[c],F3:Wr[2].efficiency[c],F4:Wr[3].efficiency[c]})),children:[g.jsx(er,{strokeDasharray:"3 3"}),g.jsx(ui,{dataKey:"time"}),g.jsx(ii,{domain:[85,100]}),g.jsx(qn,{}),g.jsx(jn,{type:"monotone",dataKey:"F1",stroke:"#3b82f6",strokeWidth:3,name:"Furnace 1"}),g.jsx(jn,{type:"monotone",dataKey:"F2",stroke:"#ef4444",strokeWidth:3,name:"Furnace 2"}),g.jsx(jn,{type:"monotone",dataKey:"F3",stroke:"#22c55e",strokeWidth:3,name:"Furnace 3"}),g.jsx(jn,{type:"monotone",dataKey:"F4",stroke:"#f59e0b",strokeWidth:3,name:"Furnace 4"})]})})})]})}),g.jsx(ri,{value:"alerts",children:g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"Active Alerts Across Furnaces"})}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:[{furnace:"F3",severity:"critical",message:"Temperature exceeding threshold",time:"2 min ago"},{furnace:"F2",severity:"warning",message:"High vibration detected",time:"15 min ago"},{furnace:"F1",severity:"info",message:"Maintenance due in 3 days",time:"1 hour ago"},{furnace:"F4",severity:"warning",message:"Power consumption spike",time:"30 min ago"}].map((l,c)=>g.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(nn,{variant:l.severity==="critical"?"destructive":l.severity==="warning"?"secondary":"outline",children:l.furnace}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:l.message}),g.jsx("div",{className:"text-sm text-muted-foreground",children:l.time})]})]}),g.jsxs(Mt,{variant:"outline",size:"sm",children:[g.jsx(Xc,{className:"w-4 h-4 mr-1"}),"View"]})]},c))})})]})})]})]})}function aQe(){const[t,e]=S.useState(!0),n=()=>{e(!1)},i=()=>{e(!0);const r=document.getElementById("wokwi-iframe");r&&(r.src=r.src)};return g.jsx("div",{className:"flex-1 overflow-auto p-3 md:p-6 grid-bg",children:g.jsxs("div",{className:"max-w-screen-2xl mx-auto space-y-4 md:space-y-6",children:[g.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[g.jsxs("div",{children:[g.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-foreground mb-2 md:mb-3 flex items-center gap-3",children:[g.jsx(jI,{className:"w-10 h-10 text-primary"}),"IoT Simulation"]}),g.jsx("p",{className:"text-lg md:text-xl text-muted-foreground",children:"Real-time IoT device simulation with ESP32 and sensors"})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs(nn,{variant:"outline",className:"flex items-center gap-2",children:[g.jsx(pA,{className:"w-3 h-3"}),"Live Simulation"]}),g.jsxs(Mt,{variant:"outline",size:"sm",onClick:i,children:[g.jsx(SW,{className:"w-4 h-4 mr-2"}),"Refresh"]}),g.jsx(Mt,{variant:"outline",size:"sm",asChild:!0,children:g.jsxs("a",{href:"https://wokwi.com/projects/448318345180665857",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[g.jsx(dle,{className:"w-4 h-4"}),"Open in Wokwi"]})})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center",children:g.jsx(Xl,{className:"w-5 h-5 text-green-500"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-lg font-medium",children:"ESP32 Status"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Online"})]})]})})}),g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:g.jsx(pA,{className:"w-5 h-5 text-blue-500"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-lg font-medium",children:"Network"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Connected"})]})]})})}),g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-500/20 flex items-center justify-center",children:g.jsx(to,{className:"w-5 h-5 text-orange-500"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-lg font-medium",children:"Sensors"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"})]})]})})})]}),g.jsx("div",{className:"flex justify-center",children:g.jsxs(Ye,{className:"glass-card overflow-hidden",style:{width:"70%",maxWidth:"1000px"},children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2 text-2xl",children:[g.jsx(jI,{className:"w-6 h-6"}),"ESP32 IoT Device Simulation"]})}),g.jsx(ke,{className:"p-0",children:g.jsxs("div",{className:"relative w-full",style:{height:"600px"},children:[t&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-10",children:g.jsxs("div",{className:"flex flex-col items-center gap-4",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),g.jsx("p",{className:"text-xl text-muted-foreground font-semibold",children:"Loading IoT Simulation..."})]})}),g.jsx("iframe",{id:"wokwi-iframe",src:"https://wokwi.com/projects/448318345180665857",className:"w-full h-full border-0",title:"ESP32 IoT Simulation",onLoad:n,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})]})})]})}),g.jsxs(Ye,{className:"glass-card",children:[g.jsx(tt,{children:g.jsx(nt,{className:"text-2xl",children:"Simulation Details"})}),g.jsxs(ke,{className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold mb-3 text-xl",children:"Hardware Components"}),g.jsxs("ul",{className:"text-lg text-muted-foreground space-y-2",children:[g.jsx("li",{children:" ESP32 Microcontroller"}),g.jsx("li",{children:" DHT11 Temperature Sensor"}),g.jsx("li",{children:" MQ-135 Air Quality Sensor"}),g.jsx("li",{children:" Vibration Sensor (SW-420)"}),g.jsx("li",{children:" LED Indicators"})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold mb-3 text-xl",children:"Features"}),g.jsxs("ul",{className:"text-lg text-muted-foreground space-y-2",children:[g.jsx("li",{children:" Real-time sensor data"}),g.jsx("li",{children:" WiFi connectivity simulation"}),g.jsx("li",{children:" MQTT protocol support"}),g.jsx("li",{children:" Industrial monitoring"}),g.jsx("li",{children:" Alert system integration"})]})]})]}),g.jsx("div",{className:"pt-6 border-t",children:g.jsx("p",{className:"text-lg text-muted-foreground",children:"This simulation demonstrates a complete IoT setup for industrial monitoring. The ESP32 collects data from various sensors and transmits it to the EcoSteel AI platform for real-time analysis and predictive maintenance."})})]})]})]})})}function lQe(){const{toast:t}=wD(),{data:e=[],isLoading:n}=vD({queryKey:["/api/alerts"],refetchInterval:5e3}),i=aae({mutationFn:async h=>await lae("POST",`/api/alerts/${h}/acknowledge`,{}),onSuccess:()=>{n5.invalidateQueries({queryKey:["/api/alerts"]}),t({title:"Alert Acknowledged",description:"The alert has been successfully acknowledged."})},onError:()=>{t({title:"Error",description:"Failed to acknowledge alert. Please try again.",variant:"destructive"})}}),r=h=>{switch(h){case"critical":return CY;case"warning":return gr;case"info":return mY;default:return fA}},s=h=>{switch(h){case"critical":return"bg-destructive text-destructive-foreground";case"warning":return"bg-yellow-500 text-background";case"info":return"bg-primary text-primary-foreground";default:return"bg-muted"}},o=h=>{i.mutate(h)},a=h=>{const I=Math.floor((Date.now()-new Date(h).getTime())/6e4);if(I<60)return`${I}m ago`;const p=Math.floor(I/60);return p<24?`${p}h ago`:`${Math.floor(p/24)}d ago`},l=e.filter(h=>h.severity==="critical"),c=e.filter(h=>h.severity==="warning"),u=e.filter(h=>h.severity==="info"),d=e.filter(h=>!h.acknowledged);return g.jsx("div",{className:"flex-1 overflow-auto p-6 grid-bg",children:g.jsxs("div",{className:"max-w-screen-2xl mx-auto space-y-6",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Alert Center"}),g.jsx("p",{className:"text-muted-foreground",children:"Monitor and manage system alerts and notifications"})]}),n&&g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-6 text-center text-muted-foreground",children:"Loading alerts..."})}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm text-muted-foreground",children:"Unacknowledged"}),g.jsx("p",{className:"text-2xl font-bold font-mono text-destructive counter pulse-glow",children:d.length})]}),g.jsx(fA,{className:"w-6 h-6 text-destructive"})]})})}),g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm text-muted-foreground",children:"Critical"}),g.jsx("p",{className:"text-2xl font-bold font-mono text-destructive counter",children:l.length})]}),g.jsx(CY,{className:"w-6 h-6 text-destructive"})]})})}),g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm text-muted-foreground",children:"Warnings"}),g.jsx("p",{className:"text-2xl font-bold font-mono text-yellow-500 counter",children:c.length})]}),g.jsx(gr,{className:"w-6 h-6 text-yellow-500"})]})})}),g.jsx(Ye,{className:"glass-card",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm text-muted-foreground",children:"Info"}),g.jsx("p",{className:"text-2xl font-bold font-mono text-primary counter",children:u.length})]}),g.jsx(mY,{className:"w-6 h-6 text-primary"})]})})})]}),g.jsxs(VC,{defaultValue:"all",className:"w-full",children:[g.jsxs(hh,{className:"glass-card",children:[g.jsx(di,{value:"all","data-testid":"tab-all",children:"All Alerts"}),g.jsxs(di,{value:"unacknowledged","data-testid":"tab-unacknowledged",children:["Unacknowledged (",d.length,")"]}),g.jsx(di,{value:"critical","data-testid":"tab-critical",children:"Critical"}),g.jsx(di,{value:"warning","data-testid":"tab-warning",children:"Warnings"}),g.jsx(di,{value:"info","data-testid":"tab-info",children:"Info"})]}),g.jsx(ri,{value:"all",className:"mt-6",children:g.jsx("div",{className:"space-y-3",children:e.map(h=>{const I=r(h.severity);return g.jsx(Ye,{className:`glass-card hover-elevate ${h.acknowledged?"":"glow-accent"}`,"data-testid":`card-alert-${h.id.toLowerCase()}`,children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-md flex items-center justify-center ${s(h.severity)} ${!h.acknowledged&&h.severity==="critical"?"pulse-glow":""}`,children:g.jsx(I,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-base font-semibold text-card-foreground",children:h.title}),g.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.message})]}),!h.acknowledged&&g.jsxs(Mt,{variant:"outline",size:"sm",onClick:()=>o(h.id),"data-testid":`button-ack-${h.id.toLowerCase()}`,children:[g.jsx(ta,{className:"w-3 h-3 mr-2"}),"Acknowledge"]}),h.acknowledged&&g.jsx(nn,{variant:"secondary",className:"whitespace-nowrap",children:"Acknowledged"})]}),g.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[g.jsx("span",{className:"font-mono",children:h.source}),h.furnaceId&&g.jsxs(nn,{variant:"outline",className:"font-mono",children:["Furnace ",h.furnaceId]}),h.sensorId&&g.jsxs(nn,{variant:"outline",className:"font-mono",children:["Sensor ",h.sensorId]}),g.jsx("span",{className:"ml-auto font-mono",children:a(h.timestamp)})]})]})]})})},h.id)})})}),g.jsx(ri,{value:"unacknowledged",className:"mt-6",children:g.jsx("div",{className:"space-y-3",children:d.map(h=>{const I=r(h.severity);return g.jsx(Ye,{className:"glass-card hover-elevate glow-accent",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-md flex items-center justify-center ${s(h.severity)} pulse-glow`,children:g.jsx(I,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-base font-semibold text-card-foreground",children:h.title}),g.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.message})]}),g.jsxs(Mt,{variant:"outline",size:"sm",onClick:()=>o(h.id),children:[g.jsx(ta,{className:"w-3 h-3 mr-2"}),"Acknowledge"]})]}),g.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[g.jsx("span",{className:"font-mono",children:h.source}),g.jsx("span",{className:"ml-auto font-mono",children:a(h.timestamp)})]})]})]})})},h.id)})})}),g.jsx(ri,{value:"critical",className:"mt-6",children:g.jsx("div",{className:"space-y-3",children:l.map(h=>{const I=r(h.severity);return g.jsx(Ye,{className:"glass-card hover-elevate",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-md flex items-center justify-center ${s(h.severity)}`,children:g.jsx(I,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"text-base font-semibold text-card-foreground",children:h.title}),g.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.message}),g.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mt-2",children:[g.jsx("span",{className:"font-mono",children:h.source}),g.jsx("span",{className:"ml-auto font-mono",children:a(h.timestamp)})]})]})]})})},h.id)})})}),g.jsx(ri,{value:"warning",className:"mt-6",children:g.jsx("div",{className:"space-y-3",children:c.map(h=>{const I=r(h.severity);return g.jsx(Ye,{className:"glass-card hover-elevate",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-md flex items-center justify-center ${s(h.severity)}`,children:g.jsx(I,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"text-base font-semibold text-card-foreground",children:h.title}),g.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.message}),g.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mt-2",children:[g.jsx("span",{className:"font-mono",children:h.source}),g.jsx("span",{className:"ml-auto font-mono",children:a(h.timestamp)})]})]})]})})},h.id)})})}),g.jsx(ri,{value:"info",className:"mt-6",children:g.jsx("div",{className:"space-y-3",children:u.map(h=>{const I=r(h.severity);return g.jsx(Ye,{className:"glass-card hover-elevate",children:g.jsx(ke,{className:"p-4",children:g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-md flex items-center justify-center ${s(h.severity)}`,children:g.jsx(I,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"text-base font-semibold text-card-foreground",children:h.title}),g.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.message}),g.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mt-2",children:[g.jsx("span",{className:"font-mono",children:h.source}),g.jsx("span",{className:"ml-auto font-mono",children:a(h.timestamp)})]})]})]})})},h.id)})})})]})]})})}var aT="Switch",[cQe,KQe]=Ns(aT),[gQe,uQe]=cQe(aT),Wne=S.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...d}=t,[h,I]=S.useState(null),p=Gn(e,v=>I(v)),y=S.useRef(!1),A=h?u||!!h.closest("form"):!0,[m=!1,b]=Qa({prop:r,defaultProp:s,onChange:c});return g.jsxs(gQe,{scope:n,checked:m,disabled:a,children:[g.jsx(Ht.button,{type:"button",role:"switch","aria-checked":m,"aria-required":o,"data-state":Fne(m),"data-disabled":a?"":void 0,disabled:a,value:l,...d,ref:p,onClick:ht(t.onClick,v=>{b(w=>!w),A&&(y.current=v.isPropagationStopped(),y.current||v.stopPropagation())})}),A&&g.jsx(dQe,{control:h,bubbles:!y.current,name:i,value:l,checked:m,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});Wne.displayName=aT;var Mne="SwitchThumb",Vne=S.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=uQe(Mne,n);return g.jsx(Ht.span,{"data-state":Fne(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});Vne.displayName=Mne;var dQe=t=>{const{control:e,checked:n,bubbles:i=!0,...r}=t,s=S.useRef(null),o=R5(n),a=A5(e);return S.useEffect(()=>{const l=s.current,c=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(c,"checked").set;if(o!==n&&d){const h=new Event("click",{bubbles:i});d.call(l,n),l.dispatchEvent(h)}},[o,n,i]),g.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:s,style:{...t.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Fne(t){return t?"checked":"unchecked"}var _ne=Wne,hQe=Vne;const Mx=S.forwardRef(({className:t,...e},n)=>g.jsx(_ne,{className:At("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:g.jsx(hQe,{className:At("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Mx.displayName=_ne.displayName;const Tne=S.forwardRef(({className:t,...e},n)=>g.jsx("textarea",{className:At("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...e}));Tne.displayName="Textarea";function IQe(){const[t,e]=S.useState({host:"mqtt.ecosteel.local",port:"1883",username:"",password:"",topic:"ecosteel/furnaces/#"}),[n,i]=S.useState({temperature:{warning:1450,critical:1500},vibration:{warning:3,critical:5},emissions:{warning:90,critical:120},power:{warning:1300,critical:1500}}),[r,s]=S.useState({email:!0,sms:!1,push:!0,slack:!1}),[o,a]=S.useState({autoBackup:!0,dataRetention:"90",theme:"light",language:"en"}),[l,c]=S.useState(!1),u=()=>{console.log("Settings saved")};return g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"System Settings & Administration"}),g.jsx("p",{className:"text-muted-foreground",children:"Configure system parameters, thresholds, and user management"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Mt,{variant:"outline",children:[g.jsx(SW,{className:"w-4 h-4 mr-2"}),"Reset to Defaults"]}),g.jsxs(Mt,{onClick:u,children:[g.jsx(wle,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]}),g.jsxs(VC,{defaultValue:"mqtt",className:"space-y-6",children:[g.jsxs(hh,{className:"grid w-full grid-cols-6",children:[g.jsx(di,{value:"mqtt",children:"MQTT"}),g.jsx(di,{value:"thresholds",children:"Thresholds"}),g.jsx(di,{value:"notifications",children:"Notifications"}),g.jsx(di,{value:"users",children:"Users"}),g.jsx(di,{value:"system",children:"System"}),g.jsx(di,{value:"maintenance",children:"Maintenance"})]}),g.jsx(ri,{value:"mqtt",children:g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(pA,{className:"w-5 h-5"}),"MQTT Configuration"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure MQTT broker settings for IoT device communication"})]}),g.jsxs(ke,{className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"mqtt-host",children:"Broker Host"}),g.jsx(Ra,{id:"mqtt-host",value:t.host,onChange:d=>e({...t,host:d.target.value}),placeholder:"mqtt.example.com"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"mqtt-port",children:"Port"}),g.jsx(Ra,{id:"mqtt-port",type:"number",value:t.port,onChange:d=>e({...t,port:d.target.value}),placeholder:"1883"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"mqtt-topic",children:"Topic Pattern"}),g.jsx(Ra,{id:"mqtt-topic",value:t.topic,onChange:d=>e({...t,topic:d.target.value}),placeholder:"ecosteel/furnaces/#"})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"mqtt-username",children:"Username"}),g.jsx(Ra,{id:"mqtt-username",value:t.username,onChange:d=>e({...t,username:d.target.value}),placeholder:"Optional"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{htmlFor:"mqtt-password",children:"Password"}),g.jsxs("div",{className:"relative",children:[g.jsx(Ra,{id:"mqtt-password",type:l?"text":"password",value:t.password,onChange:d=>e({...t,password:d.target.value}),placeholder:"Optional"}),g.jsx(Mt,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!l),children:l?g.jsx(hle,{className:"h-4 w-4"}):g.jsx(Xc,{className:"h-4 w-4"})})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Connection Status"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ta,{className:"w-4 h-4 text-green-600"}),g.jsx("span",{className:"text-sm text-green-600",children:"Connected"})]})]})]})]}),g.jsx(px,{}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"Device Mapping"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Sensor ID  Furnace Mapping"}),g.jsx(Tne,{placeholder:`TEMP001  F1
VIB001  F1
GAS001  F2
...`,rows:4})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Active Devices"}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded",children:[g.jsx("span",{className:"text-sm",children:"Temperature Sensors"}),g.jsx(nn,{variant:"outline",children:"12 active"})]}),g.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded",children:[g.jsx("span",{className:"text-sm",children:"Vibration Sensors"}),g.jsx(nn,{variant:"outline",children:"8 active"})]}),g.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded",children:[g.jsx("span",{className:"text-sm",children:"Gas Sensors"}),g.jsx(nn,{variant:"outline",children:"6 active"})]})]})]})]})]})]})]})}),g.jsx(ri,{value:"thresholds",children:g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(gr,{className:"w-5 h-5"}),"Alert Thresholds"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure warning and critical thresholds for all monitored parameters"})]}),g.jsx(ke,{className:"space-y-6",children:Object.entries(n).map(([d,h])=>g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[d==="temperature"&&g.jsx(Ud,{className:"w-4 h-4"}),d==="vibration"&&g.jsx(Xl,{className:"w-4 h-4"}),d==="emissions"&&g.jsx(to,{className:"w-4 h-4"}),d==="power"&&g.jsx(to,{className:"w-4 h-4"}),g.jsxs("h4",{className:"font-medium capitalize",children:[d," Thresholds"]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Warning Threshold"}),g.jsx(Ra,{type:"number",value:h.warning,onChange:I=>i({...n,[d]:{...h,warning:parseFloat(I.target.value)}})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Critical Threshold"}),g.jsx(Ra,{type:"number",value:h.critical,onChange:I=>i({...n,[d]:{...h,critical:parseFloat(I.target.value)}})})]})]})]},d))})]})}),g.jsx(ri,{value:"notifications",children:g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(fA,{className:"w-5 h-5"}),"Notification Preferences"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure how and when you receive system alerts and notifications"})]}),g.jsxs(ke,{className:"space-y-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"Notification Channels"}),Object.entries(r).map(([d,h])=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"space-y-0.5",children:[g.jsx(ar,{className:"text-base capitalize",children:d}),g.jsxs("p",{className:"text-sm text-muted-foreground",children:["Receive notifications via ",d]})]}),g.jsx(Mx,{checked:h,onCheckedChange:I=>s({...r,[d]:I})})]},d))]}),g.jsx(px,{}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"Alert Categories"}),g.jsx("div",{className:"space-y-3",children:[{name:"Critical Alerts",description:"System failures, safety issues"},{name:"Warning Alerts",description:"Parameter deviations, maintenance needed"},{name:"Info Alerts",description:"Status updates, scheduled events"},{name:"Maintenance Alerts",description:"Scheduled maintenance reminders"}].map(d=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx(ar,{className:"text-base",children:d.name}),g.jsx("p",{className:"text-sm text-muted-foreground",children:d.description})]}),g.jsx(Mx,{defaultChecked:!0})]},d.name))})]})]})]})}),g.jsx(ri,{value:"users",children:g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(sw,{className:"w-5 h-5"}),"User Management"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage user accounts, roles, and permissions"})]}),g.jsx(ke,{children:g.jsx("div",{className:"space-y-4",children:[{name:"John Smith",role:"Plant Manager",status:"Active",lastLogin:"2 hours ago"},{name:"Sarah Johnson",role:"Maintenance Engineer",status:"Active",lastLogin:"1 day ago"},{name:"Mike Davis",role:"Operator",status:"Active",lastLogin:"30 min ago"},{name:"Admin User",role:"Administrator",status:"Active",lastLogin:"5 min ago"}].map((d,h)=>g.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:g.jsx(sw,{className:"w-5 h-5"})}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:d.name}),g.jsx("div",{className:"text-sm text-muted-foreground",children:d.role})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(nn,{variant:d.status==="Active"?"default":"secondary",children:d.status}),g.jsx("span",{className:"text-sm text-muted-foreground",children:d.lastLogin}),g.jsx(Mt,{variant:"outline",size:"sm",children:"Edit"})]})]},h))})})]})}),g.jsx(ri,{value:"system",children:g.jsxs("div",{className:"space-y-6",children:[g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(W0,{className:"w-5 h-5"}),"System Configuration"]})}),g.jsx(ke,{className:"space-y-6",children:g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Theme"}),g.jsxs(Ml,{value:o.theme,onValueChange:d=>a({...o,theme:d}),children:[g.jsx(za,{children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"light",children:"Light"}),g.jsx(An,{value:"dark",children:"Dark"}),g.jsx(An,{value:"auto",children:"Auto"})]})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Language"}),g.jsxs(Ml,{value:o.language,onValueChange:d=>a({...o,language:d}),children:[g.jsx(za,{children:g.jsx(Vl,{})}),g.jsxs(ja,{children:[g.jsx(An,{value:"en",children:"English"}),g.jsx(An,{value:"es",children:"Spanish"}),g.jsx(An,{value:"de",children:"German"}),g.jsx(An,{value:"fr",children:"French"})]})]})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ar,{children:"Data Retention (days)"}),g.jsx(Ra,{type:"number",value:o.dataRetention,onChange:d=>a({...o,dataRetention:d.target.value})})]}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"space-y-0.5",children:[g.jsx(ar,{children:"Automatic Backup"}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Daily system backup"})]}),g.jsx(Mx,{checked:o.autoBackup,onCheckedChange:d=>a({...o,autoBackup:d})})]})]})]})})]}),g.jsxs(Ye,{children:[g.jsx(tt,{children:g.jsx(nt,{children:"System Information"})}),g.jsx(ke,{children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold",children:"4"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Furnaces"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold",children:"26"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Connected Sensors"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold",children:"99.7%"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"System Uptime"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-2xl font-bold",children:"2.1"}),g.jsx("div",{className:"text-sm text-muted-foreground",children:"Version"})]})]})})]})]})}),g.jsx(ri,{value:"maintenance",children:g.jsxs(Ye,{children:[g.jsxs(tt,{children:[g.jsxs(nt,{className:"flex items-center gap-2",children:[g.jsx(Mm,{className:"w-5 h-5"}),"System Maintenance"]}),g.jsx("p",{className:"text-sm text-muted-foreground",children:"Database maintenance, system updates, and diagnostic tools"})]}),g.jsxs(ke,{className:"space-y-6",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"Database Operations"}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(uZ,{className:"w-4 h-4 mr-2"}),"Optimize Database"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(uZ,{className:"w-4 h-4 mr-2"}),"Clean Old Data"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(uZ,{className:"w-4 h-4 mr-2"}),"Backup Database"]})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"System Diagnostics"}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(Xl,{className:"w-4 h-4 mr-2"}),"Run System Check"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(pA,{className:"w-4 h-4 mr-2"}),"Test Connectivity"]}),g.jsxs(Mt,{variant:"outline",className:"w-full justify-start",children:[g.jsx(SW,{className:"w-4 h-4 mr-2"}),"Restart Services"]})]})]})]}),g.jsx(px,{}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("h4",{className:"font-medium",children:"System Logs"}),g.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg font-mono text-sm max-h-40 overflow-y-auto",children:[g.jsx("div",{children:"[2024-01-15 14:30:25] System startup completed"}),g.jsx("div",{children:"[2024-01-15 14:30:26] MQTT connection established"}),g.jsx("div",{children:"[2024-01-15 14:30:27] All sensors online"}),g.jsx("div",{children:"[2024-01-15 14:31:15] Furnace F1 temperature alert acknowledged"}),g.jsx("div",{children:"[2024-01-15 14:32:01] Database backup completed"}),g.jsx("div",{children:"[2024-01-15 14:35:22] User login: admin"})]})]})]})]})})]})]})}function fQe(){return g.jsxs(Noe,{children:[g.jsx(gs,{path:"/login",component:CQe}),g.jsx(gs,{path:"/",component:eYe}),g.jsx(gs,{path:"/furnaces",component:FYe}),g.jsx(gs,{path:"/digital-twin",component:kJe}),g.jsx(gs,{path:"/scrap-ai",component:HJe}),g.jsx(gs,{path:"/emissions",component:LJe}),g.jsx(gs,{path:"/maintenance",component:DJe}),g.jsx(gs,{path:"/history",component:$Je}),g.jsx(gs,{path:"/reports",component:rQe}),g.jsx(gs,{path:"/ar-guide",component:sQe}),g.jsx(gs,{path:"/iot-simulation",component:aQe}),g.jsx(gs,{path:"/multi-furnace",component:oQe}),g.jsx(gs,{path:"/alerts",component:lQe}),g.jsx(gs,{path:"/settings",component:IQe}),g.jsx(gs,{component:gde})]})}function CQe(){return g.jsx(AD,{client:n5,children:g.jsxs(x5,{children:[g.jsx(Ide,{}),g.jsx(hU,{})]})})}function pQe(){const t={"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"};return g.jsx(AD,{client:n5,children:g.jsxs(x5,{children:[g.jsx(ede,{style:t,children:g.jsxs("div",{className:"flex h-screen w-full",children:[g.jsx(ade,{}),g.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[g.jsxs("header",{className:"flex items-center justify-between p-2 md:p-4 border-b border-border bg-background",children:[g.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[g.jsx(nde,{"data-testid":"button-sidebar-toggle"}),g.jsxs("div",{className:"min-w-0",children:[g.jsx("h2",{className:"text-xs md:text-sm font-semibold text-foreground truncate",children:"Steel Plant Monitoring"}),g.jsx("p",{className:"text-xs text-muted-foreground font-mono hidden sm:block",children:"Live System Status"})]})]}),g.jsx("div",{className:"flex items-center gap-2 md:gap-4",children:g.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[g.jsx("div",{className:"w-2 h-2 rounded-full bg-accent pulse-glow"}),g.jsx("span",{className:"text-muted-foreground font-mono hidden sm:inline",children:"System Online"}),g.jsx("span",{className:"text-muted-foreground font-mono sm:hidden",children:"Online"})]})})]}),g.jsx("main",{className:"flex-1 overflow-auto",children:g.jsx(fQe,{})})]})]})}),g.jsx(hU,{})]})})}UV(document.getElementById("root")).render(g.jsx(pQe,{}));
